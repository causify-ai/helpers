{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"index.html","title":"Home","text":""},{"location":"index.html#readme","title":"Readme","text":"<ul> <li>This file is the entrypoint of all the documentation and describes all the     documentation files in the <code>docs</code> directory</li> </ul>"},{"location":"index.html#how_to_organize_the_docs","title":"How to organize the docs","text":"<ul> <li> <p>Documentation can be organized in multiple ways:</p> <ul> <li>By software component</li> <li>By functionality (e.g., infra, backtesting)</li> <li>By team (e.g., trading ops)</li> </ul> </li> <li> <p>We have decided that</p> <ul> <li>For each software component there should be a corresponding documentation</li> <li>We have documentation for each functionality and team</li> </ul> </li> <li> <p>Processes</p> <ul> <li><code>onboarding</code></li> <li><code>general_background</code></li> <li><code>work_organization</code></li> <li><code>work_tools</code></li> <li><code>coding</code></li> <li>...</li> </ul> </li> <li> <p>Software components</p> <ul> <li><code>build</code></li> <li><code>kaizenflow</code></li> <li><code>datapull</code></li> <li><code>dataflow</code></li> <li><code>trade_execution</code></li> <li><code>infra</code></li> <li>...</li> </ul> </li> </ul>"},{"location":"index.html#dir_vs_no-dirs","title":"Dir vs no-dirs","text":"<ul> <li>Directories make it difficult to navigate the docs</li> <li>We use \u201cname spaces\u201d until we have enough objects to create a dir</li> </ul>"},{"location":"index.html#tracking_reviews_and_improvements","title":"Tracking reviews and improvements","text":"<ul> <li>Doc needs to be reviewed \"actively\", e.g., by making sure someone checks them     in the field</li> <li> <p>Somebody should verify that is \"executable\"</p> </li> <li> <p>There is a     Master Documentation Gdoc     that contains a list of tasks related to documentation, including what needs     to be reviewed</p> </li> <li> <p>For small action items we add a markdown TODO like we do for the code     <pre><code>&lt;!-- TODO(gp): ... --&gt;\n</code></pre></p> </li> <li> <p>To track the last revision we use a tag at the end of the document like:     <pre><code>Last review: GP on 2024-04-20, ...\n</code></pre></p> </li> </ul>"},{"location":"index.html#how_to_search_the_documentation","title":"How to search the documentation","text":"<ul> <li> <p>Be patient and assume that the documentation is there, but you can't find it     because you are not familiar with it and not because you think the     documentation is poorly done or not organized</p> </li> <li> <p>Look for files that contain words related to what you are looking for</p> <ul> <li>E.g., <code>ffind.py XYZ</code></li> </ul> </li> <li>Grep in the documentation looking for words related to what you are looking     for<ul> <li>E.g., <code>jackmd trading</code></li> </ul> </li> <li>Scan through the content of the references<ul> <li>E.g., <code>all.code_organization.reference.md</code></li> </ul> </li> <li>Grep for the name of a tool in the documentation</li> </ul>"},{"location":"index.html#file_description","title":"File description","text":"<ul> <li>Invariants:<ul> <li>Files are organized by directory (e.g., <code>docs</code>, <code>docs/work_tools</code>)</li> <li>Each file name uses the Diataxis naming convention</li> <li>Each file name should be linked to the corresponding file as always</li> <li>Files are organized in alphabetical order to make it easy to add more files     and see which file is missing</li> <li>Each file has a bullet lists summarizing its content using imperative mode</li> </ul> </li> </ul>"},{"location":"index.html#dir_structure","title":"Dir structure","text":"<ul> <li> <p>Prompt: For each directory write a short comment on its content, based on     the names of the files contained. Report the output in markdown, with a bullet     per directory, reflecting the structure of the files in the markdown and a     comment of fewer than 30 words for each directory     <pre><code>&gt; find docs -name \"*\\.md\" -d | sort\n</code></pre></p> </li> <li> <p><code>docs/</code></p> <ul> <li>Contains top-level references and guides for documentation, workflows, and     software components.</li> </ul> </li> <li><code>docs/build_system/</code><ul> <li>Documents CI tools like Gitleaks, Semgrep, linters, and Pytest-Allure     integrations for the build process.</li> </ul> </li> <li><code>docs/code_guidelines/</code><ul> <li>Provides detailed how-to guides for writing clean, maintainable, and     review-ready code with AI productivity tips.</li> </ul> </li> <li><code>docs/documentation_meta/</code><ul> <li>Explains documentation frameworks, diagrams, and tooling for producing     technical and reproducible docs.</li> </ul> </li> <li><code>docs/general_background/</code><ul> <li>Offers foundational references like glossaries, abbreviations, and curated     reading materials.</li> </ul> </li> <li><code>docs/onboarding/</code><ul> <li>Comprehensive onboarding guides and checklists for developers, interns, and     contractors.</li> </ul> </li> <li><code>docs/tools/</code><ul> <li>Guides for general-purpose development and infrastructure tools, including     code hygiene, IDEs, and APIs.</li> <li><code>docs/tools/dev_system/</code><ul> <li>Focused on local development setup, environment configuration, dependency     management, and repo orchestration.</li> </ul> </li> <li><code>docs/tools/docker/</code><ul> <li>Docker usage guides for development workflows, including sibling     containers, DockerHub, and helper containers.</li> </ul> </li> <li><code>docs/tools/documentation_toolchain/</code><ul> <li>Covers the pipeline for rendering images, LaTeX integration, and notebook     asset extraction for docs.</li> </ul> </li> <li><code>docs/tools/git/</code><ul> <li>Git usage and automation guides, including hooks and helper integrations.</li> </ul> </li> <li><code>docs/tools/helpers/</code><ul> <li>Small helper modules and utilities, like caching, playback, dataframes, and     interactive grids.</li> </ul> </li> <li><code>docs/tools/jupyter_notebooks/</code><ul> <li>Jupyter-specific enhancements, including TOC creation, Jupytext usage, and     markdown publishing.</li> </ul> </li> <li><code>docs/tools/linter/</code><ul> <li>Development and customization of linters and link fixers for markdown     content.</li> </ul> </li> <li><code>docs/tools/notebooks/</code><ul> <li>Guides for managing and plotting data in Jupyter notebooks, including     pandas and publishing.</li> </ul> </li> <li><code>docs/tools/thin_environment/</code><ul> <li>Documentation of lightweight Python environments for GitHub and CI/CD     pipelines.</li> </ul> </li> <li><code>docs/tools/unit_test/</code><ul> <li>Unit testing practices: writing, structuring, and executing tests     effectively.</li> </ul> </li> </ul> </li> <li> <p><code>docs/work_organization/</code></p> <ul> <li>Team process documentation: roles, workflows, feedback, issue tracking, and     collaboration practices like Scrum and Kaizen.</li> </ul> </li> <li> <p>Review:</p> <ul> <li>GP, 2025-05-09</li> <li>GP, 2024-08-11</li> </ul> </li> </ul>"},{"location":"ai_coding/index.html","title":"Index","text":""},{"location":"ai_coding/index.html#ai_coding_documentation","title":"AI Coding Documentation","text":"<p>This directory contains comprehensive documentation and templates for AI-assisted software development, covering coding standards, testing patterns, tool guides, and workflow templates for Claude Code and other AI coding tools.</p>"},{"location":"ai_coding/index.html#structure_of_the_dir","title":"Structure of the Dir","text":"<ul> <li><code>ai.claude_code.how_to_guide_figs/</code><ul> <li>Screenshots and images for Claude Code setup and usage guide</li> </ul> </li> <li><code>ai.github_copilot_review.how_to_guide_figs/</code><ul> <li>Screenshots demonstrating GitHub Copilot review workflow</li> </ul> </li> </ul>"},{"location":"ai_coding/index.html#description_of_files","title":"Description of Files","text":""},{"location":"ai_coding/index.html#templates","title":"Templates","text":"<ul> <li><code>code_template.py</code><ul> <li>Template demonstrating Causify coding style with logging, docstrings, REST     comments, and helper patterns</li> </ul> </li> <li><code>unit_test_template.py</code><ul> <li>Template showing unit test structure with helper methods, test cases, and     assertion patterns</li> </ul> </li> <li><code>notebook_template.py</code><ul> <li>Jupyter notebook template in py:percent format with standard setup cells     and imports</li> </ul> </li> <li><code>notebook_template.ipynb</code><ul> <li>Jupyter notebook template in ipynb format with standard cells and structure</li> </ul> </li> </ul>"},{"location":"ai_coding/index.html#tool_guides","title":"Tool Guides","text":"<ul> <li><code>ai.claude_code.how_to_guide.md</code><ul> <li>Quick start guide for using Claude Code CLI on dev servers with     authentication setup</li> </ul> </li> <li><code>ai.claude_skills.how_to_guide.md</code><ul> <li>Guide on creating and using Claude Skills for specialized, reusable AI     workflows</li> </ul> </li> <li><code>ai.github_copilot_review.how_to_guide.md</code><ul> <li>Guide for requesting and using GitHub Copilot code reviews on pull requests</li> </ul> </li> <li><code>all.claude_artifacts.how_to_guide.md</code><ul> <li>Tutorial on creating and editing interactive Claude Artifacts for web apps     and visualizations</li> </ul> </li> <li><code>all.claude_code.how_to_guide.md</code><ul> <li>Comprehensive guide covering Claude Code usage, workflows, AI development     tools, and best practices</li> </ul> </li> <li><code>all.llm_cli.how_to_guide.md</code><ul> <li>Installation and usage guide for the llm CLI tool by Simon Willison for     LLM interactions</li> </ul> </li> </ul>"},{"location":"ai_coding/index.html#workflows_and_reference","title":"Workflows and Reference","text":"<ul> <li><code>ai.instruction_template.md</code><ul> <li>Workflow template for creating Python scripts with tests, documentation,     and planning steps</li> </ul> </li> <li><code>ai.claude_code_workflows.reference.md</code><ul> <li>Reference document with practical Claude Code workflow examples and common     commands</li> </ul> </li> <li><code>all.summarizing_example.reference.md</code><ul> <li>Example demonstrating transformation from prose to structured bullet-point     notes</li> </ul> </li> </ul>"},{"location":"ai_coding/ai.claude_code.how_to_guide.html","title":"Ai.claude code.how to guide","text":""},{"location":"ai_coding/ai.claude_code.how_to_guide.html#overview","title":"Overview","text":"<ul> <li> <p>Claude Code is a CLI tool that lets you work with Claude directly inside your     project directory</p> </li> <li> <p>It acts as a coding assistant that can plan and execute tasks, generate code,     run commands, test, debug, and iterate on your code end-to-end</p> </li> <li> <p>The following are some useful resources to get you started</p> <ul> <li>Quickstart</li> <li>Common workflows</li> <li>Best practices for agentic coding</li> <li>Claude Code in Action</li> </ul> </li> </ul>"},{"location":"ai_coding/ai.claude_code.how_to_guide.html#how_to_start_developing_on_the_dev_servers","title":"How to Start Developing on the Dev Servers","text":""},{"location":"ai_coding/ai.claude_code.how_to_guide.html#start_a_claude_session_in_your_project_dir","title":"Start a Claude Session in Your Project Dir","text":"<pre><code>&gt; heanhs@dev2:~/src/csfy1$ claude\n</code></pre>"},{"location":"ai_coding/ai.claude_code.how_to_guide.html#log_in_to_your_claude_account","title":"Log in to Your Claude Account","text":"<ul> <li> <p>Choose Option 2 for pay-per-use API usage</p> <p></p> </li> <li> <p>Open the provided link in your browser, choose the Causify.AI organization,     authorize Claude Code to create a key, and paste the token back into the     terminal</p> <p></p> </li> </ul>"},{"location":"ai_coding/ai.claude_code.how_to_guide.html#using_claude_code","title":"Using Claude Code","text":"<ul> <li> <p>Once everything is set up, you can begin using Claude Code in your project</p> </li> <li> <p>To exit, just type <code>/exit</code></p> <p></p> </li> </ul>"},{"location":"ai_coding/ai.claude_code_workflows.reference.html","title":"Ai.claude code workflows.reference","text":""},{"location":"ai_coding/ai.claude_code_workflows.reference.html#create_a_script_from_scratch","title":"Create a Script From Scratch","text":"<ul> <li> <p>Use the template in <code>ai.instruction_template.md</code> <pre><code>&gt; cp docs/ai_coding/ai.instruction_template.md instr.md\n</code></pre></p> </li> <li> <p>Modify <code>instr.md</code> like below <pre><code>1) Write a Python script `dev_scripts_helpers/documentation/summarize_md.py` that\nreads a markdown file --input file.md\n\n- Read the content of the file\n\n- Summarize it with a prompt like \"\"\" Summarize the content of the text in 3 to 5\n    bullet points. \"\"\"\n\n- Use llm CLI using a specific model\n\n- Looks for a `# Summary` section in file.md and replaces it or adds it with the\n    summary of the file\n\n- For all the code you must follow the instructions in\n    `docs/ai_prompts/coding.format_rules.md`\n\n2) Update the documentation in dev_scripts_helpers/documentation/README.md using\n   the instructions in `docs/ai_coding/ai.md_instructions.md`\n</code></pre></p> </li> <li> <p>Run Claude Code     <pre><code>claude&gt; execute instr.md\n</code></pre></p> </li> </ul>"},{"location":"ai_coding/ai.claude_code_workflows.reference.html#create_a_readmemd","title":"Create a README.md","text":"<p>claude&gt; Execute the prompt in docs/ai_coding/ai.readme_template.md on the directory ./helpers_root/dev_scripts_helpers/llms/</p> <p>ccp Execute the prompt in docs/ai_prompts/readme.create.md on the directory ./docs/ai_coding/README.md</p> <p>echo \"Execute the prompt in docs/ai_prompts/readme.create.md on the directory ./docs/ai_coding/README.md\" | claude --dangerously-skip-permissions</p>"},{"location":"ai_coding/ai.claude_code_workflows.reference.html#_1","title":"Ai.claude code workflows.reference","text":"<p>Peeling off PR flow (independent of AI but useful to separate coding and merging) Create a script from scratch Add a feature Update documentation to be in sync with code Improve unit test Implement TODO(ai_gp):</p> <p>Use Cursor Write the code almost correct Pass of Claude to fix it up</p> <p>How to use Docker Write the code to run outside Docker as much as possible i docker_bash i pytest_...</p> <p>How to increase coverage</p> <p>Read and execute papers/DataFlow_white_paper/system_prompt.md</p> <p>Read papers/DataFlow_white_paper/paper.tex and all the files included</p> <p>move papers/DataFlow_white_paper/system_prompt.md to docs/</p>"},{"location":"ai_coding/ai.claude_skills.how_to_guide.html","title":"Ai.claude skills.how to guide","text":""},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#claude_skills","title":"Claude Skills","text":"<ul> <li>Claude Skills<ul> <li>Transforms Claude from a general-purpose AI into a specialized agent</li> <li>Tailors Claude to specific workflows and organizational needs</li> <li>Avoids starting from scratch with each conversation</li> <li>Packages expertise, procedures, and resources into reusable components</li> <li>Allows Claude to dynamically access these components when relevant</li> </ul> </li> </ul>"},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#what_are_skills","title":"What Are Skills?","text":"<ul> <li> <p>Skills Concept</p> <ul> <li>Skills are organized folders with instructions, scripts, and resources</li> <li>They enable Claude to perform better at specific tasks</li> <li>Serve as custom training manuals for specialized workflows</li> <li>Created by writing instructions in Markdown</li> </ul> </li> <li> <p>Structure of a Skill</p> <ul> <li>Each Skill is a directory</li> <li>Contains a SKILL.md file</li> <li>SKILL.md must start with YAML frontmatter</li> <li>YAML includes name and description metadata</li> </ul> </li> </ul>"},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#how_skills_work_progressive_disclosure","title":"How Skills Work: Progressive Disclosure","text":"<ul> <li> <p>Skill Initialization</p> <ul> <li>Claude scans skill files at session start</li> <li>Reads short explanations from YAML in Markdown files</li> <li>Efficient in token usage, approximately 30-50 tokens per skill</li> <li>Loads full instructions and resources when a task matches a skill</li> </ul> </li> <li> <p>Skill Utilization</p> <ul> <li>Enhances Claude's performance in specialized tasks</li> <li>Examples include Excel operations and adherence to brand guidelines</li> <li>System is composable, allowing multiple skills to integrate</li> <li>Supports complex workflows through automatic skill collaboration</li> </ul> </li> </ul>"},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#key_advantages_over_alternatives","title":"Key Advantages Over Alternatives","text":""},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#compared_to_openais_gpts","title":"Compared to OpenAI's GPTs","text":"<p>While OpenAI's GPTs allow users to create and share mini-agents with custom instructions and tools, Anthropic's Skills take a more developer-centric approach, prioritizing modularity, maintainability, and governance.</p>"},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#compared_to_custom_instructions","title":"Compared to Custom Instructions","text":"<p>Custom instructions apply broadly to all your conversations. Skills are task-specific and only load when relevant, making them better for specialized workflows.</p>"},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#token_efficiency_vs_mcp","title":"Token Efficiency vs MCP","text":"<p>MCPs front-load thousands of tokens describing every possible capability. Skills load a 30-token description and only pull the full details when needed.</p>"},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#real-world_applications","title":"Real-World Applications","text":""},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#platform_availability","title":"Platform Availability","text":"<p>Skills work across Claude.ai, API, and Code, giving organizations the ability to author custom Skills through a new /v1/skills endpoint. Organizations can develop a skill once and deploy it everywhere their teams use Claude.</p>"},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#creating_your_first_skill_example","title":"Creating Your First Skill: Example","text":"<p>Here's a simple example of how to create a custom skill for writing professional email responses:</p> <pre><code>---\nname: professional-email-responder\ndescription: Writes professional email responses following company communication standards and tone guidelines\n---\n\n# Professional Email Response Skill\n\nThis skill helps create professional, consistent email responses that follow our company's communication standards.\n\n## Guidelines\n\n- Use a professional but approachable tone\n- Include a clear subject line if creating a new email\n- Structure responses with proper greeting, body, and closing\n- Keep responses concise but comprehensive\n- Always include a call-to-action when appropriate\n\n## Email Structure Template\n\n1. **Greeting**: Use \"Hi [Name],\" for internal communications, \"Dear [Name],\" for external\n2. **Acknowledgment**: Briefly acknowledge their message/request\n3. **Main Content**: Address their points clearly and directly\n4. **Next Steps**: Specify any actions needed or timeline\n5. **Closing**: Use \"Best regards,\" for external, \"Thanks,\" for internal\n\n## Example Scenarios\n\n- Meeting requests: Confirm availability and suggest alternatives if needed\n- Project updates: Provide status, blockers, and next steps\n- Information requests: Provide requested information with context\n- Follow-ups: Reference previous conversation and specify what you need\n\n## Tone Examples\n\n**Good**: \"Thanks for reaching out about the quarterly report. I've reviewed the numbers and have a few questions about the methodology used in section 3.\"\n\n**Avoid**: \"Got your email. The report thing - I'm confused about part 3.\"\n\nWhen responding to emails, always consider the recipient's role, the urgency of the matter, and company hierarchy.\n</code></pre>"},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#getting_started","title":"Getting Started","text":"<p>Creating skills is simple. The \"skill-creator\" skill provides interactive guidance: Claude asks about your workflow, generates the folder structure, formats the SKILL.md file, and bundles the resources you need.</p> <p>To enable Skills: 1. Enable Skills in your Claude settings 2. For Team and Enterprise users, admins must first enable Skills organization-wide 3. Start creating your first skill using the template above 4. Skills are included in</p> <p>https://github.com/anthropics/skills/tree/main</p> <p>https://support.claude.com/en/articles/12512198-how-to-create-custom-skills</p> <p>https://support.claude.com/en/articles/12512180-using-skills-in-claude</p> <p>https://support.claude.com/en/articles/12512198-how-to-create-custom-skills</p> <p>https://support.claude.com/en/articles/12580051-teach-claude-your-way-of-working-using-skills</p> <p>Getting started Help Center: Using Skills - Setup and troubleshooting</p> <p>How to create a skill with Claude - Build your first Skill with Claude's guidance</p> <p>Going deeper Skill authoring best practices - Learn the principles behind effective Skills</p> <p>Agent skills overview - Understand how Skills work under the hood</p> <p>Skill cookbooks - Working examples you can adapt</p>"},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#getting_started_1","title":"Getting started","text":""},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#help_center_using_skills_-_setup_and_troubleshooting","title":"Help Center: Using Skills - Setup and troubleshooting","text":""},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#how_to_create_a_skill_with_claude_-_build_your_first_skill_with_claudes_guidance","title":"How to create a skill with Claude - Build your first Skill with Claude's guidance","text":""},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#going_deeper","title":"Going deeper","text":""},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#skill_authoring_best_practices_-_learn_the_principles_behind_effective_skills","title":"Skill authoring best practices - Learn the principles behind effective Skills","text":""},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#agent_skills_overview_-_understand_how_skills_work_under_the_hood","title":"Agent skills overview - Understand how Skills work under the hood","text":""},{"location":"ai_coding/ai.claude_skills.how_to_guide.html#skill_cookbooks_-_working_examples_you_can_adapt","title":"Skill cookbooks - Working examples you can adapt","text":""},{"location":"ai_coding/ai.diagram_template.html","title":"Ai.diagram template","text":""},{"location":"ai_coding/ai.diagram_template.html#graphviz_diagram","title":"Graphviz diagram","text":"<ul> <li>Any graphviz diagram should be follow the template below</li> </ul> <pre><code>digraph BayesianFlow {\n        splines=true;\n        nodesep=1.0;\n        ranksep=0.75;\n\n        node [shape=box, style=\"rounded,filled\", fontname=\"Helvetica\", fontsize=12, penwidth=1.7];\n\n        // Nodes\n        Rain       [label=\"Rain\", fillcolor=\"#A6C8F4\"];\n        WetGrass   [label=\"WetGrass\", fillcolor=\"#B2E2B2\"];\n        Cover      [label=\"Cover\", fillcolor=\"#FFD1A6\"];\n        Evaporate  [label=\"Evaporate\", fillcolor=\"#F4A6A6\"];\n        Sprinkler  [label=\"Sprinkler\", fillcolor=\"#A0D6D1\"];\n        Dew        [label=\"Dew\", fillcolor=\"#A6E7F4\"];\n\n        // Force ranks\n        { rank=same; Cover; Evaporate; }\n        { rank=same; Sprinkler; Dew; }\n\n        // Edges\n        Rain -&gt; WetGrass;\n        Rain -&gt; Cover;\n        Rain -&gt; Evaporate;\n        Cover -&gt; WetGrass [label=\"blocks\", style=dashed];\n        Evaporate -&gt; WetGrass [label=\"blocks\", style=dashed];\n        Sprinkler -&gt; WetGrass;\n        Dew -&gt; WetGrass;\n}\n</code></pre>"},{"location":"ai_coding/ai.diagram_template.html#tikz_diagram","title":"Tikz diagram","text":"<ul> <li>Any Tikz diagram should be follow the template below</li> </ul> <pre><code>\\usepackage{tikz}\n\\begin{document}\n\n\\newcommand{\\gridpattern}[2]{\n...\n}\n\n%\\begin{center}\n\\begin{tikzpicture}\n...\n%\\end{center}\n\\end{document}\n</code></pre>"},{"location":"ai_coding/ai.diagram_template.html#graphic_image","title":"Graphic image","text":"<ul> <li>Any graphic image should follow the template below</li> </ul> <pre><code>High-end editorial illustration for a business technology magazine. \n\nLighting is studio-grade and cinematic, with realistic reflections on glass and\nmetal. Materials look physically accurate (optical glass, brushed aluminum, matte\nscreens).\n\nColor palette is restrained and corporate: cool whites, slate blues, soft greens,\nwith small warm amber highlights for contrast.\n\nStyle is photorealistic illustration with the polish of a Fortune-500 annual\nreport or The Economist technology cover \u2014 no fantasy, no cyberpunk, no glowing\nneon, no cartoon outlines.\n\n&lt;description of the content&gt;\n</code></pre>"},{"location":"ai_coding/ai.github_copilot_review.how_to_guide.html","title":"Ai.github copilot review.how to guide","text":""},{"location":"ai_coding/ai.github_copilot_review.how_to_guide.html#overview","title":"Overview","text":"<ul> <li> <p>You can request a review from GitHub Copilot on your PR</p> </li> <li> <p>For authors, it acts as a first line of defense to catch mistakes early before     requesting a human review</p> </li> <li> <p>For reviewers, it helps you understand the code changes faster by providing     summaries.</p> </li> </ul>"},{"location":"ai_coding/ai.github_copilot_review.how_to_guide.html#how_to_use_copilot_code_review","title":"How to Use Copilot Code Review","text":"<ul> <li> <p>Request review for PRs from Copilot     </p> </li> <li> <p>Review summary and feedback from Copilot     </p> </li> <li> <p>Review comments from Copilot     </p> </li> </ul>"},{"location":"ai_coding/ai.instruction_template.html","title":"Ai.instruction template","text":""},{"location":"ai_coding/ai.instruction_template.html#simple_change","title":"Simple Change","text":"<ul> <li> <p>Do ...</p> </li> <li> <p>If the task is not perfectly clear, you MUST not perform it, but ask for     clarifications</p> </li> <li> <p>For all the code you must follow the instructions in     <code>docs/ai_prompts/coding.format_rules.md</code></p> </li> </ul>"},{"location":"ai_coding/ai.instruction_template.html#rules","title":"Rules","text":"<p>./helpers_root/docs/ai_prompts/blog.format_rules.md ./helpers_root/docs/ai_prompts/coding.format_rules.md ./helpers_root/docs/ai_prompts/markdown.format_rules.md ./helpers_root/docs/ai_prompts/notebooks.format_rules.md ./helpers_root/docs/ai_prompts/testing.format_rules.md</p>"},{"location":"ai_coding/ai.instruction_template.html#implement_code","title":"Implement Code","text":"<p>Implement one step at the time asking user for confirmation, before moving to the next step</p>"},{"location":"ai_coding/ai.instruction_template.html#step_1","title":"Step 1)","text":"<ul> <li> <p>Write a Python script XYZ ... that ...</p> </li> <li> <p>The interface is like:     ...</p> </li> <li> <p>If the task is not perfectly clear, you MUST not perform it, but ask for     clarifications</p> </li> <li> <p>When the task is complex, create a plan.md with 5 bullet points explaining what     the plan is</p> </li> <li> <p>For all the code you must follow the instructions in     <code>docs/ai_prompts/coding.format_rules.md</code></p> </li> </ul>"},{"location":"ai_coding/ai.instruction_template.html#step_2","title":"Step 2)","text":"<ul> <li>Update the file README.md in the same directory of the script following the     instructions in <code>docs/ai_prompts/readme.create.md</code></li> </ul>"},{"location":"ai_coding/ai.instruction_template.html#step_3","title":"Step 3)","text":"<ul> <li>Generate unit tests for the code following the instructions in     <code>docs/ai_prompts/testing.format_rules.md</code><ul> <li>Write test class and methods</li> <li>Preview unit tests that need to be written by creating input and expected     outputs</li> <li>Do not implement code for the testing yet</li> </ul> </li> </ul>"},{"location":"ai_coding/ai.instruction_template.html#step_4","title":"Step 4)","text":"<ul> <li>Implement unit test code for the code following the instructions in     <code>docs/ai_prompts/testing.format_rules.md</code></li> </ul>"},{"location":"ai_coding/ai.instruction_template.html#implement_notebook_script","title":"Implement Notebook Script","text":"<p>source = <code>msml610/lectures_source/Lesson05.1-Learning_Theory.txt</code> notebook = <code>msml610/tutorials/L5_01_Learning_Theory.Bin_Analogy_ML.ipynb</code> script = <code>msml610/tutorials/L5_01_Learning_Theory.Bin_Analogy_ML.md</code></p>"},{"location":"ai_coding/ai.instruction_template.html#build_the_notebook_script","title":"Build the Notebook Script","text":"<ul> <li>Read $source and understand the bin analogy</li> <li>Execute <code>docs/ai_prompts/notebooks.create_visual_script.md</code> to create the script     for the concept</li> </ul>"},{"location":"ai_coding/ai.instruction_template.html#build_the_notebook","title":"Build the Notebook","text":"<ul> <li>If there is no $notebook     <pre><code>&gt; cp ./msml610/tutorials/template.ipynb $notebook\n&gt; git add $notebook\n</code></pre></li> <li>Execute <code>docs/ai_prompts/notebooks.implement_script.md</code> for cells between      and  of $script <li>Update $notebook</li>"},{"location":"ai_coding/ai.instruction_template.html#rename_files","title":"Rename Files","text":""},{"location":"ai_coding/ai.instruction_template.html#step_5","title":"Step 1)","text":"<ul> <li>Rename the files in ... that have ...</li> </ul>"},{"location":"ai_coding/ai.instruction_template.html#step_6","title":"Step 2)","text":"<ul> <li>Make sure that all the files in the repo are updated with this change</li> </ul>"},{"location":"ai_coding/ai.instruction_template.html#implement_an_invoke_target","title":"Implement an Invoke Target","text":"<ul> <li>Add an invoke target in helpers/lib_tasks_git.py to create a zip file with     all the files that are modified or untracked for both the current repo, using</li> </ul> <p>git status --porcelain -u | cut -c4- | grep -vFf &lt;(git config -f .gitmodules --get-regexp path | awk '{print $2}'</p> <p>and the subrepos</p> <ul> <li>There should be an option --dry-run to just print what needs to be done</li> </ul>"},{"location":"ai_coding/ai.instruction_template.html#plan_and_then_implement_code","title":"Plan and then Implement Code","text":""},{"location":"ai_coding/ai.instruction_template.html#step_1_come_up_with_a_plan_for_the_code","title":"Step 1) Come up with a plan for the code","text":"<pre><code>- Describe the goal, listing the main steps\n- Mention any edge cases\n- If the task is not perfectly clear, you MUST not perform it, but ask for\n    clarifications\n- Write the plan in a file `claude.plan.md`\n- Wait for my response before executing the plan\n</code></pre>"},{"location":"ai_coding/ai.instruction_template.html#step_2_implement_interfaces","title":"Step 2) Implement interfaces","text":"<pre><code>- Write the interfaces and the docstrings of the needed code in the places of\n    the code base\n- Add comment explaining what each function does\n- Do not implement the body of the code\n- Wait for my response\n</code></pre>"},{"location":"ai_coding/ai.instruction_template.html#step_3_implement_code","title":"Step 3) Implement code","text":"<pre><code>- Implement the code following the instructions in\n    `docs/ai_prompts/coding.format_rules.md`\n</code></pre>"},{"location":"ai_coding/ai.instruction_template.html#step_4_come_up_with_a_plan_for_the_tests","title":"Step 4) Come up with a plan for the tests","text":"<pre><code>- Implement unit tests following the instructions in \n    `docs/ai_prompts/testing.format_rules.md`\n</code></pre>"},{"location":"ai_coding/ai.instruction_template.html#step_5_implement_tests","title":"Step 5) Implement tests","text":"<pre><code>- Implement unit tests following the instructions in \n    `docs/ai_prompts/testing.format_rules.md`\n</code></pre>"},{"location":"ai_coding/ai.instruction_template.html#step_6_create_new_readme","title":"Step 6) Create new README","text":"<pre><code>- If it's a new script, find where the documentation of this change should go\n- Generate a short description of how to use the script in a file close to the\n    script with extension .md\n- Explain the goal of the script\n- Report some examples of how to use the script\n- Update the file README.md in the same directory of the script following the\n    instructions in `docs/ai_prompts/readme.create.md`\n</code></pre>"},{"location":"ai_coding/ai.instruction_template.html#write_short_tutorial","title":"Write short tutorial","text":"<ul> <li> <p>Execute <code>docs/ai_prompts/blog.write_tutorial.md</code> about ripgrep</p> </li> <li> <p>Write the result in <code>website/docs/blog/drafts/ripgrep.md</code></p> </li> </ul>"},{"location":"ai_coding/all.claude_artifacts.how_to_guide.html","title":"All.claude artifacts.how to guide","text":""},{"location":"ai_coding/all.claude_artifacts.how_to_guide.html#tutorial_how_to_create_a_claude_artifact","title":"Tutorial: How to Create a Claude Artifact","text":""},{"location":"ai_coding/all.claude_artifacts.how_to_guide.html#1_open_a_claude_chat","title":"1. Open a Claude Chat","text":"<p>Start a new conversation in Claude. Ensure you are using a version that supports Artifacts.</p>"},{"location":"ai_coding/all.claude_artifacts.how_to_guide.html#2_enter_a_prompt_for_an_artifact","title":"2. Enter a Prompt for an Artifact","text":"<p>Type a request that involves generating something interactive or persistent. Examples:</p> <ul> <li>Create a webpage that displays a counter</li> <li>Generate a Python script that visualizes data</li> <li>Build a simple todo app UI</li> </ul> <p>Claude detects that your output is suitable for an Artifact.</p>"},{"location":"ai_coding/all.claude_artifacts.how_to_guide.html#3_accept_the_artifact_suggestion","title":"3. Accept the Artifact Suggestion","text":"<p>Claude will show a prompt offering to turn the output into an Artifact. Select the option to open it as an Artifact.</p>"},{"location":"ai_coding/all.claude_artifacts.how_to_guide.html#4_edit_the_artifact","title":"4. Edit the Artifact","text":"<p>Inside the Artifact panel, you can:</p> <ul> <li>Modify files</li> <li>Add new files</li> <li>Switch between preview and code</li> <li>Test the functionality live</li> </ul> <p>Changes are saved automatically.</p>"},{"location":"ai_coding/all.claude_artifacts.how_to_guide.html#5_iterate_through_chat","title":"5. Iterate Through Chat","text":"<p>Ask Claude to update the Artifact. Claude will modify the relevant files without replacing the whole project.</p>"},{"location":"ai_coding/all.claude_artifacts.how_to_guide.html#6_export_or_share","title":"6. Export or Share","text":"<p>When finished, you can download the Artifact files or share them according to the platform options available.</p> <p>This is the basic workflow for creating and iterating on a Claude Artifact.</p>"},{"location":"ai_coding/all.claude_code.how_to_guide.html","title":"All.claude code.how to guide","text":""},{"location":"ai_coding/all.claude_code.how_to_guide.html#using_claude_code","title":"Using Claude Code","text":"<p>Claude Code is a coding-focused interface for the Claude AI assistant. It helps you write, understand, and debug code more efficiently.</p>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#1_opening_claude_code","title":"1. Opening Claude Code","text":"<ul> <li> <p>Run <code>claude</code> in your Git client</p> </li> <li> <p>Initially you should give permissions to <code>claude</code> for any action</p> </li> <li> <p>It's not a good idea to use <code>claude --dangerously-skip-permissions</code> unless you     know what you are doing</p> </li> </ul>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#2_creating_and_editing_code","title":"2. Creating and Editing Code","text":"<p>You can use Claude Code in two ways:</p> <ol> <li>Paste or write code directly</li> <li>Paste existing code into the editor.</li> <li> <p>Ask Claude something like:</p> <ul> <li>\"Explain what this function does.\"</li> <li>\"Refactor this into smaller functions.\"</li> <li>\"Convert this from JavaScript to Python.\"</li> </ul> </li> <li> <p>Start from a natural-language request</p> </li> <li> <p>Type a prompt such as:</p> <ul> <li>\"Create a Python script that reads a CSV and prints summary stats.\"</li> <li>\"Generate a React component for a login form with validation.\"</li> </ul> </li> <li> <p>I like to use a <code>instr.md</code> file with the instructions to <code>claude</code> so that</p> </li> <li>E.g., see the template <code>docs/ai_coding/ai.instruction_template.md</code> <pre><code>&gt; cp docs/ai_coding/ai.instruction_template.md instr.md\n# Customize instr.md with detailed instructions\nclaude&gt; execute instr.md\n</code></pre></li> </ol> <p>Claude will:</p> <ul> <li>Propose code in the chat</li> <li>Often insert or update code directly in the editor</li> </ul> <p>Save or copy the generated code into your own environment to run it.</p>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#3_running_and_testing_code","title":"3. Running and Testing Code","text":"<p>Depending on the integration, Claude Code may:</p> <ul> <li>Simulate running code (describe what would happen, spot logical issues)</li> <li>Provide test cases and examples</li> <li>Help you write unit tests</li> </ul> <p>Ask things like:</p> <ul> <li>\"Write unit tests for this function using pytest.\"</li> <li>\"What edge cases might break this code?\"</li> <li>\"Can you step through this algorithm with an example input?\"</li> </ul> <p>Then paste results or error messages back into the chat so Claude can help debug.</p>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#4_debugging_with_claude_code","title":"4. Debugging with Claude Code","text":"<p>When you get an error in your local environment:</p> <ol> <li>Copy the error message and the relevant code snippet.</li> <li>Paste them into Claude Code.</li> <li>Ask:</li> <li>\"Here is the error I am seeing. Can you help me fix it?\"</li> <li>\"Why does this raise a TypeError? Suggest a fix.\"</li> </ol> <p>Claude will:</p> <ul> <li>Explain the error</li> <li>Suggest changes</li> <li>Sometimes give rewritten code blocks</li> </ul> <p>Review changes carefully and test them yourself.</p>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#5_working_with_larger_projects","title":"5. Working with Larger Projects","text":"<p>For multi-file projects:</p> <ul> <li>Use any available file browser or project view</li> <li>Open individual files in the editor.</li> <li>Ask questions like:<ul> <li>\"Give me a high-level overview of this repository.\"</li> <li>\"Where is the main entry point for this app?\"</li> <li>\"Find where the user authentication logic is implemented.\"</li> </ul> </li> </ul> <p>Claude can:</p> <ul> <li>Summarize architecture</li> <li>Trace how functions call each other</li> <li>Suggest refactors at the project level</li> </ul>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#6_prompting_tips","title":"6. Prompting Tips","text":"<p>To get better results:</p> <ol> <li>Be specific</li> <li> <p>Instead of \"Fix this\", say:</p> <ul> <li>\"Reduce the time complexity.\"</li> <li>\"Make this function pure and side-effect free.\"</li> <li>\"Rewrite this using async/await.\"</li> </ul> </li> <li> <p>Set constraints</p> </li> <li>\"Use only standard library.\"</li> <li>\"Target Python 3.10.\"</li> <li> <p>\"Avoid external dependencies.\"</p> </li> <li> <p>Iterate</p> </li> <li>Start with a rough version.</li> <li>Ask Claude to optimize, clean up, or document it:<ul> <li>\"Add comments explaining each step.\"</li> <li>\"Improve variable names and structure.\"</li> </ul> </li> </ol>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#workflows","title":"Workflows","text":"<p>This document consolidates all AI development workflows, coding conventions, and tools used in the Causify/helpers ecosystem.</p>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#overview","title":"Overview","text":"<p>This documentation provides comprehensive guidelines for:</p> <ul> <li>Writing Python code following Causify conventions</li> <li>Creating unit tests</li> <li>Formatting notes and documentation</li> <li>Using AI-powered review and transformation tools</li> <li>Integrating with ChatGPT API</li> <li>Understanding the helpers repository architecture</li> </ul>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#interesting_files","title":"Interesting Files","text":"<ul> <li><code>docs/ai_coding/code_template.py</code> shows our coding style</li> <li> <p><code>docs/ai_coding/unit_test_template.py</code> shows how our unit tests look like</p> </li> <li> <p><code>CLAUDE.md</code>: Project architecture overview and development conventions for     Claude Code working with the <code>helpers</code> repository</p> </li> <li><code>docs/ai_coding/ai.instruction_template.md</code>: Workflow template for creating     Python scripts with tests, documentation, planning steps, and AI todos</li> <li><code>docs/ai_prompts/coding.format_rules.md</code>: Python coding standards including     hdbg assertions, hsystem usage, logging patterns, and script templates</li> <li> <p><code>docs/ai_prompts/testing.format_rules.md</code>: Unit testing conventions     including test structure, naming patterns, and golden file testing</p> </li> <li> <p><code>docs/ai_prompts/blog.format_rules.md</code>: Markdown formatting guidelines for     writing blog posts with proper structure, code blocks, and metadata</p> </li> <li> <p><code>docs/ai_coding/ai.md_instructions.md</code>: Style guide for writing structured     bullet-point notes optimized for clarity and AI/human readability</p> </li> </ul>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#ai_development_workflow_template","title":"AI Development Workflow Template","text":"<p>When creating a Python script:</p> <ol> <li> <p>Write a Python script following the instructions in    <code>docs/ai_prompts/coding.format_rules.md</code></p> </li> <li> <p>Generate unit tests for the code following the instructions in    <code>docs/ai_prompts/testing.format_rules.md</code></p> </li> <li> <p>Generate a short description of how to use the script in a file close to    the script with extension <code>.md</code></p> </li> <li>Explain the goal of the script</li> <li>Report some examples of how to use the tool</li> <li>Describe the architecture</li> </ol>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#ai_review_and_transform_tools","title":"AI Review and Transform Tools","text":""},{"location":"ai_coding/all.claude_code.how_to_guide.html#operations_overview","title":"Operations Overview","text":"<p>There are several operations we want to perform using LLMs:</p> <ul> <li>Apply a transformation to a chunk of text (e.g., create a unit test)</li> <li>Create comments and lints in the form of a <code>cfile</code> (e.g., lint or AI review     based on certain criteria)</li> <li>Apply modifications from a <code>cfile</code> to a set of files (e.g., from linter and AI     review)</li> <li>Add TODOs from a <code>cfile</code> to Python or markdown files</li> <li>Apply a set of transformations to an entire Python file (e.g.,     styling/formatting code)</li> <li>Rewrite an entire markdown to fix English mistakes without changing its     structure</li> </ul> <p>Important: Always commit your code before applying automatic transforms, in the same way that we run the <code>linter</code> on a clean tree. This way, modifying a file is a separate commit and it's easy to review.</p>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#use_templates","title":"Use Templates","text":"<p>We use templates for code and documentation to show and describe how a document or code should look like:</p> <ul> <li><code>all.how_to_guide_template_doc.md</code> shows how a Diataxis how-to guide should be     structured and look like</li> </ul> <p>The same templates have multiple applications:</p> <ul> <li>For Humans:<ul> <li>Understand how to write documentation and code</li> <li>As boilerplate (e.g., \"copy the template and customize it to achieve a     certain goal\")</li> </ul> </li> <li>For LLMs:<ul> <li>As reference style to apply transforms</li> <li>To report violations of coding styles</li> <li>As boilerplate (e.g., \"explain this piece of code using this template\")</li> </ul> </li> </ul>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#available_tools","title":"Available Tools","text":"<ul> <li><code>llm_transform.py</code></li> <li><code>transform_notes.py</code>: Some transformations don't need LLMs and are implemented     as code.</li> <li><code>ai_review.py</code>: The rules for AI are saved in     <code>./docs/code_guidelines/all.coding_style_guidelines.reference.md</code>. This file     has a special structure:<ul> <li>First level represents the target language (e.g., <code>General</code>, <code>Python</code>)</li> <li>Second level represents a rule topic (e.g., <code>Imports</code>, <code>Functions</code>)</li> <li>Third level represents instructions for an LLM vs Linter</li> </ul> </li> <li><code>inject_todos.py</code>: Injects TODOs from a <code>cfile</code> into source files.</li> <li><code>apply_todos.py</code>: Automatically applies TODOs from a <code>cfile</code> using an LLM.</li> </ul>"},{"location":"ai_coding/all.claude_code.how_to_guide.html#_1","title":"All.claude code.how to guide","text":"<ul> <li>Planning mode</li> </ul> <p>claude --permission-mode plan</p> <p>Create a plan without coding</p> <ul> <li>Cheap-o mode</li> </ul> <p>claude --model haiku</p> <p>claude --output-format text -p \"Fix update_md.py -i docs/datapull/all.add_new_data_source.how_to_guide.md -a summarize -a apply_style\" --dangerously-skip-permissions</p>"},{"location":"ai_coding/all.llm_cli.how_to_guide.html","title":"All.llm cli.how to guide","text":""},{"location":"ai_coding/all.llm_cli.how_to_guide.html#install","title":"Install","text":"<pre><code>&gt; uv tool install llm\n\n&gt; export PATH=\"/Users/saggese/.local/bin:$PATH\"\n</code></pre> <pre><code>&gt; uvx llm --version\nInstalled 33 packages in 45ms\nllm, version 0.27.1\n\n- The code and the documentation is at \n- https://github.com/simonw/llm\n- https://llm.datasette.io/en/stable/\n\n## Getting help\n</code></pre> <p>llm --help <pre><code>## Models\n\n- To list the models\n    ```\n    &gt; llm models\n    OpenAI Chat: gpt-4o (aliases: 4o)\n    OpenAI Chat: chatgpt-4o-latest (aliases: chatgpt-4o)\n    OpenAI Chat: gpt-4o-mini (aliases: 4o-mini)\n    ...\n    OpenAI Chat: gpt-5\n    OpenAI Chat: gpt-5-mini\n    OpenAI Chat: gpt-5-nano\n    OpenAI Chat: gpt-5-2025-08-07\n    OpenAI Chat: gpt-5-mini-2025-08-07\n    OpenAI Chat: gpt-5-nano-2025-08-07\n    OpenAI Completion: gpt-3.5-turbo-instruct (aliases: 3.5-instruct, chatgpt-instruct)\n    Default: gpt-4o-mini\n    ```\n\n## Fragments\n</code></pre> more my_fragment.txt The solar eclipse will occur on April 8, 2024, visible across North America. ```</p> <p>llm -f my_fragment.txt \"Summarize the above in one sentence.\"</p>"},{"location":"ai_coding/all.llm_cli.how_to_guide.html#how_to","title":"How to","text":"<ul> <li> <p>How to execute a prompt from a file and save it     <code>&gt; cat prompt.txt | llm | tee output.txt</code></p> </li> <li> <p>Execute a prompt from a file using a template     <code>&gt; cat prompt.txt | llm -t llm-markdown.yaml | tee output.txt</code></p> </li> </ul>"},{"location":"ai_coding/all.summarizing_example.reference.html","title":"All.summarizing example.reference","text":"<ul> <li> <p>Using the rules in <code>docs/ai_coding/ai.md_instructions.md</code></p> </li> <li> <p>The input text should be transformed into:     <pre><code>## QUESTION 1: WHAT ARE YOUR CORE VALUES?\n\nCore Values are a timeless set of guiding principles. There are\ntypically just a few\u20143 to 7 is the rule of thumb. They define the\nbehaviors you expect from each other. They define your culture and who\nfits and who doesn\u2019t. They define what makes your company different and\nunique.\n\nA famous business guru, Peter Drucker, is attributed with the saying,\n\"Culture eats strategy for breakfast.\" History has shown that culture\nwins in the long run, not strategy. For a company to be great, it must\nfirst know who it is. Then focus on strategy. Who you are as a company\nis defined by your Core Values.\n\nEvery company has different Core Values because, well, every company is\ndifferent. To help build a strong culture, your company will use your\nCore Values to hire, fire, and review everyone (how this happens will be\ndetailed in [Chapter 8](#Top_of_Chapter08_html)).\n\nHere is an example of the EOS Worldwide Core Values (keep in mind yours\nwill be different):\n\n**1.**Humbly Confident\n\n**2.**Grow or Die\n\n**3.**Help First\n\n**4.**Do What You Say\n\n**5.**Do the Right Thing\n\nLet\u2019s take one of those, \"Do What You Say,\" as an example. In a \"Do What\nYou Say\" culture, everyone delivers on time. That means if you commit to\na date, you hit it. You fully deliver and finish what you start\u2014doing\nthings half-assed or half-finished is unacceptable. Everyone takes\nresponsibility, owns their projects, and blames no one if something\ndoesn\u2019t get finished. Finally, in a \"Do What You Say\" culture, it is\nokay to say no\u2014if you can\u2019t do it, don\u2019t commit.\n\nYour leadership team has worked very hard to discover what your\ncompany\u2019s Core Values are in order to build an amazing culture. Once\nthese Values are shared, we urge you to ask questions in order to fully\nunderstand them. Ultimately you have to ask yourself, \"Do I share these\nCore Values?\"\n\nYou\u2019ll find that when you work with people who share the same Core\nValues, communication is easier, things get done faster, and the work\nenvironment is more fun. You will have a great organization and a strong\nculture.\n</code></pre></p> </li> <li> <p>The output should be:     <pre><code>* Core values\n- Are a timeless set of guiding principles\n- Define the culture, who fits and who doesn't\n- Define what makes the Company different and unique\n\n* Culture &gt; strategy\n- In a Company, culture wins in the long term\n- A Company\n    - Needs to know who it is\n    - Is defined by the Core Values\n\n* Uses of Core Values\n- Hire\n- Fire\n- Review everyone\n\n* Core values: EOS Worldwide example\n- Be humble but confident\n- Grow or die\n- Help first\n- Do what you say\n    - E.g., if you commit to a date, you hit it\n    - You fully deliver and finish what you start: no half-assed things\n    - If you can't do it, don't commit\n- Do the right thing\n</code></pre></p> </li> </ul>"},{"location":"ai_prompts/index.html","title":"Index","text":""},{"location":"ai_prompts/index.html#ai_prompts_documentation","title":"AI Prompts Documentation","text":"<p>This directory contains LLM prompt templates for code formatting, documentation generation, writing improvement, and content transformation workflows.</p>"},{"location":"ai_prompts/index.html#structure_of_the_dir","title":"Structure of the Dir","text":"<p>This directory contains no subdirectories. All prompt templates are stored at the root level.</p>"},{"location":"ai_prompts/index.html#description_of_files","title":"Description of Files","text":""},{"location":"ai_prompts/index.html#coding_and_development","title":"Coding and Development","text":"<ul> <li><code>coding.format_rules.md</code><ul> <li>Python coding standards including assertions, logging patterns, and script     formatting rules</li> </ul> </li> <li><code>coding.improve_comments.md</code><ul> <li>Prompt template for improving code comments clarity and conciseness</li> </ul> </li> <li><code>coding.update_comments.md</code><ul> <li>Prompt template for updating outdated comments to match current code     implementation</li> </ul> </li> <li><code>coding.update_expected_vars.md</code><ul> <li>Prompt for updating expected variable names in test files to match code     changes</li> </ul> </li> <li><code>coding.factor_common_code.md</code><ul> <li>Prompt for identifying and refactoring duplicated or near-duplicated code     blocks into shared functions</li> </ul> </li> <li><code>coding.fix_gh_issue.md</code><ul> <li>Prompt for analyzing and fixing GitHub issues</li> </ul> </li> <li><code>coding.fix_param_use.md</code><ul> <li>Prompt for fixing parameter usage issues in Python code</li> </ul> </li> <li><code>coding.find_doc.md</code><ul> <li>Prompt for finding documentation for files, classes, or functions</li> </ul> </li> <li><code>coding.lint.md</code><ul> <li>Prompt for improving code appearance by applying formatting rules from     <code>coding.format_rules.md</code> and <code>testing.format_rules.md</code></li> </ul> </li> <li><code>coding.rename.md</code><ul> <li>Prompt for renaming files, functions, and variables across a codebase with     proper reference updates</li> </ul> </li> <li><code>coding.review.md</code><ul> <li>Prompt for reviewing Python code, finding bugs, and providing fixes with     minimal changes</li> </ul> </li> <li><code>coding.todoai_gp.md</code><ul> <li>Prompt for implementing TODO(ai_gp) comments in code files</li> </ul> </li> <li><code>coding.update_dir_readme.md</code><ul> <li>Prompt for creating or updating README.md for a given directory</li> </ul> </li> <li><code>coding.update_file_readme.md</code><ul> <li>Prompt for creating or updating README.md for a given file</li> </ul> </li> <li><code>coding.make_function_private.md</code><ul> <li>Prompt for identifying functions not called by other files and making them     private by prepending underscore</li> </ul> </li> </ul>"},{"location":"ai_prompts/index.html#testing","title":"Testing","text":"<ul> <li><code>testing.format_rules.md</code><ul> <li>Unit testing conventions including test structure, naming patterns, golden     file testing, and pytest usage</li> </ul> </li> <li><code>testing.fix_unit_tests.md</code><ul> <li>Prompt for refactoring test code by aligning strings, renaming test methods     as test1/test2, and factoring out common code into helper functions</li> </ul> </li> <li><code>testing.move_test_code.md</code><ul> <li>Prompt for moving test code from one file to another using     <code>split_in_files.py</code></li> </ul> </li> <li><code>testing.reach_coverage.md</code><ul> <li>Prompt for increasing unit test coverage to approach 100% for a given     function with structured 4-step process</li> </ul> </li> </ul>"},{"location":"ai_prompts/index.html#notebooks","title":"Notebooks","text":"<ul> <li><code>notebooks.format_rules.md</code><ul> <li>Jupyter notebook formatting conventions including cell structure, Jupytext     pairing, widget patterns, and plotting standards</li> </ul> </li> <li><code>notebooks.create_visual_script.md</code><ul> <li>Prompt for creating markdown descriptions of Jupyter notebook cells with     visualizations and interactive widgets for educational content</li> </ul> </li> <li><code>notebooks.implement_script.md</code><ul> <li>Prompt for implementing Jupyter notebook cells from script descriptions with     utils library integration and widget conventions</li> </ul> </li> <li><code>notebooks.create_animation.md</code><ul> <li>Prompt for creating video animations from interactive widget functions using     generate_animation template</li> </ul> </li> <li><code>notebooks.lint.md</code><ul> <li>Prompt for improving Jupyter notebook appearance using format rules without     changing behavior</li> </ul> </li> <li><code>notebooks.lint_numbered_cells.md</code><ul> <li>Prompt for renaming markdown cells with numbered format and reorganizing     utils code to match cell order</li> </ul> </li> <li><code>notebooks.move_to_lib.md</code><ul> <li>Prompt for moving Jupyter notebook functions to utils library files while     keeping only caller code in notebooks</li> </ul> </li> <li><code>notebooks.plots.md</code><ul> <li>Guidelines for creating plots with pandas/seaborn, adding information     directly to plots, and styling theoretical vs empirical data</li> </ul> </li> <li><code>notebooks.split_cells.md</code><ul> <li>Instructions for splitting Jupyter cells so each contains only one concept     or example with proper commenting structure</li> </ul> </li> <li><code>notebooks.utils_library.md</code><ul> <li>Guidelines for organizing notebook utility files with proper structure     following notebook flow with separators</li> </ul> </li> </ul>"},{"location":"ai_prompts/index.html#documentation_and_writing","title":"Documentation and Writing","text":"<ul> <li><code>markdown.format_rules.md</code><ul> <li>Style guide for writing structured bullet-point markdown optimized for AI     and human readability</li> </ul> </li> <li><code>readme.create.md</code><ul> <li>Prompt template for generating comprehensive README files with directory     structure and executable documentation</li> </ul> </li> <li><code>readme.format.md</code><ul> <li>Formatting guidelines for README files with proper command block structure     and descriptions</li> </ul> </li> <li><code>text.humanize.md</code><ul> <li>Guidelines for avoiding AI-style writing patterns and creating natural,     human-sounding text</li> </ul> </li> </ul>"},{"location":"ai_prompts/index.html#blog_content","title":"Blog Content","text":"<ul> <li><code>blog.create_tldr.md</code><ul> <li>Prompt for creating three catchy and controversial TLDRs under 20 words</li> </ul> </li> <li><code>blog.format_rules.md</code><ul> <li>Markdown formatting guidelines for writing blog posts with proper structure     and metadata</li> </ul> </li> <li><code>blog.add_figures.md</code><ul> <li>Prompt for adding images, diagrams, and visuals to blog posts using     graphviz, TikZ, or graphic images</li> </ul> </li> </ul>"},{"location":"ai_prompts/index.html#academic_papers","title":"Academic Papers","text":"<ul> <li><code>paper.use_style.md</code><ul> <li>Academic writing guidelines for formal, objective computer science papers     with reference checking</li> </ul> </li> <li><code>paper.improve_bibliography.md</code><ul> <li>Prompt template for improving bibliography formatting and citation accuracy</li> </ul> </li> <li><code>paper.suggest_improvements.md</code><ul> <li>Prompt for suggesting improvements to academic paper content and structure</li> </ul> </li> <li><code>paper.fix_figures.md</code><ul> <li>Prompt for fixing figures in academic papers</li> </ul> </li> </ul>"},{"location":"ai_prompts/index.html#demo_and_presentations","title":"Demo and Presentations","text":"<ul> <li><code>demo.create_script.md</code><ul> <li>Prompt for creating 15-slide presentation storyboards for narrated explainer     videos targeting non-technical audiences</li> </ul> </li> <li><code>demo.create_pictures.md</code><ul> <li>Prompt for creating visual assets for demonstrations and presentations</li> </ul> </li> </ul>"},{"location":"ai_prompts/index.html#graphviz_and_visualization","title":"Graphviz and Visualization","text":"<ul> <li><code>graphviz.causal_kg_style.md</code><ul> <li>Style guide for creating causal knowledge graphs using graphviz with     consistent formatting</li> </ul> </li> <li><code>graphviz.convert_image.md</code><ul> <li>Prompt for converting images to graphviz dot format by iteratively tweaking     until matching the original</li> </ul> </li> <li><code>graphviz.generate_legend.md</code><ul> <li>Prompt for generating legend diagrams for graphviz visualizations</li> </ul> </li> </ul>"},{"location":"ai_prompts/index.html#slides_and_presentations","title":"Slides and Presentations","text":"<ul> <li><code>slides.format_rules.md</code><ul> <li>Guidelines for creating executive-level presentation slides with clear     structure, bullet points, and image suggestions in markdown format</li> </ul> </li> </ul>"},{"location":"ai_prompts/bash.format_rules.html","title":"Bash.format rules","text":"<ul> <li>You are an expert at writing <code>bash</code> scripts</li> </ul>"},{"location":"ai_prompts/bash.format_rules.html#add_description_at_the_beginning_of_a_script","title":"Add Description at the Beginning of a Script","text":"<ul> <li>Add a short description of what a script using a single short paragraph.<ul> <li>E.g.,     <pre><code>#!/bin/bash\n# \"\"\"\n# This script launches a Docker container with an interactive bash shell for\n# development.\n# \"\"\"\n</code></pre></li> </ul> </li> </ul>"},{"location":"ai_prompts/bash.format_rules.html#add_docstring_to_functions","title":"Add Docstring to Functions","text":"<ul> <li>For each function, use the same style as a REST Python docstring<ul> <li>E.g.,     <pre><code>build_container_image() {\n    # \"\"\"\n    # Build a Docker container image.\n\n    # :param string: Input string to convert\n    # :return: Full path to PNG file\n    # \"\"\"\n</code></pre></li> </ul> </li> <li>If nothing is returned do not write anything</li> </ul>"},{"location":"ai_prompts/bash.format_rules.html#add_comments","title":"Add Comments","text":"<ul> <li>Make sure that each block of the script is commented.</li> </ul>"},{"location":"ai_prompts/blog.add_figures.html","title":"Blog.add figures","text":"<p>Given the blog post written in markdown, you are an expert illustrator who can help adding images, diagrams, and visuals that can explain the intuition behind the concepts in the blog post</p> <ul> <li> <p>The goal is to add clarity and intuition through examples and pictures.</p> </li> <li> <p>Each illustration can be:</p> <ul> <li>A graphviz graph</li> <li>A Tikz graph</li> <li>An graphic image with minimal or numbers or writings</li> </ul> </li> <li> <p>A graphviz diagram, any TikZ image, any graphic image should conform to the     template in <code>helpers_root/docs/ai_coding/ai.diagram_template.md</code></p> </li> <li> <p>Any causal knowledge graph should follow the style described in     <code>helpers_root/docs/ai_prompts/graphviz.causal_kg_style.md</code></p> </li> <li> <p>Add the text in the blog using the proper block in the right place in the blog</p> <ul> <li>Make sure there is text explaining the image in a concise but explicative     way</li> </ul> </li> </ul>"},{"location":"ai_prompts/blog.create_tldr.html","title":"Blog.create tldr","text":"<p>Create 3 catchy and controversial TLDR of less than 20 words without emdash.</p>"},{"location":"ai_prompts/blog.format_rules.html","title":"Blog.format rules","text":"<ul> <li>Format the text of the blog using the following rules.</li> </ul>"},{"location":"ai_prompts/blog.format_rules.html#front_matter_yaml","title":"Front Matter (YAML)","text":"<ul> <li>Every blog post must start with YAML front matter enclosed in <code>---</code>:     <pre><code>---\ntitle: \"Your Blog Post Title\"\nauthors:\n    - gpsaggese\ndate: YYYY-MM-DD\ndescription:\ncategories:\n    - Category Name\n---\n</code></pre>     where<ul> <li>title: Use double quotes, capitalize major words</li> <li>authors: List format with username(s)</li> <li>date: Use YYYY-MM-DD format</li> <li>description: Usually left empty or contains a brief description</li> <li>categories: Common categories include:<ul> <li>Business</li> <li>Causal AI</li> <li>Startup</li> <li>Causal News</li> <li>Causal ELI5</li> </ul> </li> </ul> </li> </ul>"},{"location":"ai_prompts/blog.format_rules.html#tldr_section","title":"TL;DR Section","text":"<ul> <li> <p>Immediately after the front matter, add a TL;DR (or TLDR):     <pre><code>TL;DR Your punchy one-liner summary that captures the essence of the post.\n\n&lt;!-- more --&gt;\n</code></pre></p> </li> <li> <p>Keep it very short and impactful (one sentence)</p> </li> <li>Use a colon after TL;DR or TLDR</li> <li>Always follow with <code>&lt;!-- more --&gt;</code> tag on a new line with a blank line before     it</li> </ul>"},{"location":"ai_prompts/blog.format_rules.html#introduction","title":"Introduction","text":"<ul> <li>Begin with one or more paragraphs introducing the topic</li> <li>Write in prose format - avoid bullet points in the introduction</li> <li>Set up the context and the problem being addressed</li> <li>Use a direct, conversational tone</li> <li>Keep paragraphs short and punchy</li> </ul>"},{"location":"ai_prompts/blog.format_rules.html#body_structure","title":"Body Structure","text":"<ul> <li> <p>Section Headings</p> <ul> <li>Use <code>##</code> for main sections with clear, descriptive titles</li> <li>Use <code>###</code> for subsections</li> <li>Capitalize major words in headings</li> </ul> </li> <li> <p>Content Style</p> <ul> <li>Write in a direct, conversational tone</li> <li>Keep paragraphs short (2-4 sentences typically)</li> <li>Separate paragraphs with a single blank line</li> <li>Use frequent examples to illustrate points</li> </ul> </li> </ul>"},{"location":"ai_prompts/blog.format_rules.html#lists","title":"Lists","text":"<ul> <li>Use <code>-</code> (dash) consistently for unordered lists</li> <li>Indent sub-items with two spaces</li> <li>Use ordered lists (<code>1.</code>, <code>2.</code>, etc.) when sequence matters</li> <li> <p>Lists often follow a brief introductory sentence ending with a colon</p> </li> <li> <p>Example:</p> <pre><code>The main advantages are:\n- **First advantage**: Description here\n- **Second advantage**: Description here\n    - Sub-point with details\n    - Another sub-point\n</code></pre> </li> </ul>"},{"location":"ai_prompts/blog.format_rules.html#emphasis_and_formatting","title":"Emphasis and Formatting","text":"<ul> <li> <p>Bold text (<code>**text**</code>):</p> <ul> <li>Use for key terms and important concepts</li> <li>Use at the start of list items for headers/labels</li> <li>Use for strong emphasis</li> </ul> </li> <li> <p>Italic text (<code>_text_</code>):</p> <ul> <li>Use for questions and hypothetical scenarios</li> <li>Use for terms being defined or emphasized</li> <li>Use for \"what if\" scenarios</li> </ul> </li> <li> <p>Inline code (<code>`code`</code>):</p> <ul> <li>Use for technical terms, variable names, or code snippets</li> </ul> </li> </ul>"},{"location":"ai_prompts/blog.format_rules.html#tables","title":"Tables","text":"<ul> <li> <p>Use standard Markdown tables for comparisons:</p> <pre><code>| Column 1 | Column 2 | Column 3 |\n| :------- | :------- | :------- |\n| Data 1   | Data 2   | Data 3   |\n</code></pre> </li> <li> <p>Use left-aligned columns (<code>:-------</code>)</p> </li> <li>Keep column headers bold where appropriate</li> </ul>"},{"location":"ai_prompts/blog.format_rules.html#links","title":"Links","text":"<ul> <li>Use standard Markdown format: <code>[text](URL)</code></li> <li>Link to external references and sources</li> <li>Use descriptive link text</li> </ul>"},{"location":"ai_prompts/blog.format_rules.html#mathematical_notation","title":"Mathematical Notation","text":"<p>When mathematical formulas are needed:</p> <ul> <li>Inline math: <code>$E = mc^2$</code></li> <li>Block math:     <pre><code>$$\nE = mc^2\n$$\n</code></pre></li> </ul>"},{"location":"ai_prompts/blog.format_rules.html#conclusion","title":"Conclusion","text":"<ul> <li>Often ends with a call to action or summary</li> <li>May reference Causify and invite engagement</li> <li>Keep it actionable and forward-looking</li> </ul>"},{"location":"ai_prompts/blog.format_rules.html#general_style_guidelines","title":"General Style Guidelines","text":"<ul> <li>Maintain consistent spacing between sections</li> <li>Use blank lines to separate different content blocks</li> <li>Keep the tone professional but conversational</li> <li>Be direct and avoid unnecessary jargon</li> <li>Use concrete examples to illustrate abstract concepts</li> <li>Aim for clarity and brevity</li> </ul>"},{"location":"ai_prompts/blog.write_tutorial.html","title":"Blog.write tutorial","text":"<ul> <li>You are a technical writer.</li> <li>Write a short tutorial about the topic passed from the user</li> <li> <p>Read and follow <code>docs/ai_prompts/markdown.format_rules.md</code></p> </li> <li> <p>Focus on Linux and MacOS builds</p> </li> <li> <p>Focus on simplicity and clarity</p> </li> <li> <p>When writing commands use the template     <pre><code>- On macOS and Linux using the official installer:\n```bash\n&gt; curl -LsSf https://astral.sh/uv/install.sh | sh\n```\n</code></pre></p> </li> </ul>"},{"location":"ai_prompts/coding.factor_common_code.html","title":"Coding.factor common code","text":"<ul> <li> <p>You are a senior Python engineer with strong experience in refactoring and     codebase hygiene.</p> </li> <li> <p>I will provide references to one or more Python source files</p> </li> <li>Your task is to read and analyze the code across these files and identify     meaningful duplicated or near-duplicated code blocks that can be safely     refactored into shared functions</li> <li>Do not changed the behavior of the code</li> </ul>"},{"location":"ai_prompts/coding.factor_common_code.html#objectives","title":"Objectives","text":"<ul> <li>Detect common logic that appears in multiple places (exact or structurally     similar)</li> <li>Propose reusable functions that improve maintainability and readability</li> </ul>"},{"location":"ai_prompts/coding.factor_common_code.html#constraints_guidelines","title":"Constraints &amp; Guidelines","text":"<ul> <li>Do not suggest functions that are trivial (e.g., fewer than 2\u20133 meaningful     lines)</li> <li>Avoid trivial abstractions and prefer extracting logic that:<ul> <li>Is likely to change in one place in the future</li> <li>Encapsulates a clear responsibility</li> </ul> </li> <li>If similar blocks are not identical, explain briefly why they can still be     unified</li> <li>Do not rewrite the full implementation unless explicitly asked, but only focus     on identifying and describing refactor opportunities</li> </ul>"},{"location":"ai_prompts/coding.factor_common_code.html#output_format","title":"Output Format","text":"<ul> <li>For each proposed refactoring, produce:<ul> <li>Proposed function interface<ul> <li>Function name</li> <li>Parameters (with brief explanation if non-obvious)</li> <li>Return value (if any)</li> </ul> </li> <li>Summary of the locations of duplicated code<ul> <li>Use the following format:     <pre><code>file1.py: l1\u2013l2, l3\u2013l4, ...\nFile2.py: l5\u2013l8, ...\n</code></pre></li> </ul> </li> <li>Create a vim quickfile cfile so that the user can navigate the proposed     changes with a command like <code>vim -c \"cfile cfile\"</code> for instance     <pre><code>/path/to/file1.py:10:1: Replace with function ...\n/path/to/file1.py:12:1:\n/path/to/file1.py:12:1:\n</code></pre></li> </ul> </li> </ul>"},{"location":"ai_prompts/coding.find_doc.html","title":"Coding.find doc","text":"<p>Given the passed dir, file, class, function find the files containing the documentation for that specific object and a short summary of the documentation in 3 bullet points</p>"},{"location":"ai_prompts/coding.fix_from_imports.html","title":"Coding.fix from imports","text":"<ul> <li> <p>Replace any Python statement like <code>from X import Y</code> with the form <code>import X</code>     and then replace the uses of <code>Y</code> with <code>X.Y</code></p> </li> <li> <p>The only ones that can stay as <code>from X import Y</code> are     <pre><code>from typing import Optional\nfrom IPython.display import display\n</code></pre></p> </li> </ul>"},{"location":"ai_prompts/coding.fix_gh_issue.html","title":"Coding.fix gh issue","text":"<p>Please analyze and fix the GitHub issue: $ARGUMENTS.</p> <p>Follow these steps:</p> <ol> <li>Use <code>gh issue view</code> to get the issue details</li> <li>Understand the problem described in the issue</li> <li>Search the codebase for relevant files</li> <li>Implement the necessary changes to fix the issue</li> <li>Write and run tests to verify the fix</li> <li>Ensure code passes linting and type checking</li> <li>Create a descriptive commit message</li> <li>Push and create a PR</li> </ol> <p>Remember to use the GitHub CLI (<code>gh</code>) for all GitHub-related tasks.</p>"},{"location":"ai_prompts/coding.fix_param_use.html","title":"Coding.fix param use","text":"<ul> <li> <p>I will pass you a file</p> </li> <li> <p>In that file, make sure that:</p> <ul> <li>Callers pass the parameters by position and pass the keywords arguments</li> <li>Constant should be assigned to intermediate variable with the same name     corresponding to the formal parameters</li> </ul> </li> <li> <p>For a function with the signature</p> <p><code>python def apply_llm_prompt_to_df(     prompt: str,     df: pd.DataFrame,     extractor: Callable[[Union[str, pd.Series]], str],     target_col: str,     batch_mode: str,     *,     model: str,     batch_size: int = 50,     dump_every_batch: Optional[str] = None,     tag: str = \"Processing\",     testing_functor: Optional[Callable[[str], str]] = None,     use_sys_stderr: bool = False, ) -&gt; Tuple[pd.DataFrame, Dict[str, int]]:</code></p> </li> <li> <p>Bad</p> <p><code>python df, stats = hllmcli.apply_llm_prompt_to_df(     prompt=prompt,     df=df,     extractor=extract_person_industry_from_df,     target_col=\"industry\",     batch_mode=batch_mode,     batch_size=batch_size,     model=model,     tag=tag, )</code></p> </li> <li> <p>Good     <code>python target_col = \"industry\" df, stats = hllmcli.apply_llm_prompt_to_df(         prompt,         df,         extract_person_industry_from_df,         target_col,         batch_mode,         batch_size=batch_size,         model=model,         tag=tag, )</code></p> </li> </ul>"},{"location":"ai_prompts/coding.format_rules.html","title":"Coding.format rules","text":"<ul> <li>Assume the script needs to run only on Linux</li> </ul>"},{"location":"ai_prompts/coding.format_rules.html#use_assertions_from_helpershdbgpy","title":"Use Assertions From <code>helpers/hdbg.py</code>","text":"<ul> <li>Use one of the <code>hdbg.dassert</code> functions in <code>helpers/hdbg.py</code> to check for     invariants<ul> <li>Pass parameters using lazing formatting<ul> <li>Good     <code>python hdbg.dassert...(     ...     \"Target directory does not exist:\", target_dir )</code></li> <li>Bad     <code>python hdbg.dassert...(     ...     f\"Target directory does not exist: {target_dir}\", )</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"ai_prompts/coding.format_rules.html#use_hsystem","title":"Use <code>hsystem</code>","text":"<ul> <li>Use code in <code>helpers/hsystem.py</code> to call commands</li> <li>Do not try to catching error, but let the exception propagate<ul> <li>Bad     <code>python try:     hsystem.system(\"which llm\", suppress_output=True)     _LOG.debug(\"llm command found\") except Exception as e:     hdbg.dfatal(f\"llm command not found: {e}\")</code></li> <li>Good     <code>python hsystem.system(\"which llm\", suppress_output=True)</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/coding.format_rules.html#coding_style","title":"Coding Style","text":"<ul> <li>Use the coding style in <code>docs/ai_coding/code_template.py</code></li> <li> <p>Use REST comments in docstrings</p> <ul> <li>If the comment is only one line, still convert it to<ul> <li>Bad <code>python def reset(self) -&gt; None: \"\"\"Reset any internal state of the strategy.\"\"\" pass</code></li> <li>Good <code>python def reset(self) -&gt; None: \"\"\" Reset any internal state of the strategy. \"\"\" pass</code></li> </ul> </li> </ul> </li> <li> <p>Remove empty lines inside functions so that the code is compact</p> </li> <li>Use comments to separate chunks of code</li> <li> <p>Use periods at the end of all comments</p> </li> <li> <p>Use <code>_LOG.info</code> instead of print</p> </li> <li> <p>Use <code>_LOG.debug</code> to add debugging info that can help a programmer to track the     issues</p> <ul> <li>Always use lazy % formatting in logging functions</li> </ul> </li> <li> <p>Do not use try except to recover errors but let statements raise their own     errors</p> </li> <li> <p>Use <code>hdbg.dassert_*</code> functions to check that invariants are verified</p> </li> <li> <p>Use <code>*</code> for default parameters in functions</p> </li> <li> <p>If you create a new function which it is used only in this file make it     private by starting the name with <code>_</code></p> </li> </ul>"},{"location":"ai_prompts/coding.format_rules.html#use_script_template","title":"Use Script Template","text":"<ul> <li>When creating scripts use the template     <code>dev_scripts_helpers/coding_tools/script_template.py</code><ul> <li>Create a parser function     <pre><code>def _parse() -&gt; argparse.ArgumentParser:\n\ndef _main(parser: argparse.ArgumentParser) -&gt; None:\n</code></pre></li> </ul> </li> </ul>"},{"location":"ai_prompts/coding.format_rules.html#use_action_idiom","title":"Use Action Idiom","text":"<ul> <li> <p>When using <code>--action</code></p> <p><code>python actions = hparser.select_actions(args, _VALID_ACTIONS, _DEFAULT_ACTIONS) hparser.add_action_arg(parser, _VALID_ACTIONS, _DEFAULT_ACTIONS)</code></p> </li> </ul>"},{"location":"ai_prompts/coding.format_rules.html#create_dirs","title":"Create Dirs","text":"<ul> <li>If directory doesn't exist create it using <code>hio.create_dir</code><ul> <li>If a <code>--from_scratch</code> option is requested, create the directory from scratch</li> </ul> </li> </ul>"},{"location":"ai_prompts/coding.format_rules.html#temporary_files","title":"Temporary files","text":"<ul> <li>When using temporary files use files named     <code>tmp.${name_of_script}.{function}.txt</code> to increase debuggability by inspecting     files<ul> <li>No need to clean up files</li> </ul> </li> </ul>"},{"location":"ai_prompts/coding.format_rules.html#use_progress_bar","title":"Use Progress Bar","text":"<ul> <li>When there are expensive for loop, use a progress bar using <code>tqdm</code> to track     the progress</li> </ul>"},{"location":"ai_prompts/coding.improve_comments.html","title":"Coding.improve comments","text":"<ul> <li>Make sure all the functions have a REST comments in docstrings</li> <li>Do not use empty lines within functions but use comments to separate chunks of     code</li> <li>Use periods at the end of all comments</li> <li>Make sure that there are comments in large chunks of code explaining the how.</li> </ul>"},{"location":"ai_prompts/coding.lint.html","title":"Coding.lint","text":"<p>Given a file passed on the command line, you must improve its appearance without changing its behavior</p> <ul> <li> <p>For a file containing Python code apply the rules from     <code>docs/ai_prompts/coding.format_rules.md</code></p> </li> <li> <p>For a file storing unit tests (i.e., whose base name starts with <code>test_.py</code>)     apply the rules from <code>docs/ai_prompts/testing.format_rules.md</code></p> </li> <li> <p>For a markdown or text file apply the rules in     <code>./helpers_root/docs/ai_prompts/markdown.format_rules.md</code></p> </li> <li> <p>For a blog apply the rules in     <code>./helpers_root/docs/ai_prompts/blog.format_rules.md</code></p> </li> </ul>"},{"location":"ai_prompts/coding.make_function_private.html","title":"Coding.make function private","text":"<p>You are an expert Python software engineer</p> <p>For each function and class in the passed Python file, check if it's a function called by other Python files or Jupyter notebooks</p> <p>If the function is not called by any other file, then it should be a private function and should be rename and prepended with a <code>_</code></p> <ul> <li>E.g., <code>def function</code> -&gt; <code>def _function</code></li> </ul> <p>Then modify the callers of the function to use the new name</p>"},{"location":"ai_prompts/coding.rename.html","title":"Coding.rename","text":"<p>I will give a list of files, functions, variable to rename in a codebase</p> <p>In <code>TODO: -&gt;</code> means rename</p> <p>For files use <code>git mv</code></p> <p>Make sure to update all the references to those objects in the code base</p> <ul> <li>E.g., for files, look for and update imports</li> <li>E.g., for functions, find the callers in notebooks ipynb, Python files, and     other files and update those references</li> <li>Update documentation in txt and md files</li> <li> <p>If needed, run corresponding unit tests to make sure the code works</p> </li> <li> <p>For Python code follow the rules in <code>docs/ai_prompts/coding.format_rules.md</code></p> </li> <li> <p>For Python code with unit tests, follow the rules in the rules from     <code>docs/ai_prompts/testing.format_rules.md</code></p> </li> </ul>"},{"location":"ai_prompts/coding.review.html","title":"Coding.review","text":"<ul> <li>You are a senior Python engineer.</li> <li> <p>I will pass you reference to Python files.</p> </li> <li> <p>You will read the file and look and find the file with the unit tests for the     file, typically for a file <code>foo.py</code> the file is called <code>tests/test_foo.py</code>.</p> </li> <li> <p>You will find mistakes/bugs in the code and fix them with the smallest     possible changes.</p> </li> <li> <p>Constraints: Keep the same inputs/outputs and overall structure unless     necessary.</p> </li> <li> <p>What I want back:</p> <ul> <li>A short list of issues you found (with line references).</li> <li>A corrected version of the code.</li> <li>Why each fix works.</li> <li>A few test cases (including edge cases) and expected outputs.</li> </ul> </li> <li> <p>Observed behavior / error message: ...</p> </li> <li>Expected behavior: ...</li> </ul>"},{"location":"ai_prompts/coding.todoai_gp.html","title":"Coding.todoai gp","text":"<ul> <li> <p>Implement all the <code>TODO(ai_gp)</code> in the passed file</p> </li> <li> <p>In a <code>TODO:</code> the sign <code>-&gt; XYZ</code> means \"rename to XYZ\"</p> <ul> <li>Make sure to update all the references to those objects in the code base<ul> <li>E.g., for files, look for and update imports</li> <li>E.g., for functions, find the callers in notebooks ipynb, Python files,     and other files and update those references</li> <li>Update documentation in txt and md files</li> </ul> </li> <li>If needed, run corresponding unit tests to make sure the code works</li> </ul> </li> <li> <p>For a file containing Python code you MUST apply the rules from     <code>docs/ai_prompts/coding.format_rules.md</code></p> </li> <li> <p>For a file storing unit tests (i.e., whose base name starts with <code>test_*.py</code>)     you must apply the rules from <code>docs/ai_prompts/testing.format_rules.md</code></p> </li> <li> <p>For a notebook ipynb and its paired Python file, you MUST apply the rules from     <code>docs/ai_prompts/notebook.format_rules.md</code></p> </li> </ul>"},{"location":"ai_prompts/coding.update_comments.html","title":"Coding.update comments","text":"<p>Given the passed Python file</p> <ul> <li>Do not change the actual Python code</li> <li>Update the docstring to functions and file that are not in sync with the code</li> <li>Add docstrings that are missing</li> <li> <p>Update the comments that are not in sync with the code</p> </li> <li> <p>For all the code you must follow the instructions in     <code>docs/ai_prompts/coding.format_rules.md</code></p> </li> </ul>"},{"location":"ai_prompts/coding.update_dir_readme.html","title":"Coding.update dir readme","text":"<p>Given a directory passed on the command line apply create or update a README.md in that directory following the instructions in <code>docs/ai_prompts/readme.create.md</code></p>"},{"location":"ai_prompts/coding.update_expected_vars.html","title":"Coding.update expected vars","text":""},{"location":"ai_prompts/coding.update_expected_vars.html#step_1","title":"Step 1)","text":"<ul> <li>Run all the requested tests with pytest</li> <li>Find out which ones are failing due to a mismatch between <code>actual</code> and     <code>expected</code> string</li> <li>Print the list of test cases that are failing</li> </ul>"},{"location":"ai_prompts/coding.update_expected_vars.html#step_2","title":"Step 2)","text":"<ul> <li>Run each failing test one at the time, e.g.,     <pre><code>&gt; pytest helpers/test/test_hlatex.py::Test_frame_sections1::test_all_section_types\n</code></pre></li> <li>Print the test case that is failing and that we are fixing</li> </ul>"},{"location":"ai_prompts/coding.update_expected_vars.html#step_3","title":"Step 3)","text":"<ul> <li>Update the <code>expected</code> variable in the <code>test_*.py</code> code by changing the     expected variables to match what is saved by pytest in     <code>tmp.final.expected.txt</code></li> <li>Use the idiom below     <code>python expected = r\"\"\" ... \"\"\" expected = hprint.dedent(expected)</code></li> <li>Run to make sure the test is passing</li> </ul>"},{"location":"ai_prompts/coding.update_file_readme.html","title":"Coding.update file readme","text":"<p>Given a file passed on the command line apply create or update the README.md corresponding to that file following the instructions in <code>docs/ai_prompts/readme.create.md</code></p>"},{"location":"ai_prompts/demo.create_pictures.html","title":"Demo.create pictures","text":""},{"location":"ai_prompts/demo.create_pictures.html#step_1","title":"Step 1)","text":"<ul> <li> <p>Given the text of a storyboard for a presentation, for each slide generate     images in the following format, where you can add a description in  <li> <p>The prompt should be like:</p> <pre><code>CHARACTERS\n&lt;Complete&gt;\n\nSTYLE ANCHOR:\nClean, modern vector-illustration style, flat colors, soft gradients, consistent\nlighting, no harsh shadows, slightly rounded shapes, minimal detail, professional\ncorporate look, designed for a slide deck, white background, high contrast, 16:9\naspect ratio, no text, no watermark.\n\nSETTINGS:\n- No photorealistic elements or textures\n- No slide titles, headers, or explanatory text blocks\n- No decorative elements that don't serve the concept\n- No complex scenes with many small details\n- Minimize the number of distinct elements (5-7 maximum per image)\n\nCAMERA: Medium shot, straight-on.\n</code></pre> </li>"},{"location":"ai_prompts/demo.create_pictures.html#step_2","title":"Step 2)","text":"<ul> <li>You need to generate a file demo_images.md that can be used with the command     ```python <p>./helpers_root/dev_scripts_helpers/documentation/generate_images.py \\    -i demo_images.md \\    --dst_dir demo_images.md.figs     ```</p> </li> </ul>"},{"location":"ai_prompts/demo.create_script.html","title":"Demo.create script","text":"<p>Use the information given to create the script of a presentation / storyboard that can be converted into a video</p> <p>You are an expert storyteller, presentation designer, and video script writer.</p> <p>Using the information I provide, create a 15-slide presentation storyboard that can be directly converted into a narrated explainer video.</p>"},{"location":"ai_prompts/demo.create_script.html#audience","title":"Audience","text":"<ul> <li> <p>The audience includes:</p> <ul> <li>Business executives</li> <li>The general public</li> </ul> </li> <li> <p>Assume no technical background.</p> </li> <li> <p>Use:</p> <ul> <li>Clear, simple language</li> <li>No jargon or acronyms unless explained</li> <li>Concrete real-world examples</li> <li>Emotional hooks (risk, money, mistakes, opportunity)</li> <li>A strong narrative arc: problem \u2192 tension \u2192 insight \u2192 solution \u2192 future</li> </ul> </li> </ul>"},{"location":"ai_prompts/demo.create_script.html#story_requirements","title":"Story Requirements","text":"<ul> <li> <p>The presentation must:</p> <ul> <li>Start with a high-impact real-world problem</li> <li>Show why the current industry approach fails</li> <li>Introduce the solution naturally</li> <li>Explain why it works</li> <li>End with a clear takeaway and vision</li> </ul> </li> <li> <p>Every slide should:</p> <ul> <li>Move the story forward</li> <li>Be understandable by someone with no technical background</li> <li>Feel like part of a movie, not a technical deck</li> </ul> </li> </ul>"},{"location":"ai_prompts/demo.create_script.html#output_format","title":"Output Format","text":"<ul> <li>Return the result as a markdown table with exactly 15 rows (one per slide)     and three columns:</li> </ul> <p>| Slide Title | Video / Slide Description | Bullet Points / Voiceover |</p>"},{"location":"ai_prompts/demo.create_script.html#column_rules","title":"Column Rules","text":"<p>Slide Title</p> <ul> <li>Short, powerful, and non-technical</li> <li>Sounds like a headline</li> </ul> <p>Video / Slide Description</p> <ul> <li>Describe what is on screen as if briefing a video editor</li> <li>Include visuals, scenes, or animations</li> </ul> <p>Bullet Points / Voiceover</p> <ul> <li>Written as spoken narration</li> <li>3\u20136 bullet points per slide</li> <li>Conversational and persuasive</li> <li>Avoid technical terms unless unavoidable</li> </ul>"},{"location":"ai_prompts/demo.create_script.html#tone","title":"Tone","text":"<ul> <li>Confident but not salesy</li> <li>Serious about the problem</li> <li>Inspiring about the solution</li> <li>Easy to understand</li> </ul>"},{"location":"ai_prompts/demo.create_script.html#do_not","title":"Do NOT","text":"<ul> <li>Use buzzwords</li> <li>Write like a research paper</li> <li>Explain implementation details</li> <li>Refer to \"this slide\" or \"this presentation\"</li> </ul>"},{"location":"ai_prompts/demo.create_script.html#instructions","title":"Instructions","text":"<ul> <li>Begin only when the source information is provided.</li> </ul>"},{"location":"ai_prompts/graphviz.causal_kg_style.html","title":"Graphviz.causal kg style","text":""},{"location":"ai_prompts/graphviz.causal_kg_style.html#task_represent_a_causal_knowledge_graph_ckg","title":"Task: Represent a Causal Knowledge Graph (CKG)","text":"<p>You are an expert in causal inference and graphical models.</p> <p>I will give you a Graphviz DOT graph and your task is to produce a Graphviz/DOT representation of that graph that follows the rules below exactly.</p> <p>The resulting graph should allow a knowledgeable reader to distinguish causation from correlation at a glance, identify exogenous vs endogenous variables, identify latent vs observable variables, and recognize interventions and counterfactuals. In addition, use color to distinguish variable types consistently.</p>"},{"location":"ai_prompts/graphviz.causal_kg_style.html#general_graph_rules","title":"General Graph Rules","text":"<ul> <li>Use Graphviz DOT syntax</li> <li>Use a directed graph (<code>digraph</code>)</li> <li>Set <code>rankdir=LR</code> for left-to-right causal flow</li> <li>Prefer readability over compactness</li> <li>Use both <code>color</code> (border) and <code>fillcolor</code> + <code>style=filled</code> to encode variable     type (do not rely on color alone; keep shape conventions too)</li> </ul>"},{"location":"ai_prompts/graphviz.causal_kg_style.html#node_representation_rules","title":"Node Representation Rules","text":""},{"location":"ai_prompts/graphviz.causal_kg_style.html#variable_type_colors_required","title":"Variable Type Colors (Required)","text":"<p>Use these colors consistently for node borders/fills:</p> <ul> <li>Exogenous variable: color=#408AB0, fillcolor=#EAF3F8</li> <li>Endogenous variable: color=#62D4A4, fillcolor=#EAF9F3</li> <li>Target variable: color=#F8D476, fillcolor=#FFF6DA</li> <li>Latent (unobservable) variable: color=#183B4A, fillcolor=#E6EEF1</li> <li>Intervened variable (do(X)): color=#DE5470, fillcolor=#FBE6EC</li> <li>Counterfactual variable: color=#183B4A, fillcolor=#E6EEF1</li> </ul>"},{"location":"ai_prompts/graphviz.causal_kg_style.html#exogenous_vs_endogenous_vs_target","title":"Exogenous vs Endogenous vs Target","text":"<ul> <li>Exogenous variable (no causal parents)<ul> <li><code>shape=ellipse</code></li> <li><code>penwidth=2</code></li> <li>Must be colored using the exogenous palette above</li> </ul> </li> <li>Endogenous variable (has at least one causal parent)<ul> <li><code>shape=box,rounded</code></li> <li><code>penwidth=1</code> (default)</li> <li>Must be colored using the endogenous palette above</li> </ul> </li> <li>Target variable (no descendants; under study)<ul> <li><code>shape=box</code></li> <li><code>penwidth=2</code></li> <li>Must be colored using the target palette above</li> </ul> </li> </ul>"},{"location":"ai_prompts/graphviz.causal_kg_style.html#observable_vs_unobservable_latent_variables","title":"Observable vs Unobservable (Latent) Variables","text":"<ul> <li>Observable variable<ul> <li><code>style=filled,solid</code></li> <li>Use the appropriate color palette for its type     (exogenous/endogenous/target/etc.)</li> <li><code>fontcolor=black</code></li> </ul> </li> <li>Unobservable / latent variable<ul> <li><code>style=\"filled,dashed\"</code></li> <li>Must use the latent palette above (<code>color=gray40</code>, <code>fillcolor=gray90</code>,     <code>fontcolor=gray40</code>)</li> <li>Keep the same shape rule based on exogenous/endogenous/target if known;     otherwise default to <code>shape=ellipse</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/graphviz.causal_kg_style.html#special_node_types","title":"Special Node Types","text":"<ul> <li>Intervened variable (<code>do(X)</code>)<ul> <li><code>shape=doublecircle</code></li> <li>Label must be <code>do(X)</code></li> <li><code>style=filled,solid</code></li> <li>Must use the intervened palette above</li> <li>Incoming causal edges to <code>X</code> must be omitted</li> </ul> </li> <li>Counterfactual variable<ul> <li><code>style=\"filled,dotted\"</code></li> <li>Must use the counterfactual palette above</li> <li>Label must include counterfactual context (e.g., <code>Y | do(X=1)</code>)</li> </ul> </li> </ul>"},{"location":"ai_prompts/graphviz.causal_kg_style.html#edge_representation_rules","title":"Edge Representation Rules","text":""},{"location":"ai_prompts/graphviz.causal_kg_style.html#causation","title":"Causation","text":"<ul> <li>Direct causal effect<ul> <li>Solid arrow (<code>-&gt;</code>)</li> <li><code>style=solid</code></li> <li><code>dir=forward</code></li> <li>Default <code>color=black</code> unless overridden by effect sign/strength</li> </ul> </li> <li>Uncertain or hypothesized causation<ul> <li>Dotted arrow (<code>style=dotted</code>)</li> <li>Must include <code>label=\"?\"</code></li> <li>Use <code>color=gray30</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/graphviz.causal_kg_style.html#correlation_association_non-causal","title":"Correlation / Association (Non-causal)","text":"<ul> <li>Correlation without causal claim<ul> <li>Dashed edge</li> <li>No arrowheads (<code>dir=none</code>)</li> <li>Use <code>constraint=false</code></li> <li>Label with a statistical symbol</li> <li>Use <code>color=gray50</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/graphviz.causal_kg_style.html#effect_attributes_optional","title":"Effect Attributes (Optional)","text":"<ul> <li>Positive effect<ul> <li>Default arrowhead</li> <li>Label <code>\"+\"</code>, <code>\"++\"</code>, <code>\"+++\"</code></li> <li>Use <code>color=darkgreen</code></li> </ul> </li> <li>Negative effect<ul> <li>Default arrowhead</li> <li>Label <code>\"-\"</code>, <code>\"--\"</code>, <code>\"---\"</code></li> <li>Use <code>color=firebrick3</code></li> </ul> </li> <li>Effect strength (by symbols in the label)<ul> <li>Strong: <code>+++</code>, <code>---</code></li> <li>Weak: <code>+</code>, <code>-</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/graphviz.causal_kg_style.html#confounding_and_common_causes","title":"Confounding and Common Causes","text":"<ul> <li>Represent confounders explicitly<ul> <li>Use a latent node with dashed gray styling (latent palette)</li> <li>Draw causal arrows from the confounder to each affected variable</li> </ul> </li> <li>Do not use correlation edges to represent confounding</li> </ul>"},{"location":"ai_prompts/graphviz.causal_kg_style.html#layout_and_structure","title":"Layout and Structure","text":"<ul> <li>Use subgraphs (clusters) when helpful<ul> <li>Structural model vs observational associations</li> <li>Different time slices or mechanisms</li> </ul> </li> <li>Ensure correlation edges do not affect node ranking (<code>constraint=false</code>)</li> </ul>"},{"location":"ai_prompts/graphviz.causal_kg_style.html#output_requirements","title":"Output Requirements","text":"<ul> <li>Output only valid Graphviz/DOT code without triple backticks</li> <li>Do not explain the code in natural language</li> <li>Follow all visual and semantic conventions above exactly</li> </ul>"},{"location":"ai_prompts/graphviz.convert_image.html","title":"Graphviz.convert image","text":""},{"location":"ai_prompts/graphviz.convert_image.html#step_1","title":"Step 1)","text":"<ul> <li>Given the graphviz dot below     <pre><code>digraph legend {\n        graph [rankdir=TB, nodesep=0.5, ranksep=0.7];\n        node [shape=point, width=0, height=0, margin=0];\n        edge [dir=forward];\n\n        // Row 1: Direct causation\n        {\n                rank=same;\n                a1 [label=\"\", style=invis];\n                b1 [label=\"\", style=invis];\n                t1 [shape=plaintext, style=solid, label=\"          Direct causation\", fontsize=16, fontname=\"Arial\"];\n                a1 -&gt; b1 [style=solid, color=black, penwidth=3, arrowsize=1.2, minlen=3];\n                b1 -&gt; t1 [style=invis, minlen=1];\n        }\n\n        // Row 2: Uncertain/hypothesized causation\n        {\n                rank=same;\n                a2 [label=\"\", style=invis];\n                b2 [label=\"\", style=invis];\n                t2 [shape=plaintext, style=solid, label=\"          Uncertain / hypothesized causation\", fontsize=16, fontname=\"Arial\"];\n                a2 -&gt; b2 [style=dotted, color=black, penwidth=2, arrowsize=1.0, minlen=3];\n                b2 -&gt; t2 [style=invis, minlen=1];\n        }\n\n        // Row 3: Correlation/association\n        {\n                rank=same;\n                a3 [label=\"\", style=invis];\n                b3 [label=\"\", style=invis];\n                t3 [shape=plaintext, style=solid, label=\"          Correlation / association (non-causal)\", fontsize=16, fontname=\"Arial\"];\n                a3 -&gt; b3 [style=dotted, color=gray50, penwidth=2, arrowhead=none, minlen=3];\n                b3 -&gt; t3 [style=invis, minlen=1];\n        }\n\n        // Row 4: Positive effect\n        {\n                rank=same;\n                a4 [label=\"\", style=invis];\n                b4 [label=\"\", style=invis];\n                t4 [shape=plaintext, style=solid, label=\"          Positive effect (+ / ++ / +++)\", fontsize=16, fontname=\"Arial\"];\n                a4 -&gt; b4 [style=solid, color=\"#228B22\", penwidth=3, arrowsize=1.2, minlen=3];\n                b4 -&gt; t4 [style=invis, minlen=1];\n        }\n\n        // Row 5: Negative effect\n        {\n                rank=same;\n                a5 [label=\"\", style=invis];\n                b5 [label=\"\", style=invis];\n                t5 [shape=plaintext, style=solid, label=\"          Negative effect (- / -- / ---)\", fontsize=16, fontname=\"Arial\"];\n                a5 -&gt; b5 [style=solid, color=\"#DC143C\", penwidth=3, arrowsize=1.2, minlen=3];\n                b5 -&gt; t5 [style=invis, minlen=1];\n        }\n\n        // Row 6: Strength encoding - using &lt;-&gt; instead of Unicode\n        {\n                rank=same;\n                a6 [label=\"\", style=invis];\n                b6 [label=\"\", style=invis];\n                t6 [shape=plaintext, style=solid, label=\"          Strength encoding (weak &lt;-&gt; strong)\", fontsize=16, fontname=\"Arial\"];\n                a6 -&gt; b6 [style=solid, color=\"#228B22\", penwidth=3, arrowsize=1.2, minlen=3];\n                b6 -&gt; t6 [style=invis, minlen=1];\n        }\n\n        // Force vertical ordering and left alignment\n        a1 -&gt; a2 -&gt; a3 -&gt; a4 -&gt; a5 -&gt; a6 [style=invis];\n        b1 -&gt; b2 -&gt; b3 -&gt; b4 -&gt; b5 -&gt; b6 [style=invis];\n}\n</code></pre></li> </ul>"},{"location":"ai_prompts/graphviz.convert_image.html#step_2","title":"Step 2)","text":"<ul> <li>Create a graphviz dot to match exactly the figure.png</li> </ul>"},{"location":"ai_prompts/graphviz.convert_image.html#step_3","title":"Step 3)","text":"<ul> <li>Use <code>./helpers_root/dev_scripts_helpers/documentation/dockerized_graphviz.py</code>     to generate a png</li> </ul>"},{"location":"ai_prompts/graphviz.convert_image.html#step_4","title":"Step 4)","text":"<ul> <li>Keep tweaking it until it looks like the figure</li> </ul>"},{"location":"ai_prompts/graphviz.generate_legend.html","title":"Graphviz.generate legend","text":""},{"location":"ai_prompts/graphviz.generate_legend.html#template_nodes","title":"Template Nodes","text":"<pre><code>digraph WindTurbineCKG {\n    rankdir=LR;\n    splines=true;\n    nodesep=0.8;\n    ranksep=1.2;\n    bgcolor=\"white\";\n\nsubgraph cluster_legend {\n    label=\"Legend: Node Types\";\n    fontsize=11;\n    fontname=\"Helvetica\";\n    color=gray70;\n    style=\"rounded,dashed\";\n    bgcolor=\"white\";\n\n    // Put every legend node on the SAME rank (same vertical alignment)\n    { rank=same;\n        leg_exog; leg_op; leg_latent; leg_obs; leg_health; leg_out;\n    }\n\n    leg_exog   [label=\"Exogenous /\\nEnvironmental\", shape=ellipse, style=filled, fontcolor=black, color=royalblue4, fillcolor=lightsteelblue1];\n    leg_op     [label=\"Operational /\\nMechanism\", shape=box, style=\"rounded,filled,solid\", fontcolor=black, color=darkgreen, fillcolor=palegreen1];\n    leg_latent [label=\"Latent /\\nHidden State\", shape=box, style=\"filled,dashed\", fontcolor=gray40, color=gray40, fillcolor=gray90];\n    leg_obs    [label=\"Observable\\nSignal\", shape=ellipse, style=filled, fontcolor=black, color=darkgreen, fillcolor=palegreen1];\n    leg_health [label=\"Health\\nIndicator\", shape=ellipse, style=filled, fontcolor=black, color=gray40, fillcolor=gray90];\n    leg_out    [label=\"Outcome /\\nTarget\", shape=box, penwidth=2, style=filled, fontcolor=black, color=darkorange3, fillcolor=moccasin];\n\n    // Keep left-to-right ordering without changing ranks\n    leg_exog   -&gt; leg_op     [style=invis, weight=10];\n    leg_op     -&gt; leg_latent [style=invis, weight=10];\n    leg_latent -&gt; leg_obs    [style=invis, weight=10];\n    leg_obs    -&gt; leg_health [style=invis, weight=10];\n    leg_health -&gt; leg_out    [style=invis, weight=10];\n}\n\n}\n</code></pre>"},{"location":"ai_prompts/graphviz.generate_legend.html#edge_legend","title":"Edge Legend","text":"<pre><code>digraph legend {\n        graph [rankdir=TB, nodesep=0.5, ranksep=0.7];\n        node [shape=point, width=0, height=0, margin=0];\n        edge [dir=forward];\n\n        // Row 1: Direct causation\n        {\n                rank=same;\n                a1 [label=\"\", style=invis];\n                b1 [label=\"\", style=invis];\n                t1 [shape=plaintext, style=solid, label=\"Direct causation\", fontsize=16, fontname=\"Arial\"];\n                a1 -&gt; b1 [style=solid, color=black, penwidth=3, arrowsize=1.2, minlen=3];\n                b1 -&gt; t1 [style=invis, minlen=1];\n        }\n\n        // Row 2: Uncertain/hypothesized causation\n        {\n                rank=same;\n                a2 [label=\"\", style=invis];\n                b2 [label=\"\", style=invis];\n                t2 [shape=plaintext, style=solid, label=\"Uncertain / hypothesized causation\", fontsize=16, fontname=\"Arial\"];\n                a2 -&gt; b2 [style=dotted, color=black, penwidth=2, arrowsize=1.0, minlen=3];\n                b2 -&gt; t2 [style=invis, minlen=1];\n        }\n\n        // Row 3: Correlation/association\n        {\n                rank=same;\n                a3 [label=\"\", style=invis];\n                b3 [label=\"\", style=invis];\n                t3 [shape=plaintext, style=solid, label=\"Correlation / association (non-causal)\", fontsize=16, fontname=\"Arial\"];\n                a3 -&gt; b3 [style=dotted, color=gray50, penwidth=2, arrowhead=none, minlen=3];\n                b3 -&gt; t3 [style=invis, minlen=1];\n        }\n\n        // Row 4: Positive effect\n        {\n                rank=same;\n                a4 [label=\"\", style=invis];\n                b4 [label=\"\", style=invis];\n                t4 [shape=plaintext, style=solid, label=\"Positive effect (+ / ++ / +++)\", fontsize=16, fontname=\"Arial\"];\n                a4 -&gt; b4 [style=solid, color=\"#228B22\", penwidth=3, arrowsize=1.2, minlen=3];\n                b4 -&gt; t4 [style=invis, minlen=1];\n        }\n\n        // Row 5: Negative effect\n        {\n                rank=same;\n                a5 [label=\"\", style=invis];\n                b5 [label=\"\", style=invis];\n                t5 [shape=plaintext, style=solid, label=\"Negative effect (- / -- / ---)\", fontsize=16, fontname=\"Arial\"];\n                a5 -&gt; b5 [style=solid, color=\"#DC143C\", penwidth=3, arrowsize=1.2, minlen=3];\n                b5 -&gt; t5 [style=invis, minlen=1];\n        }\n\n        // Row 6: Strength encoding - using &lt;-&gt; instead of Unicode\n        {\n                rank=same;\n                a6 [label=\"\", style=invis];\n                b6 [label=\"\", style=invis];\n                t6 [shape=plaintext, style=solid, label=\"Strength encoding (weak &lt;-&gt; strong)\", fontsize=16, fontname=\"Arial\"];\n                a6 -&gt; b6 [style=solid, color=\"#228B22\", penwidth=3, arrowsize=1.2, minlen=3];\n                b6 -&gt; t6 [style=invis, minlen=1];\n        }\n\n        // Force vertical ordering and left alignment\n        a1 -&gt; a2 -&gt; a3 -&gt; a4 -&gt; a5 -&gt; a6 [style=invis];\n        b1 -&gt; b2 -&gt; b3 -&gt; b4 -&gt; b5 -&gt; b6 [style=invis];\n}\n</code></pre>"},{"location":"ai_prompts/markdown.fix_bullet_points.html","title":"Markdown.fix bullet points","text":"<ul> <li> <p>Given a markdown file passed from the user</p> </li> <li> <p>Make sure the text is organized in bullet points</p> </li> <li> <p>Make sure that all fenced div have a syntax description (e.g., python,     markdown, verbatim)</p> </li> <li> <p>Bad     <pre><code>The simplest ripgrep command searches for a pattern in the current directory:\n\n```bash\n&gt; rg \"pattern\"\n```\n</code></pre></p> </li> <li>Good     <pre><code>- The simplest ripgrep command searches for a pattern in the current\n    directory:\n    ```bash\n    &gt; rg \"pattern\"\n    ```\n</code></pre></li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html","title":"Markdown.format rules","text":""},{"location":"ai_prompts/markdown.format_rules.html#summary","title":"Summary","text":"<ul> <li>This file contains conventions for writing markdown files</li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#goals_and_philosophy","title":"Goals and Philosophy","text":"<ul> <li> <p>Make the text easy to consume for both humans and AI</p> </li> <li> <p>Focus on:</p> <ul> <li>Clarity</li> <li>Brevity</li> <li>Visual structure</li> </ul> </li> <li> <p>Think of notes as a hybrid between a textbook and a student's notebook</p> </li> <li> <p>This document is written using the rules described in this document itself</p> </li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#formatting_guidelines","title":"Formatting Guidelines","text":""},{"location":"ai_prompts/markdown.format_rules.html#every_document_has_a_summary_header","title":"Every Document Has a Summary Header","text":"<ul> <li>Every document should have a summary paragraph with a header <code># Summary</code> with     a short paragraph containing what's the content of the document</li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#headers_and_paragraphs","title":"Headers and Paragraphs","text":"<ul> <li>Use headers and paragraphs     <pre><code># Header 1\n\n## Header 2\n</code></pre></li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#use_only_text","title":"Use Only Text","text":"<ul> <li>Avoid emojis and icons</li> <li>Avoid any decorative formatting<ul> <li>Do not use line separator like <code>---</code></li> </ul> </li> <li>Use only basic text<ul> <li>Good: A -&gt; B</li> <li>Bad: A \u2192 B</li> <li>Good: \"hello\"</li> <li>Bad: \"hello\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#use_bullets","title":"Use Bullets","text":"<ul> <li> <p>Use bullet points inside a paragraph</p> </li> <li> <p>Each bullet should express one complete atomic idea</p> <ul> <li>Keep bullets concise but meaningful (1\u20133 lines)</li> </ul> </li> <li> <p>Use bullets to show:</p> <ul> <li>Definitions</li> <li>Purpose</li> <li>Components</li> <li>Pros and cons</li> <li>Examples</li> </ul> </li> <li> <p>Use <code>=</code> for definitions</p> <ul> <li>Example:     <pre><code>- Latency = the delay before a transfer of data begins after an instruction\n</code></pre></li> </ul> </li> <li> <p>Group bullets under clear paragraph headings</p> </li> <li> <p>Do not end a bullet point with a period <code>.</code></p> </li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#use_nested_bullets","title":"Use Nested Bullets","text":"<ul> <li>Use nested bullets to show:<ul> <li>Dependencies and relationships<ul> <li>E.g., cause -&gt; effect</li> </ul> </li> <li>Hierarchy of concepts, e.g.,     <pre><code>- Technology\n    - Hardware\n        - Computers\n        - Mobile Devices\n    - Software\n        - Operating Systems\n        - Applications\n</code></pre></li> <li>Components and lists, e.g.,     <pre><code>- Allowed formats:\n    - Graphviz\n    - Mermaid\n    - TikZ-style charts\n</code></pre></li> <li>Elaboration, not to extend main bullets, e.g., for<ul> <li>Definitions</li> <li>Examples</li> <li>Implications</li> </ul> </li> </ul> </li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#list_of_items","title":"List of Items","text":"<ul> <li>In lists of items<ul> <li>Bold the item whenever possible</li> <li>Use verbatim when the item is a script, a command (e.g., <code>python</code>, <code>bash</code>,     <code>latex</code>)</li> <li>Use <code>:</code> to separate file and description instead of <code>-</code></li> <li>Bad:     <pre><code>- notes_to_pdf.py - Main tool for converting notes to PDF/HTML/slides\n- render_images.py - Auto-renders diagrams (PlantUML, Mermaid, TikZ, Graphviz)\n</code></pre></li> <li>Good:     <pre><code>- `notes_to_pdf.py`: Main tool for converting notes to PDF/HTML/slides\n- `render_images.py`: Auto-renders diagrams (PlantUML, Mermaid, TikZ, Graphviz)\n</code></pre></li> </ul> </li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#use_verbatim_for_programs","title":"Use Verbatim for Programs","text":"<ul> <li>For libraries, executables, scripts use verbatim<ul> <li>E.g., <code>notes_to_pdf.py</code>, <code>python</code>, <code>pandas</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#use_and_do_not_use","title":"Use and Do Not Use &amp;","text":"<ul> <li>Bad: Extraction &amp; Conversion Tools</li> <li>Good: Extraction and Conversion Tools</li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#writing_style","title":"Writing Style","text":""},{"location":"ai_prompts/markdown.format_rules.html#writing_style_1","title":"Writing Style","text":"<ul> <li> <p>Use explicit references instead of unclear ones</p> <ul> <li>Good: \"TCP protocol\"</li> <li>Bad: \"it\"</li> </ul> </li> <li> <p>Maintain consistent labels for recurring ideas</p> </li> <li> <p>Avoid redundancy in concepts</p> </li> <li> <p>Prefer plain language over academic jargon</p> </li> <li> <p>Make sure text is short and not unnecessarily long</p> </li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#avoid_long_prose","title":"Avoid Long Prose","text":"<ul> <li> <p>Prefer structured notes over narrative prose</p> </li> <li> <p>Use a first-person, self-directed voice, e.g.,</p> <ul> <li>Good: \"Key thing to remember: entropy increases\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#use_direct_statements","title":"Use Direct Statements","text":"<ul> <li>Convert abstract principles into short, direct statements, e.g.,<ul> <li>Good: \"Everyone takes responsibility: no blaming others if work isn't     finished.\"</li> <li>Bad: \"Everyone takes responsibility, owns their projects, and blames no     one if something doesn't get finished.\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#try_to_use_lists","title":"Try to Use Lists","text":"<ul> <li>Good <pre><code>- This document covers how to publish:\n    - documents\n    - books\n    - blogs\n    across different repos, e.g.,\n    - `//helpers`\n    - `//csfy`\n    - `//tutorials`\n    - `//umd_classes`\n</code></pre></li> <li>Bad <pre><code>This document covers how to publish documents, books, and blogs across\ndifferent repos (e.g., `//helpers`, `//csfy`, `//tutorials`, and\n`//umd_classes`)\n</code></pre></li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#use_fenced_code_blocks","title":"Use Fenced Code Blocks","text":"<ul> <li>When using fenced code blocks, make sure there are valid programming language     (e.g., <code>python</code>, <code>bash</code>, <code>latex</code>, <code>verbatim</code>)</li> <li>E.g.,     <pre><code>```python\n</code></pre></li> <li>The fenced code block should be aligned with the text and the bullet points     <pre><code>- Do this and that:\n    ```bash\n    &gt; do_this_and_that\n    ```\n</code></pre></li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#use_for_commands","title":"Use <code>&gt;</code> For Commands","text":"<ul> <li>Prepend a <code>&gt;</code> before each bash command</li> <li>E.g., convert     <pre><code>pipenv install requests\npipenv shell\n</code></pre>     to     <pre><code>&gt; pipenv install requests\n&gt; pipenv shell\n</code></pre></li> </ul>"},{"location":"ai_prompts/markdown.format_rules.html#use_diagrams_over_text_when_possible","title":"Use Diagrams Over Text When Possible","text":"<ul> <li>Summarize systems or relationships using:<ul> <li>Graphviz</li> <li>Mermaid</li> <li>Tikz-style charts</li> </ul> </li> <li>Add annotation arrows and layered explanations</li> </ul>"},{"location":"ai_prompts/notebooks.create_animation.html","title":"Notebooks.create animation","text":"<ul> <li> <p>Given the function passed that can go in <code>ipywidget.interact()</code> create an     animation using the template below:</p> <p>```python</p> </li> </ul>"},{"location":"ai_prompts/notebooks.create_animation.html#parameters_for_video_generation","title":"Parameters for video generation.","text":"<p>n_steps = 11 n_samples_fixed = 300 dependence_values = np.linspace(0.0, 1.0, n_steps)</p>"},{"location":"ai_prompts/notebooks.create_animation.html#prepare_values_list_for_generate_animation","title":"Prepare values list for generate_animation.","text":"<p>values = [] for val in dependence_values:         values.append({\"dependence\": val, \"n_samples\": n_samples_fixed})</p>"},{"location":"ai_prompts/notebooks.create_animation.html#directory_to_save_frames","title":"Directory to save frames.","text":"<p>dst_dir = \"./figures/Lesson94_Joint_Entropy_video\"</p>"},{"location":"ai_prompts/notebooks.create_animation.html#generate_animation_frames_with_fixed_dimensions","title":"Generate animation frames with fixed dimensions.","text":"<p>ut.generate_animation(         utils.plot_joint_entropy_interactive,         values,         dst_dir,         incremental=False,         figsize=(20, 5),         dpi=150 )     ```</p> <ul> <li>Always follow the instructions in <code>docs/ai_prompts/notebooks.format_rules.md</code></li> </ul>"},{"location":"ai_prompts/notebooks.create_visual_script.html","title":"Notebooks.create visual script","text":"<ul> <li>Given the passed content, you need to create a Jupyter notebook that helps a     college student to understand the requested concepts<ul> <li>The Jupyter notebook is described in terms of a markdown</li> <li>Create or update the file with the script <code>script.md</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/notebooks.create_visual_script.html#goals","title":"Goals","text":"<ul> <li> <p>The goals for the Jupyter notebook are:</p> <ul> <li>Strong intuition</li> <li>Visual explanation</li> <li>Build example incrementally</li> <li>Interactivity with widgets so that user can change the important variables     and see the results immediately</li> </ul> </li> <li> <p>Do not write any code</p> </li> </ul>"},{"location":"ai_prompts/notebooks.create_visual_script.html#markdown_description_of_each_cell","title":"Markdown Description of Each Cell","text":"<ul> <li> <p>Focus only on the examples without repeating content from the content</p> </li> <li> <p>Describe each cell using bullet points</p> </li> <li> <p>Each cell is described with the following format</p> <pre><code>## Cell i: Visual Bin.\n- Purpose: Give a concrete visual of the \"unknown\" population\n- Display:\n    - Show bin with marbles colored proportionally to mu\n    - ...\n- Interactive widget:\n    - Slider for mu (true proportion of red marbles, 0-1)\n    - ...\n- Key insights: ...\n</code></pre> </li> <li> <p>Cells should be numbered incrementally with a format</p> </li> </ul>"},{"location":"ai_prompts/notebooks.create_visual_script.html#formatting","title":"Formatting","text":"<ul> <li> <p>Do not use non-ascii characters</p> <ul> <li>E.g., use mu instead of \u03bc</li> </ul> </li> <li> <p>Do not use page separator</p> </li> </ul>"},{"location":"ai_prompts/notebooks.format_rules.html","title":"Notebooks.format rules","text":"<ul> <li> <p>You are an expert Python developer.</p> </li> <li> <p>I will pass you a Python file paired with Jupyter notebook with jupytext using     a <code>py:percent</code> format</p> <ul> <li>E.g., <code>msml610/tutorials/Lesson94-Information_Theory.py</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/notebooks.format_rules.html#use_jupytext","title":"Use Jupytext","text":"<ul> <li>When changing a notebook, you must only modify the Python file paired with the     given Jupyter notebook</li> <li> <p>If there is no Python file, but only the ipynb Jupyter notebook, you will run     a command to pair the notebook and the Python file:</p> <pre><code>&gt; uvx jupytext --set-formats ipynb,py:percent  &lt;ipynb file&gt;\n</code></pre> </li> <li> <p>After you have modified the Python file corresponding to the Jupyter notebook,     you will run a command to pair the notebook and the Python file     <pre><code>&gt; uvx jupytext --sync &lt;python file&gt;\n</code></pre></p> </li> </ul>"},{"location":"ai_prompts/notebooks.format_rules.html#use_python_style","title":"Use Python Style","text":"<ul> <li>For all the Python code you must follow the rules from     <code>docs/ai_prompts/coding.format_code.md</code></li> </ul>"},{"location":"ai_prompts/notebooks.format_rules.html#format_of_a_jupyter_notebook","title":"Format of a Jupyter Notebook","text":"<ul> <li> <p>Each notebook has the following format</p> </li> <li> <p>The first cell of a notebook is:</p> <p>```python %load_ext autoreload %autoreload 2</p> </li> </ul> <p>import logging</p> <p>import numpy as np import pandas as pd import seaborn as sns import matplotlib.pyplot as plt</p> <p>ut.config_notebook()</p>"},{"location":"ai_prompts/notebooks.format_rules.html#initialize_logger","title":"Initialize logger.","text":"<p>logging.basicConfig(level=logging.INFO) _LOG = logging.getLogger(name)     ```</p> <ul> <li> <p>The second cell is like:</p> <p><code>python import msml610_utils as ut import Lesson94_Information_Theory_utils as utils</code></p> </li> </ul>"},{"location":"ai_prompts/notebooks.format_rules.html#do_not_use_emoji_or_non-ascii_characters","title":"Do Not Use Emoji or Non-Ascii Characters","text":"<ul> <li>Do not use emoji or non-ascii characters, but only ascii ones</li> <li>You can use Latex notation for formulas, like \\(...\\) even if they are not     rendered</li> </ul>"},{"location":"ai_prompts/notebooks.format_rules.html#title_for_the_comment_box","title":"Title for the Comment Box","text":"<ul> <li>When using <code>add_fitted_text_box()</code> set the title     <pre><code>ax.set_title(\"Comments\", fontsize=14, fontweight=\"bold\", pad=20)\n</code></pre></li> </ul>"},{"location":"ai_prompts/notebooks.format_rules.html#interactive_widgets_conventions","title":"Interactive Widgets Conventions","text":"<ul> <li>Interactive widgets must always have:<ul> <li>The name of the variable (e.g., n, mu, nu)</li> <li>Value cell and \"-\" and \"+\" buttons</li> </ul> </li> <li> <p>The widget to select the seed must always be the first widget</p> </li> <li> <p>Use code in <code>msml610_utils.py</code> like <code>_create_slider_widget()</code>,     <code>build_widget_control()</code> to create the widgets</p> </li> </ul>"},{"location":"ai_prompts/notebooks.format_rules.html#logarithmic_widget_control","title":"Logarithmic Widget Control","text":"<ul> <li>When asked to build a logarithmic widget control, use the following idiom     ```python</li> </ul>"},{"location":"ai_prompts/notebooks.format_rules.html#create_n_widget_with_logarithmic_slider_and_-_buttons","title":"Create N widget with logarithmic slider and +/- buttons.","text":""},{"location":"ai_prompts/notebooks.format_rules.html#uses_exponents_2-10_for_base_2_gives_values_4_8_16_32_64_128_256_512_1024","title":"Uses exponents 2-10 for base 2: gives values 4, 8, 16, 32, 64, 128, 256, 512, 1024","text":""},{"location":"ai_prompts/notebooks.format_rules.html#initial_exponent_4_gives_initial_value_of_16","title":"Initial exponent 4 gives initial value of 16","text":"<p>N_exp_slider, N_box = mtumsuti.build_log_widget_control(         name=\"log(N)\",         description=\"N (total samples)\",         min_exp=2,         max_exp=10,         initial_exp=4,         base=2, )     ```</p>"},{"location":"ai_prompts/notebooks.format_rules.html#notebook_pairing_to_python_file_and_utility_file","title":"Notebook Pairing to Python File and Utility File","text":"<ul> <li>Each notebook is paired with Jupytext to a Python file and has a corresponding     <code>*_utils.py</code> file containing the code corresponding to that notebook<ul> <li>E.g., for the Jupyter notebook     <code>msml610/tutorials/Lesson94-Information_Theory.ipynb</code> is paired with     Jupytext to the file <code>msml610/tutorials/Lesson94-Information_Theory.py</code> and     the corresponding <code>*_utils.py</code> file is     <code>./msml610/tutorials/Lesson94_Information_Theory_utils.py</code></li> </ul> </li> <li>Given the notebook, find and print the corresponding paired file and the     <code>*_utils.py</code> file</li> </ul>"},{"location":"ai_prompts/notebooks.implement_script.html","title":"Notebooks.implement script","text":"<ul> <li>Given the passed description for a Jupyter notebook in the format described in     <code>docs/ai_prompts/notebooks.create_visual_script.md</code> implement the cells     requested by the user</li> </ul>"},{"location":"ai_prompts/notebooks.implement_script.html#conventions","title":"Conventions","text":"<ul> <li>Always use the conventions in <code>docs/ai_prompts/notebooks.format_rules.md</code></li> </ul>"},{"location":"ai_prompts/notebooks.implement_script.html#save_code_to_the_utilspy","title":"Save Code to the <code>*_utils.py</code>","text":"<ul> <li> <p>Each notebook is paired with Jupytext to a Python file and has a corresponding     <code>*_utils.py</code> file containing the code corresponding to that notebook</p> <ul> <li>E.g., for the Jupyter notebook     <code>msml610/tutorials/Lesson94-Information_Theory.ipynb</code> is paired with     Jupytext to the file <code>msml610/tutorials/Lesson94-Information_Theory.py</code> and     the corresponding <code>*_utils.py</code> file is     <code>./msml610/tutorials/Lesson94_Information_Theory_utils.py</code></li> </ul> </li> <li> <p>All the code implementing the widget must go in the utility</p> </li> <li>Only the caller to the function must be in the notebook     ```python</li> </ul>"},{"location":"ai_prompts/notebooks.implement_script.html#display_pdf_empirical_mean_nu_and_compare_with_theoretical_statistics","title":"Display PDF, empirical mean nu, and compare with theoretical statistics.","text":"<p>utils.sample_bernoulli3()</p>"},{"location":"ai_prompts/notebooks.implement_script.html#changing_the_seed_generates_new_realizations_with_different_empirical_values","title":"Changing the seed generates new realizations with different empirical values.","text":"<pre><code>```\n</code></pre>"},{"location":"ai_prompts/notebooks.implement_script.html#format_of_cells","title":"Format of Cells","text":"<ul> <li>Each cell description of the Jupyter notebook has the format     <pre><code>## Cell i: Visual Bin.\n- Purpose: Give a concrete visual of the \"unknown\" population\n- Visualization:\n    - Draw a 2D bin filled with red and green marbles\n    - Show bin with marbles colored proportionally to mu\n    - ...\n- Interactive widget:\n    - Slider for mu (true proportion of red marbles, 0-1)\n    - ...\n- Comment box: ...\n</code></pre></li> <li>Each cell description corresponds to a markdown cell and an interactive cell<ul> <li>The markdown cell contains the Header and the Purpose</li> <li>The interactive cell contains the Visualization, Interactive widget, Comment     box</li> </ul> </li> </ul>"},{"location":"ai_prompts/notebooks.implement_script.html#complex_interactive_widgets","title":"Complex Interactive Widgets","text":"<ul> <li>When the user asks for a \"complex interactive widget\", it means that there     must be multiple graphs (like 3 or 4 on the same row) in the same cell</li> <li> <p>Add the controls first with both sliders and a cell to enter the values</p> </li> <li> <p>Use a single row of 3 or 4 graphs (not in a 2 by 2 grid)</p> <ul> <li>E.g., joint distribution, entropy metrics, sampled realizations, explanation</li> <li>One graph must be \"Comments\" containing an explanation of what's happening     in the remaining graphs, based on the values selected in the widget</li> <li>Add information in each graph as a legend</li> </ul> </li> <li>Do not print any information as <code>print()</code> statement, but write all the     information in the \"Comments\" graph</li> <li>You can use <code>plot_joint_entropy_interactive()</code> in     <code>msml610/tutorials/Lesson94_Information_Theory_utils.py</code> as a reference</li> </ul>"},{"location":"ai_prompts/notebooks.implement_script.html#plotting_graphs","title":"Plotting Graphs","text":"<ul> <li>When a plot changes a little bit because of the interactive widget controls,     it must not abruptly change the values on the y-axis and x-axis</li> <li>The xlim and ylim of the graphs must be fixed until the graph is too big to     fit in which case it must change so that the xlim or ylim doubles or it's     reduced in half, so that the xlim / ylim can be stable when changing the     widget controls</li> </ul>"},{"location":"ai_prompts/notebooks.lint.html","title":"Notebooks.lint","text":"<p>Given a Jupyter notebook passed on the command line, you must improve its appearance without changing its behavior using the rules from <code>docs/ai_prompts/notebooks.format_rules.md</code></p>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html","title":"Notebooks.lint numbered cells","text":"<ul> <li>Given a Jupyter notebook passed on the command line, you must improve its     appearance without changing its behavior using the rules from     <code>docs/ai_prompts/notebooks.format_rules.md</code></li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#use_jupytext","title":"Use Jupytext","text":"<ul> <li>Remember to modify only the Python file paired with Jupytext to the notebook     and then sync them with Jupytext</li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#rename_markdown_cells","title":"Rename Markdown Cells","text":"<ul> <li>Each markdown cell must be named, depending on the markdown header level, with     a format like \"Cell 1:\" or \"Cell 1.1:\" as in the following<ul> <li>For header of level 1     <pre><code># Cell 1: Visual Bin: Population of Marbles.\n</code></pre></li> <li>For header of level 2     <pre><code>## Cell 1.1: Visual Bin: Population of Marbles.\n</code></pre></li> </ul> </li> <li>Cells around importing packages and configuring the notebook don't need the     prefix \"Cell:\"     <pre><code># Imports\n</code></pre></li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#cells_in_increasing_order","title":"Cells in Increasing Order","text":"<ul> <li> <p>Cells should be increasing and consecutive order</p> <ul> <li> <p>Bad</p> <p><pre><code># Cell 2: Entropy vs Variance\n\n# Cell 5: Interactive Visualization: Binary Entropy\n</code></pre>     - Good</p> <pre><code># Cell 2: Entropy vs Variance\n\n# Cell 3: Interactive Visualization: Binary Entropy\n</code></pre> </li> </ul> </li> <li> <p>When cells are renamed in the Python and Jupyter notebook also the names of     the functions should be renamed</p> <ul> <li> <p>Bad</p> <p>```python</p> </li> </ul> </li> </ul> <p>utils.cell5_create_binary_entropy_widget()         ```     - Good</p> <pre><code>    ```python\n</code></pre>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#cell_2_interactive_visualization_binary_entropy","title":"Cell 2: Interactive Visualization: Binary Entropy","text":""},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#cell_2_interactive_visualization_binary_entropy_1","title":"Cell 2: Interactive Visualization: Binary Entropy","text":"<p>utils.cell2_create_binary_entropy_widget()         ```</p>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#header_of_a_markdown_cell_with_cell_xyz","title":"Header of a Markdown Cell with <code>Cell XYZ</code>","text":"<ul> <li>A markdown cell can have a title starting with <code>Cell XYZ: ...</code><ul> <li>If the header is level 1 (e.g., 1, 2, 3), it should have a single <code>#</code>, e.g.,     <pre><code># Cell i: Visual Bin.\n</code></pre></li> <li>If the header is level 2 (e.g., 1.2, 2.3), it should be prepended <code>##</code>,     e.g.,     <pre><code>## Cell 1.2: Samples Over Time and Empirical PDF.\n</code></pre></li> </ul> </li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#content_of_a_markdown_cell_with_cell_xyz_header","title":"Content of a Markdown Cell with <code>Cell XYZ</code> Header","text":"<ul> <li>Each Markdown cell before of an interactive cell should have a description of     the parameters</li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#goal","title":"Goal","text":"<ul> <li>Describe the goal of the interactive cell     <pre><code>**Goal**:\n- Visualize the true target function and how we sample data from it\n- Understand that in real-world machine learning, we don't have access to the\n    complete target function: we only observe sampled points\n- Show the relationship between the true function, in-sample (training) data,\n    and out-of-sample (test) data\n</code></pre></li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#plots","title":"Plots","text":"<ul> <li>Describe the plots of the interactive cell     <pre><code>**Plots**:\n- Display four plots:\n    - _True Target Function_: The complete unknown function we want to learn\n        (shown with and without noise)\n    - _In-Sample Data (80%)_: Green points used for training the model\n    - _Out-of-Sample Data (20%)_: Red points used for testing the model\n    - _Comments_: Summary of parameters and observations\n</code></pre></li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#parameters","title":"Parameters","text":"<ul> <li>Describe the parameters of the interactive cell     <pre><code>**Parameters**:\n- `Function`: Select the true target function (Slow Sinusoid, Fast Sinusoid,\n    Parabola, Constant, or Linear)\n- `epsilon` ($\\epsilon$): Standard deviation of noise added to observations\n- `N (total samples)` ($N$): Number of data points to sample from the function\n</code></pre></li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#key_observations","title":"Key Observations","text":"<ul> <li>Describe the key points and observations of the interactive cell     <pre><code>**Key observations**:\n- The complete curve represents the unknown target function $f(x)$\n- In practice, we only have access to a few noisy samples from this function\n- We split data into training (green) and testing (red) sets\n- The goal is to learn from training data and generalize to test data\n</code></pre></li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#use_nested_bullets","title":"Use Nested Bullets","text":"<ul> <li>Each markdown cell must have text organized in nested bullet list<ul> <li>Bad     <pre><code>Examine what happens when we repeatedly sample N points many times. Each trial produces an empirical mean nu. This cell shows the distribution of nu over many trials and compares it with the expected distribution predicted by the Law of Large Numbers and Central Limit Theorem.\n</code></pre></li> <li>Good     <pre><code>- Examine what happens when we repeatedly sample N points many times\n- Each trial produces an empirical mean nu\n- This cell:\n    - Shows the distribution of nu over many trials\n    - Compares it with the expected distribution predicted by the Law of Large\n        Numbers and Central Limit Theorem.\n</code></pre></li> </ul> </li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#do_not_use_capitalized_text","title":"Do Not Use Capitalized Text","text":"<ul> <li>Do not use capitalized text, but prefer to use italic or bold text</li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#use_latex_notation","title":"Use Latex Notation","text":"<ul> <li>Markdown cell must use Latex notation for variables and formulas</li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#content_of_code_cells","title":"Content of Code Cells","text":"<ul> <li> <p>The interactive code in each cell must have a reference to the cell itself so     that they are in sync</p> </li> <li> <p>E.g., for a cell with the header     <pre><code>## Cell 1: Visual Bin: Population of Marbles.\n</code></pre>     the name of the function must be:     <pre><code>utils.cell1_draw_bin_with_marbles_interactive()\n</code></pre></p> </li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#keep_function_names_in_sync_with_the_cells","title":"Keep Function Names in Sync with the Cells","text":"<ul> <li> <p>The name of a Python function needs to be in sync with the header of the     corresponding cell</p> <ul> <li>Good     <pre><code># Cell 1: True Target Function and Data Sampling\n\nutils.cell1_plot_true_target_function()\n</code></pre> <pre><code>## Cell 2.2: Interactive Hoeffding Inequality Demonstration\n\nutils.cell4_hoeffding_inequality_demo()\n</code></pre></li> <li>Bad     <pre><code>## Cell 2.2: Interactive Hoeffding Inequality Demonstration\n\nutils.cell4_hoeffding_inequality_demo()\n</code></pre></li> </ul> </li> <li> <p>Assume that the header of the cells are correct and the function names need to     be renamed</p> </li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#widget_variable_names","title":"Widget Variable Names","text":"<ul> <li>In the widgets of an interactive cell use only the names of the variables     without description<ul> <li><code>mu</code>, <code>N</code>, <code>epsilon</code>, <code>seed</code></li> </ul> </li> <li><code>seed</code> should be the last one</li> </ul>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#reorganize_code_in_the_utilspy_python_file","title":"Reorganize Code in the <code>*_utils.py</code> Python File","text":"<ul> <li> <p>When the code implementing the cells is in a <code>*_utils.py</code> Python file, make     sure that:</p> </li> <li> <p>All the code must be in the right order according to the cells</p> </li> <li>E.g., the code for <code>cell1_draw_bin_with_marbles_interactive</code> comes before      the code for <code>cell2_...</code></li> <li>All the code for each chunk of cells is close to each other</li> <li>Bad      <pre><code>def cell1_calculate_entropy(\ndef cell4_plot_joint_entropy_interactive(\ndef cell5_plot_conditional_entropy_interactive(\ndef cell2_plot_distribution_with_stats(\ndef cell3_plot_binary_entropy_interactive(\ndef cell3_create_binary_entropy_widget() -&gt; None:\ndef cell6_plot_mutual_info_interactive(\ndef cell6_plot_mutual_information_venn_interactive(\ndef cell8_plot_cross_entropy_interactive(\ndef cell7_plot_kl_divergence_interactive(\ndef cell9_plot_data_processing_inequality_interactive(\ndef cell10_plot_mdl_interactive(\ndef cell11_plot_kolmogorov_complexity_interactive(\ndef cell4_create_joint_entropy_widget() -&gt; None:\ndef cell5_create_conditional_entropy_widget() -&gt; None:\ndef cell6_create_mutual_information_venn_widget() -&gt; None:\ndef cell6_create_mutual_info_correlation_widget() -&gt; None:\ndef cell7_create_kl_divergence_widget() -&gt; None:\ndef cell8_create_cross_entropy_widget() -&gt; None:\ndef cell9_create_data_processing_inequality_widget() -&gt; None:\ndef cell10_create_mdl_widget() -&gt; None:\ndef cell11_create_kolmogorov_complexity_widget() -&gt; None:\ndef cell3_generate_binary_entropy_animation() -&gt; None:\ndef cell4_generate_joint_entropy_animation() -&gt; None:\ndef cell5_generate_conditional_entropy_animation() -&gt; None:\ndef cell6_generate_mutual_info_venn_binary_animation() -&gt; None:\ndef cell6_generate_mutual_info_venn_weather_animation() -&gt; None:\ndef cell6_generate_mutual_info_correlation_animation() -&gt; None:\ndef cell7_generate_kl_divergence_animation() -&gt; None:\ndef cell8_generate_cross_entropy_animation() -&gt; None:\ndef cell9_generate_data_processing_inequality_animation() -&gt; None:\ndef cell10_generate_mdl_animation() -&gt; None:\ndef cell11_generate_kolmogorov_complexity_animation() -&gt; None:\n</code></pre></li> <li> <p>Good      <pre><code>def cell1_calculate_entropy(\ndef cell2_plot_distribution_with_stats(\ndef cell3_create_binary_entropy_widget() -&gt; None:\ndef cell3_generate_binary_entropy_animation() -&gt; None:\ndef cell3_plot_binary_entropy_interactive(\ndef cell4_create_joint_entropy_widget() -&gt; None:\ndef cell4_generate_joint_entropy_animation() -&gt; None:\ndef cell4_plot_joint_entropy_interactive(\ndef cell5_create_conditional_entropy_widget() -&gt; None:\ndef cell5_generate_conditional_entropy_animation() -&gt; None:\ndef cell5_plot_conditional_entropy_interactive(\ndef cell6_create_mutual_info_correlation_widget() -&gt; None:\ndef cell6_create_mutual_information_venn_widget() -&gt; None:\ndef cell6_generate_mutual_info_correlation_animation() -&gt; None:\ndef cell6_generate_mutual_info_venn_binary_animation() -&gt; None:\ndef cell6_generate_mutual_info_venn_weather_animation() -&gt; None:\ndef cell6_plot_mutual_info_interactive(\ndef cell6_plot_mutual_information_venn_interactive(\ndef cell7_create_kl_divergence_widget() -&gt; None:\ndef cell7_generate_kl_divergence_animation() -&gt; None:\ndef cell7_plot_kl_divergence_interactive(\ndef cell8_create_cross_entropy_widget() -&gt; None:\ndef cell8_generate_cross_entropy_animation() -&gt; None:\ndef cell8_plot_cross_entropy_interactive(\ndef cell9_create_data_processing_inequality_widget() -&gt; None:\ndef cell9_generate_data_processing_inequality_animation() -&gt; None:\ndef cell9_plot_data_processing_inequality_interactive(\ndef cell10_create_mdl_widget() -&gt; None:\ndef cell10_generate_mdl_animation() -&gt; None:\ndef cell10_plot_mdl_interactive(\ndef cell11_create_kolmogorov_complexity_widget() -&gt; None:\ndef cell11_generate_kolmogorov_complexity_animation() -&gt; None:\ndef cell11_plot_kolmogorov_complexity_interactive(\n</code></pre></p> </li> <li> <p>In the Python file, there are framed dividers between cells matching the    title of the cells</p> </li> <li> <p>Good</p> <p>```python</p> </li> </ul> <p>def cell1_calculate_entropy( ...</p>"},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#_1","title":"####################...","text":""},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#cell_1_visual_bin_population_of_marbles","title":"Cell 1: Visual Bin: Population of Marbles.","text":""},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#_2","title":"####################...","text":""},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#_3","title":"####################...","text":""},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#cell_2","title":"Cell 2: ...","text":""},{"location":"ai_prompts/notebooks.lint_numbered_cells.html#_4","title":"####################...","text":"<p>def cell2_plot_distribution_with_stats(      ```</p>"},{"location":"ai_prompts/notebooks.move_to_lib.html","title":"Notebooks.move to lib","text":"<p>You are an expert Python developer.</p> <p>I will pass you a Python file paired with Jupyter notebook with jupytext using a py:percent format (e.g., msml610/tutorials/Lesson94-Information_Theory.py)</p> <p>For all the code follow the rules from <code>docs/ai_prompts/coding.format_code.md</code></p>"},{"location":"ai_prompts/notebooks.move_to_lib.html#step_1","title":"Step 1)","text":"<ul> <li>Given the input, you will create a <code>*_utils.py</code> Python file called with a name     derived from the file:<ul> <li>E.g., <code>Lesson94-Information_Theory.ipynb</code> -&gt;     <code>Lesson94_Information_Theory_utils.py</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/notebooks.move_to_lib.html#step_2","title":"Step 2)","text":"<ul> <li>Then you will move all the functions from the notebook to the <code>*_utils.py</code>     file without changing the code</li> </ul>"},{"location":"ai_prompts/notebooks.move_to_lib.html#step_3","title":"Step 3)","text":"<ul> <li> <p>You will change the Python code to call the functions in the utils file</p> <p>```python import ... as utils</p> </li> </ul> <p>utils.function(...)     ```</p>"},{"location":"ai_prompts/notebooks.move_to_lib.html#add_code_to_a_library_utilities","title":"Add Code to a Library / Utilities","text":"<ul> <li>Find or create the library / utility file that correspond to the notebook<ul> <li>E.g., <code>Lesson94-Information_Theory.ipynb</code> -&gt;     <code>Lesson94-Information_Theory_utils.py</code></li> </ul> </li> <li>Implement the code and then:<ul> <li>Save the functions and the bulk of the code in the <code>*_utils.py</code> files</li> <li>Leave only the caller code in Jupyter notebook</li> </ul> </li> <li>Reuse code already existing in the <code>*_utils.py</code> file and in the <code>helpers</code>     directory</li> </ul>"},{"location":"ai_prompts/notebooks.move_to_lib.html#add_code_to_the_right_place_in_the_library","title":"Add Code to the Right Place in the Library","text":"<ul> <li>The library / utility file should have a structure that follows the flow of     the notebook</li> <li>Add the functions in the part of the utility file that corresponds to the     Jupyter notebook</li> <li>There should be some separators to organize the code in the library to follow     the structure of the notebook<ul> <li>E.g.,     <pre><code># ############################...\n# Code for ...\n# ############################...\n</code></pre></li> </ul> </li> </ul>"},{"location":"ai_prompts/notebooks.move_to_lib.html#step_4","title":"Step 4)","text":"<ul> <li>After you have modified the Python file you will run a command to pair the     notebook and the Python file     <pre><code>&gt; uvx jupytext --sync &lt;python file&gt;\n</code></pre></li> </ul>"},{"location":"ai_prompts/notebooks.plots.html","title":"Notebooks.plots","text":""},{"location":"ai_prompts/notebooks.plots.html#use_pandas_and_seaborn","title":"Use Pandas and Seaborn","text":"<ul> <li>When writing new code:<ul> <li>Use <code>pandas</code> library instead of <code>numpy</code></li> <li>Prefer to use <code>Seaborn</code> package instead of <code>matplotlib</code></li> </ul> </li> <li>The goal is to make the code shorter and more readable</li> </ul>"},{"location":"ai_prompts/notebooks.plots.html#add_all_information_on_plot","title":"Add All Information on Plot","text":"<ul> <li>When creating a plot<ul> <li>Do not use the statement <code>print</code> after the plot</li> <li>Add results and information directly to the plot using <code>ax.text</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/notebooks.plots.html#theoretical_vs_empirical_data","title":"Theoretical vs Empirical Data","text":"<ul> <li>When plotting data with theoretical (e.g., the mean of the underlying     distribution) vs empirical (e.g., the sample mean of the data):<ul> <li>The theoretical data should have lighter and transparent colors and dotted     lines</li> <li>Empirical data should have darker colors and be solid lines</li> </ul> </li> </ul>"},{"location":"ai_prompts/notebooks.split_cells.html","title":"Notebooks.split cells","text":""},{"location":"ai_prompts/notebooks.split_cells.html#format_of_each_jupyter_cell","title":"Format of Each Jupyter Cell","text":"<ul> <li>Each cell has only one concept / group of statements and a comment on the     result</li> <li> <p>Each cell has:</p> <ul> <li>A comment explaining what we want to do</li> <li>A group of commands</li> <li>A statement to show the result (e.g., <code>print()</code>, <code>display()</code>)</li> <li>A comment about the outcome <pre><code># Comment explaining what we are trying to do.\noperation\n\nprint results\n# Comment on the result.\n</code></pre></li> </ul> </li> <li> <p>Example:     ```python</p> </li> </ul>"},{"location":"ai_prompts/notebooks.split_cells.html#test_with_broken_coin","title":"Test with broken coin.","text":"<p>biased_coin = [1.0, 0.0] print(f\"Biased coin (100-0) entropy: {utils.calculate_entropy(biased_coin):.4f} bits\")</p>"},{"location":"ai_prompts/notebooks.split_cells.html#if_heads_occurs_100_of_the_time_no_uncertainty_h_0_bit","title":"If heads occurs 100% of the time \u2192 no uncertainty, \\(H = 0\\) bit.","text":"<pre><code>```\n</code></pre>"},{"location":"ai_prompts/notebooks.split_cells.html#each_jupyter_cell_should_have_only_one_example","title":"Each Jupyter Cell Should Have Only One Example","text":"<ul> <li> <p>Cells that contain more than one concept / example should be split so that     each cell has only one example</p> </li> <li> <p>Example1</p> <ul> <li> <p>Bad: this cell has 3 examples and should be split in 3 cells, as below</p> <p>```python</p> </li> </ul> </li> </ul>"},{"location":"ai_prompts/notebooks.split_cells.html#test_with_fair_coin","title":"Test with fair coin.","text":"<p>fair_coin = [0.5, 0.5] print(f\"Fair coin entropy: {utils.calculate_entropy(fair_coin):.4f} bits\")</p>"},{"location":"ai_prompts/notebooks.split_cells.html#test_with_biased_coin","title":"Test with biased coin.","text":"<p>biased_coin = [0.9, 0.1] print(f\"Biased coin (90-10) entropy: {utils.calculate_entropy(biased_coin):.4f} bits\")</p>"},{"location":"ai_prompts/notebooks.split_cells.html#test_with_certain_outcome","title":"Test with certain outcome.","text":"<p>certain = [1.0, 0.0] print(f\"Certain outcome entropy: {utils.calculate_entropy(certain):.4f} bits\")         ```     - Good: each cell has one example</p> <pre><code>    ```python\n</code></pre>"},{"location":"ai_prompts/notebooks.split_cells.html#test_with_fair_coin_1","title":"Test with fair coin.","text":""},{"location":"ai_prompts/notebooks.split_cells.html#two_equally_likely_outcomes_maximum_uncertainty_h_1_bit","title":"Two equally likely outcomes \u2192 maximum uncertainty, \\(H = 1\\) bit","text":"<p>fair_coin = [0.5, 0.5] print(f\"Fair coin entropy: {utils.calculate_entropy(fair_coin):.4f} bits\")                  # Test with biased coin.         # If heads occurs 90% of the time \u2192 less uncertainty, \\(H &lt; 1\\) bit         biased_coin = [0.9, 0.1]         print(f\"Biased coin (90-10) entropy: {utils.calculate_entropy(biased_coin):.4f} bits\")                  # Test with certain outcome.         # Certain results have no entropy, \\(H = 0\\) bit.         certain = [1.0, 0.0]         print(f\"Certain outcome entropy: {utils.calculate_entropy(certain):.4f} bits\")         ```</p> <ul> <li>Example2<ul> <li>Bad <pre><code># Use the weather-activity example.\nprint(\"Example: Weather and Activity Correlation\")\nprint(\"=\" * 50)\nutils.visualize_information_decomposition(joint_prob)\n\n# Calculate and display mutual information.\nmi = utils.calculate_mutual_information(joint_prob)\nprint(f\"\\nMutual Information I(Weather; Activity) = {mi:.4f} bits\")\nprint(f\"This means knowing the weather reduces uncertainty about activity by {mi:.4f} bits\")\n</code></pre></li> <li>Good: two different cells     <pre><code># Use the weather-activity example.\nprint(\"Example: Weather and Activity Correlation\")\nprint(\"=\" * 50)\nutils.visualize_information_decomposition(joint_prob)\n</code></pre> <pre><code># Calculate and display mutual information.\nmi = utils.calculate_mutual_information(joint_prob)\nprint(f\"\\nMutual Information I(Weather; Activity) = {mi:.4f} bits\")\nprint(f\"This means knowing the weather reduces uncertainty about activity by {mi:.4f} bits\")\n</code></pre></li> </ul> </li> </ul>"},{"location":"ai_prompts/notebooks.utils_library.html","title":"Notebooks.utils library","text":""},{"location":"ai_prompts/notebooks.utils_library.html#add_code_to_a_library_utilities","title":"Add Code to a Library / Utilities","text":"<ul> <li>Find or create the library / utility file that correspond to the notebook<ul> <li>E.g., <code>Lesson94-Information_Theory.ipynb</code> -&gt;     Lesson94-Information_Theory_utils.py`</li> </ul> </li> <li>Implement the code and then:<ul> <li>Save the functions and the bulk of the code in the <code>*_utils.py</code> files</li> <li>Leave only the caller code in Jupyter notebook</li> </ul> </li> <li>Reuse code already existing in the <code>*_utils.py</code> file and in the <code>helpers</code>     directory</li> </ul>"},{"location":"ai_prompts/notebooks.utils_library.html#add_code_to_the_right_place_in_the_library","title":"Add Code to the Right Place in the Library","text":"<ul> <li>The library / utility file should have a structure that follows the flow of     the notebook</li> <li>Add the functions in the part of the utility file that corresponds to the     Jupyter notebook</li> <li>There should be some separators to organize the code in the library to follow     the structure of the notebook<ul> <li>E.g.,     <pre><code># ############################...\n# Code for ...\n# ############################...\n</code></pre></li> </ul> </li> </ul>"},{"location":"ai_prompts/paper.fix_figures.html","title":"Paper.fix figures","text":""},{"location":"ai_prompts/paper.fix_figures.html#check_references","title":"Check References","text":"<ul> <li>Make sure every picture and table has a label and caption and it's referenced     in the text</li> <li>Captions should only contain a reference to what is done and comments and more     content should be in the text</li> </ul>"},{"location":"ai_prompts/paper.fix_figures.html#add_captions_and_labels","title":"Add Captions and Labels","text":"<ul> <li> <p>For all the figures in the latex files in the passed directory convert the     figure adding the caption and label to the commented section.</p> </li> <li> <p>For instance convert</p> <pre><code>%     ```\n% rendered_images:end\n% render_images:begin\n\\begin{figure}[!ht]\n    \\centering\n    \\includegraphics[width=\\linewidth]{figs/02_architecture.1.png}\n    \\caption{Confounding adjustment in causal inference}\n    \\label{fig:confounding_adjustment}\n\\end{figure}\n% render_images:end\n</code></pre> <p>to</p> <pre><code>%     ```\n% caption=Confounding adjustment in causal inference\n% label=fig:confounding_adjustment\n% rendered_images:end\n% render_images:begin\n\\begin{figure}[!ht]\n    \\centering\n    \\includegraphics[width=\\linewidth]{figs/02_architecture.1.png}\n    \\caption{Confounding adjustment in causal inference}\n    \\label{fig:confounding_adjustment}\n\\end{figure}\n% render_images:end\n</code></pre> </li> </ul>"},{"location":"ai_prompts/paper.improve_bibliography.html","title":"Paper.improve bibliography","text":"<ul> <li> <p>You are a college professor in computer science and artificial intelligence     and you are writing an academic paper</p> </li> <li> <p>Read the given Latex paper</p> <ul> <li>Add more relevant bibliography to the paper or to the references.bib if used</li> <li>Add references to the new articles to the text of the paper</li> <li>Make sure the bibliography is relevant</li> </ul> </li> </ul>"},{"location":"ai_prompts/paper.suggest_improvements.html","title":"Paper.suggest improvements","text":"<ul> <li> <p>Read the instructions in <code>./helpers_root/docs/ai_coding/ai.paper.prompt.md</code></p> </li> <li> <p>Come up with the top 5 suggestions on how to improve the paper and make it     more impactful</p> </li> <li>Write down the suggestions as bullet points</li> </ul>"},{"location":"ai_prompts/paper.use_style.html","title":"Paper.use style","text":"<p>You are a college professor in computer science and artificial intelligence and you are writing an academic paper</p>"},{"location":"ai_prompts/paper.use_style.html#reading_papers","title":"Reading Papers","text":"<ul> <li>When asked to read a paper (e.g., a Latex paper) makes sure to read all the     files included in the Latex file</li> </ul>"},{"location":"ai_prompts/paper.use_style.html#writing_style","title":"Writing Style","text":"<p>When writing a paper follow the following suggestions</p>"},{"location":"ai_prompts/paper.use_style.html#1_formal_and_objective","title":"1. Formal and Objective","text":"<ul> <li>Use precise, scholarly language.</li> <li>Avoid conversational tone, idioms, or subjective phrasing.</li> <li>Prefer third-person perspective and appropriate passive voice.</li> </ul> <p>Example:</p> <ul> <li>Incorrect: \"I think this algorithm is pretty efficient.\"</li> <li>Correct: \"The proposed algorithm demonstrates improved efficiency.\"</li> </ul>"},{"location":"ai_prompts/paper.use_style.html#2_clear_and_concise","title":"2. Clear and Concise","text":"<ul> <li>Prioritize clarity over stylistic complexity.</li> <li>Keep sentences logically structured and direct.</li> <li>Avoid unnecessary adjectives or filler words.</li> </ul>"},{"location":"ai_prompts/paper.use_style.html#3_evidence-driven","title":"3. Evidence-Driven","text":"<ul> <li>Support all claims with data, experiments, or citations.</li> <li> <p>Clearly describe the basis for assertions.</p> </li> <li> <p>Good</p> <ul> <li>\"Empirical results show a 12% reduction in latency compared to the     baseline.\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/paper.use_style.html#4_precise_and_technical","title":"4. Precise and Technical","text":"<ul> <li>Use accurate technical terminology.</li> <li> <p>Define acronyms, symbols, or domain-specific notation on first use.</p> </li> <li> <p>Good</p> <ul> <li>\"We use a transformer-based architecture with multi-head attention (MHA).\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/paper.use_style.html#5_neutral_and_non-personal","title":"5. Neutral and Non-Personal","text":"<ul> <li>Avoid emotional or persuasive wording.</li> <li> <p>Let data and analysis express significance.</p> </li> <li> <p>Example:</p> <ul> <li>Correct: \"The method reduces computational complexity.\"</li> <li>Incorrect: \"The method impressively reduces computational complexity.\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/paper.use_style.html#6_structured_and_logical","title":"6. Structured and Logical","text":"<p>A strong CS academic tone reflects the conventional structure:</p> <ul> <li>Abstract: concise and factual</li> <li>Introduction: motivation, contributions, background</li> <li>Related Work: impartial comparisons</li> <li>Method: technical description, reproducibility</li> <li>Experiments: quantitative evaluation, transparency</li> <li>Conclusion: modest, acknowledges limitations</li> </ul>"},{"location":"ai_prompts/paper.use_style.html#7_modest_and_cautious","title":"7. Modest and Cautious","text":"<ul> <li>Avoid absolute claims such as \"solves,\" \"proves,\" or \"always.\"</li> <li>Use appropriately hedged language like \"suggests,\" \"indicates,\" or \"in most     cases.\"</li> </ul>"},{"location":"ai_prompts/paper.use_style.html#check_references","title":"Check References","text":"<ul> <li>Make sure every picture and table has a label and caption and it's referenced     in the text</li> <li>Captions should only contain a reference to what is done and comments and more     content should be in the text</li> </ul>"},{"location":"ai_prompts/paper.use_style.html#instructions","title":"Instructions","text":"<ul> <li>When asked to perform a task<ul> <li>Create a todo list when working on complex tasks</li> <li>Make sure the task is clear. If not, ask for clarifications</li> <li>Track progress and remain on track</li> <li>Ask for confirmation before executing the plan</li> </ul> </li> </ul>"},{"location":"ai_prompts/readme.create.html","title":"Readme.create","text":"<ul> <li> <p>You are an expert technical writer specializing in software documentation.</p> </li> <li> <p>I will give you the path of a directory  and you will write a <code>README.md</code>     in the target directory that has the following sections"},{"location":"ai_prompts/readme.create.html#structure_of_the_dir","title":"Structure of the Dir","text":"<ul> <li>Find all the dirs under  <li>For each directory write a short comment on its content<ul> <li>Report the output in markdown, with a bullet per directory, reflecting the     structure of the files in the markdown and a comment of fewer than 20 words     for each directory, in the format     <pre><code>- `ai.claude_code.how_to_guide_figs/`\n    - Screenshots and images for Claude Code setup and usage guide\n- `ai.github_copilot_review.how_to_guide_figs/`\n    - Screenshots demonstrating GitHub Copilot review workflow\n</code></pre></li> </ul> </li>"},{"location":"ai_prompts/readme.create.html#description_of_files","title":"Description of Files","text":"<ul> <li>For each file Python and markdown file write a one line description of what it     contains in fewer than 20 words, in the format     <pre><code>- `ai.coding.prompt.md`\n    - Python coding standards including assertions, logging patterns, and script\n        templates\n- `ai.unit_test.prompt.md`\n    - Unit testing conventions including test structure, naming patterns, and\n        golden file testing\n</code></pre></li> </ul>"},{"location":"ai_prompts/readme.create.html#description_of_executables","title":"Description of Executables","text":"<ul> <li>Find a list of executable files in that directory</li> <li> <p>For each executable create a short description of what it does</p> <ul> <li>Its <code>--help</code> text</li> <li>Its docstring</li> </ul> </li> <li> <p>Create a \"Description of executables\" section with one subsection per tool,     using this exact structure:</p> <pre><code>## `&lt;tool&gt;`\n\n- **What It Does**:\n    - 1\u20133 bullet points describing the tool's purpose in clear, plain language.\n    - Mention important inputs, outputs, and side effects.\n\n- Provide 2\u20134 realistic example commands\n- For each example:\n    - Start with a short description\n    - Follow with a fenced bash code block:\n        ```bash\n        &gt; actual command here\n        ```\n</code></pre> </li> <li> <p>For instance</p> <pre><code>- Generate 5 HD quality images from a prompt:\n    ```bash\n    &gt; ./generate_class_images.py \"A sunset over mountains\" --dst_dir ./images\n    ```\n</code></pre> </li> <li> <p>Examples of this file are:</p> <ul> <li><code>dev_scripts_helpers/documentation/README.md</code></li> <li><code>dev_scripts_helpers/llms/README.md</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/readme.fix_what_it_does.html","title":"Readme.fix what it does","text":"<p>1) Convert </p> <pre><code>#### What It Does\n\n- Launches Jupyter Lab server with no authentication (token and password disabled)\n- Binds to all network interfaces (0.0.0.0) on port 8888\n- Allows root access for container environments\n</code></pre> <pre><code>into\n</code></pre> <pre><code>- **What It Does**\n    - Launches Jupyter Lab server with no authentication (token and password disabled)\n    - Binds to all network interfaces (0.0.0.0) on port 8888\n    - Allows root access for container environments\n</code></pre> <p>2) Remove the <code>#### Examples</code></p> <p>E.g.,</p> <pre><code>#### Examples\n\n- Start Jupyter Lab server (typically called from docker_jupyter.sh):\n    ```bash\n    &gt; ./run_jupyter.sh\n    ```\n</code></pre> <pre><code>to\n</code></pre> <pre><code>- Start Jupyter Lab server (typically called from docker_jupyter.sh):\n    ```bash\n    &gt; ./run_jupyter.sh\n    ```\n</code></pre>"},{"location":"ai_prompts/readme.format.html","title":"Readme.format","text":"<ul> <li>Commands in a readme must follow the format below<ul> <li> <p>Description</p> <p><pre><code>&gt; command\n</code></pre>     - Good</p> <p><pre><code>- With system prompt from file:\n```bash\n&gt; llm_cli.py -i input.txt -o output.txt \\\n        --system_prompt_file system_prompt.txt\n```\n</code></pre>     - Bad <pre><code>**With system prompt from file:**\n```bash\n&gt; llm_cli.py -i input.txt -o output.txt \\\n        --system_prompt_file system_prompt.txt\n```\n</code></pre></p> </li> </ul> </li> </ul>"},{"location":"ai_prompts/slides.fix_slides.html","title":"Slides.fix slides","text":"<ul> <li> <p>Given the slides in Markdown</p> <ul> <li>Each slide titles are prepended with <code>*</code></li> </ul> </li> <li> <p>You will:</p> <ul> <li>Maintain the structure of the text and keep the content of the existing text</li> <li>Add bullet points to the text that are important or missing</li> <li>Add examples to clarify the text and help intuition</li> <li>Fix the English grammar</li> <li>Fix any mistake only if you are sure about the correction</li> </ul> </li> </ul> <p>Print only the markdown without any explanation.</p>"},{"location":"ai_prompts/slides.format_rules.html","title":"Slides.format rules","text":"<p>You are an expert writer of slides and presentation.</p>"},{"location":"ai_prompts/slides.format_rules.html#audience","title":"Audience","text":"<ul> <li>Your target is CEO and executives<ul> <li>You need to be clear and persuasive</li> <li>Avoid technical terms unless it's clearly needed and defined</li> </ul> </li> </ul>"},{"location":"ai_prompts/slides.format_rules.html#formatting","title":"Formatting","text":"<ul> <li>Don't use emoji</li> <li>Don't use page separators</li> <li>Make examples for concept whenever possible</li> </ul>"},{"location":"ai_prompts/slides.format_rules.html#when_i_ask_you_to_create_a_slide","title":"When I Ask You to Create a Slide","text":"<ul> <li>Each slide should start with &lt;#### Slide title&gt;</li> <li>Each slide contains at most 8 bullet point arranged in a hierarchical     structure</li> <li>Every line starts with a bullet point</li> <li>Do not use period at the end of a phrase</li> </ul>"},{"location":"ai_prompts/slides.format_rules.html#suggest_images_when_possible","title":"Suggest Images When Possible","text":"<ul> <li>When an image might help with clarity, add a     <pre><code>&lt;image&gt;\nDescription of the image\n&lt;/image&gt;\n</code></pre></li> </ul>"},{"location":"ai_prompts/slides.format_rules.html#output_is_markdown","title":"Output Is Markdown","text":"<ul> <li>Write the output in a markdown format in the form of code</li> </ul>"},{"location":"ai_prompts/slides.suggest_improvements.html","title":"Slides.suggest improvements","text":"<ul> <li> <p>Given the slides in Markdown, where each slide title is prepended with <code>*</code></p> </li> <li> <p>You will:</p> <ul> <li>Suggest which slide can be removed in terms of slide title</li> <li>Suggest which slides should be merged in terms of slide title</li> </ul> </li> </ul>"},{"location":"ai_prompts/slides.write_slides.html","title":"Slides.write slides","text":"<p>You are a college professor in CS.</p> <p>You are tasked with creating lecture slides for MSML610: Advanced Machine Learning.</p> <ul> <li>Follow this format exactly</li> </ul>"},{"location":"ai_prompts/slides.write_slides.html#pedagogical_style","title":"Pedagogical Style","text":"<ul> <li>When writing slides, maintain academic rigor while ensuring clarity for     graduate-level ML students</li> <li> <p>Balance mathematical formalism with intuitive explanations and concrete     examples</p> </li> <li> <p>Progressive Complexity: Start simple, build to complex</p> </li> <li>Multiple Representations: Text, math, diagrams, tables, examples</li> <li>Concrete Examples: Burglar alarm, wet grass, car insurance, medical diagnosis</li> <li>Clear Terminology: Bold new terms on first use</li> <li>Intuition Before Formalism: Explain concept, then formalize</li> <li>Connections: Reference earlier concepts when building on them</li> </ul>"},{"location":"ai_prompts/slides.write_slides.html#sections","title":"Sections","text":"<ul> <li> <p>Major Sections are delimited with:     <pre><code># ##############################################################################\n# Section Title\n# ##############################################################################\n</code></pre></p> </li> <li> <p>Subsections: Use <code>##</code> for subsections or just section names without <code>#</code></p> </li> </ul>"},{"location":"ai_prompts/slides.write_slides.html#formatting_style","title":"Formatting style","text":"<ul> <li>Write slides in markdown</li> <li>Do not use page separators</li> <li>Special definitions: <code>\\defeq</code> for \"defined as\"</li> <li>Group font size changes: <code>\\begingroup \\large ... \\endgroup</code></li> <li>Reference figures from <code>msml610/lectures_source/figures/</code></li> <li>Use <code>\\iff</code> for \"if and only if\"</li> <li>Use <code>\\perp</code> for independence symbol</li> <li>Do not use non ASCII characters but use Latex when neede<ul> <li>E.g., instead of \u03b5 use \\(\\epsilon\\)</li> </ul> </li> <li>Instead of \u2192 use \\(\\to\\)</li> <li>Use \\(\\EE[...]\\) and \\(\\VV[...]\\)</li> </ul>"},{"location":"ai_prompts/slides.write_slides.html#slide_formats","title":"Slide formats","text":"<ul> <li>Use <code>*</code> for slide title/bullets:     <pre><code>* Slide Title\n\n- Main point\n    - Sub-point with 2-space indentation\n        - Further nesting with 4-space indentation\n</code></pre></li> </ul>"},{"location":"ai_prompts/slides.write_slides.html#graphviz_diagrams","title":"GraphViz Diagrams","text":"<ul> <li>Whenever possible use Graphviz images     <pre><code>```graphviz\ndigraph DiagramName {\n        splines=true;\n        nodesep=1.0;\n        ranksep=0.75;\n\n        node [shape=box, style=\"rounded,filled\", fontname=\"Helvetica\", fontsize=12, penwidth=1.4];\n\n        NodeName [label=\"Display Name\", fillcolor=\"#A6C8F4\"];\n\n        { rank=same; Node1; Node2; }\n\n        Node1 -&gt; Node2;\n}\n```\n</code></pre></li> </ul>"},{"location":"ai_prompts/slides.write_slides.html#tables","title":"Tables","text":"<pre><code>\\begingroup \\scriptsize\n| **Column1** | **Column2** |\n| ----------- | ----------- |\n| Value       | Value       |\n\\endgroup\n</code></pre>"},{"location":"ai_prompts/slides.write_slides.html#columns_side-by-side_content","title":"Columns (Side-by-Side Content)","text":"<pre><code>::: columns\n:::: {.column width=60%}\nContent on left\n::::\n:::: {.column width=35%}\nContent on right\n::::\n:::\n</code></pre>"},{"location":"ai_prompts/slides.write_slides.html#mathematical_notation","title":"Mathematical Notation","text":"<ul> <li>Inline math: <code>$\\Pr(X | Y)$</code></li> <li>Display math: <code>$$\\Pr(X | Y) = \\frac{\\Pr(Y | X) \\Pr(X)}{\\Pr(Y)}$$</code></li> <li>Multi-line equations:     <pre><code>\\begin{align*}\n&amp; \\Pr(x_1, x_2) \\\\\n&amp; = \\Pr(x_1) \\Pr(x_2 | x_1)\n\\end{align*}\n</code></pre></li> </ul>"},{"location":"ai_prompts/slides.write_slides.html#content_patterns","title":"Content Patterns","text":"<ol> <li>Introduce Problem/Motivation: Start with why the topic matters</li> <li>Formal Definitions: Use clear, mathematical definitions</li> <li>Examples: Label clearly as \"Example\" with real-world scenarios</li> <li>Visualizations: Include GraphViz diagrams for relationships/networks</li> <li>Comparisons: Use \"vs\" or side-by-side columns</li> <li>Algorithms: Number steps clearly</li> <li>Pros/Cons: Use bullet lists with <code>**Pros**</code> and <code>**Cons**</code> headers</li> </ol>"},{"location":"ai_prompts/slides.write_slides.html#definition_slide","title":"Definition Slide","text":"<pre><code>#### Term: Definition\n\n- **Term** is [definition]\n    - Property 1\n    - Property 2\n\n- Mathematically:\n    $$[formula]$$\n</code></pre>"},{"location":"ai_prompts/slides.write_slides.html#example_slide","title":"Example Slide","text":"<pre><code>#### Topic: Example\n\n- **Example**: [scenario description]\n    - Given: [conditions]\n    - Question: [what to find]\n    - Solution: [step-by-step]\n</code></pre>"},{"location":"ai_prompts/slides.write_slides.html#comparison_slide","title":"Comparison Slide","text":"<pre><code>::: columns\n:::: {.column width=50%}\n**Approach A**\n- Characteristic 1\n- Pros/Cons\n::::\n:::: {.column width=50%}\n**Approach B**\n- Characteristic 1\n- Pros/Cons\n::::\n:::\n</code></pre>"},{"location":"ai_prompts/testing.fix_unit_tests.html","title":"Testing.fix unit tests","text":"<ul> <li>When I pass you a test file apply the following transformations to the code,     making sure that there is no change in behavior.</li> </ul>"},{"location":"ai_prompts/testing.fix_unit_tests.html#align_strings_to_the_code","title":"Align Strings to the Code","text":"<ul> <li> <p>Instead of this</p> <p><code>python def hello()     ...     content = \"\"\"&lt;start:file1.txt&gt; Content for file1 &lt;start:file2.txt&gt; Content for file2 \"\"\"</code></p> <p>align the content of the string to the rest of the code</p> <p><code>python def hello() ... content = \"\"\" &lt;start:file1.txt&gt; Content for file1 &lt;start:file2.txt&gt; Content for file2 \"\"\" content = hprint.dedent(content)</code></p> </li> </ul>"},{"location":"ai_prompts/testing.fix_unit_tests.html#rename_the_test_methods_as_test1_test2","title":"Rename the Test Methods as <code>test1</code>, <code>test2</code>, ...","text":""},{"location":"ai_prompts/testing.fix_unit_tests.html#factor_out_common_coded","title":"Factor Out Common Coded","text":"<ul> <li> <p>Aggressively factor out common code in helper code so that each test method     sets the inputs and the expected value and then calls the helper function with     the common code</p> </li> <li> <p>Instead of:</p> <p>```python def test_first_line(self) -&gt; None:     \"\"\"     Test position in first line returns line 1.     \"\"\"     # Prepare inputs.     content = \"Line 1\\nLine 2\\nLine 3\"     position = 3     # Run test.     actual = dshctsifi._get_line_number(content, position)     # Check outputs.     expected = 1     self.assertEqual(actual, expected)</p> </li> </ul> <p>def test_second_line(self) -&gt; None:         \"\"\"         Test position in second line returns line 2.         \"\"\"         # Prepare inputs.         content = \"Line 1\\nLine 2\\nLine 3\"         position = 10         # Run test.         actual = dshctsifi._get_line_number(content, position)         # Check outputs.         expected = 2         self.assertEqual(actual, expected)     ```</p> <ul> <li> <p>Do</p> <p>```python def helper(self, content: str, position: int, expected: int) -&gt; None:     # Run test.     actual = dshctsifi._get_line_number(content, position)     # Check outputs.     self.assertEqual(actual, expected)</p> </li> </ul> <p>def test1(self) -&gt; None:         \"\"\"         Test position in first line returns line 1.         \"\"\"         # Prepare inputs.         content = \"Line 1\\nLine 2\\nLine 3\"         position = 3         expected = 1         # Run test.         self.helper(content, position, expected)</p> <p>def test2(self) -&gt; None:         \"\"\"         Test position in second line returns line 2.         \"\"\"         # Prepare inputs.         content = \"Line 1\\nLine 2\\nLine 3\"         position = 10         expected = 2         # Run test.         self.helper(content, position, expected)     ```</p>"},{"location":"ai_prompts/testing.fix_unit_tests.html#important","title":"Important","text":"<ul> <li>For all the code you must follow the instructions in     <code>docs/ai_prompts/coding.format_rules.md</code></li> </ul>"},{"location":"ai_prompts/testing.format_rules.html","title":"Testing.format rules","text":"<p>You are an expert Python developer.</p> <p>I will pass you a Python file that needs unit tests or ask you to update existing tests in the helpers repository.</p>"},{"location":"ai_prompts/testing.format_rules.html#test_coverage","title":"Test Coverage","text":""},{"location":"ai_prompts/testing.format_rules.html#what_to_test","title":"What to Test","text":"<ul> <li>For each function, generate tests for:<ul> <li>Happy path (normal, expected input)</li> <li>Edge cases (boundary conditions)<ul> <li>E.g., empty input, zero, single item, large input</li> </ul> </li> <li>Do not test heavily error conditions (e.g., invalid input)</li> </ul> </li> </ul>"},{"location":"ai_prompts/testing.format_rules.html#file_and_test_structure","title":"File and Test Structure","text":""},{"location":"ai_prompts/testing.format_rules.html#file_structure","title":"File Structure","text":"<ul> <li>For a source file <code>helpers/module_name.py</code>, create a test file at     <code>helpers/test/test_module_name.py</code></li> </ul>"},{"location":"ai_prompts/testing.format_rules.html#unit_test_code_structure","title":"Unit Test Code Structure","text":"<ul> <li> <p>Always derive testing classes from <code>hunitest.TestCase</code></p> </li> <li> <p>Use this exact structure:</p> <p>```python import logging</p> </li> </ul> <p>import helpers.hunit_test as hunitest</p>"},{"location":"ai_prompts/testing.format_rules.html#add_other_imports_as_needed","title":"Add other imports as needed","text":"<p>_LOG = logging.getLogger(name)</p> <p>class TestClassName1(hunitest.TestCase):         \"\"\"         Brief description of what this test class tests.         \"\"\"</p> <pre><code>    # Test methods here\n</code></pre> <p>class TestClassName2(hunitest.TestCase):         \"\"\"         Brief description of what this test class tests.         \"\"\"</p> <pre><code>    # Test methods here\n```\n</code></pre>"},{"location":"ai_prompts/testing.format_rules.html#naming_conventions","title":"Naming Conventions","text":""},{"location":"ai_prompts/testing.format_rules.html#naming_conventions_for_a_function","title":"Naming Conventions for a Function","text":"<ul> <li>Testing a function -&gt; Use <code>Test_&lt;FunctionName&gt;</code> (with underscore)<ul> <li>Examples</li> <li>For function <code>parse_limit_range()</code> -&gt;     <code>class Test_parse_limit_range(hunitest.TestCase):</code></li> <li>For function <code>apply_limit_range()</code> -&gt;     <code>class Test_apply_limit_range(hunitest.TestCase):</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/testing.format_rules.html#naming_conventions_for_a_class","title":"Naming Conventions for a Class","text":"<ul> <li>Testing a class -&gt; Use <code>Test&lt;ClassName&gt;</code> (no underscore)<ul> <li>Examples</li> <li>For class <code>Config</code> -&gt; <code>class TestConfig(hunitest.TestCase):</code></li> <li>For class <code>ConfigBuilder</code> -&gt; <code>class TestConfigBuilder(hunitest.TestCase):</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/testing.format_rules.html#test_method_names","title":"Test Method Names","text":"<ul> <li>For test method names always number the method tests, as <code>test1</code>, <code>test2</code><ul> <li>Good<ul> <li><code>test1</code></li> <li><code>test2</code></li> </ul> </li> <li>Bad<ul> <li><code>test_preserve_yaml_frontmatter</code></li> <li><code>test_page_separator_removal_with_frontmatter</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"ai_prompts/testing.format_rules.html#test_method_conventions","title":"Test Method Conventions","text":""},{"location":"ai_prompts/testing.format_rules.html#use_three_sections_in_testing_methods","title":"Use Three Sections in Testing Methods","text":"<ul> <li> <p>Every test method must have three sections with standard comments:</p> <p><code>python def test_something(self) -&gt; None:     \"\"\"     Brief description of what this tests.     \"\"\"     # Prepare inputs.     &lt;setup test data&gt;     # Run test.     &lt;call function under test&gt;     # Check outputs.     &lt;verify results&gt;</code></p> </li> <li> <p>For section 1 use:</p> <ul> <li><code># Prepare inputs.</code> (when setting up input data)</li> <li><code># Prepare outputs.</code> (when setting up expected values)</li> </ul> </li> <li> <p>For section 2 use:</p> <ul> <li><code># Run test.</code></li> </ul> </li> <li> <p>For section 3 use:</p> <ul> <li><code># Check output.</code></li> <li><code># Check outputs.</code></li> </ul> </li> </ul>"},{"location":"ai_prompts/testing.format_rules.html#use_helper_methods_when_you_have_repetitive_tests","title":"Use Helper Methods When You Have Repetitive Tests","text":"<ul> <li> <p>If you write 2 or more test methods that call the same function with only     different input values and expected outputs, create a helper method</p> </li> <li> <p>Example:</p> <p>```python class TestFunctionName(hunitest.TestCase):     \"\"\"     Test description.     \"\"\"</p> <pre><code>def helper(self, param1: Type1, expected: Type2) -&gt; None:\n        \"\"\"\n        Test helper for function_name.\n\n        :param param1: Description of param1\n        :param expected: Expected output\n        \"\"\"\n        # Run test.\n        actual = function_under_test(param1)\n        # Check outputs.\n        self.assert_equal(str(actual), str(expected))\n\ndef test1(self) -&gt; None:\n        \"\"\"\n        Test description.\n        \"\"\"\n        # Prepare inputs.\n        input1 = &lt;value&gt;\n        # Prepare outputs.\n        expected = &lt;value&gt;\n        # Run test.\n        self.helper(input1, expected)\n\ndef test2(self) -&gt; None:\n        \"\"\"\n        Test description.\n        \"\"\"\n        # Prepare inputs.\n        input1 = &lt;different_value&gt;\n        # Prepare outputs.\n        expected = &lt;different_value&gt;\n        # Run test.\n        self.helper(input1, expected)\n</code></pre> <p>```</p> </li> </ul>"},{"location":"ai_prompts/testing.format_rules.html#assertion_patterns","title":"Assertion Patterns","text":"<ul> <li> <p>Compare simple values:</p> <p>```python</p> </li> <li> <p>Compare data structures as strings:</p> <p>```python</p> </li> <li> <p>Compare with fuzzy matching (whitespace differences):</p> <p>```python</p> </li> <li> <p>Compare with text purification (memory addresses):</p> <p>```python</p> </li> <li> <p>Compare with auto-dedent:     ```python</p> </li> </ul>"},{"location":"ai_prompts/testing.format_rules.html#check_outputs","title":"Check outputs.","text":"<p>self.assert_equal(actual, expected) ```</p>"},{"location":"ai_prompts/testing.format_rules.html#check_outputs_1","title":"Check outputs.","text":"<p>self.assert_equal(str(actual), str(expected)) ```</p>"},{"location":"ai_prompts/testing.format_rules.html#check_outputs_2","title":"Check outputs.","text":"<p>self.assert_equal(actual, expected, fuzzy_match=True) ```</p>"},{"location":"ai_prompts/testing.format_rules.html#check_outputs_3","title":"Check outputs.","text":"<p>self.assert_equal(actual, expected, purify_text=True) ```</p>"},{"location":"ai_prompts/testing.format_rules.html#check_outputs_4","title":"Check outputs.","text":"<p>expected = \"\"\"         line1         line2         \"\"\" self.assert_equal(actual, expected, dedent=True)     ```</p>"},{"location":"ai_prompts/testing.format_rules.html#testing_exceptions","title":"Testing Exceptions","text":"<ul> <li> <p>Full exception testing with message verification:</p> <p><code>python def test_raises_error(self) -&gt; None:     \"\"\"     Test that function raises ExceptionType for invalid input.     \"\"\"     # Prepare inputs.     invalid_input = &lt;value&gt;     # Run test and check output.     with self.assertRaises(ExceptionType) as cm:             function_under_test(invalid_input)     actual = str(cm.exception)     expected = \"\"\"     Expected error message     \"\"\"     self.assert_equal(actual, expected, fuzzy_match=True)</code></p> </li> <li> <p>Simplified version when exact message doesn't matter:</p> <p><code>python def test_raises_error(self) -&gt; None:     \"\"\"     Test that function raises AssertionError for invalid input.     \"\"\"     # Prepare inputs.     invalid_input = &lt;value&gt;     # Run test and check output.     with self.assertRaises(AssertionError):             function_under_test(invalid_input)</code></p> </li> <li> <p>Check for partial message:     <code>python def test_error_message_content(self) -&gt; None:         \"\"\"         Test that error message contains expected text.         \"\"\"         # Prepare inputs.         invalid_input = &lt;value&gt;         # Run test and check output.         with self.assertRaises(AssertionError) as cm:                 function_under_test(invalid_input)         self.assertIn(\"expected substring\", str(cm.exception))</code></p> </li> </ul>"},{"location":"ai_prompts/testing.format_rules.html#use_golden_file_testing_for_large_outputs","title":"Use Golden File Testing for Large Outputs","text":"<ul> <li> <p>When output is &gt; 50 lines or changes frequently:</p> <p><code>python def test_large_output(self) -&gt; None:     \"\"\"Test description.\"\"\"     # Prepare inputs.     input_data = &lt;value&gt;     # Run test.     actual = function_under_test(input_data)     # Check outputs.     self.check_string(actual)</code></p> </li> <li> <p>With fuzzy matching:     <code>python self.check_string(actual, fuzzy_match=True)</code></p> </li> </ul>"},{"location":"ai_prompts/testing.format_rules.html#input_data_patterns","title":"Input Data Patterns","text":"<ul> <li> <p>Use multiline text (preferred):</p> <p>```python</p> </li> <li> <p>Use list input:</p> <p>```python</p> </li> <li> <p>Use scratch space for file testing:</p> <p>```python</p> </li> <li> <p>Use input directory for large test data:     ```python</p> </li> </ul>"},{"location":"ai_prompts/testing.format_rules.html#prepare_inputs","title":"Prepare inputs.","text":"<p>text = \"\"\" line1 line2 line3 \"\"\" text = hprint.dedent(text) ```</p>"},{"location":"ai_prompts/testing.format_rules.html#prepare_inputs_1","title":"Prepare inputs.","text":"<p>items = [\"a\", \"b\", \"c\"] ```</p>"},{"location":"ai_prompts/testing.format_rules.html#prepare_inputs_2","title":"Prepare inputs.","text":"<p>scratch_dir = self.get_scratch_space() test_file = os.path.join(scratch_dir, \"test.txt\") hio.to_file(test_file, \"content\") ```</p>"},{"location":"ai_prompts/testing.format_rules.html#prepare_inputs_3","title":"Prepare inputs.","text":"<p>input_file = os.path.join(self.get_input_dir(), \"test_data.json\") data = hio.from_json(input_file)     ```</p>"},{"location":"ai_prompts/testing.format_rules.html#setup_and_teardown","title":"Setup and Teardown","text":"<ul> <li> <p>Use when multiple test methods need the same setup/teardown code:</p> <p>```python class TestClassName(hunitest.TestCase):     \"\"\"     Test description.     \"\"\"</p> <pre><code>@pytest.fixture(autouse=True)\ndef setup_teardown_test(self):\n        \"\"\"\n        Setup and teardown for each test.\n        \"\"\"\n        # Run before each test.\n        self.set_up_test()\n        yield\n        # Run after each test.\n        self.tear_down_test()\n\ndef set_up_test(self) -&gt; None:\n        \"\"\"\n        Setup code that runs before each test.\n        \"\"\"\n        self.test_data = &lt;initialize&gt;\n\ndef tear_down_test(self) -&gt; None:\n        \"\"\"\n        Cleanup code that runs after each test.\n        \"\"\"\n        &lt;cleanup&gt;\n\ndef test_method1(self) -&gt; None:\n        \"\"\"\n        Test description.i\n        \"\"\"\n        # Use self.test_data here.\n</code></pre> <p>```</p> </li> </ul>"},{"location":"ai_prompts/testing.move_test_code.html","title":"Testing.move test code","text":"<ul> <li>I will pass you a file with unit tests test_file.py</li> </ul>"},{"location":"ai_prompts/testing.move_test_code.html#step_1","title":"Step 1","text":"<ul> <li>Find the functions that are tested in the file <code>test_file.py</code></li> <li>Prepare a plan that shows a mapping between test classes and file that     contains the functions tested by each class</li> </ul>"},{"location":"ai_prompts/testing.move_test_code.html#step_2","title":"Step 2","text":"<ul> <li> <p>Implement this plan</p> <ul> <li>Using the --append option in <code>split_in_files.py</code></li> <li>Not preserving the input file so it's an actual move of code from one file     to another</li> </ul> </li> <li> <p>Modify <code>test_file.py</code> to move the code to the right direction</p> </li> <li> <p>Write the <code>split_in_files.py</code> command</p> </li> </ul>"},{"location":"ai_prompts/testing.reach_coverage.html","title":"Testing.reach coverage","text":"<ul> <li> <p>Increase unit test coverage to approach 100 percent for a given function.</p> </li> <li> <p>Context and constraints:</p> <ul> <li>You will be given a specific function to work on.</li> <li>All tests and code must strictly follow:<ul> <li><code>docs/ai_prompts/testing.format_rules.md</code> for tests</li> <li><code>docs/ai_prompts/coding.format_rules.md</code> for any code</li> </ul> </li> <li>Focus on meaningful behavior and correctness rather than superficial     coverage.</li> <li>If any part of the task is unclear or underspecified, stop and ask for     clarification before proceeding.</li> </ul> </li> </ul>"},{"location":"ai_prompts/testing.reach_coverage.html#step_1_establish_current_coverage","title":"Step 1: Establish Current Coverage","text":"<ul> <li>Identify the test file corresponding to the target function Example:     helpers/hllm_cli.py \u2192 helpers/test/test_hllm_cli.py</li> <li> <p>Run the following command and record the results:     <pre><code>pytest --cov=yourpkg --cov-report=term-missing --cov-report=html\n</code></pre></p> </li> <li> <p>Summarize which lines and branches are not covered.</p> </li> </ul>"},{"location":"ai_prompts/testing.reach_coverage.html#step_2_design_a_testing_plan","title":"Step 2: Design a Testing Plan","text":"<ul> <li>Analyze uncovered code paths and behaviors.</li> <li>Propose a clear testing plan that:<ul> <li>Tests functions modularly before testing interactions.</li> <li>Prioritizes end-to-end and user-visible behavior over incidental     implementation details.</li> <li>Avoids testing assertions, defensive checks, or invalid inputs unless they     are critical to correctness.</li> </ul> </li> <li>Explicitly map each uncovered area to one or more proposed tests.</li> </ul>"},{"location":"ai_prompts/testing.reach_coverage.html#step_3_specify_tests_without_implementation","title":"Step 3: Specify Tests Without Implementation","text":"<ul> <li>Define test classes and test method names.</li> <li>For each proposed test:<ul> <li>Describe the input data.</li> <li>Describe the expected output or observable behavior.</li> </ul> </li> <li>Do not write executable test code at this stage.</li> </ul>"},{"location":"ai_prompts/testing.reach_coverage.html#step_4_implement_after_approval","title":"Step 4: Implement After Approval","text":"<ul> <li>Wait for user confirmation or feedback on the testing plan.</li> <li>After approval:<ul> <li>Implement the tests according to the approved plan.</li> <li>Re-run coverage and verify that coverage for the target function is near 100     percent.</li> <li>Report final coverage results and remaining gaps, if any.</li> </ul> </li> </ul> <p>Important rules:</p> <ul> <li>Do not implement tests before the plan is approved.</li> <li>Do not proceed if instructions or requirements are ambiguous.</li> <li>Always adhere to the formatting and style guides referenced above.</li> </ul>"},{"location":"ai_prompts/text.humanize.html","title":"Text.humanize","text":""},{"location":"ai_prompts/text.humanize.html#rules_to_avoid_ai-style_writing","title":"Rules to Avoid \"AI-Style\" Writing","text":"<ul> <li> <p>Avoid grandiose or inflated language</p> <ul> <li>Don't describe ordinary topics as \"vital\", \"pivotal\", or \"groundbreaking\"     unless they truly are</li> <li>Keep tone proportionate</li> </ul> </li> <li> <p>Don't imply notability without evidence</p> <ul> <li>Avoid generic claims like \"widely covered\" or \"significant attention\"</li> <li>If coverage matters, name the sources directly</li> </ul> </li> <li> <p>Prefer concrete details over meta-verbs</p> <ul> <li>Instead of saying something \"highlights\", \"underscores\", or \"emphasizes\" a     point, simply explain what it shows</li> </ul> </li> <li> <p>Limit formulaic phrasing</p> <ul> <li>Use the \"rule of three\" sparingly (\"simple, efficient, and powerful\") and     avoid overly tidy, repetitive sentence structures</li> </ul> </li> <li> <p>Be specific with attribution</p> <ul> <li>Avoid vague references like \"some experts say...\"</li> <li>Identify the actual critic, report, study, or author when possible</li> </ul> </li> <li> <p>Keep tone neutral, not promotional</p> <ul> <li>Skip marketing language (\"boasts\", \"redefines\", \"offers unparalleled value\")</li> <li>Describe features plainly and factually</li> </ul> </li> <li> <p>Don't force variation for its own sake</p> <ul> <li>Avoid overusing synonyms just to avoid repetition</li> <li>Choose clear, consistent terms rather than elegant variation</li> </ul> </li> <li> <p>Use punctuation in a natural, unobtrusive way</p> <ul> <li>Don't rely heavily on em dashes or elaborate punctuation patterns</li> <li>Prefer simple, readable structures</li> </ul> </li> <li> <p>Avoid generic disclaimers or prefaces</p> <ul> <li>Cut phrases like \"It's important to note that...\" or \"Before proceeding...\"</li> <li>Integrate necessary caveats naturally into the text</li> </ul> </li> <li> <p>Avoid AI self-references</p> <ul> <li>Don't mention being an AI model, a language model, or having a knowledge     cutoff</li> <li>Express uncertainty in human-like terms if needed</li> </ul> </li> <li> <p>Keep quotation style consistent</p> <ul> <li>Use one type of quotation mark consistently rather than mixing curly and     straight quotes in the same text</li> </ul> </li> <li> <p>Avoid memo-like or email-like headers</p> <ul> <li>Don't begin with \"Subject:\" or similar formal headings unless the format     calls for it</li> <li>Start directly with the content</li> </ul> </li> </ul>"},{"location":"ai_prompts/text.humanize.html#deslop","title":"Deslop","text":"<p>You are a writing editor. Your job is to remove AI-generated writing patterns from the text I give you.</p> <ul> <li>Do not rewrite. Do not add ideas. Do not change my meaning or voice. Just clean     up the slop. Preserve my voice, opinions, and structure. You are an editor, not     a ghostwriter.</li> <li>If a sentence sounds better with a \"rule break\" (e.g. a well- placed em dash or     a short sentence run for effect), leave it. Use judgment.</li> </ul> <p>I will paste a draft. You will return a cleaned version with every flagged pattern fixed</p>"},{"location":"ai_prompts/text.humanize.html#rules","title":"Rules","text":"<p>Apply every rule below. If a pattern appears, fix it. If it doesn't</p>"},{"location":"ai_prompts/text.humanize.html#phrasing","title":"Phrasing","text":""},{"location":"ai_prompts/text.humanize.html#1_em_dashes","title":"1. Em Dashes","text":"<ul> <li>Remove em dashes (\u2014). Rewrite using commas, full stops, or restructure the     sentence. One or two in a long piece is fine. Three or more is a pattern.</li> </ul>"},{"location":"ai_prompts/text.humanize.html#2_corrective_antithesis","title":"2. Corrective Antithesis","text":"<ul> <li>Remove \"Not X. But Y.\" constructions where you set up something the reader     never assumed and then correct it for drama</li> <li> <p>Just say what you mean directly</p> </li> <li> <p>Bad:</p> <ul> <li>\"This isn't because they don't trust the technology. It's because they can't     predict it.\"</li> </ul> </li> <li> <p>Good:</p> <ul> <li>\"They trust the technology fine. What they can't do is predict it.\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/text.humanize.html#3_dramatic_pivot_phrases","title":"3. Dramatic Pivot Phrases","text":"<ul> <li>Remove<ul> <li>\"But here's the thing.\"</li> <li>\"Here's the catch.\"</li> <li>\"Here's the bind.\",</li> <li>\"Here's what most people miss.\" and similar theatrical pivots</li> </ul> </li> <li> <p>Fold the point into the sentence naturally.</p> </li> <li> <p>Bad:</p> <ul> <li>\"The patterns are valuable. But here's the bind: building a tool cost more     than most could justify.\"</li> </ul> </li> <li> <p>Good:</p> <ul> <li>\"The patterns are valuable but building a tool to capture them cost more     than most could justify.\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/text.humanize.html#4_soft_hedging_language","title":"4. Soft Hedging Language","text":"<ul> <li> <p>Remove filler hedges. Just say the thing.</p> </li> <li> <p>Cut phrases like:</p> <ul> <li>\"It's worth noting that\"</li> <li>\"Something we've observed\"</li> <li>\"This is where X really shines\"</li> <li>\"It's important to remember\"</li> <li>\"It should be noted\"</li> <li>\"Interestingly enough\"</li> </ul> </li> <li> <p>Bad:</p> <ul> <li>\"It's worth noting that this approach has shown some promising results in     certain contexts.\"</li> </ul> </li> <li> <p>Good:</p> <ul> <li>\"This approach works.\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/text.humanize.html#rhythm","title":"Rhythm","text":""},{"location":"ai_prompts/text.humanize.html#5_staccato_rhythm","title":"5. Staccato Rhythm","text":"<ul> <li> <p>Break up runs of short, punchy sentences that stack without variation. Combine     some. Lengthen others. Let the rhythm follow the thinking, not a drumbeat.</p> </li> <li> <p>Bad:</p> <ul> <li>\"Now, agents act. They send emails. They modify code. They book     appointments.\"</li> </ul> </li> <li> <p>Good:</p> <ul> <li>\"Agents are starting to do real things now. They'll send an email on your     behalf or update a database, sometimes without you even realising it     happened.\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/text.humanize.html#6_cookie-cutter_paragraphs","title":"6. Cookie-Cutter Paragraphs","text":"<ul> <li>Vary paragraph length. If every paragraph is 3\u20134 sentences, break some into     one-liners and let others stretch. The shape of the text on the page should     look uneven, like real thinking.</li> </ul>"},{"location":"ai_prompts/text.humanize.html#7_gift-wrapped_endings","title":"7. Gift-Wrapped Endings","text":"<ul> <li>Remove summary conclusions that restate the article's points</li> <li>Cut:<ul> <li>\"In summary\"</li> <li>\"In conclusion\"</li> <li>\"Ultimately\"</li> <li>\"Moving forward\"</li> <li>\"At the end of the day\"</li> </ul> </li> <li> <p>End with something specific, human, or unresolved</p> </li> <li> <p>Bad:</p> <ul> <li>\"In summary, by focusing on clear communication, consistent feedback, and     mutual trust, teams can build stronger relationships.\"</li> </ul> </li> <li> <p>Good:</p> <ul> <li>\"The best teams I've worked with never talked about trust. They just had     it.\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/text.humanize.html#8_throat-clearing_intros","title":"8. Throat-Clearing Intros","text":"<ul> <li>Remove<ul> <li>\"Let's explore\"</li> <li>\"Let's unpack\"</li> <li>\"Let's dive in\"</li> <li>\"Let's break it down\"</li> <li>\"In this article, we'll\"</li> </ul> </li> <li> <p>Just start. The best first sentence puts the reader in the middle of something.</p> </li> <li> <p>Bad:</p> <ul> <li>\"In this article, we'll explore the hidden costs of micromanagement. Let's     dive in.\"</li> </ul> </li> <li> <p>Good:</p> <ul> <li>\"I micromanaged someone last Tuesday.\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/text.humanize.html#authenticity","title":"Authenticity","text":""},{"location":"ai_prompts/text.humanize.html#9_perfect_punctuation","title":"9. Perfect Punctuation","text":"<ul> <li>Don't correct every grammar \"mistake\" if it sounds more natural broken.<ul> <li>Fragments are fine</li> <li>Starting with And or But is fine</li> <li>A comma splice can stay if it reads well</li> </ul> </li> <li>If the draft has personality in its punctuation, keep it.</li> </ul>"},{"location":"ai_prompts/text.humanize.html#10_copy-paste_metaphors","title":"10. Copy-Paste Metaphors","text":"<ul> <li>If the same metaphor or phrase appears more than twice, vary the language. Use     a pronoun, rephrase it, or trust the reader to remember</li> <li> <p>Never repeat a metaphor word-for-word three times.</p> </li> <li> <p>Bad:</p> <ul> <li>\"Trust is like a battery. When the trust battery is full... But when the     trust battery runs low... To recharge the trust battery...\"</li> </ul> </li> <li> <p>Good:</p> <ul> <li>\"Trust is like a battery. When it's full, you barely think about it. But let     it drain and suddenly every interaction needs a charger.\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/text.humanize.html#11_overexplaining_the_obvious","title":"11. Overexplaining the Obvious","text":"<ul> <li> <p>Cut sentences that explain things the reader already understands. If you've     made a clear point, don't then re-explain how that point works.</p> </li> <li> <p>Bad:</p> <ul> <li>\"Trust is earned over time. You give people small tasks, observe how they     handle them, then gradually expand their responsibilities.\"</li> </ul> </li> <li> <p>Good:</p> <ul> <li>\"Trust is earned. Everyone knows this. The question is whether you're     actually giving people the chance to earn it.\"</li> </ul> </li> </ul>"},{"location":"ai_prompts/text.humanize.html#12_generic_examples","title":"12. Generic Examples","text":"<ul> <li> <p>Flag examples that could apply to any company or product. If an example doesn't     contain a specific, surprising, or insider detail, it's filler. Either sharpen     it or cut it.</p> </li> <li> <p>Bad:</p> <ul> <li>\"Take Slack, for example. By focusing on seamless team communication, they     transformed how modern workplaces collaborate.\"</li> </ul> </li> <li> <p>Good:</p> <ul> <li>\"Slack solved the wrong problem brilliantly. Nobody needed another messaging     app, but everyone needed a place to dump links and pretend they'd read them     later.\"appear, move on.</li> </ul> </li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html","title":"All.ghost platform.how to guide","text":""},{"location":"blogging/all.ghost_platform.how_to_guide.html#causify_blog_platform_documentation","title":"Causify Blog Platform Documentation","text":""},{"location":"blogging/all.ghost_platform.how_to_guide.html#introduction","title":"Introduction","text":"<ul> <li>The blog platform is accessible at blog.causify.ai</li> <li>It enables us to share company updates, thought leadership content, and     technical insights</li> <li>The audience includes both internal and external stakeholders</li> <li>The platform is built on Ghost, an open-source, modern publishing solution</li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#stakeholders","title":"Stakeholders","text":"<ul> <li>Executives: Gain visibility into platform reach, editorial calendar, and     content quality</li> <li>Marketing &amp; Communications: Publish and manage content (blog posts and     announcements)</li> <li>Technical Team: Manage and maintain underlying infrastructure, security,     and updates</li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#accessing_the_blog","title":"Accessing the Blog","text":""},{"location":"blogging/all.ghost_platform.how_to_guide.html#public_access","title":"Public Access","text":"<ul> <li>Navigate to blog.causify.ai. Readers can see     published posts without logging in</li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#admin_access_staff_portal","title":"Admin Access (Staff Portal)","text":"<ul> <li>Go to blog.causify.ai/ghost</li> <li>Enter your email and password (provided via staff invites)</li> <li>After logging in, you can create, edit, or publish content\u2014depending on your     role</li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#getting_started_as_a_staff_user","title":"Getting Started as a Staff User","text":""},{"location":"blogging/all.ghost_platform.how_to_guide.html#receiving_an_invitation","title":"Receiving an Invitation","text":"<ul> <li>An admin invites you by entering your email address in the Staff \u2192 Invite     People section</li> <li>You receive an email link prompting you to create or confirm an account</li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#logging_in","title":"Logging In","text":"<ul> <li>Open blog.causify.ai/ghost</li> <li>Enter your credentials (email and password)</li> <li>You'll be taken to the Ghost Admin Dashboard, where you can see recent posts,     drafts, and announcements</li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#how_to_create_and_publish_a_blog","title":"How to create and publish a blog","text":""},{"location":"blogging/all.ghost_platform.how_to_guide.html#jekyll","title":"Jekyll","text":""},{"location":"blogging/all.ghost_platform.how_to_guide.html#set_up_jekyll","title":"Set up Jekyll","text":"<p>https://github.com/jekyll/jekyll</p> <ul> <li> <p>Install Jekyll locally</p> <ul> <li> <p>Install Ruby and Bundler:     <pre><code>&gt; gem install jekyll bundler\n</code></pre></p> </li> <li> <p>Create a new site: <pre><code>&gt; jekyll new my-blog\n&gt; cd my-blog\n</code></pre></p> </li> <li> <p>Build and serve locally: <pre><code>&gt; bundle exec jekyll serve\n</code></pre></p> </li> <li> <p>Open your browser at http://localhost:4000 to see your site</p> </li> </ul> </li> <li> <p>Use Docker</p> <ul> <li> <p>Instructions at https://github.com/envygeeks/jekyll-docker/blob/master/README.md</p> </li> <li> <p>Pull docker     <pre><code>&gt; docker pull jekyll/jekyll\n</code></pre></p> </li> <li> <p>On Mac     &gt; docker run --platform linux/amd64 -v $(pwd):/site jekyll/jekyll jekyll new blog</p> <p><code>export JEKYLL_VERSION=3.8 docker run --rm \\     --platform linux/amd64 \\     --volume=\"$PWD:/srv/jekyll:Z\" \\     -it jekyll/jekyll:$JEKYLL_VERSION \\     jekyll build</code></p> </li> </ul> </li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#add_blog_posts_on_github","title":"Add blog posts on GitHub","text":"<pre><code>- Create a `_posts` folder if it doesn't exist\n- Add Markdown files named in the format `YYYY-MM-DD-title.md`, for example:\n    ```text\n    _posts/2025-07-06-my-first-post.md\n    ```\n\n- Each post needs front matter at the top:\n```text\n    ---\n    layout: post\n    title: \"My First Blog Post\"\n    date: 2025-07-06\n    ---\n\n    This is my first blog post written in Markdown\n    ```\n</code></pre>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#configure_github_pages","title":"Configure GitHub Pages","text":"<pre><code>- Push your code to GitHub\n- Go to the repository's Settings &gt; Pages\n- Set the source branch to main and the folder to / (root) or /docs if your\n    site is in a docs folder\n- Save your settings. Your site will be published at:\n    `https://yourusername.github.io/my-blog/`\n</code></pre> <ul> <li>Add a custom domain (optional)<ul> <li>Buy a domain name and update your DNS to point to <code>yourusername.github.io</code></li> <li>In your repo, create a file named CNAME with your custom domain name:     <code>www.yourdomain.com</code></li> </ul> </li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#configure","title":"Configure","text":"<ul> <li> <p>Example <code>_config.yml</code> to configure your site:     <pre><code>title: My Blog\ndescription: A blog powered by Jekyll and GitHub Pages\nbaseurl: \"\"\nurl: \"https://yourusername.github.io\"\n\nremote_theme: jekyll/minima\n\nplugins:\n    - jekyll-feed\n</code></pre></p> </li> <li> <p>Add an <code>index.md</code> at the root of your repo:     <pre><code>---\nlayout: home\n---\n</code></pre></p> </li> <li> <p>Folder structure example     <pre><code>\u251c\u2500\u2500 _config.yml\n\u251c\u2500\u2500 _posts/\n\u2502   \u2514\u2500\u2500 2025-07-06-my-first-post.md\n\u251c\u2500\u2500 index.md\n\u2514\u2500\u2500 CNAME  # only if using a custom domain\n</code></pre></p> </li> <li> <p>Every time you push changes to GitHub, GitHub Pages will rebuild and publish your site automatically</p> </li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#hugo","title":"Hugo","text":""},{"location":"blogging/all.ghost_platform.how_to_guide.html#ananke","title":"Ananke","text":"<p>https://themes.gohugo.io/tags/blog/ Download a them from https://github.com/theNewDynamic/gohugo-theme-ananke</p> <p>unzip blog/gohugo-theme-ananke-main.zip</p> <p>mv gohugo-theme-ananke-main blog/themes/ananke</p> <p>Add theme = \"ananke\" config.toml</p> <p>docker run --rm -it -v $(pwd):/src klakegg/hugo:ext new posts/my-first-post.md WARN 2025/07/06 15:41:14 Module \"ananke\" is not compatible with this Hugo version; run \"hugo mod graph\" for more information. Content \"/src/content/posts/my-first-post.md\" created</p> <p>vi ./content/posts/my-first-post.md</p>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#hugo-book","title":"hugo-book","text":"<p>https://themes.gohugo.io/themes/hugo-book/ https://github.com/alex-shpak/hugo-book# https://hugo-book-demo.netlify.app/</p>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#pre-built_image","title":"pre-built image","text":"<ul> <li>This image is too old and doesn't work with many themes</li> </ul> <p>docker run --rm -it -v $(pwd):/src klakegg/hugo:latest new site blog --force</p> <p>Ananke is not compatible with the klakegg version</p>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#dockerfile","title":"Dockerfile","text":"<p>docker build -t hugo .</p> <p>docker run --rm -it -p 1313:1313 -v $(pwd):/src hugo hugo server --bind 0.0.0.0</p>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#to_clean","title":"To clean","text":"<p>hugo mod clean rm -rf public</p>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#ghost","title":"Ghost","text":""},{"location":"blogging/all.ghost_platform.how_to_guide.html#writing_publishing_content","title":"Writing &amp; Publishing Content","text":"<ul> <li> <p>Create a New Post</p> <ul> <li>Click New post in the admin panel</li> <li>Enter a title and start writing. Ghost uses a rich text/markdown hybrid     editor with slash commands (<code>/</code>) for quick embeds</li> </ul> </li> <li> <p>Add Images &amp; Media</p> <ul> <li>Drag and drop images directly into the editor, or click the \"+\" button and     select Image</li> <li>(Optional): We can have S3 or external storage configured, so the files are     automatically uploaded to that location</li> </ul> </li> <li> <p>Using Cards &amp; Embeds</p> <ul> <li>Type <code>/</code> in a new line to see options (e.g., Markdown card, HTML, YouTube     embed, etc.)</li> </ul> </li> <li> <p>Preview &amp; Publish</p> <ul> <li>Click Preview to see how the post will appear to readers</li> <li>When ready, click Publish \u2192 Publish now or schedule a specific time</li> </ul> </li> <li> <p>Tags &amp; Organization</p> <ul> <li>Add tags to group similar posts (e.g., <code>Company News</code>, <code>Technical</code>,     <code>Research</code>)</li> </ul> </li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#example","title":"Example","text":"<ul> <li> <p>Consider the case where we want to push the Markdown file     <code>all.invoke_git_branch_copy.how_to_guide.md</code> to the blog</p> </li> <li> <p>After creating an account, follow these steps:</p> </li> <li> <p>Step 1: Open the Ghost Admin panel</p> <ul> <li>Open blog.causify.ai/ghost</li> <li> <p>Enter your credentials to login</p> <p></p> </li> <li> <p>Open the Ghost Admin Panel</p> <p></p> </li> </ul> </li> <li> <p>Step 2: Create a new post</p> <ul> <li> <p>Click New post on the top right</p> <p></p> </li> </ul> </li> <li> <p>Step 3: Insert Markdown card</p> <ul> <li> <p>Use the <code>/markdown</code> command to insert a Markdown card</p> <p></p> </li> </ul> </li> <li> <p>Step 4: Paste the contents to post</p> <ul> <li> <p>Copy and paste the content of <code>all.invoke_git_branch_copy.how_to_guide.md</code>     into the Markdown card</p> <p></p> </li> </ul> </li> <li> <p>Step 5: Perform edits to the content</p> <ul> <li>Move the level 1 title (e.g., <code># The Git Branch Copy Workflow</code>) into the Ghost     post title field</li> <li> <p>Delete the level 1 header from the Markdown card content</p> <p></p> </li> </ul> </li> <li> <p>Step 6: Handle authorship attribution</p> <ul> <li> <p>If you are a Contributor:</p> <ul> <li>Add a temporary <code>## Authorship</code> section at the very top of the Markdown card     content</li> <li>List everyone who contributed (e.g., wrote code, reviewed, edited)</li> </ul> <p></p> </li> <li> <p>If you are an Author or higher:</p> <ul> <li>Add contributors directly in the Authors field using the Ghost sidebar</li> <li>You do not need to include a <code>## Authorship</code> section in the content</li> </ul> </li> <li> <p>If you are reviewing a blog created by a Contributor:</p> <ul> <li>You need to have Author or higher access to do this</li> <li>Check the <code>## Authorship</code> section at the top of the Markdown card</li> <li>Manually copy the listed names into the Ghost Authors field</li> <li>Delete the <code>## Authorship</code> section from the Markdown content before     publishing</li> </ul> </li> </ul> </li> <li> <p>Step 7: Preview post</p> <ul> <li> <p>Click Preview on the top right to verify formatting (headings, TOC, code     blocks)</p> <p> </p> </li> </ul> </li> <li> <p>Step 8: Optionally add metadata like excerpt, tags, or scheduled time</p> <ul> <li>These actions require Author access or higher</li> <li> <p>Contributors cannot modify metadata or scheduling options</p> <p></p> </li> </ul> </li> <li> <p>Step 9: Publish the blog</p> <ul> <li>Click Publish \u2192 Publish now (or schedule the post for later) to publish     the blog</li> <li>If you are a Contributor, you cannot publish or schedule posts directly</li> <li>A staff member with Author or higher access must review and approve the     post before it goes live</li> </ul> </li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#themes_design","title":"Themes &amp; Design","text":"<ul> <li> <p>Default Theme (Casper)</p> <ul> <li>The blog currently uses Ghost's default theme, \"Casper\", providing a clean     and responsive layout</li> </ul> </li> <li> <p>Customizing Design</p> <ul> <li>Navigate to Settings \u2192 Design to upload a new theme or activate an     existing one</li> <li>Use Code Injection (under the same area) for tracking scripts (e.g.,     Google Analytics) or custom CSS</li> </ul> </li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#additional_guides_tutorials","title":"Additional Guides &amp; Tutorials","text":"<ul> <li> <p>Below are step-by-step mini-tutorials to help users and contributors     understand some advanced or less obvious features of Ghost</p> </li> <li> <p>Creating and Managing Tags</p> <ul> <li> <p>What are tags?</p> <ul> <li>Tags let you organize content into categories (e.g., <code>Product Updates</code>,     <code>Engineering</code>)</li> </ul> </li> <li> <p>How to add tags</p> <ul> <li>When editing a post, find the Tags section on the right panel, type a new     tag name or select an existing one</li> <li>Posts can have multiple tags (e.g., <code>Engineering</code> + <code>Announcements</code>)</li> </ul> </li> <li> <p>Managing tags</p> <ul> <li>Go to Posts \u2192 Tags in the admin panel to rename or delete tags</li> </ul> </li> </ul> </li> <li> <p>Scheduling Posts</p> <ul> <li> <p>Why schedule posts?</p> <ul> <li>Perfect for timing announcements, product releases, or holiday-themed posts</li> </ul> </li> <li> <p>How to schedule</p> <ul> <li>Write your post, click Publish \u2192 Schedule it for later</li> <li>Pick a date and time (in your local timezone)</li> </ul> </li> <li> <p>Editing a scheduled post</p> <ul> <li>Navigate to Posts \u2192 Scheduled, then click the post to edit or change the     scheduled time</li> </ul> </li> </ul> </li> <li> <p>Using Markdown &amp; HTML Blocks</p> <ul> <li> <p>Markdown basics</p> <ul> <li>Ghost's editor supports inline markdown. For advanced formatting, insert a     Markdown card by typing <code>/markdown</code></li> <li>You can use headings, bold, italics, blockquotes, lists, etc.</li> </ul> </li> <li> <p>HTML cards</p> <ul> <li>Type <code>/html</code> to embed raw HTML for custom iframes, custom scripts, or     specialized formatting</li> </ul> </li> </ul> </li> <li> <p>Excerpt and Meta Data</p> <ul> <li> <p>Excerpt(Optional)</p> <ul> <li>Under Post settings \u2192 Excerpt, you can define a short preview text for     your post</li> <li>This snippet appears on the home page or in RSS feeds, depending on your     theme</li> </ul> </li> <li> <p>Meta title and description</p> <ul> <li>For SEO benefits, set custom meta titles and descriptions under Post     settings \u2192 Meta data</li> </ul> </li> </ul> </li> <li> <p>Integrations &amp; Webhooks</p> <ul> <li> <p>Built-in integrations</p> <ul> <li>Under Settings \u2192 Integrations, you can quickly connect Slack, Zapier, or     other tools to notify our team when new posts are published</li> </ul> </li> <li> <p>Custom webhooks</p> <ul> <li>You can create webhooks for publish events, letting external systems react     (e.g., cross-posting to social media)</li> </ul> </li> </ul> </li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#frequently_asked_questions_faq","title":"Frequently Asked Questions (FAQ)","text":"<ul> <li> <p>How do I reset my password?</p> <ul> <li>Click Forgot Password? on the login page. Check your inbox for a reset     link (ensure it's not caught in spam)</li> </ul> </li> <li> <p>Why isn't my invitation email received?</p> <ul> <li>Check your spam folder</li> </ul> </li> <li> <p>Can we schedule posts for later?</p> <ul> <li>Yes, while publishing a new post, choose Publish \u2192 Schedule it for later</li> </ul> </li> <li> <p>How do I integrate analytics?</p> <ul> <li>Use Settings \u2192 Code Injection to add your analytics script in the     site-wide header/footer</li> </ul> </li> <li> <p>How to reset a staff user's password if they can't access email?</p> <ul> <li>Admin can go to Staff \u2192 Select User \u2192 Resend Invitation or Change     Password. Alternatively, the user can use the Forgot Password? link</li> </ul> </li> <li> <p>I see a \"502 Bad Gateway\" error when accessing blog.causify.ai. What do I do?</p> <ul> <li>Contact the Infra/DevOps team to investigate network issues</li> </ul> </li> <li> <p>Why can't I see the scheduling option?</p> <ul> <li>Make sure you have an Author (or higher) role. Contributors can't schedule     posts</li> </ul> </li> <li> <p>Can we add custom pages (e.g., \"About,\" \"Contact,\" \"Terms of Service\")?</p> <ul> <li>Yes. Create a new post and mark it as a page in Post Settings and toggle     \"Turn this post into a static page.\"</li> <li>Adjust your theme's navigation to link these pages</li> </ul> </li> </ul>"},{"location":"blogging/all.ghost_platform.how_to_guide.html#summary_next_steps","title":"Summary &amp; Next Steps","text":"<ul> <li> <p>We have successfully deployed a secure, scalable Ghost blog at     blog.causify.ai/ghost</p> <ul> <li>Executives and stakeholders can review content for corporate alignment and     brand consistency</li> <li>Authors can quickly draft and publish posts, while editors ensure quality</li> <li>Technical teams maintain the underlying Kubernetes infrastructure, backups,     and security posture</li> </ul> </li> <li> <p>Next Steps:</p> <ul> <li>Continue inviting staff members who need author access</li> <li>Customize the theme to fit the Causify brand</li> <li>Review and refine settings as you collect feedback from readers and     contributors</li> </ul> </li> </ul>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html","title":"All.publish causify blogs.how to guide","text":""},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#how_to_publish_causify_blogs","title":"How to Publish Causify Blogs","text":""},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#overview","title":"Overview","text":"<p>The Causify blog is hosted at https://blog.causify.ai/ and is built using MkDocs Material with the blog plugin. All blog content is managed through the csfy repository, and changes are automatically deployed via GitHub Actions.</p> <p>The blog uses a preprocessing step that:</p> <ul> <li>Validates required frontmatter fields (title, authors, date, description,     categories)</li> <li>Renders diagrams (Graphviz, Mermaid, PlantUML) to PNG images</li> <li>Copies all necessary files including hidden files like <code>.authors.yml</code> to <code>tmp</code>     dir (needed while deploying)</li> </ul>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#how_to_publish_a_blog","title":"How to Publish a Blog","text":"<p>Publishing a blog post is straightforward:</p> <ol> <li>Create your blog post as a Markdown file following the conventions below</li> <li>Add the file to <code>//csfy/blog/docs/posts/</code> directory</li> <li>Commit and merge your changes to the <code>master</code> branch</li> </ol> <p>That's it! The publish_blog.yml GitHub Action will automatically:</p> <ul> <li>Detect changes in the <code>blog/**</code> directory</li> <li>Run preprocessing to validate frontmatter and render diagrams</li> <li>Build the MkDocs site</li> <li>Deploy it to S3 at <code>s3://causify-blog</code></li> <li>Your blog will be live at https://blog.causify.ai/</li> </ul> <p>Note: The GitHub Action publishes ANY changes made in the <code>//csfy/blog/</code> directory, including:</p> <ul> <li>New blog posts</li> <li>Updates to existing posts</li> <li>Changes to styling (<code>styles/</code>)</li> <li>New or updated assets/images</li> <li>Configuration changes (<code>mkdocs.yml</code>)</li> <li>Author information (<code>.authors.yml</code>)</li> </ul>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#how_to_preview_locally","title":"How to Preview Locally","text":"<p>Before publishing, you should preview your blog post locally to ensure it renders correctly.</p>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#prerequisites","title":"Prerequisites","text":"<p>Activate the MkDocs virtual environment before serving/ building:</p> <pre><code>source \"$HOME/src/venv/mkdocs/bin/activate\"\n</code></pre> <p>This environment already has all the necessary dependencies (<code>mkdocs</code>, <code>mkdocs-material</code>, etc.) installed.</p>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#steps_to_preview","title":"Steps to Preview","text":"<ol> <li>Navigate to the repository root:</li> </ol> <pre><code>   cd ~/src/csfy1\n</code></pre> <ol> <li>Run the preprocessing script:</li> </ol> <pre><code>   python helpers_root/docs/mkdocs/preprocess_mkdocs.py \\\n     --blog \\\n     --input_dir blog \\\n     --output_dir tmp.mkblogs \\\n     --render_images \\\n     --force_rebuild \\\n     -v INFO\n</code></pre> <p>What this does:</p> <ul> <li>Validates frontmatter in all blog posts</li> <li>Renders Graphviz/Mermaid/PlantUML diagrams to PNG images</li> <li>Copies all files from <code>blog/</code> to <code>tmp.mkblogs/</code></li> <li>Includes hidden files like <code>.authors.yml</code></li> <li>Moves generated images to correct location</li> </ul> <p>Flags:</p> <ul> <li><code>--blog</code>: Process as blog (enables frontmatter validation)</li> <li><code>--render_images</code>: Render diagrams to images</li> <li><code>--force_rebuild</code>: Ignore cache and regenerate all images</li> <li> <p><code>-v INFO</code>: Verbose logging</p> </li> <li> <p>Navigate to the blog directory:</p> </li> </ul> <pre><code>   cd blog\n</code></pre> <ol> <li>Activate the mkdocs env</li> </ol> <pre><code>    source \"$HOME/src/venv/mkdocs/bin/activate\"\n</code></pre> <ol> <li>Start the local server:</li> </ol> <pre><code>   mkdocs serve\n</code></pre> <p>Note: The <code>mkdocs.yml</code> is configured with <code>docs_dir: tmp.docs</code>, so MkDocs will serve from the preprocessed content. One might need to <code>unset PYTHONPATH</code> if encountering env errors.</p> <ol> <li>Open the local site:</li> <li>The terminal will display the local URL (typically <code>http://127.0.0.1:8000</code>)</li> <li> <p>Open this URL in your browser to preview your blog</p> </li> <li> <p>Make changes:</p> </li> <li>Edit files in <code>blog/docs/posts/</code></li> <li>Re-run the preprocessing script (step 2) to see changes</li> <li> <p>The mkdocs server will auto-reload after preprocessing</p> </li> <li> <p>Stop the server:</p> </li> <li>Press <code>Ctrl+C</code> in the terminal when done</li> </ol>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#changes_in_website_structure","title":"Changes in Website Structure","text":""},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#adding_or_editing_categories","title":"Adding or Editing Categories","text":"<p>Categories are defined in the <code>mkdocs.yml</code> configuration file. To add or modify categories:</p> <ol> <li>Edit the configuration:</li> </ol> <pre><code>   vim blog/mkdocs.yml\n</code></pre> <ol> <li>Locate the <code>categories_allowed</code> section:</li> </ol> <pre><code>plugins:\n    - blog:\n            categories_allowed:\n                - \"Causal News\"\n                - \"Causal ELI5\"\n                - Business\n                - DevOps\n                - Startup\n</code></pre> <ol> <li>Add or modify categories:</li> <li>Add new categories to this list</li> <li>Remove categories that are no longer needed</li> <li> <p>Categories with spaces must be quoted (e.g., <code>\"Causal News\"</code>)</p> </li> <li> <p>Note on case sensitivity:</p> </li> <li>The blog plugin is configured with <code>case: preserve</code></li> <li>Category names are case-sensitive</li> <li>Use consistent capitalization across all blog posts</li> </ol>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#adding_or_editing_authors","title":"Adding or Editing Authors","text":"<p>Author information is centrally managed in a YAML file:</p> <ol> <li>Edit the authors file:</li> </ol> <pre><code>   vim blog/docs/.authors.yml\n</code></pre> <ol> <li>Add a new author:</li> </ol> <pre><code>author_id:\n    name: Full Name\n    description: Author bio or role\n    avatar: https://github.com/username.png # Or path to local image.\n</code></pre> <ol> <li>Example author entry:</li> </ol> <pre><code>gpsaggese:\n    name: GP Saggese\n    description: CEO &amp; Co-founder at Causify\n    avatar: https://github.com/gpsaggese.png\n</code></pre> <ol> <li>Using the author in blog posts:</li> <li>Reference the author by their <code>author_id</code> in the blog post frontmatter</li> <li>Multiple authors can be listed for a single post</li> </ol>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#blog_post_structure_and_conventions","title":"Blog Post Structure and Conventions","text":""},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#required_frontmatter","title":"Required Frontmatter","text":"<p>Every blog post must include YAML frontmatter at the beginning of the file. Here are the required fields:</p> <pre><code>title: Your Blog Post Title\nauthors:\n    - author_id_1\n    - author_id_2 # Optional: multiple authors.\ndate: YYYY-MM-DD\ndescription: Brief description of the blog post\ncategories:\n    - Category1\n    - Category2 # Optional: multiple categories.\n</code></pre> <p>Field descriptions:</p> <ul> <li><code>title</code>: The main title of your blog post (required)</li> <li><code>authors</code>: List of author IDs from <code>.authors.yml</code> (required)</li> <li><code>date</code>: Publication date in YYYY-MM-DD format (required)</li> <li><code>description</code>: Short summary that appears in previews (required)</li> <li><code>categories</code>: List of categories from the allowed categories (required)</li> </ul> <p>Important: The preprocessing script will validate these fields and fail if any are missing. This ensures all blog posts have complete metadata before publishing.</p>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#blog_post_template","title":"Blog Post Template","text":"<p>Here's a complete template for a new blog post:</p> <pre><code>title: Your Compelling Blog Title authors:\n\n- your_author_id date: 2025-01-15 description: A brief, engaging description\n    that will appear in blog previews and search results categories:\n- Business\n- Startup\n\nYour opening paragraph goes here. This should hook the reader and provide\ncontext for what they're about to read.\n\nThis introduction text will appear in blog list previews.\n\n&lt;!-- more --&gt;\n\n## Main Content Starts Here\n\nAfter the `&lt;!-- more --&gt;` separator, you can include the full content of your\nblog post.\n\n## Conclusion\n</code></pre>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#naming_convention","title":"Naming Convention","text":"<p>Blog post files should follow this naming convention:</p> <p>Format: <code>Title_of_the_Blog.md</code></p> <p>Examples:</p> <ul> <li><code>AI_for_Optimal_Decision-Making.md</code></li> <li><code>Understanding_Causal_Inference.md</code></li> <li><code>A_Causal_Analysis_of_Vaccine_Kills_Claim.md</code></li> </ul> <p>Guidelines:</p> <ul> <li>Use title case for the filename</li> <li>Use underscores instead of spaces for better compatibility</li> <li>Keep names descriptive but concise</li> <li>The <code>.md</code> extension is required</li> </ul>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#using_the_excerpt_separator","title":"Using the Excerpt Separator","text":"<p>The <code>&lt;!-- more --&gt;</code> separator is crucial for blog post previews:</p> <p>Purpose:</p> <ul> <li>Content before <code>&lt;!-- more --&gt;</code> appears in the blog list/index page</li> <li>Content after <code>&lt;!-- more --&gt;</code> only appears when clicking into the full     post</li> <li>This creates a clean preview without showing the entire post</li> </ul> <p>Best practices:</p> <ul> <li>Place <code>&lt;!-- more --&gt;</code> after 1-2 introductory paragraphs</li> <li>Ensure the preview content is compelling enough to make readers want to click</li> <li>Don't place it too early (at least one paragraph) or too late (not more than     3-4 paragraphs)</li> </ul>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#working_with_assets_and_images","title":"Working with Assets and Images","text":""},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#image_location","title":"Image Location","text":"<p>All blog images and assets should be stored in:</p> <pre><code>//csfy/blog/docs/assets/\n</code></pre> <p>Directory structure:</p> <pre><code>blog/\n\u251c\u2500\u2500 docs/\n\u2502   \u251c\u2500\u2500 assets/\n\u2502   \u2502   \u251c\u2500\u2500 logo.png\n\u2502   \u2502   \u251c\u2500\u2500 favicon.ico\n\u2502   \u2502   \u251c\u2500\u2500 ETA_analogy.png\n\u2502   \u2502   \u2514\u2500\u2500 your_image.png\n\u2502   \u2514\u2500\u2500 posts/\n\u2502       \u2514\u2500\u2500 Your_Blog_Post.md\n\u2514\u2500\u2500 mkdocs.yml\n</code></pre> <p>Image best practices:</p> <ul> <li>Always include descriptive alt text in square brackets</li> <li>Use descriptive filenames for images</li> <li>Optimize images for web (compress large files)</li> <li>Supported formats: PNG, JPG, SVG, GIF</li> <li>Use SVG for diagrams and logos when possible</li> </ul>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#using_diagrams_graphviz_mermaid_plantuml","title":"Using Diagrams (Graphviz, Mermaid, Plantuml)","text":"<p>You can include diagrams directly in your blog posts using code blocks. The preprocessing script will automatically render them to PNG images.</p> <p>Supported diagram types:</p> <ul> <li>Graphviz: For flowcharts, decision trees, and graph diagrams</li> <li>Mermaid: For sequence diagrams, flowcharts, and Gantt charts</li> <li>PlantUML: For UML diagrams</li> </ul> <p>How it works:</p> <ol> <li>Write your diagram code in a fenced code block with the diagram type    (graphviz, mermaid, plantuml)</li> <li>The preprocessing script detects these blocks</li> <li>It renders them to PNG images using Docker containers</li> <li>The images are saved to <code>blog/tmp.docs/posts/figs/</code></li> <li>The markdown is updated to reference the generated images</li> </ol> <p>Important notes:</p> <ul> <li>The preprocessing script must be run with <code>--render_images</code> flag</li> <li>Generated images are automatically named based on the blog post filename</li> <li>Images are cached to avoid regenerating unchanged diagrams (use     <code>--force_rebuild</code> to regenerate)</li> </ul>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#available_categories","title":"Available Categories","text":"<p>The blog currently supports the following categories (defined in <code>mkdocs.yml</code>):</p> <ul> <li>\"Causal News\" - News and updates related to causal AI and the field</li> <li>\"Causal ELI5\" - Simplified explanations of causal concepts</li> <li>Business - Business strategy, insights, and case studies</li> <li>DevOps - Development operations, infrastructure, and tooling</li> <li>Startup - Startup journey, lessons learned, and entrepreneurship</li> </ul> <p>Note: Categories with spaces must be quoted in the frontmatter:</p> <pre><code>categories:\n    - \"Causal News\" # Quoted because it contains a space.\n    - Business # No quotes needed for single words.\n</code></pre> <p>To add new categories, edit the <code>categories_allowed</code> list in <code>blog/mkdocs.yml</code>.</p>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#publishing_workflow_details","title":"Publishing Workflow Details","text":""},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#automatic_deployment","title":"Automatic Deployment","text":"<p>The blog uses a GitHub Action (publish_blog.yml) that:</p> <p>Triggers on:</p> <ul> <li>Push to <code>master</code> branch with changes in <code>blog/**</code> path</li> <li>Manual workflow dispatch</li> </ul> <p>Steps performed:</p> <ol> <li>Checks out the repository with submodules</li> <li>Configures Git credentials</li> <li>Sets up Python 3.x</li> <li>Installs MkDocs and MkDocs Material</li> <li>Updates PYTHONPATH to include helpers</li> <li>Runs preprocessing to validate frontmatter and render diagrams</li> <li>Builds the static site (<code>mkdocs build</code> in <code>./blog</code> directory)</li> <li>Configures AWS credentials via OIDC</li> <li>Syncs the built site to S3: <code>s3://causify-blog</code> with <code>--delete</code> flag</li> </ol> <p>Deployment time:</p> <ul> <li>Typically 2-5 minutes from merge to live</li> <li>CloudFront caching may add a few additional minutes for global propagation</li> </ul>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#what_gets_published","title":"What Gets Published","text":"<p>Any changes in the <code>blog/</code> directory will trigger a deployment:</p> <ul> <li>Blog posts (<code>blog/docs/posts/*.md</code>)</li> <li>Assets (<code>blog/docs/assets/*</code>)</li> <li>Styling (<code>blog/styles/*</code>)</li> <li>Configuration (<code>blog/mkdocs.yml</code>)</li> <li>Author info (<code>blog/docs/.authors.yml</code>)</li> </ul>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#preprocessing_step","title":"Preprocessing Step","text":"<p>The preprocessing step is crucial for blog publishing:</p> <p>What it does:</p> <ol> <li>Validates frontmatter: Checks that all required fields (title, authors,    date, description, categories) are present</li> <li>Renders diagrams: Converts Graphviz/Mermaid/PlantUML code blocks to PNG    images</li> <li>Copies files: Copies all content from <code>blog/docs/</code> to <code>blog/tmp.docs/</code>    (including hidden files)</li> <li>Moves images: Ensures generated images are in the correct location    (<code>blog/tmp.docs/posts/figs/</code>)</li> </ol> <p>Command:</p> <pre><code>python helpers_root/docs/mkdocs/preprocess_mkdocs.py \\\n    --blog \\\n    --input_dir blog \\\n    --output_dir tmp.mkblogs \\\n    --render_images \\\n    --force_rebuild \\\n    -v INFO\n</code></pre> <p>If preprocessing fails:</p> <ul> <li>The GitHub Action will fail and the blog won't be deployed</li> <li>Check the Action logs for validation errors (e.g., missing frontmatter fields)</li> <li>Fix the errors in your blog post and push again</li> </ul> <p>Why <code>blog/tmp.docs/</code>?</p> <ul> <li>The <code>mkdocs.yml</code> configuration has <code>docs_dir: tmp.docs</code></li> <li>This tells MkDocs to build from the preprocessed content</li> <li>The preprocessed content includes rendered diagrams and validated frontmatter</li> <li>The <code>blog/tmp.docs/</code> directory is gitignored and regenerated on each build</li> </ul>"},{"location":"blogging/all.publish_causify_blogs.how_to_guide.html#examples_and_references","title":"Examples and References","text":"<p>For detailed blog writing conventions:</p> <ul> <li>Refer to:     <code>/docs/blogging/all.write_blog.how_to_guide.md</code></li> </ul> <p>Example blog posts:</p> <ul> <li>Browse all published blogs:     https://github.com/causify-ai/csfy/tree/master/blog/docs/posts</li> <li>Pick any <code>.md</code> file to see real examples of:<ul> <li>Frontmatter structure</li> <li>Content organization</li> <li>Image usage</li> <li>Excerpt placement</li> <li>Diagram usage (see <code>A_Causal_Analysis_of_Vaccine_Kills_Claim.md</code> for     Graphviz examples)</li> </ul> </li> </ul> <p>Study these examples to understand:</p> <ul> <li>How to structure compelling introductions</li> <li>Where to place the <code>&lt;!-- more --&gt;</code> separator</li> <li>How to organize content with headers</li> <li>Effective use of images and formatting</li> <li>How to create diagrams with Graphviz, Mermaid, or PlantUML</li> </ul>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html","title":"All.publish mkdocs.how to guide","text":""},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#how_to_publish_mkdocs_documentation","title":"How to Publish Mkdocs Documentation","text":""},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#overview","title":"Overview","text":"<p>At Causify, we use MkDocs with the Material theme to publish documentation for multiple projects. We have two main publishing methods:</p> <ol> <li>Custom domain with S3 (e.g.,    https://docs.causify.ai) - VPN-protected internal    documentation</li> <li>GitHub Pages (e.g.,    https://causify-ai.github.io/helpers) -    Public documentation</li> </ol> <p>Both methods follow the same structure and workflow, with only minor variations in the deployment step.</p>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#publishing_options","title":"Publishing Options","text":""},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#option_1_custom_domain_s3_vpn","title":"Option 1: Custom Domain (S3 + VPN)","text":"<p>Use case: Internal documentation that should be VPN-protected</p> <p>Infrastructure:</p> <ul> <li>S3 bucket for static hosting</li> <li>CloudFront distribution (optional, for caching)</li> <li>VPN \u2192 VPC \u2192 Load Balancer \u2192 S3 VPC Endpoint \u2192 S3 bucket</li> <li>Custom subdomain (e.g., <code>docs.causify.ai</code>)</li> </ul> <p>Examples:</p> <ul> <li>Causify documentation: https://docs.causify.ai</li> <li>Causify blog: https://blog.causify.ai</li> </ul> <p>Workflow: GitHub Action builds MkDocs \u2192 syncs to S3 \u2192 invalidates CloudFront cache Example:-Causify doc Git Action</p>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#option_2_github_pages","title":"Option 2: Github Pages","text":"<p>Use case: Public documentation that should be accessible without VPN</p> <p>Infrastructure:</p> <ul> <li>GitHub Pages hosting (free)</li> <li>Automatic HTTPS via GitHub</li> <li>URL format: <code>https://&lt;org&gt;.github.io/&lt;repo&gt;/</code></li> </ul> <p>Examples:</p> <ul> <li>Helpers documentation:     https://causify-ai.github.io/helpers</li> </ul> <p>Workflow: GitHub Action builds MkDocs \u2192 pushes to <code>gh-pages</code> branch \u2192 GitHub Pages serves it</p>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#directory_structure","title":"Directory Structure","text":""},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#required_layout","title":"Required Layout","text":"<p>Every MkDocs site we publish must follow this exact directory and file layout: <pre><code>&lt;site-root&gt;/\n    mkdocs.yml                # Site configuration (docs_dir points to tmp.mkdocs)\n    docs/                     # Raw source content (committed to git)\n        index.md                # Homepage\n        &lt;other .md files&gt;       # Documentation pages\n        &lt;folders&gt;/              # Organized documentation sections\n        assets/                 # Images and icons\n            logo.png              # Site logo (symlink or real file)\n            favicon.ico           # Site favicon (symlink or real file)\n        styles/                 # Custom CSS\n            styles.css            # Main stylesheet (symlink or real file)\n    tmp.mkdocs/               # Preprocessed content (DO NOT COMMIT)\n        index.md                # Processed files\n        &lt;other processed files&gt;\n        assets/                 # Copied assets\n        styles/                 # Copied styles\n</code></pre></p>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#file_descriptions","title":"File Descriptions","text":"<p><code>mkdocs.yml</code></p> <ul> <li>Main configuration file for the site</li> <li>Defines site name, theme, plugins, and markdown extensions</li> <li>Critical: <code>docs_dir: tmp.mkdocs</code> points to preprocessed content</li> </ul> <p><code>docs/</code></p> <ul> <li>Contains raw markdown files that you write and edit</li> <li>This is what gets committed to git</li> <li>Organized with folders for different documentation sections</li> </ul> <p><code>docs/assets/</code></p> <ul> <li>Logo, favicon, images, diagrams</li> <li>Should be symlinked to canonical versions (see below)</li> </ul> <p><code>docs/styles/</code></p> <ul> <li>Custom CSS for site styling</li> <li>Should be symlinked to canonical stylesheet</li> </ul> <p><code>tmp.mkdocs/</code></p> <ul> <li>Generated by the preprocessing script</li> <li>Never commit this directory to git (add to <code>.gitignore</code>)</li> <li>This is what MkDocs builds from</li> </ul>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#design_invariants","title":"Design Invariants","text":"<p>To maintain consistency across all our documentation sites, we follow these invariants:</p> <ol> <li>Unified Configuration</li> <li>All documentation sites reuse the same <code>mkdocs.yml</code> template</li> <li>Only <code>site_name</code>, <code>site_url</code>, and site-specific settings change</li> <li> <p>Blogs add the blog plugin but keep the same base structure</p> </li> <li> <p>Standardized Workflows</p> </li> <li>Only two GitHub workflow templates:<ul> <li>Documents workflow: For standard documentation (with preprocessing)</li> <li>Blog workflow: For blog posts (no preprocessing needed)</li> </ul> </li> <li> <p>Same logic with small variations for S3 vs GitHub Pages</p> </li> <li> <p>Consistent Structure</p> </li> <li>All sites follow the same directory layout</li> <li>Assets and styles in predictable locations</li> <li> <p>Preprocessing always outputs to <code>tmp.mkdocs/</code></p> </li> <li> <p>Shared Assets</p> </li> <li>Logo, favicon, and CSS should be symlinked from canonical sources</li> <li>This ensures consistency and single source of truth</li> <li>Changes propagate to all sites automatically</li> </ol>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#canonical_assets_and_css","title":"Canonical Assets and CSS","text":"<p>To ensure consistent branding and styling across all documentation sites, we maintain canonical versions of shared assets.</p>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#source_of_truth","title":"Source of Truth","text":"<p>The canonical assets are located in the helpers repository: <pre><code>helpers_root/docs/mkdocs/assets/logo.png\nhelpers_root/docs/mkdocs/assets/favicon.ico\nhelpers_root/docs/mkdocs/styles/styles.css\n</code></pre></p> <ul> <li>When creating a new documentation site, symlink rather than copy these files:</li> </ul> <p>Benefits of symlinking:</p> <ul> <li>Single source of truth for branding</li> <li>Updates to logo/favicon/styles propagate automatically</li> <li>No duplicate files to maintain</li> <li>Consistent appearance across all sites</li> </ul> <p>Verify symlinks:</p> <pre><code>ls -la docs/assets/\nls -la docs/styles/\n</code></pre> <p>You should see symlinks pointing to the helpers repository.</p>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#how_to_publish_documentation","title":"How to Publish Documentation","text":""},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#preview_locally","title":"Preview Locally","text":"<p>Before publishing, always preview your documentation locally to ensure it renders correctly.</p> <p>Step 1: Run preprocessing</p> <p>Navigate to your repository root and run the preprocessing script:</p> <pre><code>cd ~/src/your_repo\n\n# Run Preprocessing.\npython helpers_root/docs/mkdocs/preprocess_mkdocs.py \\\n    --input_dir docs \\\n    --output_dir tmp.mkdocs \\\n    -v INFO\n</code></pre> <p>Step 2: Activate the MkDocs environment</p> <pre><code>source \"$HOME/src/venv/mkdocs/bin/activate\"\n</code></pre> <p>Step 3: Navigate to your docs directory</p> <pre><code>cd your_docs_directory  # e.g., docs_mkdocs/ or the directory with mkdocs.yml\n</code></pre> <p>Step 4: Start the local server</p> <pre><code>mkdocs serve\n</code></pre> <p>Step 5: Open in browser</p> <ul> <li>The terminal will display the URL (typically <code>http://127.0.0.1:8000</code>)</li> <li>Open this URL in your browser</li> <li>The server supports live reload - changes will auto-refresh</li> </ul> <p>Step 6: Stop the server</p> <p>Press <code>Ctrl+C</code> when done previewing</p>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#publish_to_custom_domain_s3_instead_of_gh-pages","title":"Publish to Custom Domain (S3) (Instead of Gh-Pages)","text":"<p>Prerequisites:</p> <ul> <li>S3 bucket configured for static hosting</li> <li>AWS credentials configured in GitHub repository secrets</li> <li>CloudFront distribution (optional but recommended)</li> </ul> <p>Step 1: Set up GitHub Actions workflow</p> <p>Create and <code>.github/workflows/publish_docs.yml</code>:</p> <pre><code>name: Publish MkDocs\n\non:\n    push:\n        branches:\n            - master\n        paths:\n            - docs/**\n    workflow_dispatch:\n\npermissions:\n    id-token: write\n    contents: read\n\njobs:\n    deploy:\n        runs-on: ubuntu-latest\n        steps:\n            - uses: actions/checkout@v4\n                with:\n                    submodules: recursive # If using helpers as submodule.\n            - name: Setup Python\n                uses: actions/setup-python@v5\n                with:\n                    python-version: 3.x\n            - name: Install MkDocs\n                run: pip install mkdocs mkdocs-material\n            - name: Run preprocessing\n                run: |\n                    python helpers_root/docs/mkdocs/preprocess_mkdocs.py \\\n                        --input_dir docs \\\n                        --output_dir tmp.mkdocs \\\n                        -v INFO\n            - name: Build MkDocs\n                run: mkdocs build\n                working-directory: ./docs_mkdocs # Adjust to your structure.\n            - name: Configure AWS credentials\n                uses: aws-actions/configure-aws-credentials@v1\n                with:\n                    role-to-assume: ${{ vars.GH_ACTION_AWS_ROLE_ARN }}\n                    role-session-name: ${{ vars.GH_ACTION_AWS_SESSION_NAME }}\n                    aws-region: ${{ vars.CSFY_AWS_DEFAULT_REGION }}\n            - name: Publish to S3\n                run: |\n                    aws s3 sync ./docs_mkdocs/site s3://your-bucket-name --delete\n</code></pre> <p>The workflow will automatically run on push to master! Example: Csfy Repo docs Git Action</p>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#publish_to_github_pages","title":"Publish to Github Pages","text":"<p>Prerequisites:</p> <ul> <li>GitHub Pages enabled in repository settings</li> <li><code>gh-pages</code> branch will be created automatically</li> </ul> <p>Step 1: Set up GitHub Actions workflow</p> <p>Create <code>.github/workflows/publish_mkdocs.yml</code>:</p> <pre><code>name: Publish MkDocs\n\non:\n    push:\n        branches:\n            - master\n        paths:\n            - docs/**\n    workflow_dispatch:\n\npermissions:\n    contents: write\n\njobs:\n    deploy:\n        runs-on: ubuntu-latest\n        steps:\n            - uses: actions/checkout@v4\n                with:\n                    submodules: recursive # If using helpers as submodule.\n            - name: Configure Git Credentials\n                run: |\n                    git config user.name github-actions[bot]\n                    git config user.email 41898282+github-actions[bot]@users.noreply.github.com\n            - uses: actions/setup-python@v5\n                with:\n                    python-version: 3.x\n            - run: pip install mkdocs mkdocs-material\n            - name: Update PYTHONPATH\n                run: |\n                    echo \"PYTHONPATH=${{ github.workspace }}:${{ github.workspace }}/helpers_root\" &gt;&gt; $GITHUB_ENV\n            - name: Preprocess MkDocs\n                working-directory: ./docs/mkdocs # Adjust to your structure.\n                run: |\n                    python ../../helpers_root/docs/mkdocs/preprocess_mkdocs.py \\\n                        --input_dir docs \\\n                        --output_dir tmp.mkdocs\n            - run: mkdocs gh-deploy --force\n                working-directory: ./docs/mkdocs\n</code></pre> <p>Step 2: Enable GitHub Pages</p> <ol> <li>Go to repository Settings \u2192 Pages</li> <li>Source: Deploy from a branch</li> <li>Branch: <code>gh-pages</code> / <code>/ (root)</code></li> <li>Click Save</li> </ol> <p>Step 3: Commit and push</p> <pre><code>git add .github/workflows/publish_mkdocs.yml\ngit commit -m \"Add MkDocs GitHub Pages workflow\"\ngit push origin master\n</code></pre> <p>Step 4: Access your site</p> <p>After the workflow completes:</p> <ul> <li>Your site will be available at: <code>https://&lt;org&gt;.github.io/&lt;repo&gt;/</code></li> <li>Example: <code>https://causify-ai.github.io/helpers/</code></li> </ul>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#mkdocs_configuration","title":"Mkdocs Configuration","text":""},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#example_mkdocsyml","title":"Example Mkdocs.Yml","text":"<p>Here's a standard <code>mkdocs.yml</code> template used across all Causify documentation:</p> <pre><code>site_name: Your Site Name\n# Site_Url: Https://Yourdomain.Org/Yoursite # Optional: for Absolute Urls.\n\ntheme:\n    name: material\n    palette:\n        primary: black\n        accent: cyan\n    logo: assets/logo.png\n    favicon: assets/favicon.ico\n    features:\n        # - navigation.tabs\n        # - navigation.top\n        - content.action.edit  # Shows \"Edit this page\" link.\n\n# CRITICAL: Docs_Dir Must Point to Preprocessed Content.\ndocs_dir: tmp.mkdocs\n\n# Helps Render Images and Other Assets Correctly.\nuse_directory_urls: false\n\n# Plugins - Search Is Enabled by Default, but Must Be Explicit If You Add Others.\nplugins:\n    - search\n\n# Markdown Extensions for Enhanced Functionality.\nmarkdown_extensions:\n    - toc:\n            permalink: \"#\"\n            baselevel: 2\n            separator: \"_\"\n    - pymdownx.superfences:\n            custom_fences:\n                - name: mermaid\n                    class: mermaid\n                    format: !!python/name:pymdownx.superfences.fence_code_format\n\n# Custom CSS.\nextra_css:\n    - styles/styles.css\n</code></pre> <p>Example at: Helpers repo mkdocs</p>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#key_configuration_options","title":"Key Configuration Options","text":"<p><code>site_name</code></p> <ul> <li>Required: The name of your documentation site</li> <li>Appears in the browser title and site header</li> <li>Example: <code>\"Helpers Documentation\"</code>, <code>\"Causify Docs\"</code></li> </ul> <p><code>site_url</code></p> <ul> <li>Optional but recommended for SEO and absolute URLs</li> <li>Format: <code>https://yourdomain.com/path</code></li> <li>Not needed for GitHub Pages (auto-detected)</li> </ul> <p><code>theme</code></p> <ul> <li>We use Material theme for all documentation</li> <li>Colors: <code>primary: black</code>, <code>accent: cyan</code> (Causify brand colors)</li> <li>Logo and favicon paths relative to <code>docs_dir</code></li> </ul> <p><code>docs_dir</code></p> <ul> <li>CRITICAL: Must be <code>tmp.mkdocs</code> (preprocessed content)</li> <li>Never point directly to <code>docs/</code> - preprocessing is required</li> </ul> <p><code>use_directory_urls: false</code></p> <ul> <li>Ensures clean URLs work with S3 static hosting</li> <li>Pages are <code>page.html</code> instead of <code>page/index.html</code></li> <li>Required for S3/CloudFront setup</li> </ul> <p><code>plugins</code></p> <ul> <li><code>search</code>: Enables full-text search (include explicitly if adding others)</li> <li>For blogs, add the <code>blog</code> plugin here</li> </ul> <p><code>markdown_extensions</code></p> <ul> <li>Table of contents with permalink support</li> <li><code>pymdownx.superfences</code>: Code blocks with syntax highlighting and mermaid     diagrams</li> </ul> <p><code>extra_css</code></p> <ul> <li>Path to custom stylesheet (relative to <code>docs_dir</code>)</li> <li>Should point to <code>styles/styles.css</code> (symlinked from canonical)</li> </ul>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#preprocessing","title":"Preprocessing","text":""},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#what_preprocessing_does","title":"What Preprocessing Does","text":"<p>The preprocessing script (<code>preprocess_mkdocs.py</code>) transforms raw markdown files before MkDocs builds them. It performs:</p> <ol> <li>Removes table of contents blocks</li> <li>Strips content between markers</li> <li> <p>MkDocs generates its own navigation</p> </li> <li> <p>Dedents Python code blocks</p> </li> <li>Ensures code is properly aligned</li> <li> <p>Fixes indentation issues that break rendering</p> </li> <li> <p>Standardizes indentation</p> </li> <li>Converts 2-space indentation to 4 spaces</li> <li> <p>Maintains consistent code formatting</p> </li> <li> <p>Processes markdown syntax</p> </li> <li>Handles mermaid diagrams</li> <li>Processes PlantUML blocks</li> <li> <p>Other markdown transformations via <code>hmkdocs</code> helpers</p> </li> <li> <p>Copies and processes directory structure</p> </li> <li>Creates <code>tmp.mkdocs/</code> with all processed files</li> <li>Preserves directory structure</li> <li>Copies assets and styles</li> </ol>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#running_preprocessing_manually","title":"Running Preprocessing Manually","text":"<p>Basic usage:</p> <pre><code>python helpers_root/docs/mkdocs/preprocess_mkdocs.py \\\n    --input_dir docs \\\n    --output_dir tmp.mkdocs \\\n    -v INFO\n</code></pre>"},{"location":"blogging/all.publish_mkdocs.how_to_guide.html#examples","title":"Examples","text":"<p>Causify Documentation (S3 + Custom Domain):</p> <ul> <li>Repository:     https://github.com/causify-ai/csfy</li> <li>Live site: https://docs.causify.ai (VPN required)</li> <li>Workflow: <code>.github/workflows/publish_mkdocs.yml</code></li> <li>Configuration: <code>docs_mkdocs/mkdocs.yml</code></li> </ul> <p>Helpers Documentation (GitHub Pages):</p> <ul> <li>Repository:     https://github.com/causify-ai/helpers</li> <li>Live site:     https://causify-ai.github.io/helpers</li> <li>Workflow: <code>.github/workflows/publish_mkdocs.yml</code></li> <li>Configuration: <code>/docs/mkdocs/mkdocs.yml</code></li> <li>Example:     https://github.com/causify-ai/helpers/blob/master/docs/mkdocs/mkdocs.yml</li> </ul> <p>Causify Blog (S3 + Custom Domain):</p> <ul> <li>Repository:     https://github.com/causify-ai/csfy</li> <li>Live site: https://blog.causify.ai</li> <li>Workflow: <code>.github/workflows/publish_blog.yml</code></li> <li>Configuration: <code>blog/mkdocs.yml</code></li> <li>Note: Blogs don't use preprocessing</li> </ul>"},{"location":"blogging/all.write_blog.how_to_guide.html","title":"All.write blog.how to guide","text":""},{"location":"blogging/all.write_blog.how_to_guide.html#how_to_write_a_blog_for_causify","title":"How to Write a Blog for Causify","text":"<p>Writing a blog at Causify is about communicating our ideas clearly, while re-using and connecting with the broader body of internal documentation, white papers, tutorials, and research notes we already create. This guide explains how blogs fit into our documentation ecosystem, what principles to follow, and provides a checklist to get started.</p>"},{"location":"blogging/all.write_blog.how_to_guide.html#position_of_blogs_in_our_documentation_ecosystem","title":"Position of Blogs in Our Documentation Ecosystem","text":"<ul> <li>There is often overlap between:<ul> <li>Internal white papers (aka an internal report)</li> <li>Journal / conference papers</li> <li>Blogs</li> <li>Internal documentation</li> <li>Research Google Docs</li> </ul> </li> </ul>"},{"location":"blogging/all.write_blog.how_to_guide.html#invariants","title":"Invariants","text":"<ul> <li>Internal documentation: Contains all the information at maximum detail,     organized using the Diataxis framework</li> <li>Internal white paper: Abstracted version of internal documentation,     emphasizing architecture and high-level results</li> <li>Journal / conference paper: A succinct and highly structured version of a     white paper</li> <li>Blog: Often the union of several documentation pieces. A blog should give a     high-level view of the work and why it matters.<ul> <li>Point to detailed technical resources (internal docs, repos, tutorials)     instead of duplicating them.</li> <li>Do a comparison with the state-of-the-art (SOTA), and explain why our     approach is better, different, or more practical.</li> <li>Keep it accessible as blogs are not white papers.</li> </ul> </li> <li>Research Google Docs: Living documents to store ongoing project information     before being consolidated.</li> </ul> <p>Note: It is common for a project to start with a blog and then evolve into a journal/conference paper.</p>"},{"location":"blogging/all.write_blog.how_to_guide.html#practical_guidelines_for_blogs","title":"Practical Guidelines for Blogs","text":"<ul> <li>Level of detail<ul> <li>Blogs should stay at a high level</li> <li>Only go deep if it is explicitly a tutorial-style blog</li> </ul> </li> <li>References<ul> <li>Always link to technical resources (internal docs, repos, code, or white     papers) for implementation details.</li> </ul> </li> <li>Comparisons<ul> <li>Compare against SOTA or industry norms, and clearly explain why our approach     is novel, impactful, or more effective.</li> </ul> </li> <li>Workflow &amp; Tools<ul> <li>Markdown first: When writing technical blogs (that don\u2019t need exec input),     keep everything in markdown and work directly in GitHub.<ul> <li>Easier to manage diffs, PRs, reviews, and formatting.</li> <li>Enables diagrams via Mermaid, and integration with internal rendering     tools.</li> </ul> </li> <li>Google Docs only if needed: Use Google Docs when we need broader     collaboration (e.g., exec reviews, heavy commenting).<ul> <li>Conversion tools exist to move from GDocs \u2192 Markdown.</li> </ul> </li> </ul> </li> <li>Assets and Diagrams<ul> <li>Use <code>./helpers_root/dev_scripts_helpers/documentation/render_images.py</code> to     render images/diagrams.</li> </ul> </li> </ul>"},{"location":"blogging/all.write_blog.how_to_guide.html#checklist_for_preparing_a_blog_file_in_a_github_issue","title":"Checklist for Preparing a Blog (File in a Github Issue)","text":"<p>When starting a blog on a project, open a GitHub Issue and track the following:</p>"},{"location":"blogging/all.write_blog.how_to_guide.html#learn_how_we_write_and_organize_documentation","title":"Learn How We Write and Organize Documentation","text":"<ul> <li>[ ] Read docs in [<code>//helpers/docs/documentation_meta</code>]<ul> <li>[ ] [<code>//helpers/docs/documentation_meta/all.diataxis.explanation.md</code>]</li> <li>[ ] [<code>//helpers/docs/documentation_meta/all.google_technical_writing.how_to_guide.md</code>]</li> <li>[ ] [`//helpers/docs/documentation_meta/all.writing_docs.how_to_guide.md]</li> </ul> </li> </ul>"},{"location":"blogging/all.write_blog.how_to_guide.html#learn_our_style_and_tooling","title":"Learn Our Style and Tooling","text":"<ul> <li>Read rules enforced by <code>linter</code> and <code>ai_review.py</code><ul> <li>[ ] Read ./docs/code_guidelines/all.coding_style_guidelines.reference.md</li> </ul> </li> </ul>"},{"location":"blogging/all.write_blog.how_to_guide.html#learn_how_we_organize_projects_and_tutorials","title":"Learn How We Organize Projects and Tutorials","text":"<ul> <li>[ ] Read [<code>//tutorials/class_project_instructions/README.md</code>]</li> <li>[ ] Read [<code>//tutorials/docs/all.learn_X_in_60_minutes.how_to_guide.md</code>]</li> </ul>"},{"location":"blogging/all.write_blog.how_to_guide.html#read_examples_of_past_blogs","title":"Read Examples of Past Blogs","text":"<ul> <li>[ ] [<code>//tutorials/blogs</code>]</li> </ul>"},{"location":"blogging/all.write_blog.how_to_guide.html#apply_blog-specific_best_practices","title":"Apply Blog-Specific Best Practices","text":"<ul> <li>[ ] Keep content at a high level (unless it\u2019s a tutorial).</li> <li>[ ] Link to internal docs, repos, or white papers for details.</li> <li>[ ] Compare against SOTA and articulate why our work is different/better.</li> <li>[ ] Decide workflow:<ul> <li>[ ] Markdown-first (default)</li> <li>[ ] Google Docs (if executive review required)</li> </ul> </li> <li>[ ] Use image rendering tools (<code>render_images.py</code>) or Mermaid for diagrams.</li> <li>[ ] If using GDocs, plan for Markdown conversion before publication.</li> </ul>"},{"location":"blogging/all.write_blog.how_to_guide.html#summary","title":"Summary","text":"<p>A Causify blog is not just a write-up, it\u2019s a way of:</p> <ul> <li>Communicating why a project matters,</li> <li>Placing our work in the context of SOTA, and</li> <li>Connecting readers to deeper resources if they want details.</li> </ul> <p>By following this guide and checklist, contributors can ensure our blogs are consistent, informative, and impactful.</p>"},{"location":"build_system/all.gitleaks_workflow.explanation.html","title":"All.gitleaks workflow.explanation","text":""},{"location":"build_system/all.gitleaks_workflow.explanation.html#gitleaks_integration_in_github_actions","title":"Gitleaks Integration in GitHub Actions","text":"<ul> <li>For more information on Gitleaks, refer to the following documentation:<ul> <li>/docs/tools/git/all.gitleaks.reference.md</li> <li>/docs/tools/git/all.gitleaks.how_to_guide.md</li> </ul> </li> </ul>"},{"location":"build_system/all.gitleaks_workflow.explanation.html#feature","title":"Feature","text":"<ul> <li>Automatic Scanning: Gitleaks runs automatically on every pull request to     the master branch and for every push to the master branch. This ensures that     new code is checked before merging</li> <li>Scheduled Scans: Gitleaks scans are scheduled to run once a day, ensuring     regular codebase checks even without new commits</li> <li>Workflow Dispatch: Allows for manual triggering of the Gitleaks scan,     providing flexibility for ad-hoc code analysis</li> </ul>"},{"location":"build_system/all.gitleaks_workflow.explanation.html#setup","title":"Setup","text":"<ul> <li>GitHub Action Workflow: The Gitleaks integration is set up as a part of     the GitHub Actions workflow in the <code>.github/workflows/gitleaks.yml</code> file in     each repo</li> <li>Gitleaks rules: The rules for Gitleaks used by the workflow are specified     in <code>.github/gitleaks-rules.toml</code></li> <li>Running Environment: The workflow runs on <code>ubuntu-latest</code> and uses GitHub     action <code>gitleaks/gitleaks-action@v2</code> available on the marketplace</li> </ul>"},{"location":"build_system/all.gitleaks_workflow.explanation.html#notification","title":"Notification","text":"<ul> <li>Slack: Sends a message to the <code>build-notifications</code> Slack channel when the     workflow fails (e.g., when leaks are detected)</li> </ul>"},{"location":"build_system/all.gitleaks_workflow.explanation.html#additional_resource","title":"Additional Resource","text":"<ul> <li>The official GitHub page for Gitleaks -     https://github.com/gitleaks/gitleaks</li> <li>For more information about how Gitleaks functions in GH Actions -     https://github.com/gitleaks/gitleaks-action/tree/master</li> <li>The custom ruleset was based on -     https://github.com/mazen160/secrets-patterns-db</li> </ul>"},{"location":"build_system/all.linter_gh_workflow.explanation.html","title":"All.linter gh workflow.explanation","text":""},{"location":"build_system/all.linter_gh_workflow.explanation.html#linter_gh_workflow","title":"Linter Gh Workflow","text":""},{"location":"build_system/all.linter_gh_workflow.explanation.html#linter_github_action_workflow_explanation","title":"Linter Github Action Workflow Explanation","text":""},{"location":"build_system/all.linter_gh_workflow.explanation.html#overview","title":"Overview","text":"<ul> <li>We want to use linter for all the new code that needs to be merged into the     <code>master</code> branch</li> <li>This is implemented by running the GitHub Actions workflow, <code>linter.yml</code>,     which is executed against the changed or added files in the branch</li> <li>If the linter detects changes in the new files, it indicates that the linter     did not run before.</li> <li>In this case, the workflow will fail, and will not allow the PR to be merged</li> </ul>"},{"location":"build_system/all.linter_gh_workflow.explanation.html#how_it_works","title":"How It Works","text":""},{"location":"build_system/all.linter_gh_workflow.explanation.html#fetch_master_branch","title":"Fetch Master Branch","text":"<p>In order to compare the changed files in the PR with the latest master branch, fetch the latest master, e.g.,</p> <pre><code>invoke git_fetch_master\n</code></pre>"},{"location":"build_system/all.linter_gh_workflow.explanation.html#run_the_linter_and_check_the_linter_results","title":"Run the Linter and Check the Linter Results","text":"<ul> <li>Run the linter against the changed files in the PR branch</li> </ul> <pre><code>invoke lint --branch\n</code></pre> <ul> <li>Check if the git client is clean</li> </ul> <pre><code>git status\n</code></pre> <ul> <li>If the git client is not clean, abort the execution and the workflow will fail</li> <li>If the git client is clean, the workflow will exit successfully</li> </ul> <p>Invoke task for this action is:</p> <pre><code>invoke lint_check_if_it_was_run\n</code></pre>"},{"location":"build_system/all.pytest_allure.explanation.html","title":"All.pytest allure.explanation","text":""},{"location":"build_system/all.pytest_allure.explanation.html#pytest_allure_-_explanation","title":"Pytest Allure - Explanation","text":""},{"location":"build_system/all.pytest_allure.explanation.html#overview","title":"Overview","text":"<ul> <li>Allure Report boosts collaboration and project quality by providing clear,     detailed test reports that aid issue resolution for different team members</li> <li>The goal is to set up all our tests to generate and publish this report</li> <li>Here is the demo report     from allure</li> <li>The simplified flow for the Allure report is:</li> </ul> <pre><code>flowchart TD\n\nsubgraph A1[\" \"]\ndirection LR\n        A[Run tests and generate\\nthe Allure output] --&gt; B[(Backup the Allure output\\nto the AWS S3 bucket)]\n        B --&gt; C(Copy last history\\nfrom the S3 bucket\\nto the Allure output folder)\nend\nsubgraph B1[\" \"]\ndirection LR\n        D[Generate the HTML-report\\nfrom the Allure output] --&gt; E[(Publish the HTML-report\\nto the S3 HTML bucket)]\nend\nA1 ==&gt; B1 ==&gt; C1[View the report in the browser]</code></pre>"},{"location":"build_system/all.pytest_allure.explanation.html#core_features","title":"Core Features","text":""},{"location":"build_system/all.pytest_allure.explanation.html#rich_and_interactive_reports","title":"Rich and Interactive Reports","text":"<ul> <li>Allure generates visually appealing and interactive HTML reports, making it     easy to analyze test results</li> <li>Reports include detailed information about test cases, steps, attachments, and     more</li> </ul>"},{"location":"build_system/all.pytest_allure.explanation.html#annotations_and_labels","title":"Annotations and Labels","text":"<ul> <li>Allure uses annotations and labels to provide additional information about     test methods, making it easier to understand and categorize test results</li> <li>Annotations are used to mark and describe test methods, and labels help in     categorizing and filtering tests</li> </ul>"},{"location":"build_system/all.pytest_allure.explanation.html#test_history_and_trends","title":"Test History and Trends","text":"<ul> <li>Allure maintains a history of test runs, allowing you to track changes in test     results over time</li> <li>Trends and statistics help identify patterns, improvements, or regressions in     the application's behavior</li> </ul>"},{"location":"build_system/all.pytest_allure.explanation.html#key_components","title":"Key Components","text":""},{"location":"build_system/all.pytest_allure.explanation.html#pytest_plugin_for_the_allure_output_generation","title":"Pytest Plugin for the Allure Output Generation","text":"<p>In order to generate the Allure output, we need to install the <code>allure-pytest</code> plugin. For the time and efforts saving reasons, we will install it on-the-fly in the container where we will run the tests. This feature is introduced as the <code>allure_dir</code> parameter to the <code>run_&lt;type&gt;_tests</code> tasks. If specified the <code>allure-pytest</code> plugin will be installed and the results will be stored in the specified directory.</p>"},{"location":"build_system/all.pytest_allure.explanation.html#allure_reporting_tool","title":"Allure Reporting Tool","text":"<p>The CLI utility for generating Allure reports creates an HTML report from the Allure output. We'll install this utility using GitHub Actions workflow to generate the HTML report.</p>"},{"location":"build_system/all.pytest_allure.explanation.html#how_it_works","title":"How It Works","text":"<ul> <li>Allure Report is composed of a framework(pytest) adapter and the allure     command-line utility</li> <li>Run the tests with pytest options <code>--alluredir=allure-results</code> to store the     results</li> <li>The generated files include:<ul> <li>Test result files     to describe execution of tests</li> <li>Container files     to describe test fixtures</li> </ul> </li> <li>If required, add additional files to the <code>allure-results</code> to display     additional info in the report</li> <li>Additional files includes:<ul> <li>Environment file     to store some global data for all the tests in the report</li> <li>History files     to enable trend graphs and other history-related features</li> <li>Categories file     to group test results into custom categories</li> </ul> </li> <li>Use <code>allure generate</code> to generate the test report into the specified     directory. For e.g.: <code>allure generate allure-report</code></li> </ul>"},{"location":"build_system/all.pytest_allure.explanation.html#historical_trends","title":"Historical Trends","text":"<p>A test report generated by Allure can not only display data about the latest test launch, but also help you compare it with the data from previous reports. To do so, Allure can keep a history or previous reports.</p> <p>In a tests report with the history included, you can:</p> <ul> <li>See what statuses did a test have previously (see Details panel \u2192 History tab)</li> <li>Find tests that changed status since last report (see Sorting and filtering \u2192     Filter tests by marks)</li> <li>See how specific values change over time (see Graphs)</li> </ul>"},{"location":"build_system/all.pytest_allure.how_to_guide.html","title":"All.pytest allure.how to guide","text":""},{"location":"build_system/all.pytest_allure.how_to_guide.html#pytest_allure","title":"Pytest Allure","text":""},{"location":"build_system/all.pytest_allure.how_to_guide.html#how_to_run_the_flow_end-to-end_via_gh_actions","title":"How to Run the Flow End-To-End Via GH Actions","text":"<p>Considering that we run the tests on the <code>cmamp</code> repo with the fast <code>tests</code> group</p> <p>Important note: Unlike usual test run, we don't stop the execution on failure. For this we use the <code>continue-on-error: true</code> in the GitHub action step.</p> <p>Here is the link to the GitHub action file.</p>"},{"location":"build_system/all.pytest_allure.how_to_guide.html#how_to_generate_allure-pytest_results","title":"How to Generate Allure-Pytest Results","text":"<p>To save Allure results after a test run, append <code>--allure-dir</code> parameter to a <code>pytest</code> cmd, e.g.,</p> <pre><code>i run_fast_tests ... --allure-dir ./allure_results\n</code></pre> <p>where <code>allure-dir</code> is the directory where the Allure results will be stored.</p>"},{"location":"build_system/all.pytest_allure.how_to_guide.html#how_to_backup_the_allure_results","title":"How to Backup the Allure Results","text":"<p>To backup the Allure results, copy the <code>allure_results</code> directory to a AWS S3 bucket, e.g.,</p> <pre><code>aws s3 cp allure_results s3://cryptokaizen-unit-test/allure_test/cmamp/fast/results.20231120_102030 --recursive\n</code></pre> <p>where:</p> <ul> <li><code>allure_results</code> is the directory where the Allure results are stored</li> <li><code>20231120_102030</code> is the date and time with the mask <code>%Y%m%d_%H%M%S</code></li> <li><code>cmamp</code> is the name of the GitHub repo</li> <li><code>fast</code> is the name of the tests group</li> </ul>"},{"location":"build_system/all.pytest_allure.how_to_guide.html#how_to_generate_allure_html-report","title":"How to Generate Allure Html-Report","text":"<ul> <li>Whenever Allure generates a test report in a specified directory i.e.     <code>allure-report</code> (refer to the     \"How it works\" section), it     concurrently produces data inside the history subdirectory</li> <li>The JSON files within the history subdirectory preserve all the necessary     information for Allure to use the data from this test report into the next     test report, see     History files</li> </ul> <p>To install the Allure CLI utility, refer to the official docs.</p> <p>In order to generate the HTML report, run the following command: <pre><code>allure generate allure_results -o allure_report\n</code></pre></p> <p>where:</p> <ul> <li><code>allure_results</code> is the directory where the Allure results are stored</li> <li><code>allure_report</code> is the directory where the Allure HTML-report will be stored</li> </ul> <p>TODO(Vlad): Come up with a clean-up strategy for the S3 bucket.</p>"},{"location":"build_system/all.pytest_allure.how_to_guide.html#keep_the_history_of_test_runs","title":"Keep the History of Test Runs","text":"<ul> <li>To activate the features related to history, copy the history subdirectory     from the previous report into the latest test results directory before     generating the subsequent test report</li> <li>Here is an example of how to do it, assuming that your project is configured     to use <code>allure-results</code> and <code>allure-report</code> directories:<ul> <li>Make sure you have the previous report generated in the <code>allure-report</code>     directory</li> <li>Remove the <code>allure-results</code> directory</li> <li>Run the tests with the option <code>--allure-dir allure_results</code></li> <li>Copy the <code>allure-report/history</code> subdirectory to <code>allure-results/history</code></li> <li>Generate the new report</li> </ul> </li> </ul> <p>To copy the history subdirectory from the previous run to the <code>allure_results</code>:</p> <pre><code>aws s3 cp s3://cryptokaizen-html/allure_reports/cmamp/fast/report.20231120_102030/history allure_results/history --recursive\n</code></pre>"},{"location":"build_system/all.pytest_allure.how_to_guide.html#how_to_publish_the_allure-html_report","title":"How to Publish the Allure-Html Report","text":"<p>To publish the Allure report, copy the <code>allure_report</code> directory to a AWS S3 bucket, e.g.,</p> <pre><code>aws s3 cp allure_report s3://cryptokaizen-html/allure_reports/cmamp/fast/report.20231120_102030 --recursive\n</code></pre> <p>where:</p> <ul> <li><code>allure_report</code> is the directory where the Allure HTML-report will be stored</li> <li><code>20231120_102030</code> is the date and time with the mask <code>%Y%m%d_%H%M%S</code></li> <li><code>cmamp</code> is the name of the GitHub repo</li> <li><code>fast</code> is the name of the tests group</li> </ul> <p>For e.g., to access the HTML-report open this link on a browser: http://172.30.2.44/allure_reports/cmamp/fast/report.20231120_102030</p>"},{"location":"build_system/all.semgrep_workflow.explanation.html","title":"All.semgrep workflow.explanation","text":""},{"location":"build_system/all.semgrep_workflow.explanation.html#semgrep_integration_in_github_actions","title":"Semgrep Integration in GitHub Actions","text":""},{"location":"build_system/all.semgrep_workflow.explanation.html#overview","title":"Overview","text":"<p>This document provides an overview and guidance on the integration of Semgrep, a static analysis tool, into the GitHub Actions workflow. Semgrep is used for identifying issues and vulnerabilities in the codebase automatically during the development process.</p>"},{"location":"build_system/all.semgrep_workflow.explanation.html#features","title":"Features","text":"<ul> <li>Automatic Scanning: Semgrep runs automatically on every pull request to     the <code>master</code> branch and for every push to the <code>master</code> branch. This ensures     that new code is checked before merging.</li> <li>Scheduled Scans: Additionally, Semgrep scans are scheduled to run once a     day, ensuring regular codebase checks even without new commits.</li> <li>Workflow Dispatch: The integration allows for manual triggering of the     Semgrep scan, providing flexibility for ad-hoc code analysis.</li> </ul>"},{"location":"build_system/all.semgrep_workflow.explanation.html#setup","title":"Setup","text":"<ul> <li>GitHub Action Workflow: The Semgrep integration is set up as a part of the     GitHub Actions workflow in the <code>semgrep.yml</code>     file.</li> <li>Running Environment: The workflow runs on <code>ubuntu-latest</code> and uses the     <code>returntocorp/semgrep</code> container.</li> <li>Semgrep Rules: The current configuration uses the <code>p/secrets</code> rule pack     from Semgrep, focusing on detecting secrets and sensitive information     inadvertently committed to the repository.</li> </ul>"},{"location":"build_system/all.semgrep_workflow.explanation.html#exclusions","title":"Exclusions","text":""},{"location":"build_system/all.semgrep_workflow.explanation.html#semgrepignore_file","title":"<code>.semgrepignore</code> File","text":"<ul> <li>To optimize the scanning process, a <code>.semgrepignore</code> file     is placed in the root directory. This file functions similarly to     <code>.gitignore</code>, specifying files and paths that Semgrep should ignore during     scans. This is useful for excluding third-party libraries, or any other     non-relevant parts of the codebase from the scan.</li> </ul>"},{"location":"build_system/all.semgrep_workflow.explanation.html#ignoring_specific_lines","title":"Ignoring Specific Lines","text":"<ul> <li>To exclude a specific line of code from Semgrep analysis, append the comment     <code># nosemgrep</code> to the end of the line. This directive instructs Semgrep to     bypass that particular line, allowing developers to suppress false positives     or exclude non-relevant code snippets from analysis.</li> </ul>"},{"location":"build_system/all.semgrep_workflow.explanation.html#notifications","title":"Notifications","text":"<ul> <li>Failure Notifications: In case of scan failures on the <code>master</code> branch, a     Telegram notification is sent. This includes details such as the workflow     name, repository, branch, event type, and a link to the GitHub Actions run.</li> </ul>"},{"location":"build_system/all.semgrep_workflow.explanation.html#running_semgrep_locally","title":"Running Semgrep Locally","text":"<p>To run Semgrep locally for testing before pushing your changes:</p> <ol> <li>Install Semgrep on your local machine. Instructions can be found at    Semgrep Installation Guide.</li> <li>Run <code>semgrep --config=p/secrets</code> in your project directory to execute the    same rules as the CI/CD pipeline.</li> </ol>"},{"location":"build_system/all.semgrep_workflow.explanation.html#additional_resources","title":"Additional Resources","text":"<ul> <li>For more details on Semgrep rules and usage, visit the     Semgrep Official Documentation.</li> <li>To understand GitHub Actions configuration, refer to the     GitHub Actions Documentation.</li> </ul>"},{"location":"build_system/all.semgrep_workflow.explanation.html#conclusion","title":"Conclusion","text":"<p>The Semgrep integration into the GitHub Actions workflow provides an essential layer of code quality and security checks, aligning with the commitment to maintaining a robust and secure codebase.</p>"},{"location":"code_guidelines/all.code_design.how_to_guide.html","title":"All.code design.how to guide","text":""},{"location":"code_guidelines/all.code_design.how_to_guide.html#code_design","title":"Code Design","text":""},{"location":"code_guidelines/all.code_design.how_to_guide.html#design_philosophy","title":"Design Philosophy","text":""},{"location":"code_guidelines/all.code_design.how_to_guide.html#measure_seven_times_cut_once_russian_proverb","title":"Measure Seven Times, Cut Once (Russian Proverb)","text":"<ul> <li> <p>Before doing any work, sit down and plan</p> <ul> <li>Describe somewhere in writing your high-level plan. Put it in a Google doc     to make it easier to collaborate and review.<ul> <li>What should the code do?</li> <li>What are the functionalities you want to implement?</li> <li>What are the functionalities you don't want to implement? (what are you     explicitly considering to be out-of-scope?)</li> <li>What is more important, what is less important? E.g., in terms of P0, P1,     P2</li> <li>What are the requirements/invariants?</li> <li>What are the semantics of the entities involved?</li> <li>What are the analyses, the comparisons, and the plots?</li> <li>What are the ideas (expressed without any code!)?</li> <li>ETA: Spend quality time thinking about it (e.g., 30 mins, 1 hr)</li> </ul> </li> <li>Review the plan<ul> <li>Look at the plan again with fresh eyes (e.g., go for a 5-min walk)</li> <li>Does the plan make sense?</li> <li>What can you remove?</li> <li>Can you make things simpler?</li> <li>What is not elegant?</li> <li>What entity is a special case of another?</li> <li>What is similar to what?</li> <li>ETA: Spend 30 mins thinking</li> </ul> </li> <li>Ask for someone to review the plan<ul> <li>Don't be ashamed of asking for advice</li> </ul> </li> <li>Implement a design<ul> <li>Transform the plan into high-level code, e.g.,<ul> <li>What are the objects / functions involved?</li> <li>What are the responsibilities of each class / function?</li> <li>What are the code invariants?</li> <li>What are the data structures?</li> </ul> </li> <li>Write the interfaces<ul> <li>Only the interfaces! Refrain from implementing the logic</li> <li>Comment the interfaces clearly</li> </ul> </li> <li>Think of how the objects / functions interact (who does what, what is the     data passed around)</li> <li>Sprinkle TODOs with ideas about potential problems, simpler approaches</li> <li>ETA: Spend 1/2 day, 1 day</li> </ul> </li> <li>Do a PR of the design</li> <li>Once we converge on the design:<ul> <li>Implement the functions</li> <li>Unit test</li> <li>PR</li> </ul> </li> </ul> </li> <li> <p>Remember:</p> <ul> <li>We want to do quick interactions: every day there is communication, update     and discussion</li> <li>Do not disappear for one week and come back with something that makes sense     only to you, or that you didn't get buy-in from others on</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_design.how_to_guide.html#hacker_laws","title":"Hacker Laws","text":"<ul> <li>A list of interesting \"laws\" (some are more rule of thumbs / heuristics)     related to computing:<ul> <li>hacker-laws</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_design.how_to_guide.html#keep_it_simple","title":"Keep It Simple","text":"<ul> <li>Follow the KISS principle.</li> <li>Pursue simple, elegant solutions. Some things are inherently complex, but even     complex systems can (and should) be broken down into simple pieces.</li> <li>Designs that are simple are easier to<ul> <li>Understand</li> <li>Modify</li> <li>Debug</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_design.how_to_guide.html#tips_from_a_pro","title":"Tips From a Pro","text":"<ul> <li>Adapted from     these slides     from a Stanford talk given by     Jeff Dean     (the Chuck Norris of SWE)</li> </ul>"},{"location":"code_guidelines/all.code_design.how_to_guide.html#designing_software_systems_is_tricky","title":"Designing Software Systems Is Tricky","text":"<ul> <li>Need to balance:<ul> <li>Simplicity [note that this comes first!]</li> <li>Scalability</li> <li>Performance</li> <li>Reliability</li> <li>Generality</li> <li>Features [note that this comes last!]</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_design.how_to_guide.html#get_advice_early","title":"Get Advice Early!","text":"<ul> <li>Get advice<ul> <li>Before you write any code</li> <li>Before you write any lengthy design documents [notice the implicit     assumption that there is a design documented!]</li> </ul> </li> <li>Before writing a doc or code<ul> <li>Jot down some rough ideas (a few paragraphs)</li> <li>Chat about the design with colleagues</li> <li>Consider discussing multiple potential designs</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_design.how_to_guide.html#interfaces","title":"Interfaces","text":"<ul> <li>Think carefully about interfaces in your system!<ul> <li>Imagine other hypothetical clients trying to use your interface</li> <li>Document precisely, but avoid constraining the implementation</li> <li>Get feedback on your interfaces before implementing!</li> <li>The best way to learn is to look at well-designed interfaces</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_design.how_to_guide.html#architecture","title":"Architecture","text":""},{"location":"code_guidelines/all.code_design.how_to_guide.html#use_design_patterns","title":"Use Design Patterns","text":"<ul> <li>Design patterns are     idioms or recipes for solving problems that commonly appear in software     engineering across projects and even languages. The classical introduction to     design patterns is the so-called \"Gang of Four\"     book.</li> <li>A free Python-focused reference is available     here.</li> <li>Expanding your knowledge of design patterns is a worthwhile investment,     because design patterns<ul> <li>Capture elegant solutions that have been developed by many experienced     programmers over a long period of time</li> <li>Provide a framework and reference point for software architecture</li> <li>Are widely used and well-known and therefore quickly recognized by skilled     programmers</li> </ul> </li> <li>In other words, by using design patterns, you<ul> <li>Don't have to re-invent the wheel</li> <li>Simplify the high-level picture of your code</li> <li>Make it easier for other people to understand your code</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_design.how_to_guide.html#functions","title":"Functions","text":""},{"location":"code_guidelines/all.code_design.how_to_guide.html#avoid_modifying_the_function_input","title":"Avoid Modifying the Function Input","text":"<ul> <li> <p>If, for example, a function <code>f</code> accepts a dataframe <code>df</code> as its (sole)     argument, then, ideally, <code>f(df)</code> will not modify <code>df</code>. If modifications are     desired, then instead one can do:</p> <p><code>python def f(df): df = df.copy() ... return df</code></p> <p>in the function so that <code>f(df)</code> returns the desired new dataframe without modifying the dataframe that was passed in to the function.</p> </li> <li> <p>In some cases the memory costs associated with the copy are prohibitive, and     so modifying in-place is appropriate. If such is the case, state it explicitly     in the docstring.</p> </li> <li> <p>Functions that do not modify the input are especially convenient to have in     notebook settings. In particular, using them makes it easy to write blocks of     code in a notebook that will return the same results when re-executed out of     order.</p> </li> </ul>"},{"location":"code_guidelines/all.code_design.how_to_guide.html#prefer_pure_functions_by_default","title":"Prefer Pure Functions by Default","text":"<ul> <li>Pure functions have two key     properties:<ul> <li>If the function arguments do not change, then the return value returned does     not change (in contrast to, e.g., functions that rely upon global state)</li> <li>Function evaluation does not have     side effects</li> </ul> </li> <li>Some nice properties enjoyed by pure functions are:<ul> <li>They are easy to understand and easy to test</li> <li>Using pure functions makes refactoring easier</li> <li>They allow chaining in an     elegant way</li> <li>They are often a natural choice for data manipulation and analysis</li> <li>They are convenient in notebooks</li> </ul> </li> <li>Though it is good to develop an appreciation for     functional programming,     and we like to adopt that style when appropriate, we recognize that it is not     pragmatic to dogmatically insist upon a functional style (especially in our     domain and when using Python).</li> </ul>"},{"location":"code_guidelines/all.code_design.how_to_guide.html#invariants","title":"Invariants","text":"<p>From ./oms/architecture.md</p> <p>Invariants and conventions</p> <ul> <li> <p>In this doc we use the new names for concepts and use \"aka\" to refer to the     old name, if needed</p> </li> <li> <p>We refer to:</p> </li> <li>The as-of-date for a query as <code>as_of_timestamp</code></li> <li>The actual time from <code>get_wall_clock_time()</code> as <code>wall_clock_timestamp</code></li> <li>Objects need to use <code>get_wall_clock_time()</code> to get the \"actual\" time</li> <li>We don't want to pass <code>wall_clock_timestamp</code> because this is dangerous</li> <li> <p>It is difficult to enforce that there is no future peeking when one object     tells another what time it is, since there is no way for the second object to     double check that the wall clock time is accurate</p> </li> <li> <p>We pass <code>wall_clock_timestamp</code> only when one \"action\" happens atomically but     it is split in multiple functions that need to all share this information.     This approach should be the exception to the rule of calling</p> </li> </ul> <p><code>get_wall_clock_time()</code></p> <ul> <li> <p>It's ok to ask for a view of the world as of <code>as_of_timestamp</code>, but then the     queried object needs to check that there is no future peeking by using     <code>get_wall_clock_time()</code></p> </li> <li> <p>Objects might need to get <code>event_loop</code></p> </li> <li> <p>TODO(gp): Clean it up so that we pass event loop all the times and event loop     has a reference to the global <code>get_wall_clock_time()</code></p> </li> <li> <p>The Optimizer only thinks in terms of dollar</p> </li> </ul>"},{"location":"code_guidelines/all.code_design.how_to_guide.html#our_approach_to_doing_things","title":"Our Approach to Doing Things","text":""},{"location":"code_guidelines/all.code_design.how_to_guide.html#roles_and_responsibilities","title":"Roles and Responsibilities","text":"<ul> <li> <p>How to communicate</p> <ul> <li>Slack for urgent stuff or interactive things (ideally on a small group chat)</li> <li>All the action happens in the GH issues<ul> <li>Update the Issues multiple times a day</li> </ul> </li> </ul> </li> <li> <p>RPs (responsible party), aka \"Tech leads\"</p> <ul> <li>Review / clean up the board once a week (before Mon meeting)</li> <li>Distribute / coordinate work in the teams</li> <li>Do first PR review</li> <li>Merge PRs (trivial or agreed upon)</li> <li>First line of defense for IT / dev issues<ul> <li>The best answer to any problem is a link to gdoc with the solution</li> </ul> </li> </ul> </li> <li> <p>Everybody to keep their Issues up to date in GH</p> <ul> <li>In the <code>In progress</code> and <code>Sprint Backlog</code></li> <li>Each issue has typically:<ul> <li>A single assignee</li> <li>A GH Project</li> <li>Maybe a label</li> </ul> </li> <li>Each Git branch should go with the corresponding Issue<ul> <li>E.g., <code>AmpTask2163_Implement_tiled_backtesting</code></li> <li><code>i git_issue_number</code>, <code>i git_create_branch -i XYZ</code></li> </ul> </li> <li>When you create a (draft) branch always create an associated PR<ul> <li>E.g., <code>i gh_create_pr</code></li> </ul> </li> <li>We like draft PRs to discuss architecture before unit testing</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_design.how_to_guide.html#good_practices","title":"Good Practices","text":"<ul> <li> <p>Good Issue reports</p> <ul> <li>What are you trying to achieve</li> <li>What are you doing (cmd line, setup)</li> <li>What is the error</li> <li>Why do you think things should work differently?</li> </ul> </li> <li> <p>\"One PR a day keeps the doctor away\"</p> <ul> <li>\"... keeps investors at bay\"</li> <li>At least 1 PR a day</li> <li>Draft architectural PR when in doubt     </li> <li>Break work in smaller chunks (multiple PRs per bug)</li> </ul> </li> <li> <p>Go for a skateboard</p> <ul> <li>= something that works end-to-end     </li> </ul> </li> <li> <p>1 PR per day</p> </li> <li>Even if it's not complete (do a draft)</li> <li>Update the bugs (at least) every day</li> <li>Ask questions if you have any doubt</li> <li>Always sync</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html","title":"All.code like pragmatic programmer.how to guide","text":""},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#code_like_pragmatic_programmer","title":"Code Like Pragmatic Programmer","text":""},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#a_pragmatic_philosophy","title":"A pragmatic philosophy","text":""},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_1_care_about_your_craft","title":"PP_Tip 1: Care about your craft","text":"<ul> <li>Why spending your life developing software unless you care doing it well?</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_2_think_about_your_work","title":"PP_Tip 2: Think! About your work","text":"<ul> <li>Turn off the autopilot and take control</li> <li>Constantly critique and evaluate your work</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_3_provide_options_dont_make_lame_excuses","title":"PP_Tip 3: Provide options, don't make lame excuses","text":"<ul> <li> <p>Things go wrong:</p> <ul> <li>Deliverables are late</li> <li>Unforeseen technical problems come up</li> <li>Specs are misunderstood</li> <li>...</li> </ul> </li> <li> <p>Don't be afraid to admit ignorance or error</p> </li> <li>Before saying that something cannot be done, consider what the other people     are likely to say<ul> <li>\"Have you tried this?\"</li> <li>\"Did you consider that?\"</li> <li>...</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#broken_windows","title":"Broken windows","text":"<ul> <li>= bad designs, wrong decisions, poor code, rotten software</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_4_dont_live_with_broken_windows","title":"PP_Tip 4: Don't live with broken windows","text":"<ul> <li>A broken window left un-repaired instills a sense of abandonment</li> <li>Don't live with broken windows un-repaired<ul> <li>If there is no time, board it up</li> <li>Take action to show that you are on top of the situation</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_5_be_a_catalyst_for_change","title":"PP_Tip 5: Be a catalyst for change","text":"<ul> <li> <p>Sometimes you know what is right, but if you ask for permissions you will be     slowed down</p> <ul> <li>Request for feedback</li> <li>Committees, budgets, ...</li> <li>It's the so-called \"startup fatigue\"</li> </ul> </li> <li> <p>It's easier to ask forgiveness, than it is to get permission</p> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_6_remember_the_big_picture","title":"PP_Tip 6: Remember the big picture","text":"<ul> <li>Projects slowly and inexorably get totally out of hand</li> <li>Missing a deadline happens one day at a time</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_7_make_quality_a_requirement_issue","title":"PP_Tip 7: Make quality a requirement issue","text":"<ul> <li>One of the requirements from the user should be \"how good do you want the     software to be?\"</li> <li>Good software today is better than perfect software tomorrow</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_8_invest_regularly_in_your_knowledge_portfolio","title":"PP_Tip 8: Invest regularly in your knowledge portfolio","text":"<ul> <li> <p>Your knowledge and experience are your most important professional assets</p> <ul> <li>Unfortunately they are expiring assets</li> </ul> </li> <li> <p>It's like investing for retirement</p> <ol> <li>Invest as a habit</li> <li>Study every day</li> <li>Diversify</li> <li>The more different things you know, the more valuable you are</li> <li>Balance conservative and high-risk / high-reward investments</li> <li>Don't put all the technical eggs in one basket</li> <li>Review and rebalance periodically</li> </ol> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_9_critically_analyze_what_you_read_and_hear","title":"PP_Tip 9: Critically analyze what you read and hear","text":"<ul> <li>Beware of media hype</li> <li>Beware of zealots who insist that their dogma provides the only answer</li> <li>A best seller book is not necessarily a good book</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_10_its_both_what_you_say_and_the_way_you_say_it","title":"PP_Tip 10: It's both what you say and the way you say it","text":"<ul> <li>Plan what you want to say: write an outline</li> <li>Choose the right moment</li> <li>Choose a style; if in doubt, ask)</li> <li>Make it look good</li> <li>Involve your audience in early drafts</li> <li>Be a listener</li> <li>Get back to people</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_10_remember_the_wisdom_acrostic","title":"PP_Tip 10: Remember the WISDOM acrostic","text":"<ul> <li>What do you Want them to learn?</li> <li>What is their Interest in what you've got to say?</li> <li>How Sophisticated are they?</li> <li>How much Detail do they want?</li> <li>Whom do you want to Own the information?</li> <li>How can you Motivate them to listen?</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#a_pragmatic_approach","title":"A pragmatic approach","text":""},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_11_dry_-_dont_repeat_yourself","title":"PP_Tip 11: DRY - Don't repeat yourself","text":"<ul> <li> <p>Every piece of information must have a:</p> <ul> <li>Single</li> <li>Unambiguous</li> <li>Authoritative representation within a system</li> </ul> </li> <li> <p>Information is duplicated in multiple places -&gt; maintenance nightmare</p> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_11_programs_knowledge","title":"PP_Tip 11: Programs = knowledge","text":"<ul> <li>Programs are made of knowledge (e.g., requirements, specifications, code,     internal and external documentation)</li> <li>Knowledge is unstable<ul> <li>Over time one gets better understanding of requirements</li> <li>Requirements change</li> <li>The solution to a problem changes over time<ul> <li>E.g., tests show that an algorithm is not general or does not work</li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_11_how_does_duplication_arise","title":"PP_Tip 11: How does duplication arise?","text":"<ul> <li> <p>There are 4 I's of duplication:</p> </li> <li> <p>Imposed</p> </li> <li>The environment seems to require duplication</li> <li>Inadvertent</li> <li>A developer does not realize that he/she is duplicating information</li> <li>Impatient</li> <li>A developer gets lazy and duplicates code because it is easy</li> <li>Inter-developer</li> <li>Multiple developers duplicate a piece of info</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_11_imposed_duplication","title":"PP_Tip 11: Imposed duplication","text":"<ul> <li> <p>Multiple representations of the same piece of info</p> <ul> <li>E.g., same info in two pieces of code written in different languages</li> <li>Solution: write a filter or code generator</li> </ul> </li> <li> <p>Internal documentation and code</p> <ul> <li>Solution: comments should not duplicate info present in the code</li> <li>Comments should be for why, code for how</li> </ul> </li> <li> <p>External documentation and code</p> <ul> <li>Solution: be careful, generate it automatically</li> </ul> </li> <li> <p>Language issues</p> <ul> <li>Some languages require duplication (e.g., C/C++ header vs cpp)</li> <li>Solution: at least warnings and errors are reported</li> <li>Do not duplicate comments in headers and code</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_11_inadvertent_duplication","title":"PP_Tip 11: Inadvertent duplication","text":"<ul> <li> <p>Un-normalized data structures</p> <ul> <li>E.g.,</li> <li>A <code>Truck</code> has a type, maker, a license plate, and a driver</li> <li>A <code>DeliveryRoute</code> has a route, a truck, and a driver</li> <li>Now if the driver of a truck is changed, this info needs to be changed in     two objects</li> <li>Solution: use a 3rd object to bind <code>DeliveryRoute</code>, <code>Truck</code>, <code>Driver</code></li> </ul> </li> <li> <p>Data elements that are mutually dependent for perf reason</p> <ul> <li>E.g., a line has <code>startPoint</code> and <code>endPoint</code>, and a field <code>length</code> is     redundant</li> <li>Solution: use accessors to read/write object attributes</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_11_impatient_duplication","title":"PP_Tip 11: Impatient duplication","text":"<ul> <li>The temptation is always to cut-and-paste code and then modify it<ul> <li>It increases the technical debt: shortcuts end up in long delays</li> <li>Solution: re-factor and then change it</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_11_inter-developer_duplication","title":"PP_Tip 11: Inter-developer duplication","text":"<ul> <li> <p>It is hard to detect</p> </li> <li> <p>Solutions:</p> <ul> <li>Encourage communication</li> <li>Do code reviews</li> <li>Project libraries: central place for utility and scripts (so one knows where     to look before writing a routine)</li> <li>Project librarian to supervise the reuse</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_12_make_it_easy_to_reuse","title":"PP_Tip 12: Make it easy to reuse","text":"<ul> <li>If something is not easy to find, use, reuse, people won't reuse</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#orthogonality","title":"Orthogonality","text":"<ul> <li>= independence, decoupling</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_13_eliminate_effects_between_unrelated_things","title":"PP_Tip 13: Eliminate effects between unrelated things","text":"<ul> <li>Systems are orthogonal when changes in one sub-system don't affect other     sub-systems<ul> <li>E.g., helicopter controls are not orthogonal</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_13_orthogonality_pros","title":"PP_Tip 13: Orthogonality: pros","text":"<ol> <li>Easier to change</li> <li>Changes are localized</li> <li>Changes are easier to be unit tested</li> <li>Gain productivity</li> <li>Less overlap means more useful function per unit of code</li> <li>Promote reuse</li> <li>Reduce risk</li> <li>Easier to change design</li> <li>Not being tied to a particular vendor / product / platform</li> </ol>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_13_how_to_maintain_orthogonality","title":"PP_Tip 13: How to maintain orthogonality","text":"<ol> <li>Avoid global state (e.g., singletons)</li> <li>Write shy code</li> <li>Modules / objects that don't reveal anything unnecessary</li> <li>Pass required context to modules, objects, functions</li> <li>Avoid coupling (e.g., law of Demeter)</li> <li>Always look for opportunities to refactor</li> <li>Reorganize</li> <li>Improve structure</li> <li>Increase orthogonality</li> </ol>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_14_there_are_no_final_decisions","title":"PP_Tip 14: There are no final decisions","text":"<ul> <li>Do not carve decisions into stone</li> <li>Think of them as being written on the sand</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_14_there_are_no_final_decisions_why","title":"PP_Tip 14: There are no final decisions: why","text":"<ol> <li>Requirements can change on us</li> <li>The first decision is not always the best one</li> <li>Change 3rd party components</li> </ol>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_15_use_tracer_bullets_to_find_the_target","title":"PP_Tip 15: Use tracer bullets to find the target","text":"<ul> <li>Ready, fire, aim!</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#analogy_between_shooting_bullets_in_the_dark_and_software_engineering","title":"Analogy between shooting bullets in the dark and software engineering","text":"<ul> <li> <p>How to shoot a bullet to a target in the dark?</p> <ol> <li>Open loop approach</li> <li>Compute all the interesting quantities (wind, angles, distance)</li> <li>Hope that the conditions don't change at all</li> <li>Closed loop approach</li> <li>Use tracer bullets</li> <li>They leave trace in the dark so one can see if they are hitting the    target</li> <li>If not, adjust the aim</li> <li>If they hit the target, other bullets will also hit the target</li> </ol> </li> <li> <p>Software engineering:</p> <ol> <li>Open loop approach</li> <li>Specify the system to death</li> <li>Closed loop approach</li> <li>Achieve end-to-end connection among components with minimal functionality</li> <li>Then adjust, re-aim, ... until you are on target</li> </ol> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_15_tracer_bullets_pros","title":"PP_Tip 15: Tracer bullets: pros","text":"<ul> <li>Users see something working early</li> <li>You have an integration platform, instead of big-bang integration</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_15_tracer_bullets_cons","title":"PP_Tip 15: Tracer bullets: cons","text":"<ul> <li>Tracer bullets don't always hit their target</li> <li>Still imagine the result using a waterfall approach</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_16_prototype_to_learn","title":"PP_Tip 16: Prototype to learn","text":"<ul> <li>The value of prototype lies not in the code produced, but in the lessons     learned</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_16_prototype_to_learn_cons","title":"PP_Tip 16: Prototype to learn: cons","text":"<ul> <li>Set the right expectations</li> <li>Make sure everyone understands that you are writing disposable code</li> <li>Otherwise management might insist on deploying the prototype or a cleaned up     version of it</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_16_tracer_code_vs_prototyping","title":"PP_Tip 16: Tracer code vs prototyping","text":"<ul> <li> <p>Prototype:</p> <ul> <li>When experimentation is done, the prototype is thrown away and it is     reimplemented using the lessons learned</li> <li>E.g., write prototype in Python and then code the production system in C++</li> </ul> </li> <li> <p>Tracer code:</p> <ul> <li>Build architectural template</li> <li>Components have minimal implementation</li> <li>Over time stubbed routines are completed</li> <li>The framework stays intact</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_17_program_close_to_the_problem_domain","title":"PP_Tip 17: Program close to the problem domain","text":"<ul> <li>Always try to write code using the vocabulary of the application domain</li> <li> <p>So you are free to concentrate on solving domain problems and ignore petty     implementation details</p> </li> <li> <p>Use mini-languages</p> <ul> <li>Other people can implement business logic</li> </ul> </li> <li>Code can issue domain specific errors</li> <li>Create metadata compiled or read-in by the main application</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_18_estimate_to_avoid_surprises","title":"PP_Tip 18: Estimate to avoid surprises","text":"<ul> <li> <p>All answers are estimates: some are more accurate than others</p> </li> <li> <p>Do we need a high accuracy or a ballpark figure?</p> <ul> <li>The unit of measurement of the estimate conveys a message about accuracy</li> <li>E.g., 130 working days vs 6 months</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_18_how_to_make_estimates","title":"PP_Tip 18: How to make estimates","text":"<ol> <li>Ask people that have done a similar project before</li> <li>Specify what's the scope of an estimate: \"under assumptions X and Y, the    estimate is Z\"</li> <li>Break the system in pieces, understand which parameters they take, assign a    value to each parameter</li> <li>Understand which are the critical parameters and try to estimate them    properly</li> <li>When estimates are wrong, understand why</li> </ol>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_19_iterate_the_schedule_with_the_code","title":"PP_Tip 19: Iterate the schedule with the code","text":"<ul> <li> <p>Management often wants a single estimate for the schedule before the project     starts</p> </li> <li> <p>In reality:</p> <ul> <li>Team</li> <li>Productivity</li> <li>Environment will determine the schedule</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_19_estimates_at_the_coffee_machine","title":"PP_Tip 19: Estimates at the coffee machine","text":"<ul> <li>Estimates given at the coffee machine will come back to haunt you</li> <li>When asked for an estimate, answer \"I'll get back to you\"</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#the_basic_tools","title":"The basic tools","text":""},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_20_keep_knowledge_in_plain_text","title":"PP_Tip 20: Keep knowledge in plain text","text":"<ul> <li> <p>The base material for a programmer is knowledge</p> </li> <li> <p>Knowledge is made of:</p> <ul> <li>Requirements</li> <li>Specifications</li> <li>Documentation</li> <li>Design</li> <li>Implementation</li> <li>Test</li> </ul> </li> <li> <p>The best format to store knowledge is plain text</p> </li> <li>Plain text can be manipulated manually and programmatically using virtually     any tool (e.g., source code control, editors, stand-alone filters)</li> <li>Human-readable self-describing data will outlive<ul> <li>All other forms of data; and</li> <li>The application that created it</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_21_use_the_power_of_command_shells","title":"PP_Tip 21: Use the power of command shells","text":"<ul> <li> <p>GUIs</p> <ul> <li>Are great</li> <li>Allow to do only what they were designed for</li> </ul> </li> <li> <p>In life one does not know what exactly will be needed</p> </li> <li>Shells allow to automate and combine tools in ways that one didn't intended or     planned for</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_22_use_a_single_editor_well","title":"PP_Tip 22: Use a single editor well","text":"<ul> <li>Better to know one editor very well than knowing many editors superficially</li> <li>Use the same editor for all editing tasks</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_23_always_use_source_code_control","title":"PP_Tip 23: Always use source code control","text":"<ul> <li>Source control is like an undo key, a time machine</li> <li>Use it always: even if you are a single person team, even if you are working     on a throw-away prototype</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_23_advantages_of_source_code_control","title":"PP_Tip 23: Advantages of source code control","text":"<ul> <li>It allows to answer questions like:<ul> <li>Who made changes to this line of code?</li> <li>What are the difference between this release and the previous one?</li> </ul> </li> <li>It allows to work on a new release, while fixing bugs in the previous (i.e.,     branches)</li> <li>It can connect to automatic repeatable builds and regressions</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_24_fix_the_problem_not_the_blame","title":"PP_Tip 24: Fix the problem, not the blame","text":"<ul> <li>No one writes perfect software so debugging will take up a major portion of     your day</li> <li>Attack debugging as a puzzle to be solved</li> <li>Avoid denial, finger pointing, lame excuses</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_25_dont_panic","title":"PP_Tip 25: Don't panic","text":"<ul> <li>Before you start debugging, adopt the right mindset:<ul> <li>Turn off defenses that protect your ego</li> <li>Tune out project pressure</li> <li>Get comfortable</li> </ul> </li> <li>Don't panic while you debug, even if you have your nervous boss or your client     breathing on your neck</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_25_how_to_debug","title":"PP_Tip 25: How to debug","text":"<ul> <li> <p>Don't waste time thinking \"this cannot happen\"</p> <ul> <li>Obviously it is happening</li> </ul> </li> <li> <p>Make the bug reproducible with a single command</p> <ul> <li>So you know you are fixing the right problem</li> <li>So you know when it is fixed</li> <li>You can easily add a unit test for that bug</li> </ul> </li> <li> <p>What could be causing the symptoms?</p> </li> <li>Check for warnings from the compiler<ul> <li>Always set all the compiler warnings so the compiler can find issues for you</li> </ul> </li> <li>Step through the code with a debugger</li> <li>Add tracing statements</li> <li>Corrupt variables?<ul> <li>Check their neighborhood variables, use <code>valgrind</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_25_rubber_ducking","title":"PP_Tip 25: Rubber ducking","text":"<ul> <li>= explain the issue step-by-step to someone else, even to a yellow rubber duck</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_25_why_rubber_ducking_works","title":"PP_Tip 25: Why rubber ducking works?","text":"<ul> <li>The simple act of explaining the issue often uncovers the problem</li> <li>You state things that you may take for granted</li> <li>Verbalizing your assumptions lets you gain new insights into the problem</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_26_select_is_not_broken","title":"PP_Tip 26: <code>select</code> is not broken","text":"<ul> <li>Do not assume that the library is broken</li> <li>Assume that you are calling the library in the wrong way</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_27_dont_assume_it_prove_it","title":"PP_Tip 27: Don't assume it: prove it","text":"<ul> <li>Don't assume that a piece of code works in any condition<ul> <li>Avoid statements like \"that piece of code has been used for years: it cannot     be wrong!\"</li> </ul> </li> <li> <p>Prove that the code works:</p> <ul> <li>In this context</li> <li>With this data</li> <li>With these boundary conditions</li> </ul> </li> <li> <p>After you find a surprising error, are there any other places in the code that     may be susceptible to the same bug?</p> </li> <li>Make sure that whatever happened, never happens again</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_28_learn_a_text_manipulation_language","title":"PP_Tip 28: Learn a text manipulation language","text":"<ul> <li>Spending 30 mins trying out a crazy idea is better than spending 5 hours</li> <li>With scripting languages (e.g., Python, perl) you can quickly prototype ideas     instead of using a production language (e.g., C, C++)</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_29_write_code_that_writes_code","title":"PP_Tip 29: Write code that writes code","text":"<ul> <li>Passive code generators</li> <li>They are run once and the origin of the code is forgotten<ul> <li>E.g., parameterized templates, boilerplate</li> </ul> </li> <li> <p>They can be 90\\% accurate and the rest is done by hand</p> </li> <li> <p>Active code generators</p> </li> <li>They convert a single representation of knowledge into all the forms that are     needed</li> <li>This is not duplication, it is the DRY principle in action</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pragmatic_paranoia","title":"Pragmatic paranoia","text":""},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_30_you_cannot_write_perfect_software","title":"PP_Tip 30: You cannot write perfect software","text":"<ul> <li>Accept it and celebrate it<ul> <li>Unless you accept it, you'll end up wasting time chasing an impossible dream</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#know_when_to_stop","title":"Know when to stop","text":"<ul> <li>A painter needs to know when to stop adding layers of paint</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#dont_trust_others","title":"Don't trust others","text":"<ul> <li>Code defensively</li> <li>Anticipate the unexpected</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#dont_trust_yourself","title":"Don't trust yourself","text":"<ul> <li>Code defensively against your own mistakes</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#preconditions","title":"Preconditions","text":"<ul> <li>= what must be true in order for the routine to be called</li> <li>It is caller's responsibility to pass good data</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#postconditions","title":"Postconditions","text":"<ul> <li>= what the routine is guaranteed to do</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#class_invariants","title":"Class invariants","text":"<ul> <li>= a class ensures that some conditions are always true<ul> <li>E.g., between invocations to public methods</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#contracts","title":"Contracts","text":"<ul> <li>If all routines' preconditions are met<ul> <li>=&gt; the routine guarantees that all postconditions and invariants will be     true when it completes</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_31_design_with_contracts","title":"PP_Tip 31: Design with contracts","text":"<ul> <li>Some languages support design by contract:<ul> <li>In the compiler (e.g., static assertion, type system)</li> <li>In the runtime systems (e.g., assertions)</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_32_crash_early","title":"PP_Tip 32: Crash early","text":"<ul> <li>Better to crash than to thrash (=corrupting the state of the system)</li> <li>When something unexpected happens throw a runtime exception<ul> <li>The exception, if not caught, will percolate up to the top level halting the     program</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_33_if_it_cannot_happen_use_assertions_to_ensure_that_it_wont","title":"PP_Tip 33: If it cannot happen, use assertions to ensure that it won't","text":"<ul> <li>Assertions check for things that should never happen<ul> <li>E.g., at the end of a sorting routine the data is not sorted</li> </ul> </li> <li>Don't use assertions in place of real error handling</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#leave_assertions_enabled","title":"Leave assertions enabled","text":"<ul> <li>Assertions should be left on even after the system is tested and shipped</li> <li>The assumption that testing will find all the bugs is wrong<ul> <li>Testing tests a miniscule percentage of possible real-world conditions</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_34_use_exceptions_for_exceptional_problems","title":"PP_Tip 34: Use exceptions for exceptional problems","text":"<ul> <li>Interleaving normal control flow code and error handling code leads to ugly     code<ul> <li>With exceptions one can split the code neatly into two parts</li> <li>Exceptions are like <code>goto</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#exceptions_are_for_unexpected_events","title":"Exceptions are for unexpected events","text":"<ul> <li>Use exceptions only for truly unexpected events</li> <li>The code should still run in normal conditions if one removes all the     exception handlers</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_35_finish_what_you_start","title":"PP_Tip 35: Finish what you start","text":"<ul> <li>Resources (e.g., memory, DB transactions, threads, files, timers) follow a     pattern:<ul> <li>Allocate</li> <li>Use</li> <li>Deallocate</li> </ul> </li> <li>Routine or objects that allocate resources are responsible for deallocating     them</li> <li>To avoid deadlocks always deallocate resources in the opposite order to that     in which you allocate them</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#bend_or_break","title":"Bend or break","text":""},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_36_minimize_coupling_between_modules","title":"PP_Tip 36: Minimize coupling between modules","text":"<ul> <li>We want to limit the interaction between modules<ul> <li>If one modules has to be replaced / is broken, the other modules can carry     on</li> </ul> </li> <li>Traversing relationships between objects can quickly lead to a combinatorial     explosion of dependencies</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_36_law_of_demeter_for_functions","title":"PP_Tip 36: Law of Demeter for functions","text":"<ul> <li> <p>Any method <code>O.m(A, B, C)</code> of an object <code>O</code> should call only methods belonging     to:</p> <ul> <li>Object <code>O</code> itself</li> <li>Objects through parameters passed to the method (e.g., <code>A</code>)</li> <li>Objects instantiated within <code>m</code></li> </ul> </li> <li> <p>A rule of thumb in OOP is to use a single dot, e.g., <code>a.m()</code> and avoid     multiple dots, e.g., <code>a.b.m()</code></p> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_36_intuition_of_the_law_of_demeter","title":"PP_Tip 36: Intuition of the Law of Demeter","text":"<ul> <li>Object <code>A</code> can call a method of <code>B</code></li> <li><code>A</code> cannot reach through <code>B</code> to access an object <code>C</code><ul> <li>Otherwise <code>A</code> knows about the internal structure of <code>B</code></li> </ul> </li> <li><code>B</code> needs to be changed to expose the interface of <code>C</code><ul> <li>Cons: lots of wrapper methods to forward requests to delegates</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_36_law_of_demeter_as_general_contractor","title":"PP_Tip 36: Law of Demeter as general contractor","text":"<ul> <li> <p>It's like using a general contractor</p> </li> <li> <p>Pros</p> <ul> <li>You ask a job to be done, but you don't deal with subcontractors directly</li> </ul> </li> <li>Cons<ul> <li>The client needs to go through the general contractor all the times</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_37_configure_dont_integrate","title":"PP_Tip 37: Configure, don't integrate","text":"<ul> <li> <p>Every time we change the code to accommodate a change in business logic we     risk to break the system or to introduce a new bug</p> </li> <li> <p>Make the system highly configurable</p> </li> <li>Always use metadata, i.e., data about data (e.g., choice of algorithm,     database, middleware, user-interface style, ...)</li> <li>Use <code>.ini</code> files</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_38_put_abstractions_in_code_details_in_metadata","title":"PP_Tip 38: Put abstractions in code, details in metadata","text":"<ul> <li>The goal is to think declaratively: specify what to do, not how to do it</li> <li>We want to configure and drive the application via metadata as much as     possible</li> <li>So we program for the general case and put the specifics outside the compiled     code</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#mechanisms_vs_policies","title":"Mechanisms vs policies","text":"<ul> <li>Mechanisms = primitives, what can be done</li> <li>Policies = how to put together primitives</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_38_advantages_of_splitting_mechanisms_and_policies","title":"PP_Tip 38: Advantages of splitting mechanisms and policies","text":"<ol> <li>Decouple components in the design, resulting in more flexible and adaptable    programs</li> <li>Customize the application without recompiling it</li> <li>Metadata can be expressed in a form closer to problem domain</li> <li>Anybody can change the behavior without understanding the code</li> </ol>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_38_put_business_logic_in_metadata","title":"PP_Tip 38: Put business logic in metadata","text":"<ul> <li>Business logic and rules are the parts that are most likely to change</li> <li>So we want to maintain them in a flexible format, e.g., metadata</li> <li>Metadata should be encoded in plain text</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_39_analyze_workflow_to_improve_concurrency","title":"PP_Tip 39: Analyze workflow to improve concurrency","text":"<ul> <li>Avoid temporal coupling</li> <li>Use activity diagrams to identify activities that could be performed in     parallel</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_40_temporal_coupling","title":"PP_Tip 40: Temporal coupling","text":"<ul> <li>Time is often ignored when designing a software architecture</li> <li>We tend to think in a linear sequential fashion: \"do this, then do that\"</li> <li> <p>This leads to temporal coupling, i.e., coupling in time</p> </li> <li> <p>When designing an architecture, we need to think about:</p> <ul> <li>Concurrency = things happening at the same time</li> <li>Ordering = <code>A</code> must occur before <code>B</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_40_uml_activity_diagram","title":"PP_Tip 40: UML activity diagram","text":"<ul> <li>Actions are represented by rounded boxes</li> <li>Arrows between actions mean \"temporal ordering\"</li> <li>Actions with no incoming arrows can be started at any time</li> <li>Synchronization points are represented by a thick bar:<ul> <li>Once all the actions leading to a barrier are done, one can proceed with the     arrows leaving the synchronization point</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#service","title":"Service","text":"<ul> <li>= independent, concurrent objects behind well-defined, consistent interfaces</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_40_design_using_services","title":"PP_Tip 40: Design using services","text":"<ul> <li>Using services allows to avoid temporal coupling</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_41_hungry_consumer_model","title":"PP_Tip 41: Hungry consumer model","text":"<ul> <li>There are multiple independent consumers and a centralized work queue</li> <li>Each consumer grabs a task from the work queue and processes it</li> <li>Load balancing: if a consumer task gets bogged down or it is slower, the     others can pick up the slack</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_41_example_of_3-tier_architecture_with_hungry_consumer_model","title":"PP_Tip 41: Example of 3-tier architecture with hungry consumer model","text":"<ul> <li>Goal</li> <li> <p>Read a request from multiple lines and process the transactions against the     database</p> </li> <li> <p>Constraints</p> </li> <li>DB operations are slow</li> <li>We need to keep accepting service requests even when waiting on DB</li> <li> <p>DB performance suffers with too many concurrent sessions</p> </li> <li> <p>Solution</p> </li> <li>3 tier, multi-processing distributed application</li> <li>Tier 1: input tasks monitor the input lines and add requests to application     queue<ul> <li>Application queue</li> </ul> </li> <li>Tier 2: read application queue, apply business logic, add transaction to DB     queue<ul> <li>DB queue</li> </ul> </li> <li> <p>Tier 3: read transactions from DB queue and apply it to DB</p> </li> <li> <p>Each component is an independent entity, running concurrently (on the same     machine or on multiple machines)</p> </li> <li>Actions are asynchronous: as soon as a request is handled by a process and put     on next queue, the process goes back to monitor inputs</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_41_always_design_for_concurrency","title":"PP_Tip 41: Always design for concurrency","text":"<ul> <li>Programming with threads imposes some design constraints</li> <li>Concurrency forces you to think things more carefully</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#examples_of_problems_with_concurrency","title":"Examples of problems with concurrency","text":"<ul> <li>Global or static variables must be protected from concurrent access<ul> <li>Do you really need a global variable?</li> </ul> </li> <li>Objects must always be in a valid state when called<ul> <li>Classes with separate constructor and initialization routines are     problematic</li> </ul> </li> <li>Interfaces should not keep state<ul> <li>Make services stateless</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#event","title":"Event","text":"<ul> <li>= special message that says \"something interesting just happened\"</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_42_objects_communicating_through_events","title":"PP_Tip 42: Objects communicating through events","text":"<ul> <li> <p>We know that we need to separate a program in modules / classes</p> <ul> <li>A module / class has a single, well-defined responsibility</li> </ul> </li> <li> <p>At run-time how do objects talk to each other?</p> </li> <li>We don't want objects to know too much about each other<ul> <li>E.g., how does object <code>A</code> know which objects to talk to?</li> </ul> </li> <li>By using events one can minimize coupling between objects: objects are     interested in events and not in other objects</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_42_all_events_through_a_single_routine_approach","title":"PP_Tip 42: All events through a single routine approach","text":"<ul> <li>One approach is to send all events to a single routine that dispatches them to     the objects</li> <li>This is bad!<ul> <li>A single routing needs to know all interactions among objects</li> <li>It's like a huge case statement</li> <li>It violates encapsulation, increases coupling</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_42_publish_subscribe_model","title":"PP_Tip 42: Publish / subscribe model","text":"<ul> <li>Objects should only receive events they want (do no spam objects!)<ul> <li>Subscribers register themselves with publisher objects for interesting     events</li> <li>Publisher calls all subscribers when a corresponding event occurs</li> </ul> </li> <li>Organization can be:<ul> <li>Peer-to-peer</li> <li>Software bus (a centralized object maintains DB of listeners and dispatches     messages)</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_42_sequence_diagram","title":"PP_Tip 42: Sequence diagram","text":"<ul> <li>It shows the flow of messages among several objects</li> <li>Objects are arranged in columns</li> <li>Each message is an arrow from sender's column to receiver's column</li> <li>Timing relationship between messages is captured by vertical ordering</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_42_push_pull_model_for_event_services","title":"PP_Tip 42: Push / pull model for event services","text":"<ul> <li>Push mode</li> <li>Event producers inform the event channel that event has occurred</li> <li> <p>Event channel distributes event to all client objects registered for that     event</p> </li> <li> <p>Pull mode</p> </li> <li>Event consumers poll the event channel periodically</li> <li>Event channel polls possible suppliers and report interesting events</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_42_separate_views_from_models","title":"PP_Tip 42: Separate views from models","text":"<ul> <li> <p>Model-View-Controller design pattern</p> </li> <li> <p>Model:</p> <ul> <li>It stores the data</li> <li>It has methods to change its state, to report changes (through events), and     to report data</li> <li>It is like a DB</li> </ul> </li> <li>View:<ul> <li>A way to interpret the Model</li> <li>It subscribes to changes in the Model</li> <li>It subscribes to events from the Controller to change representation</li> </ul> </li> <li> <p>Controller:</p> <ul> <li>It controls the View</li> <li>It provides new data to the Model</li> </ul> </li> <li> <p>One can even have a network of MVCs: e.g., a View for one Model can be the     Model for another View</p> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_42_examples_of_mvc","title":"PP_Tip 42: Examples of MVC","text":"<ul> <li>Almost any GUI</li> <li>Tree widget = a clickable, traversable tree</li> <li>Spreadsheet with a graph attached to represent data as bar charts, running     totals, ...; controllers allow to zoom in / out, enter new data, ...</li> <li>System reporting interesting information about a baseball game<ul> <li>Model is a DB with all possible information</li> <li>New data from the Controller: a pitcher is changed, a player strikes out, it     starts raining</li> <li>A View reports the score</li> <li>A View reports info about current batter</li> <li>A View looks for new world records</li> <li>A View posts information on the web</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_43_use_blackboards_to_coordinate_workflow","title":"PP_Tip 43: Use blackboards to coordinate workflow","text":"<ul> <li>A blackboard system lets decouple objects from each other completely</li> <li>There is even less coupling that publish / subscribe model</li> <li>Consumers and producers exchange data anonymously and asynchronously</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_43_example_of_blackboard_implementation","title":"PP_Tip 43: Example of blackboard implementation","text":"<ul> <li> <p>Blackboard is like a DB providing atomic and distributed storage of objects</p> </li> <li> <p>One can store any object, not just data</p> </li> <li>Objects can be retrieved by partial matching fields (templates and wildcards)     or by subtypes</li> <li>Operations can be:<ul> <li>Read = search and retrieve item from blackboard</li> <li>Write = put an item on the blackboard</li> <li>Take = read + remove from blackboard</li> <li>Notify = set up notification when an object matching a template is written</li> </ul> </li> <li>Advantage is a single and consistent interface to blackboard, instead of     different APIs for every transaction / interaction in the system</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_43_example_of_blackboard_application","title":"PP_Tip 43: Example of blackboard application","text":"<ul> <li> <p>Program that accepts and process loan applications</p> </li> <li> <p>Constrains</p> </li> <li>The laws are very complex</li> <li>There is no guarantee on the order in which data arrives</li> <li>Data is gathered by different people</li> <li>Certain data is dependent on other data</li> <li>Arrival of new data may raise request for more data and policies</li> <li> <p>As regulation change, the workflow must be re-organized</p> </li> <li> <p>Solutions</p> </li> <li>Encoding all the workflow is a nightmare</li> <li>A better solution is a blackboard + rules engine</li> <li>Any time new data arrives, a new rule is triggered</li> <li>Rules can output more data on the blackboard, triggering more rules and so on</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#while_you_are_coding","title":"While you are coding","text":""},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_44_dont_program_by_coincidence","title":"PP_Tip 44: Don't program by coincidence","text":"<ul> <li>Do not program by coincidence (= relying on luck and accidental successes)</li> <li>Program deliberately</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_44_how_to_program_by_coincidence","title":"PP_Tip 44: How to program by coincidence","text":"<ul> <li>You type some code, try it, and it seems to work</li> <li>Type more code and still works</li> <li>After few weeks the program stops to work</li> <li>You don't know why the code is failing, because you didn't know why it worked     in the first place</li> <li>The code seemed to work, given the (limited) testing did, but it was just a     coincidence</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_44_why_program_by_coincidence_seems_to_work","title":"PP_Tip 44: Why program by coincidence seems to work?","text":"<ul> <li>One ends up relying on undocumented boundary conditions and when the code is     fixed / changed, our code breaks</li> <li>One tries until something works, then it does not wonder why it works: \"it     works now, better leave it alone\"</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_44_how_to_program_deliberately","title":"PP_Tip 44: How to program deliberately","text":"<ul> <li>Rely only on reliable things</li> <li>Document your assumptions (e.g., design by contract)</li> <li>Add assertions to test assumptions</li> <li>Don't just test your code, test your assumptions as well (e.g., with small     unit tests)</li> <li>Don't let existing code (even your own code) dictate future code</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_45_estimate_the_order_of_your_algorithms","title":"PP_Tip 45: Estimate the order of your algorithms","text":"<ul> <li>We always want to estimate the resources (e.g., time, memory) required by     algorithms</li> <li>E.g., \"Would the algorithm scale up from 1k records to 1M records?\"</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#big-oh_notation","title":"Big-Oh notation","text":"<ul> <li>Big-Oh notation represents the worst-case time taken by an algorithm<ul> <li>Simple loops: \\(O(n)\\)</li> <li>Nested loops: \\(O(n^k)\\)</li> <li>Binary chop (e.g., binary search): \\(O(\\log(n))\\)</li> <li>Divide and conquer (split, recurse, combine): \\(O(n \\log(n))\\)</li> <li>Combinatoric: \\(O(2^n)\\)</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#estimating_big-oh","title":"Estimating Big-Oh","text":"<ul> <li>If you are not sure about Big Oh, vary input record size and plot the resource     needed (e.g., time, memory) against the input size</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#big-oh_in_the_real_world","title":"Big-Oh in the real world","text":"<ul> <li>It is possible that a \\(O(n^2)\\) algorithm is faster than a \\(O(n \\log(n))\\) for     small inputs</li> <li>Even if runtime looks linear, the machine might start trashing for lack of     memory and thus not scale linearly in the real world</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_46_test_your_estimate","title":"PP_Tip 46: Test your estimate","text":"<ul> <li>It's tricky to get accurate execution times</li> <li>Use code profilers to count the number of times different steps of your     algorithm get executed and plot against the input size</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#be_wary_of_premature_optimization","title":"Be wary of premature optimization","text":"<ul> <li>Make sure an algorithm is really the bottleneck before investing precious time     trying to improve it</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#refactoring","title":"Refactoring","text":"<ul> <li>= re-writing, re-working, re-architecting code</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_47_refactor_early_refactor_often","title":"PP_Tip 47: Refactor early, refactor often","text":"<ul> <li>If you cannot refactor immediately<ul> <li>Make space in the schedule</li> <li>File a bug</li> <li>Limit the spread of the virus</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#how_to_refactor","title":"How to refactor","text":"<ul> <li>Refactoring needs to be undertaken slowly, deliberately, and carefully</li> <li>Don't refactor and add functionality at the same time</li> <li>Make sure you have good tests before refactoring</li> <li>Take baby steps to avoid prolonged debugging</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_47_software_development_is_more_gardening_than_building","title":"PP_Tip 47: Software development is more gardening than building","text":"<ul> <li> <p>Unfortunately the most common metaphor for software development is building     construction: blueprints, build, release, maintenance, ...</p> </li> <li> <p>As a program evolves, it is necessary to rethink earlier decisions and rework     portions of the code</p> </li> <li>Software is more like gardening:<ul> <li>Start with a plan</li> <li>Some plants die</li> <li>Move plants to get in the sun / shade</li> <li>Pull weeds</li> <li>Monitor health of the plants</li> <li>Make adjustments</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_47_when_to_refactor","title":"PP_Tip 47: When to refactor?","text":"<ul> <li>It is time to refactor when you notice:<ul> <li>Duplication</li> <li>Non-orthogonal design</li> <li>Outdated knowledge</li> <li>Bad performance</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_47_management_and_refactoring","title":"PP_Tip 47: Management and refactoring","text":"<ul> <li>How do you explain to your boss that \"the code works, but it needs to be     refactored?\"</li> <li>Fail to refactor now and the investment to fix the problem later on will be     larger</li> <li>It's like accumulating debt: at some point it will need to be repaid, with     interests!</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_48_design_to_test","title":"PP_Tip 48: Design to test","text":"<ul> <li> <p>Chips are designed to be tested</p> <ul> <li>At the factory</li> <li>When they are installed</li> <li>When they are deployed in the field</li> </ul> </li> <li> <p>BIST (Built-In Self Test) features</p> </li> <li> <p>TAM (Test Access Mechanism) = test harness to provide stimuli and collect     responses</p> </li> <li> <p>We need to build testability into the software from the very beginning</p> </li> <li>Test each piece thoroughly (unit testing) before wiring them together     (integration testing)</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_48_testing_against_contract","title":"PP_Tip 48: Testing against contract","text":"<ul> <li> <p>Write test cases that ensure that a unit honors its contract</p> <ul> <li>This also checks whether the contract means what we think it means</li> </ul> </li> <li> <p>We need to check over a wide range of test cases and boundary conditions</p> </li> <li>There's no better way to fix errors than by avoiding them in the first place</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#test-driven_development","title":"Test-driven development","text":"<ul> <li>By building the tests before you implement the code, you try out the interface     before you commit to it</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_48_where_to_put_unit_tests","title":"PP_Tip 48: Where to put unit tests?","text":"<ul> <li>Unit tests should be somehow close to the code they test<ul> <li>E.g., in a parallel directory</li> </ul> </li> <li> <p>If something is not easy to find and use, it won't be used</p> </li> <li> <p>By making the test code readily accessible, one provides:</p> <ul> <li>Examples of how to use a module</li> <li>A means to validate any future changes to code</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_48_provide_a_test_harness","title":"PP_Tip 48: Provide a test harness","text":"<ul> <li>It's good to have a way to:<ul> <li>Select tests to run</li> <li>Pass arguments on the command line to control the testing</li> <li>Analyze the test output</li> <li>Automatically find all the unit tests (instead of having a list of tests, so     that we can honor the DRY principle)</li> </ul> </li> <li>Test harness can be built using OOP<ul> <li>E.g., objects provide setup and cleanup methods, standard form of failure     report, ...</li> </ul> </li> <li>There are standard test harness (e.g., <code>unittest</code> for Python, <code>cppunit</code> for     C++)</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_48_build_a_test_backdoor","title":"PP_Tip 48: Build a test backdoor","text":"<ul> <li>No piece of software is perfect and bugs show up in real world</li> <li>Have log files containing trace messages</li> <li>Log messages should be in a regular, consistent format</li> <li>An interesting technique is to have a built-in web server in the application<ul> <li>Pointing to a certain port of the machine one can see internal status, log     entries, a debug control panel</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_49_test_your_software_or_your_users_will","title":"PP_Tip 49: Test your software or your users will","text":"<ul> <li>All software you write will be tested<ul> <li>If not by you, then by the eventual users</li> </ul> </li> <li>It is better to test it thoroughly than being swamped in help desk calls</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_50_dont_use_wizard_code_you_dont_understand","title":"PP_Tip 50: Don't use wizard code you don't understand","text":"<ul> <li>Applications are getting harder and harder to write<ul> <li>User interfaces are becoming increasingly sophisticated</li> <li>The underlying applications are getting more complex</li> </ul> </li> <li> <p>One can use wizards to generate code to perform most functions, but one must     understand all of it (otherwise one is programming by coincidence)</p> </li> <li> <p>One could argue that we routinely rely on things we don't understand</p> <ul> <li>E.g., quantum mechanics in integrated circuits</li> <li>What we don't understand is behind a tidy interface</li> <li>Wizard code is interwoven with our application</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#before_the_project","title":"Before the project","text":""},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#requirement","title":"Requirement","text":"<ul> <li>= a statement about something that needs to be accomplished</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_51_dont_gather_requirements_dig_for_them","title":"PP_Tip 51: Don't gather requirements: dig for them","text":"<ul> <li>Gathering requirements implies that the requirements are already there</li> <li>In reality they are buried deep beneath layers of<ul> <li>Assumptions</li> <li>Misconceptions</li> <li>Politics</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_51_example_of_tricky_requirements","title":"PP_Tip 51: Example of tricky requirements","text":"<ul> <li>A requirements can sound like: \"Only an employee's supervisors and HR may view     an employee's records\"</li> <li>This requirement has a policy embedded in it<ul> <li>We don't want to hard-wire policies into requirements, since policies change     all the time</li> </ul> </li> <li>Requirements should be a general statement: \"An employee record may be viewed     only by a nominated group of people\"</li> <li>Give the policy as an example of what should be supported</li> <li>Policies should eventually go in the metadata of the application</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_52_work_with_a_user_to_think_like_a_user","title":"PP_Tip 52: Work with a user to think like a user","text":"<ul> <li>We need to discover the underlying reason why users do a thing, rather than     just the way they currently do it</li> <li>We want to solve a business problem, not just check off requirements</li> <li>You can ask the user to sit with him for a week while he does his job<ul> <li>See how the system will be really used, not how management intended to be     used</li> <li>Build trust and establish communication with your users</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#use_cases","title":"Use cases","text":"<ul> <li>= capture requirements through a particular use of the system</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_53_use_cases","title":"PP_Tip 53: Use cases","text":"<ul> <li>While sitting with the user, you see a few interesting scenarios that describe     what the application needs to do</li> <li>Write the scenarios in a document that everyone (developers, end users,     project sponsor, management) can discuss</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_53_abstractions_live_longer_than_details","title":"PP_Tip 53: Abstractions live longer than details","text":"<ul> <li>Good requirement docs should remain abstract</li> <li>They reflect the business needs, not architecture, not design, not user     interface, ...</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_53_feature-itis","title":"PP_Tip 53: Feature-itis","text":"<ul> <li>Aka feature bloat</li> <li>The issue is that by adding \"just one more feature\", the scope of the project     keeps growing</li> <li>One should track the number of bugs reported and fixed, the number of     additional features requested and who approved them</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#project_glossary","title":"Project glossary","text":"<ul> <li>= one place that defines all the specific terms and vocabulary used in a     project</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_54_use_a_project_glossary","title":"PP_Tip 54: Use a project glossary","text":"<ul> <li>It's hard to succeed if users and developers<ul> <li>Refer to the same thing with different names, or</li> <li>Refer to different things with the same name</li> </ul> </li> <li>Create and maintain a project glossary</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_55_dont_think_outside_the_box_find_the_box","title":"PP_Tip 55: Don't think outside the box: find the box","text":"<ul> <li>The secret to solve a puzzle is to identify the real (not imagined)     constraints and find a solution therein</li> <li>Some constraints are preconceived notions</li> <li> <p>E.g., \"the Gordian knot\"</p> </li> <li> <p>E.g., the Trojan horse:</p> <ul> <li>How do you get troops into a walled city?</li> <li>Would you have dismissed the idea of getting troops \"through the front     door\"?</li> </ul> </li> <li> <p>To solve a problem enumerate all the possible avenues</p> <ul> <li>Don't dismiss anything, then explain why a certain path cannot be taken. Can     you prove it?</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_55_impossible_problems","title":"PP_Tip 55: Impossible problems","text":"<ul> <li>You are stuck on a problem that seems \"impossible\"</li> <li>You are late on the schedule</li> <li>Step back and ask yourself:<ul> <li>Is there an easier way?</li> <li>What is that makes this problem so hard to solve?</li> <li>Does it have to be done this way?</li> <li>Does it have to be done at all?</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_56_listen_to_nagging_doubts_start_when_you_are_ready","title":"PP_Tip 56: Listen to nagging doubts: start when you are ready","text":"<ul> <li>When you experience some reluctance when faced with a task, take notice</li> <li>Sometimes your instinct is right on the spot, although you cannot put a finger     on it</li> <li>How can you tell that is not just procrastination?<ul> <li>You can start prototyping and verify if some basic premises were wrong</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#program_specification","title":"Program specification","text":"<ul> <li>= process of reducing requirements to the point where coding can start</li> <li>The goal is to remove major ambiguities</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_57_some_things_are_better_done_than_described","title":"PP_Tip 57: Some things are better done than described","text":"<ul> <li>Program specification is an agreement with the user</li> <li>It's important to stop increasing level of detail and start coding,     prototyping, tracer bullet, because:<ul> <li>It is naive to assume that a specification will ever capture every detail</li> <li>Once the system is running, users will ask for changes</li> <li>Natural language is not expressive enough to clarify everything</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_58_dont_be_a_slave_to_formal_methods","title":"PP_Tip 58: Don't be a slave to formal methods","text":"<ul> <li>Many methods have been developed to make programming more like engineering     (e.g., waterfall development, UML, ...)</li> <li>These formal methods use a combination of diagrams and supporting words</li> <li>The user typically does not understand them and cannot provide feedback</li> <li>It's better to give the users a prototype and let them play with it</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_59_expensive_tools_do_not_produce_better_designs","title":"PP_Tip 59: Expensive tools do not produce better designs","text":"<ul> <li>Never give in into a methodology just because it is the hot new fad</li> <li>Do not think about how much a tool costs when you look at its output</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pragmatic_projects","title":"Pragmatic projects","text":""},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_60_pragmatic_teams","title":"PP_Tip 60: Pragmatic teams","text":"<ul> <li> <p>Most of the pragmatic programming principles apply to teams, as much as they     apply to an individual</p> </li> <li> <p>No broken windows</p> </li> <li>Quality is a team issue</li> <li> <p>Team as a whole should not tolerate broken windows (= small imperfections      that no one fixes)</p> </li> <li> <p>Boiled frogs</p> </li> <li>People assume that someone is handling an issue or that someone must have      OK-ed a change request from the user</li> <li> <p>Fight this: everyone must actively monitor the environment for changes</p> </li> <li> <p>Communicate</p> </li> <li> <p>Great teams speak with one voice and are always prepared</p> </li> <li> <p>Don't repeat yourself (DRY)</p> </li> <li> <p>Some teams appoint a member as the project librarian, responsible for      checking on duplication, coordinating documentation, ...</p> </li> <li> <p>Orthogonality</p> </li> <li>Traditional team organization is based on the old-fashioned waterfall      method of software construction<ul> <li>Individuals are assigned roles based on their job function, e.g.,</li> <li>Business analysts</li> <li>Architects</li> <li>Designers</li> <li>Programmers</li> <li>Testers</li> </ul> </li> <li>Different activities of a project (analysis, design, coding, testing) can't      happen in isolation</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_60_organize_around_functionality_not_job_functions","title":"PP_Tip 60: Organize around functionality, not job functions","text":"<ul> <li> <p>Organize people in the same way one organizes code</p> <ul> <li>Design by contract</li> <li>Decoupling</li> <li>Orthogonality</li> </ul> </li> <li> <p>Split teams by functionality not by job function (e.g., architect, programmer,     tester)</p> <ul> <li>We look for cohesive, self-contained teams of people</li> </ul> </li> <li> <p>Let each team organize themselves internally</p> <ul> <li>Each team has agreed upon responsibilities and commitments to the other     teams</li> <li>Of course this approach works only with responsible developers and strong     project management</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_61_dont_use_manual_procedures","title":"PP_Tip 61: Don't use manual procedures","text":"<ul> <li> <p>We want to ensure consistency and repeatability in the project</p> <ul> <li>Manual procedures leave consistency up to chance</li> <li>Let the computer do the mundane jobs: it will do a better job than we do</li> </ul> </li> <li> <p>Compiling the project should be reliable and repeatable</p> </li> <li>We want to check out, build, test, ship with a single command</li> <li><code>make</code> and <code>cronjobs</code> are the solutions</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_62_test_early","title":"PP_Tip 62: Test early","text":"<ul> <li>Look for your bugs now, so you don't have to endure the shame of others     finding your bugs later</li> <li>Start testing as soon as you have code</li> <li>Code a little, test a little</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_62_test_often","title":"PP_Tip 62: Test often","text":"<ul> <li>The earlier a bug is found, the cheaper it is to remedy</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_62_test_automatically","title":"PP_Tip 62: Test automatically","text":"<ul> <li>Tests that run with every build are better than test plans that sit on a shelf</li> <li>A good project may well have more test code than production code</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_top_63_coding_aint_done_til_all_the_tests_run","title":"PP Top 63: Coding ain't done 'til all the tests run","text":"<ul> <li>Just because you finished coding, you cannot tell that the code is done</li> <li>You cannot claim that the code is done until it passes all the available tests</li> <li>Code is never really done</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_63_what_to_test","title":"PP_Tip 63: What to test","text":"<ul> <li>There are multiple types of tests:<ul> <li>Unit</li> <li>Integration</li> <li>Validation</li> <li>Performance</li> <li>Usability tests</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#unit_test","title":"Unit test","text":"<ul> <li>= exercise a module</li> <li>If the parts don't work by themselves, they won't work together</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#integration_test","title":"Integration test","text":"<ul> <li>= show that the major subsystems work well together</li> <li>Integration is the largest source of bugs in the system<ul> <li>Test that the entire system honors its contract</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#validation_and_verification_test","title":"Validation and verification test","text":"<ul> <li>= the users told you what they wanted, but is it what they really need?</li> <li>A bug-free system that answers the wrong question is not useful</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#resource_exhaustion_errors_and_recovery_test","title":"Resource exhaustion, errors, and recovery test","text":"<ul> <li>Resources are limited in the real world, e.g.:<ul> <li>Memory</li> <li>Disk space / bandwidth</li> <li>CPU</li> <li>Network bandwidth</li> <li>Video resolution</li> </ul> </li> <li>How will the system behave under real-world conditions?</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#performance_test","title":"Performance test","text":"<ul> <li>= testing under a given load (e.g., expected number of users, connections,     transactions per second)</li> <li>Does the system scale?</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#usability_test","title":"Usability test","text":"<ul> <li>= performed with real users, under real environmental conditions</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_63_how_to_test","title":"PP_Tip 63: How to test","text":"<ul> <li>Run regression tests for all types of tests</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#regression_testing","title":"Regression testing","text":"<ul> <li>= compare output of current test with previous known values</li> <li>It ensures that fixes for today's bugs don't break things that were working     yesterday</li> <li>All types of tests can be run as regression tests<ul> <li>Unit</li> <li>Integration</li> <li>Validation</li> <li>Performance</li> <li>Usability tests</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#test_data","title":"Test data","text":"<ul> <li>Test data is either real-world data or synthetic data<ul> <li>One needs to use both, since they expose different kind of bugs</li> </ul> </li> <li>Synthetic data<ul> <li>Stresses boundary conditions</li> <li>Can have certain statistical properties (e.g., data to sort is already     sorted or inversely sorted)</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#exercising_gui_systems","title":"Exercising GUI systems","text":"<ul> <li>Often specialized testing tools are required, e.g.,<ul> <li>Event capture / playback model</li> <li>A data processing application with GUI front end should be decoupled so that     one can test each component by itself</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#testing_the_tests","title":"Testing the tests","text":"<ul> <li>We cannot write perfect software</li> <li>We need to test the tests and the test infrastructure</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#testing_thoroughly","title":"Testing thoroughly","text":"<ul> <li>Use coverage analysis tools to keep track of which lines of the code have been     / not been executed</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_64_use_saboteurs_to_test_your_testing","title":"PP_Tip 64: Use saboteurs to test your testing","text":"<ul> <li>If the system is a security system, test the system by trying to break in</li> <li>After you have written a test to detect a particular bug, cause the bug     deliberately and make sure the tests catch it</li> <li>Write test for both positive and negative cases</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_65_test_state_coverage_not_code_coverage","title":"PP_Tip 65: Test state coverage, not code coverage","text":"<ul> <li>Knowing that you executed all code does not tell you if you tested all states</li> <li>This is a combinatorial problem</li> <li>You can tame the complexity thinking about:<ul> <li>Boundary conditions</li> <li>Structure of the code</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_65_when_to_test","title":"PP_Tip 65: When to test","text":"<ul> <li>As soon as any code exists, it must be tested</li> <li>Testing should be done automatically as often as we can (e.g., before code is     committed to the repository)</li> <li>Also results should be easy to interpret: ideally the outcome is binary <code>ok</code> /     <code>not_ok</code></li> <li>Expensive / special tests can be run less frequently, but on a regular basis</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_66_find_bugs_once","title":"PP_Tip 66: Find bugs once","text":"<ul> <li>Once a human tester finds a bug, a new test should be created to check for     that bug every time</li> <li>You don't want to keep chasing the same bugs that the automated tests could     find for you</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_67_treat_english_as_just_another_programming_language","title":"PP_Tip 67: Treat English as just another programming language","text":"<ul> <li>Embrace documentation as an integral part of software development</li> <li>Keep the documentation in the code itself as much as possible</li> <li>Treat code and documentation as two views of the same model</li> <li>Apply all the principles learned for coding (DRY principle, orthogonality,     ...) to English as well</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_68_internal_documentation","title":"PP_Tip 68: Internal documentation","text":"<ul> <li>Source code comments</li> <li>Design documents</li> <li>Test documents</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#external_documentation","title":"External documentation","text":"<ul> <li>= anything that is shipped or published to the outside world together with the     software product (e.g., user manuals)</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#documentation_vs_code","title":"Documentation vs code","text":"<ul> <li>Documentation and code are different views of the same underlying model</li> <li>If there is a discrepancy, the code is what matters</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_68_comments","title":"PP_Tip 68: Comments","text":"<ul> <li>Code should have comments, but too many comments are as bad as too few<ul> <li>Comments should discuss \\textit{why} something is done (e.g, engineering     trade-offs, why decisions were made)</li> <li>The code already shows \\textit{how} it is done</li> </ul> </li> <li>Modules, class, methods should have comments describing what is not obvious</li> <li>Javadoc notation is useful (<code>\\@param</code>, <code>\\@return</code>, ...) to extract information     from the code automatically</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#naming_concepts","title":"Naming concepts","text":"<ul> <li>Variable names should be meaningful</li> <li>Remember that you will be writing the code once, but reading it hundreds of     time: avoid write-only code</li> <li>Misleading names are worse than meaningless names</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_68_automatically_generated_documentation","title":"PP_Tip 68: Automatically generated documentation","text":"<ul> <li> <p>Also for documentation we want to use pragmatic principles</p> <ul> <li>DRY principle</li> <li>Orthogonality</li> <li>Model-view-controller</li> <li>Automation</li> </ul> </li> <li> <p>Printed material is out of date as soon as it is printed</p> <ul> <li>Publish documents on-line</li> </ul> </li> <li>There should be a single command to generate and publish the documents on-line</li> <li>Use a timestamp or review number for each page</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_69_gently_exceed_your_users_expectations","title":"PP_Tip 69: Gently exceed your users' expectations","text":"<ul> <li>Success of a project is measured by how well it meets the expectations of its     users</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#examples_of_difference_between_actual_and_expected_results","title":"Examples of difference between actual and expected results","text":"<ul> <li>A company announces record profits, and its share price drops 20\\%<ul> <li>It didn't meet analysts' expectations</li> </ul> </li> <li>A child opens an expensive present and bursts into tears<ul> <li>It wasn't the cheap doll that she wanted</li> </ul> </li> <li>A team works miracles to implement a complex application<ul> <li>The users don't like it because it does not have an help system</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_69_communicating_expectations","title":"PP_Tip 69: Communicating expectations","text":"<ul> <li>Users come to you with some vision of what they want</li> <li>It may be<ul> <li>Incomplete</li> <li>Inconsistent</li> <li>Impossible</li> </ul> </li> <li>They are invested in it: you cannot ignore this</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#manage_expectations","title":"Manage expectations","text":"<ul> <li>Work with your users so that they understand what you are delivering</li> <li>Never lose sight of the business problems your application is intended to     solve</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#go_the_extra_mile","title":"Go the extra mile","text":"<ul> <li>Surprise and delight your users</li> <li>E.g., balloon help, colorization, automatic installation, splash screen     customized for their organization, ...</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_70_sign_your_work","title":"PP_Tip 70: Sign your work","text":"<ul> <li>Craftsmen of earlier ages were proud to sign their work</li> <li>Your signature should come to be recognized as an indicator of quality</li> </ul>"},{"location":"code_guidelines/all.code_like_pragmatic_programmer.how_to_guide.html#pp_tip_70_code_ownership_vs_anonymity","title":"PP_Tip 70: Code ownership vs anonymity","text":"<ul> <li>Code ownership can cause cooperation problems: people become territorial</li> <li>Anonymity can enable sloppiness, laziness</li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html","title":"All.code review.how to guide","text":""},{"location":"code_guidelines/all.code_review.how_to_guide.html#code_review","title":"Code Review","text":""},{"location":"code_guidelines/all.code_review.how_to_guide.html#code_review_1","title":"Code Review","text":""},{"location":"code_guidelines/all.code_review.how_to_guide.html#general_rules_about_code_review","title":"General Rules About Code Review","text":""},{"location":"code_guidelines/all.code_review.how_to_guide.html#read_the_google_code_review_best_practices","title":"Read the Google Code Review Best Practices","text":"<ul> <li> <p>From the     developer\\'s perspective</p> </li> <li> <p>From the     reviewer\\'s perspective</p> </li> <li> <p>Where the Google guide says \"CL\", think \"PR\"</p> </li> <li> <p>Read it (several times, if you need to)</p> </li> <li> <p>Think about it</p> </li> <li> <p>Understand the rationale</p> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#code_review_workflows","title":"Code Review Workflows","text":""},{"location":"code_guidelines/all.code_review.how_to_guide.html#pull_request","title":"Pull Request","text":"<ul> <li>Our usual review process is to work in a branch and create a pull request (PR)<ul> <li>See our Git doc for details</li> <li>The name of the pull request should be based on the name of the branch,     which in turn should reference the issue repo, number and title. The PR name     is generally generated automatically, e.g.,     <code>PTask2704 make exchange contracts get contracts applicable to series</code>.</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#from_the_code_author_point_of_view","title":"From the Code Author Point of View","text":""},{"location":"code_guidelines/all.code_review.how_to_guide.html#why_we_review_code","title":"Why We Review Code","text":"<ul> <li>We spend time reviewing each other code so that we can:<ul> <li>Build a better product, by letting other people look for bugs</li> <li>Propagate knowledge of the code base through the team</li> <li>Learn from each other</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#pr_checklist","title":"PR Checklist","text":"<ul> <li> <p>From     Google reviewer checklist:</p> </li> <li> <p>In asking (and doing) a code review, you should make sure that:</p> <ul> <li>The code is well-designed.</li> <li>The functionality is good for the users of the code.</li> <li>The code isn't more complex than it needs to be.</li> <li>The developer isn't implementing things they might need in the future but     don't know they need now.</li> <li>Code has appropriate unit tests.</li> <li>Tests are well-designed.</li> <li>The developer used clear names for everything.</li> <li>Comments are clear and useful, and mostly explain why instead of what.</li> <li>Code is appropriately documented.</li> <li>The code conforms to our style guides.</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#the_golden_rule_of_code_review","title":"The Golden Rule of Code Review","text":"<ul> <li> <p>Make life easy for the reviewers</p> <ul> <li>Aka \"Do not upset the reviewers, otherwise they won't let you merge your     code\"</li> </ul> </li> <li> <p>Remember that reviewing other people's code is hard and unrewarding work</p> <ul> <li>Do your best for not frustrating the reviewers</li> </ul> </li> <li> <p>If you are in doubt \"it's probably clear, although I am not 100% sure\", err on     giving more information and answer potential questions</p> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#be_clear_in_the_pr_request_about_what_you_want","title":"Be Clear in the PR Request About What You Want","text":"<ul> <li> <p>Summarize what was done in the PR</p> <ul> <li>Refer to the GH task, but the task alone might not be sufficient</li> <li>A PR can implement only part of a complex task<ul> <li>Which part is it implementing?</li> <li>Why is it doing it in a certain way?</li> </ul> </li> </ul> </li> <li> <p>If the code is not ready for merge, but you want a \"pre-review\" convert PR to     a draft</p> <ul> <li>E.g., ask for an architectural review</li> <li>Draft PRs can not be merged</li> </ul> </li> <li> <p>Is it blocking?</p> <ul> <li>Do not abuse asking for a quick review</li> <li>All code is important and we do our best to review code quickly and     carefully</li> <li>If it\\'s blocking a ping on Slack is a good idea</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#do_not_mix_changes_and_refactoring_shuffling_code","title":"Do Not Mix Changes and Refactoring / Shuffling Code","text":"<ul> <li> <p>The job of the reviewers become frustrating when the author mixes:</p> <ul> <li>Refactoring / moving code; and</li> <li>Changes</li> </ul> </li> <li> <p>It is time consuming or impossible for a reviewer to understand what happened:</p> <ul> <li>What is exactly changed?</li> <li>What was moved where?</li> </ul> </li> <li> <p>In those cases reviewers have the right to ask the PR to be broken in pieces</p> </li> <li> <p>One approach for the PR author is to:</p> <ul> <li>Do a quick PR to move code around (e.g., refactoring) or purely cosmetic<ul> <li>You can ask the reviewer to take a quick look</li> </ul> </li> <li>Do the next PRs with the actual changes</li> </ul> </li> <li> <p>Another approach is to develop in a branch and break the code into PRs as the     code firms up</p> <ul> <li>In this case you need to be very organized and be fluent in using Git: both     qualities are expected of you</li> <li>E.g., develop in a branch (e.g., <code>gp_scratch</code>)</li> <li>Create a branch from it (e.g., <code>TaskXYZ_do_this_and_that</code>) or copy the files     from <code>gp_scratch</code> to <code>TaskXYZ_do_this_and_that</code></li> <li>Edit the files to make the PR self-consistent</li> <li>Do a PR for <code>TaskXYZ_do_this_and_that</code></li> <li>Keep working in <code>gp_scratch</code> while the review is moving forward</li> <li>Make changes to the <code>TaskXYZ_do_this_and_that</code> as requested</li> <li>Merge <code>TaskXYZ_do_this_and_that</code> to master</li> <li>Merge <code>master</code> back into <code>gp_scratch</code> and keep moving</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#double_check_before_sending_a_pr","title":"Double Check Before Sending a PR","text":"<ul> <li>After creating a PR take a look at it to make sure things look good, e.g.,<ul> <li>Are there merge problems?</li> <li>Did you forget some file?</li> <li>Skim through the PR to make sure that people can understand what you changed</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#reviewing_other_peoples_code_is_usually_not_fun","title":"Reviewing Other People'S Code Is Usually Not Fun","text":"<ul> <li> <p>Reviewing code is time-consuming and tedious</p> <ul> <li>So do everything you can to make the reviewer's job easier</li> <li>Don't cut corners</li> </ul> </li> <li> <p>If a reviewer is confused about something, other readers (including you in 1     year) likely would be too</p> <ul> <li>What is obvious to you as the author is often not obvious to readers</li> <li>Readability is paramount</li> <li>You should abhor write-only code</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#the_first_reviews_are_painful","title":"The First Reviews Are Painful","text":"<ul> <li> <p>One needs to work on the same code over and over</p> <ul> <li>Just think about the fact that the reviewer is also reading (still crappy)     code over and over</li> </ul> </li> <li> <p>Unfortunately it is needed pain to get to the quality of code we need to make     progress as a team</p> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#apply_review_comments_everywhere","title":"Apply Review Comments Everywhere","text":"<ul> <li> <p>Apply a review comment everywhere, not just where the reviewer pointed out the     issue</p> </li> <li> <p>E.g., reviewer says:</p> <ul> <li>\"Please replace <code>_LOG.warning(\"Hello %s\".format(name))</code> with     <code>_LOG.warning(\"Hello %s\", name)</code>\"</li> </ul> </li> <li>You are expected to do this replacement:<ul> <li>In the current review</li> <li>In all future code you write</li> <li>In old code, as you come across it in the course of your work<ul> <li>Of course don't start modifying the old code in this review, but open a     clean-up bug, if you need a reminder</li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#look_at_the_code_top-to-bottom","title":"Look at the Code Top-To-Bottom","text":"<ul> <li>E.g., if you do a search &amp; replace, make sure everything is fine</li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#answering_comments_after_a_review","title":"Answering Comments After a Review","text":"<ul> <li>It's better to answer comments in chunks so we don't get an email per comment<ul> <li>Use \"start a review\" (not in conversation)</li> </ul> </li> <li>If one of the comment is urgent (e.g., other comments depend on this) you can     send it as single comment</li> <li>When you answer a comment, mark it as resolved</li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#apply_changes_to_a_review_quickly","title":"Apply Changes to a Review Quickly","text":"<ul> <li> <p>In the same way the reviewers are expected to review PRs within 24 hours, the     author of a PR is expected to apply the requested changes quickly, ideally in     few hours</p> <ul> <li>If it takes longer, then either the PR was too big or the quality of the PR     was too low</li> </ul> </li> <li> <p>If it takes too long to apply the changes:</p> <ul> <li>The reviewers (and the authors) might forget what is the context of the     requested changes</li> <li>It becomes more difficult (or even impossible) to merge, since the code base     is continuously changing</li> <li>It creates dependencies among your PRs</li> <li>Remember that you should not be adding more code to the same PR, but only     fix the problems and then open a PR with new code</li> <li>Other people that rely on your code are blocked</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#ask_for_another_review","title":"Ask for Another Review","text":"<ul> <li>Once you are done with resolving all the comments ask for another review</li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#workflow_of_a_review_in_terms_of_gh_labels","title":"Workflow of a Review in Terms of GH Labels","text":"<ul> <li>The current meaning of the labels are:<ul> <li>See GitHub workflows     doc</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#link_pr_to_gh_issue","title":"Link PR to GH Issue","text":"<ul> <li>Mention the corresponding issue in the PR description to ease the navigation     E.g., see an     example</li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#fix_later","title":"Fix Later","text":"<ul> <li> <p>It's ok for an author to file a follow up Issue (e.g., with a clean up), by     pointing the new Issue to the comments to address, and move on with merge</p> </li> <li> <p>The Issue needs to be addressed immediately after</p> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#from_the_code_reviewer_point_of_view","title":"From the Code Reviewer Point of View","text":""},{"location":"code_guidelines/all.code_review.how_to_guide.html#post-commit_review","title":"Post-Commit Review","text":"<ul> <li> <p>You can comment on a PR already merged</p> </li> <li> <p>You can comment on the relevant lines in a commit straight to <code>master</code> (this     is the exception)</p> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#code_walk-through","title":"Code Walk-Through","text":"<ul> <li> <p>It is best to create a branch with the files you want to review</p> <ul> <li>Add TODOs in the code (so that the PR will pick up those sections)</li> <li>File bugs for the more involved changes</li> </ul> </li> <li> <p>Try to get a top to bottom review of a component once every N weeks (N = 2, 3)</p> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#close_the_pr_and_delete_the_branch","title":"Close the PR and Delete the Branch","text":"<ul> <li> <p>When code is merged into master by one of the reviewers through the UI, one     can select the \"delete branch\" option (usually it is done automatically)</p> </li> <li> <p>Otherwise you can delete the branch using the procedure in     Git</p> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#give_priority_to_code_review","title":"Give Priority to Code Review","text":"<ul> <li>We target to give feedback on a PR within 24hr so that the author is not     blocked for too long<ul> <li>Usually we respond in a few hours</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#multiple_reviewers_problem","title":"Multiple Reviewers Problem","text":"<ul> <li> <p>When there are multiple reviewers for the same PR there can be some problems</p> </li> <li> <p>Ok to keep moving fast and avoid blocking</p> <ul> <li>Block only if it is controversial</li> </ul> </li> <li> <p>Merge when we are confident that the other is ok with it</p> <ul> <li>The other can catch up with a post-commit review</li> <li>A good approach is to monitor recently merged PRs in GH to catch up</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#remember_small_steps_ahead","title":"Remember \"small steps ahead\"","text":"<ul> <li>Follow the Google approach of merging a PR that is a strict improvement</li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#nothing_is_too_small","title":"Nothing Is Too Small","text":"<ul> <li> <p>Each reviewer reviews the code pointing out everything that can be a problem</p> </li> <li> <p>Problems are highlighted even if small or controversial</p> <ul> <li>Not all of those comments might not be implemented by the author</li> </ul> </li> <li> <p>Of course if different approaches are really equivalent but reviewers have     their own stylistic preference, this should not be pointed out, unless it's a     matter of consistency or the choice is left to the author</p> </li> </ul>"},{"location":"code_guidelines/all.code_review.how_to_guide.html#final_gh_comment","title":"Final GH Comment","text":"<ul> <li> <p>Once you are done with the detailed review of the code, you need to</p> <ul> <li>Write a short comment</li> <li>Decide what is the next step for the PR, e.g.,<ul> <li>Comment<ul> <li>Submit general feedback without explicit approval</li> </ul> </li> <li>Approve<ul> <li>Submit feedback and approve merging these changes</li> </ul> </li> <li>Request changes<ul> <li>Submit feedback that must be addressed before merging</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>We use an integrator / developer manager workflow, initially with Paul and GP     testing and merging most of the PRs</p> </li> <li> <p>We use the 3 possible options in the following way:</p> <ul> <li>Comment<ul> <li>When reviewers want the changes to be applied and will then look at the     resulting changes to decide the next steps</li> <li>In practice this means \"make the changes and then we'll discuss more\"</li> <li>E.g., this is of course the right choice for a pre-PR</li> </ul> </li> <li>Approve<ul> <li>No more changes: time to merge!</li> <li>Often it is accompanied by the comment \"LGTM\" (= \"Looks Good To Me\")</li> </ul> </li> <li>Request changes<ul> <li>This typically means \"if you address the comments we can merge\"</li> <li>In practice this is more or less equivalent to \"Comment\"</li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html","title":"All.coding style.how to guide","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#coding_style","title":"Coding Style","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#meta","title":"Meta","text":"<ul> <li>What we call \"rules\" are actually just a convention</li> <li>The \"rules\"<ul> <li>Are optimized for the common case</li> <li>Are not the absolute best way of doing something in all possible cases</li> <li>Can become cumbersome or weird to follow for some corner cases</li> </ul> </li> <li>We prefer simple rather than optimal rules so that they can be applied in most     of the cases, without thinking or going to check the documentation</li> <li>The rules are striving to achieve consistency and robustness<ul> <li>We prefer to care about consistency rather than arguing about which approach     is better in each case</li> <li>E.g., see the futile \"tab vs space\" flame-war from the 90s</li> </ul> </li> <li>The rules are optimized for the average developer / data scientist and not for     power users</li> <li>The rules try to minimize the maintenance burden<ul> <li>We want to minimize the propagation of a change</li> </ul> </li> <li>Rules are not fixed in stone<ul> <li>Rules evolve based on what we discuss through the reviews</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#disclaimer","title":"Disclaimer","text":"<ul> <li>This document was forked from     Google Python Style Guide,     therefore, the numbering of chapters sets off where the Style Guide ends. Make     sure to familiarize yourself with it before proceeding to the rest of the doc,     since it is the basis of our team's code style.</li> <li>Another important source is     The Pragmatic Programmer     by David Thomas and Andrew Hunt. While not Python-specific, it provides an     invaluable set of general principles by which any person working with code     (software developer, DevOps or data scientist) should abide. Read it on long     commutes, during lunch, and treat yourself to a physical copy on Christmas.     The book is summarized     here, but     do not deprive yourself of the engaging manner in which Thomas &amp; Hunt     elaborate on these points -- on top of it all, it is a very, very enjoyable     read.</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#references","title":"References","text":"<ul> <li>Coding<ul> <li>Google Python Style Guide (GPSG)</li> <li>Code convention from PEP8</li> </ul> </li> <li>Documentation<ul> <li>Docstring convention from PEP257</li> <li>Google documentation best practices</li> </ul> </li> <li>Commenting style<ul> <li>Sphinx</li> </ul> </li> <li>Sphinx tutorial</li> <li>Design<ul> <li>Google philosophical stuff</li> <li>Unix rules (although a bit cryptic sometimes)</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#high-level_principles","title":"High-Level Principles","text":"<ul> <li>In this paragraph we summarize the high-level principles that we follow for     designing and implementing code and research. We should be careful in adding     principles here. Ideally principles should be non-overlapping and generating     all the other lower level principles we follow (like a basis for a vector     space)</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#follow_the_dry_principle","title":"Follow the DRY Principle","text":"<ul> <li>DRY =     Don't repeat yourself</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#the_writer_is_the_reader","title":"The Writer Is the Reader","text":"<ul> <li>Make code easy to read even if it is more difficult to write</li> <li>Code is written 1x and read 100x</li> <li>Remember that even if things are perfectly clear now to the person that wrote     the code, in a couple of months the code will look foreign to whoever wrote     the code.</li> <li>So make your future-self's life easier by following the conventions and erring     on the side of documenting for the reader.</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#encapsulate_what_changes","title":"Encapsulate What Changes","text":"<ul> <li>Separate what changes from what stays the same</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#least_surprise_principle","title":"Least Surprise Principle","text":"<ul> <li>Try to make sure that the reader is not surprised</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#pay_the_technical_debt","title":"Pay the Technical Debt","text":"<ul> <li>Any unpaid debt is guaranteed to bite you when you don't expect it</li> <li>Still some debt is inevitable: try to find the right trade-off</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#end-to-end_first","title":"End-To-End First","text":"<ul> <li>Always focus on implementing things end-to-end, then improve each block</li> <li>Remember the analogy of building the car through the skateboard, the bike,     etc.<ul> <li>Compare this approach to building wheels, chassis, with a big-bang     integration at the end</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#unit_test_everything","title":"Unit Test Everything","text":"<ul> <li>Code that matters needs to be unit tested</li> <li>Code that doesn't matter should not be checked in the repo</li> <li>The logical implication is: all code checked in the repo should be unit tested</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#dont_get_attached_to_code","title":"Don'T Get Attached to Code","text":"<ul> <li>It's ok to delete, discard, retire code that is not useful any more</li> <li>Don't take it personally when people suggest changes or simplification</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#always_plan_before_writing_code","title":"Always Plan Before Writing Code","text":"<ul> <li>File a GitHub issue</li> <li>Think about what to do and how to do it</li> <li>Ask for help or for a review</li> <li>The best code is the one that we avoid to write through a clever mental     kung-fu move</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#think_hard_about_naming","title":"Think Hard About Naming","text":"<ul> <li>Finding a name for a code object, notebook, is extremely difficult but very     important to build a mental map</li> <li>Spend the needed time on it</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#look_for_inconsistencies","title":"Look for Inconsistencies","text":"<ul> <li>Stop for a second after you have, before sending out:<ul> <li>Implemented code or a notebook</li> <li>Written documentation</li> <li>Written an e-mail</li> <li>...</li> </ul> </li> <li>Reset your mind and look at everything with fresh eyes like if it was the     first time you saw it<ul> <li>Does everything make sense to someone that sees this for the first time?</li> <li>Can (and should) it be improved?</li> <li>Do you see inconsistencies, potential issues?</li> </ul> </li> <li>It will take less and less time to become good at this</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#no_ugly_hacks","title":"No Ugly Hacks","text":"<ul> <li>We don't tolerate \"ugly hacks\", i.e., hacks that require lots of work to be     undone (much more than the effort to do it right in the first place)<ul> <li>Especially an ugly design hack, e.g., a Singleton, or some unnecessary     dependency between distant pieces of code</li> <li>Ugly hacks spreads everywhere in the code base</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#our_coding_suggestions","title":"Our Coding Suggestions","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#being_careful_with_naming","title":"Being Careful with Naming","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#follow_the_conventions","title":"Follow the Conventions","text":"<ul> <li>Name executable files (scripts) and library functions using verbs (e.g.,     <code>download.py</code>, <code>download_data()</code>)</li> <li>Name classes and (non-executable) files using nouns (e.g., <code>Downloader()</code>,     <code>downloader.py</code>)</li> <li>For decorators we don't use a verb as we do for normal functions, but rather     an adjective or a past tense verb, e.g.,     <code>python def timed(f):         \"\"\"         Add a timer decorator around a specified function.         \"\"\"         ...</code></li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#follow_spelling_rules","title":"Follow Spelling Rules","text":"<ul> <li>We spell commands in lower-case, and programs with initial upper case:<ul> <li>\"Git\" (as program), \"git\" (as the command)</li> </ul> </li> <li>We distinguish \"research\" (not \"default\", \"base\") vs \"production\"</li> <li>We use different names for indicating the same concept, e.g., <code>dir</code>, <code>path</code>,     <code>folder</code><ul> <li>Preferred term is <code>dir</code></li> </ul> </li> <li>Name of columns<ul> <li>The name of columns should be <code>..._col</code> and not <code>..._col_name</code> or <code>_column</code></li> </ul> </li> <li>Timestamp<ul> <li>We spell <code>timestamp</code>, we do not abbreviate it as <code>ts</code></li> <li>We prefer timestamp to <code>datetime</code><ul> <li>E.g., <code>start_timestamp</code> instead of <code>start_datetime</code></li> </ul> </li> </ul> </li> <li>Abbreviations<ul> <li>JSON, CSV, DB, etc., are abbreviations and thus should be capitalized in     comments and docstrings, and treated as abbreviations in code when it     doesn't conflict with other rules<ul> <li>E.g., <code>convert_to_CSV</code>, but <code>csv_file_name</code> as a variable name that is not     global</li> </ul> </li> <li>Profit-and-loss: PnL instead of pnl or PNL</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#search_good_names_avoid_bad_names","title":"Search Good Names, Avoid Bad Names","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#general_naming_rules","title":"General Naming Rules","text":"<ul> <li>Naming things properly is one of the most difficult task of a programmer /     data scientist<ul> <li>The name needs to be (possibly) short and memorable<ul> <li>However, don't be afraid to use long names, if needed, e.g.,     <code>process_text_with_full_pipeline_twitter_v1</code></li> <li>Clarity is more important than number of bytes used</li> </ul> </li> <li>The name should capture what the object represents, without reference to     things that can change or to details that are not important</li> <li>The name should refer to what objects do (i.e., mechanisms), rather than how     we use them (i.e., policies)</li> <li>The name needs to be non-controversial: people need to be able to map the     name in their mental model</li> <li>The name needs to sound good in English<ul> <li>Bad: <code>AdapterSequential</code> sounds bad</li> <li>Good: <code>SequentialAdapter</code> sounds good</li> </ul> </li> </ul> </li> <li>Some examples of how NOT to do naming:<ul> <li><code>raw_df</code> is a terrible name<ul> <li>\"raw\" with respect to what?</li> <li>Cooked?</li> <li>Read-After-Write race condition?</li> </ul> </li> <li><code>person_dict</code> is bad<ul> <li>What if we switch from a dictionary to an object?<ul> <li>Then we need to change the name everywhere!</li> </ul> </li> <li>The name should capture what the data structure represents (its semantics)     and not how it is implemented</li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#do_not_be_stingy","title":"Do Not Be Stingy","text":"<ul> <li>Why calling an object <code>TimeSeriesMinStudy</code> instead of <code>TimeSeriesMinuteStudy</code>?<ul> <li>Saving 3 letters is not worth</li> <li>The reader might interpret <code>Min</code> as <code>Minimal</code> (or <code>Miniature</code>, <code>Minnie</code>,     <code>Minotaur</code>)</li> </ul> </li> <li>If you don't like to type, we suggest you get a better keyboard, e.g.,     this</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#do_not_abbreviate_just_to_save_characters","title":"Do Not Abbreviate Just to Save Characters","text":"<ul> <li>Abbreviations just to save space are rarely beneficial to the reader. E.g.,<ul> <li>Fwd (forward)</li> <li>Bwd (backward)</li> <li>Act (actual)</li> <li>Exp (expected)</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#when_to_use_abbreviations","title":"When to Use Abbreviations","text":"<ul> <li>We could relax this rule for short lived functions and variables in order to     save some visual noise.</li> <li>Sometimes an abbreviation is so short and common that it's ok to leave it     E.g.,<ul> <li>Df (dataframe)</li> <li>Srs (series)</li> <li>Idx (index)</li> <li>Id (identifier)</li> <li>Val (value)</li> <li>Var (variable)</li> <li>Args (arguments)</li> <li>Kwargs (keyword arguments)</li> <li>Col (column)</li> <li>Vol (volatility) while volume is always spelled out</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#avoid_code_stutter","title":"Avoid Code Stutter","text":"<ul> <li>An example of code stutter: you want to add a function that returns <code>git</code> root     path in a module <code>git</code></li> <li>Bad<ul> <li> <p>Name is <code>get_git_root_path()</code></p> <p>```python import helpers.hgit as hgit</p> </li> </ul> </li> </ul> <p>... hgit.get_git_root_path()         ```     - You see that the module is already specifying we are talking about Git</p> <ul> <li>Good<ul> <li> <p>Name is <code>get_root_path()</code></p> <p>```python import helpers.hgit as hgit</p> </li> </ul> </li> </ul> <p>... hgit.get_root_path()         ```     - This is not only aesthetic reason but a bit related to a weak form of DRY</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#comments_and_docstrings","title":"Comments and Docstrings","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#general_conventions","title":"General Conventions","text":"<ul> <li>Code needs to be properly commented</li> <li>We follow Python standard PEP 257     for commenting<ul> <li>PEP 257 standardizes what comments should express and how they should do it     (e.g., use triple quotes for commenting a function), but does not specify     what markup syntax should be used to describe comments</li> </ul> </li> <li>Different conventions have been developed for documenting interfaces<ul> <li>ReST</li> <li>Google (which is cross-language, e.g., C++, Python, ...)</li> <li>Epytext</li> <li>Numpydoc</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#descriptive_vs_imperative_style","title":"Descriptive vs Imperative Style","text":"<ul> <li>We decided to use imperative style for our comments and docstrings<ul> <li>Pylint and other Python QA tools favor an imperative style</li> <li>From PEP 257 <pre><code>The docstring is a phrase ending in a period. It prescribes the function or\nmethod's effect as a command (\"Do this\", \"Return that\"), not as a description;\ne.g. don't write \"Returns the pathname ...\".\n</code></pre></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#docstrings_style","title":"Docstrings Style","text":"<ul> <li>We follow ReST (aka re-Structured Text) style for docstrings which is:<ul> <li>The most widely supported in the Python community</li> <li>Supported by all doc generation tools (e.g., epydoc, sphinx)</li> <li>Default in Pycharm</li> <li>Default in <code>pyment</code></li> <li>Supported by <code>pydocstyle</code> (which does not support Google style as explained     here)</li> </ul> </li> <li> <p>Example of a function definition with ReST styled docstring:</p> <p>```python def my_function(param1: str) -&gt; str:     \"\"\"     A one-line description of what the function does.</p> <pre><code>A longer description (possibly on multiple lines) with a more detailed\nexplanation of what the function does, trying to not be redundant with\nthe parameter / return description below. The focus is on the interface\nand what the user should know to use the function and not how the\nfunction is implemented.\n\n:param param1: this is the first param\n:return: this is a description of what is returned\n\"\"\"\n</code></pre> <p><code>`` - We use lowercase after</code>:param XYZ: ...<code>/</code>:return:` unless the first word is     a proper noun - First docstring line must be a single line - A full ReST docstring styling also requires to specify params and return     types, however type hinting makes it redundant so you should use only type     hinting</p> </li> <li> <p>Put docstrings in triple quotation marks</p> <ul> <li>Bad <code>python Generate \"random returns\".</code></li> <li>Good <code>python \"\"\" Generate \"random returns\". \"\"\"</code></li> </ul> </li> <li>Sometimes functions are small enough so we just use a 1-liner docstring     without detailed params and return descriptions. Just do not put text and     docstring brackets in one line<ul> <li>Bad <code>python \"\"\"This is not our approach.\"\"\"</code></li> <li>Good <code>python \"\"\" This is our approach. \"\"\"</code></li> </ul> </li> <li>Follow this example for indentation of param/return descriptions:<ul> <li>Good     ```python \"\"\" :param param1: a very very long param description that     continues into a second line :param param2: a param with two possible values<ul> <li>first value description</li> <li>second value description that is very long and     continues into a second line \"\"\" ```</li> </ul> </li> </ul> </li> <li>More examples of and discussions on Python docstrings</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#doctrings_content","title":"Doctrings Content","text":"<ul> <li> <p>The docstring should focus on the \"what\" (the goal of the code) and not the     \"how\" (the implementation)</p> </li> <li> <p>The docstring should not be a line-by-line \"translation\" of code into text</p> <ul> <li>People can look at the code if they want to know the details of the     implementation</li> <li>We don't want to create a maintainability burden where the docstring should     change with every update in the implementation</li> </ul> </li> <li> <p>We encourage adding examples (e.g., of input and output) to the docstring to     improve clarity</p> </li> <li> <p>Type of variables should not be mentioned in <code>:param:</code>/<code>:return:</code> descriptions</p> <ul> <li>E.g., do not do <code>:return: a list of messages</code>, do <code>:return: messages</code></li> <li>Types should already be evident (from the type hinting)</li> <li>We don't want to have to change all the docstrings if we change the     implementation (e.g., turn a list into a set)</li> </ul> </li> <li> <p>Default values of parameters should not be mentioned in <code>:param:</code> descriptions     for the same reasons as above</p> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#comments_style","title":"Comments Style","text":"<ul> <li>Comments follow the same style of docstrings, e.g., imperative style, start     with a capital letter, with period <code>.</code> at the end<ul> <li>Bad     ```python</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#this_comment_is_not_imperative_not_capitalized_and_has_no_period_at_the_end","title":"this comment is not imperative, not capitalized and has no period at the end","text":"<pre><code>    ```\n- _Good_\n    ```python\n</code></pre>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#make_comments_imperative_start_with_a_capital_letter_and_end_with_a_period","title":"Make comments imperative, start with a capital letter and end with a period.","text":"<pre><code>    ```\n</code></pre> <ul> <li>Always place comments above the lines that they are referring to. Avoid     writing comments on the same line as code since they require extra maintenance     (e.g., when the line becomes too long)<ul> <li>Bad <code>python print(\"hello world\")      # Introduce yourself.</code></li> <li>Good     ```python</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#introduce_yourself","title":"Introduce yourself.","text":"<p>print(\"hello world\")         <code>- The only exception is commenting `if-elif-else` statements: we comment them     underneath the each statement in order to explain the code that belongs to the     each statement particularly     - _Bad_</code>python</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#set_remapping_based_on_the_run_type","title":"Set remapping based on the run type.","text":"<p>if is_prod:         ... else:         ...         <code>- _Good_</code>python</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#_1","title":"All.coding style.how to guide","text":"<p>if is_prod:         # Set remapping for database data used in production.         ... else:         # Set remapping for file system data used in simulation.         ...         <code>``         - If you want to separate an</code>if` statement from a bunch of code preceding             it, you can leave an empty comment before it</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#replace_empty_lines_in_code_with_comments","title":"Replace Empty Lines in Code with Comments","text":"<ul> <li> <p>The problem with empty lines is that they are visually confusing since one     empty line is used also to separate functions. For this reason we suggest     using a comment</p> </li> <li> <p>If you feel that you need an empty line in the code, it probably means that a     specific chunk of code is a logical piece of code performing a cohesive     function</p> <p>```python ... end_y = end_dt.year</p> </li> </ul> <p>paths = list() ...     ```</p> <ul> <li>Instead of putting an empty line, you should put a comment describing at high     level what the code does.     ```python ... end_y = end_dt.year</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#generate_a_list_of_file_paths_for_parquet_dataset","title":"Generate a list of file paths for Parquet dataset.","text":"<p>paths = list() ...     <code>- A less optimal solution is to add an empty comment, but this is not great:</code>python ... end_y = end_dt.year</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#_2","title":"All.coding style.how to guide","text":"<p>paths = list() ...     ```</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#comment_chunks_of_code","title":"Comment Chunks of Code","text":"<ul> <li> <p>Avoid wall-of-code, by commenting chunks of code that perform a cohesive work</p> </li> <li> <p>Bad</p> <p><code>python system_log_dir = rsiprrec.get_system_log_dir(mode) prod_dir = os.path.join(target_dir, system_log_dir) hio.create_dir(prod_dir, incremental=True) config_dict = {     \"dag_runner_config\": {             \"wake_up_timestamp\": \"2023-11-13 08:09:00-05:00\",             \"rt_timeout_in_secs_or_time\": 86400,             \"bar_duration_in_secs\": 300,     }, } config = cconfig.Config.from_dict(config_dict) config_tag = \"system_config.output\" config.save_to_file(prod_dir, config_tag)</code></p> </li> <li> <p>The code above has obviously various chunks that can be described with     comments     <pre><code># Create a dir to store the System Config.\n...\n# Create an example Config.\n...\n# Save the Config in the target dir.\n</code></pre></p> </li> <li> <p>Good</p> <p>```python</p> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#create_a_dir_to_store_the_system_config","title":"Create a dir to store the System Config.","text":"<p>system_log_dir = rsiprrec.get_system_log_dir(mode) prod_dir = os.path.join(target_dir, system_log_dir) hio.create_dir(prod_dir, incremental=True)</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#create_an_example_config","title":"Create an example Config.","text":"<p>config_dict = {     \"dag_runner_config\": {             \"wake_up_timestamp\": \"2023-11-13 08:09:00-05:00\",             \"rt_timeout_in_secs_or_time\": 86400,             \"bar_duration_in_secs\": 300,     }, } config = cconfig.Config.from_dict(config_dict) config_tag = \"system_config.output\"</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#save_the_config_in_the_target_dir","title":"Save the Config in the target dir.","text":"<p>config.save_to_file(prod_dir, config_tag) ```</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#referring_to_an_object_in_code_comments","title":"Referring to an Object in Code Comments","text":"<ul> <li>In general, avoid this whenever possible</li> <li>Code object names (e.g., function, class, params) are often subject to change,     so we need to take care of them everywhere. It is very hard to track all of     them in comments so replace the names with their actual meaning<ul> <li>Bad     ```python</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#generate_a_list_of_file_paths_for_parquetdataset","title":"Generate a list of file paths for <code>ParquetDataset</code>.","text":"<pre><code>    ```\n- _Good_\n    ```python\n</code></pre>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#generate_a_list_of_file_paths_for_parquet_dataset_1","title":"Generate a list of file paths for Parquet dataset.","text":"<pre><code>    ```\n</code></pre> <ul> <li>However, sometimes it is necessary. In this case refer to objects in the code     using Markdown. This is useful for distinguishing the object code from the     real-life object<ul> <li>Bad     ```python</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#the_dataframe_df_tmp_is_used_for","title":"The dataframe df_tmp is used for ...","text":"<pre><code>    ```\n- _Good_\n    ```python\n</code></pre>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#the_dataframe_df_tmp_is_used_for_1","title":"The dataframe <code>df_tmp</code> is used for ...","text":"<pre><code>    ```\n</code></pre>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#referring_to_type_of_vars_in_code_comments","title":"Referring to Type of Vars in Code Comments","text":"<ul> <li>Similarly, and for the same reason, avoid referring to the type of a variable     in the comments<ul> <li>Bad     ```python</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#filter_the_list_of_llm_prompts","title":"Filter the list of LLM prompts.","text":"<pre><code>    ```\n- _Good_\n    ```python\n</code></pre>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#filter_the_llm_prompts","title":"Filter the LLM prompts.","text":"<pre><code>    ```\n</code></pre>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#avoid_distracting_comments","title":"Avoid Distracting Comments","text":"<ul> <li>Use comments to explain the high level logic / goal of a piece of code and not     the implementation details (\"what\" and not \"how\")<ul> <li>Bad     ```python</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#format_the_output_by_displaying_only_the_beginning_and_the_end_segments","title":"Format the output by displaying only the beginning and the end segments.","text":"<pre><code>    ```\n- _Good_\n    ```python\n</code></pre>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#format_the_output","title":"Format the output.","text":"<pre><code>    ```\n</code></pre> <ul> <li>Do not comment things that are obvious<ul> <li>Bad     ```python</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#print_results","title":"Print results.","text":"<p>_LOG.info(\"Results are %s\", ...)         ```</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#commenting_out_code","title":"Commenting Out Code","text":"<ul> <li>When we comment out code, we should explain why it is no longer relevant<ul> <li>Bad     ```python is_alive = pd.Series(True, index=metadata.index)</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#is_alive_kgutilsannotate_alivemetadata_selfalive_cutoff","title":"is_alive = kgutils.annotate_alive(metadata, self.alive_cutoff)","text":"<pre><code>    ```\n- _Good_\n    ```python\n</code></pre>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#todo_as_discussed_in_ptask5047_for_now_we_set_all_timeseries_to_be_alive","title":"TODO(*): As discussed in PTask5047 for now we set all timeseries to be alive.","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#is_alive_kgutilsannotate_alivemetadata_selfalive_cutoff_1","title":"is_alive = kgutils.annotate_alive(metadata, self.alive_cutoff)","text":"<p>is_alive = pd.Series(True, index=metadata.index)         ```</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#use_type_hints","title":"Use Type Hints","text":"<ul> <li>We expect new code to use type hints whenever possible<ul> <li>See PEP 484</li> <li>Type hints cheat sheet</li> </ul> </li> <li>At some point we will start adding type hints to old code</li> <li>We use <code>mypy</code> to check for type mistakes and to enforce type hints as part of     the Linter flow</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#interval_notation","title":"Interval Notation","text":"<ul> <li>Intervals are represented with <code>[a, b), (a, b], (a, b), [a, b]</code></li> <li>We don't use the other style <code>[a, b[</code></li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#if_you_find_a_bug_or_obsolete_docstringtodo_in_the_code","title":"If You Find a Bug or Obsolete Docstring/Todo in the Code","text":"<ul> <li>The process is:<ul> <li>Do a <code>git blame</code> to find who wrote the code</li> <li>If it's an easy bug, you can fix it and ask for a review from the author</li> <li>You can comment on a PR (if there is one)</li> <li>You can file a bug on Github with<ul> <li>Clear info on the problem</li> <li>How to reproduce it, ideally a unit test</li> <li>Stacktrace</li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#linter","title":"Linter","text":"<ul> <li>Linter is in charge of reformatting the code according to our conventions and     reporting potential problems</li> <li>You can find instructions on how to run Linter     here</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#remove_linter_messages","title":"Remove Linter Messages","text":"<ul> <li>When Linter reports a problem:<ul> <li>We assume that Linter messages are correct, until it is proven wrong</li> <li>We try to understand what is the rationale for Linter's complaints</li> <li>We then change the code to follow Linter's suggestions and remove the lint</li> </ul> </li> <li>If you think a message is too pedantic, please file a bug with the example and     as a team we will consider whether to exclude that message from our list of     Linter suggestions</li> <li>If you think the message is a false positive, then try to change the code to     make Linter happy<ul> <li>E.g., if the code depends on some run-time behavior that Linter can't infer,     then you should question whether that behavior is really needed</li> <li>A human reader would probably be as confused as Linter is</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#when_to_disable_linter_messages","title":"When to Disable Linter Messages","text":"<ul> <li>If you really believe you should override Linter in this particular case, then     use something like:     ```python</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#pylint_disablesome-messageanother-one","title":"pylint: disable=some-message,another-one","text":"<pre><code>```\n- You then need to explain in a comment why you are overriding Linter.\n- Don't use Linter code numbers, but the\n    [symbolic name](https://github.com/josherickson/pylint-symbolic-names)\n    whenever possible:\n    - _Bad_\n        ```python\n</code></pre>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#pylint_disablew0611","title":"pylint: disable=W0611","text":"<p>import config.logging_settings             <code>- _Good_</code>python</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#pylint_disableunused-import","title":"pylint: disable=unused-import","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#this_is_needed_when_evaluating_code_at_run-time_that_depends_from","title":"This is needed when evaluating code at run-time that depends from","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#this_import","title":"this import.","text":"<p>import config.logging_settings             ```</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#prefer_non-inlined_linter_comments","title":"Prefer Non-Inlined Linter Comments","text":"<ul> <li>As for the general comments, we prefer to make Linter comments non-inlined</li> <li>However, sometimes there is no other choice than an inlined comment to get     Linter to understand which line we are referring to, so in rare cases it is     OK:<ul> <li>Bad but ok if needed     <code>python import config.logging_settings  # pylint: disable=unused-import</code></li> <li>Good     ```python</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#pylint_disableline-too-long","title":"pylint: disable=line-too-long","text":"<pre><code>expected_df_as_str = \"\"\"# df=\n                                                        asset_id   last_price            start_datetime              timestamp_db\nend_datetime\n2000-01-01 09:31:00-05:00      1000   999.874540 2000-01-01 09:30:00-05:00 2000-01-01 09:31:00-05:00\n2000-01-01 09:32:00-05:00      1000  1000.325254 2000-01-01 09:31:00-05:00 2000-01-01 09:32:00-05:00\n2000-01-01 09:33:00-05:00      1000  1000.557248 2000-01-01 09:32:00-05:00 2000-01-01 09:33:00-05:00\"\"\"\n# pylint: enable=line-too-long\n    ```\n</code></pre>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#dont_mix_real_changes_with_linter_changes","title":"Don'T Mix Real Changes with Linter Changes","text":"<ul> <li>We don't commit changes that modify the code together with Linter     reformatting, unless linting is applied to the changes we just made<ul> <li>The reason for not mixing real and Linter changes is that for a PR or to     just read the code it is difficult to understand what really changed vs what     was just a cosmetic modification</li> </ul> </li> <li>If you are worried Linter might change your code in a way you don't like,     e.g.,<ul> <li>Screwing up some formatting you care about for some reason, or</li> <li>Suggesting changes that you are worried might introduce bugs you can commit     your code and then do a \"lint commit\" with a message \"CMTaskXYZ: Lint\"</li> <li>In this way you have a backup state that you can rollback to, if you want</li> </ul> </li> <li>If you run Linter and see that it is reformatting / modifying pieces of code     you didn't change, it means that our teammate forgot to lint their code<ul> <li><code>git blame</code> can figure out the culprit</li> <li>You can send him / her a ping to remind her to lint, so you don't have to     clean after him / her</li> <li>In this case, the suggested approach is:<ul> <li>Commit your change to a branch / stash</li> <li>Run Linter by itself on the files that need to be cleaned, without any     change</li> <li>Run the unit tests to make sure nothing is breaking</li> <li>You can fix lints or just do formatting: it's up to you</li> <li>You can make this change directly on <code>master</code> or do a PR if you want to be     extra sure: your call</li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#logging","title":"Logging","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#always_use_logging_instead_of_prints","title":"Always Use Logging Instead of Prints","text":"<ul> <li>Always use <code>logging</code> and never <code>print()</code> to monitor the execution</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#our_logging_idiom","title":"Our Logging Idiom","text":"<ul> <li> <p>In order to use our logging framework (e.g., <code>-v</code> from command lines, and much     more) use:</p> <p>```python import helpers.hdbg as hdbg</p> </li> </ul> <p>_LOG = logging.getLogger(name)</p> <p>hdbg.init_logger(verbosity=logging.DEBUG)</p> <p>_LOG.debug(\"I am a debug function about %s\", a)     ```</p> <ul> <li>In this way one can decide how much debug info is needed (see Unix rule of     silence)<ul> <li>E.g., when there is a bug one can run with <code>-v DEBUG</code> and see what's     happening right before the bug</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#logging_level","title":"Logging Level","text":"<ul> <li>Use <code>_LOG.warning</code> for messages to the final user related to something     unexpected where the code is making a decision that might be controversial<ul> <li>E.g., processing a dir that is supposed to contain only <code>.csv</code> files the     code finds a non-<code>.csv</code> file and decides to skip it, instead of breaking</li> </ul> </li> <li>Use <code>_LOG.info</code> to communicate to the final user, e.g.,<ul> <li>When the script is started</li> <li>Where the script is saving its results</li> <li>A progress bar indicating the amount of work completed</li> </ul> </li> <li>Use <code>_LOG.debug</code> to communicate information related to the internal behavior     of code<ul> <li>Do not pollute the output with information a regular user does not care     about</li> </ul> </li> <li>Make sure the script prints when the work is terminated, e.g., \"DONE\" or     \"Results written to ...\"<ul> <li>This is useful to indicate that the script did not die in the middle:     sometimes this happens silently and it is reported only from the OS return     code</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#how_to_pick_the_level_for_a_logging_statement","title":"How to Pick the Level for a Logging Statement","text":"<ul> <li>If all the debug info was printed at <code>INFO</code> level, the output will be too slow     by default</li> <li>So we separate what needs to be always printed (i.e., <code>INFO</code>) and what is     needed only if there is a problem to debug (i.e., <code>DEBUG</code>)<ul> <li>Only who writes the code should decide what is <code>DEBUG</code>, since they know what     is needed to debug</li> <li>In fact many loggers use multiple levels of debugging level depending of how     much detailed debugging info are needed</li> </ul> </li> <li><code>logging</code> has ways to enable logging on a per module basis<ul> <li>So in prod mode you need to know which part you want to debug, since     printing everything at <code>INFO</code> level is not possible</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#use_positional_args_when_logging","title":"Use Positional Args When Logging","text":"<ul> <li>Bad <code>python _LOG.debug(\"cmd=%s %s %s\" % (cmd1, cmd2, cmd3)) _LOG.debug(\"cmd=%s %s %s\".format(cmd1, cmd2, cmd3)) _LOG.debug(\"cmd={cmd1} {cmd2} {cmd3}\")</code></li> <li>Good <code>python _LOG.debug(\"cmd=%s %s %s\", cmd1, cmd2, cmd3)</code></li> <li>All the statements are equivalent from the functional point of view</li> <li>The reason is that in the second case the string is not built unless the     logging is actually performed, which limits time overhead from logging</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#exceptions_dont_allow_positional_args","title":"Exceptions Don'T Allow Positional Args","text":"<ul> <li>For some reason people tend to believe that using the <code>logging</code> / <code>dassert</code>     approach of positional param to exceptions<ul> <li>Bad (use positional args)     <code>python raise ValueError(\"Invalid server_name='%s'\", server_name)</code></li> <li>Good (use string interpolation)     <code>python raise ValueError(\"Invalid server_name='%s'\" % server_name)</code></li> <li>Best (use string format)     <code>python raise ValueError(f\"Invalid server_name='{server_name}'\")</code></li> </ul> </li> <li>The constructor of an exception accepts a string</li> <li>Using the string f-format is best since<ul> <li>It's more readable</li> <li>There is little time overhead since if you get to the exception probably the     code is going to terminate, and it's not in a hot loop</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#report_warnings","title":"Report Warnings","text":"<ul> <li>If there is a something that is suspicious but you don't feel like it's     worthwhile to assert, report a warning with:     <code>python _LOG.warning(...)</code></li> <li>If you know that if there is a warning then there are going to be many many     warnings<ul> <li>Print the first warning</li> <li>Send the rest to <code>warnings.log</code></li> <li>At the end of the run, reports \"there are warnings in warnings.log\"</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#assertions","title":"Assertions","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#validate_values_before_an_assignment","title":"Validate Values Before an Assignment","text":"<ul> <li>We consider this as an extension of a pre-condition (\"only assign values that     are correct\") rather than a postcondition</li> <li>Often is more compact since it doesn't have reference to <code>self</code><ul> <li>Bad <code>python self._tau = tau hdbg.dassert_lte(self._tau, 0)</code></li> <li>Good <code>python hdbg.dassert_lte(tau, 0) self._tau = tau</code></li> <li> <p>Exceptions</p> <p>When we handle a default assignment, it's more natural to implement a post-condition:</p> <p><code>python col_rename_func = col_rename_func or (lambda x: x) hdbg.dassert_isinstance(col_rename_func, collections.Callable)</code></p> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#encode_the_assumptions_using_assertions","title":"Encode the Assumptions Using Assertions","text":"<ul> <li>If your code makes an assumption don't just write a comment, but implement an     assertion so the code can't be executed if the assertion is not verified     (instead of failing silently)     <code>python hdbg.dassert_lt(start_date, end_date)</code></li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#use_positional_args_when_asserting","title":"Use Positional Args When Asserting","text":"<ul> <li><code>dassert_*</code> is modeled after logging so for the same reasons one should use     positional args</li> <li>Bad <code>python hdbg.dassert_eq(a, 1, \"No info for %s\" % method)</code>     Good     <code>python hdbg.dassert_eq(a, 1, \"No info for %s\", method)</code></li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#report_as_much_information_as_possible_in_an_assertion","title":"Report as Much Information as Possible in an Assertion","text":"<ul> <li>When using a <code>dassert_*</code> you want to give to the user as much information as     possible to fix the problem<ul> <li>E.g., if you get an assertion after 8 hours of computation you don't want to     have to add some logging and run for 8 hours to just know what happened</li> </ul> </li> <li>A <code>dassert_*</code> typically prints as much info as possible, but it can't report     information that is not visible to it:<ul> <li>Bad <code>python hdbg.dassert(string.startswith(\"hello\"))</code><ul> <li>You don't know what is value of <code>string</code> is</li> </ul> </li> <li>Good <code>python hdbg.dassert(string.startswith(\"hello\"), \"string='%s'\", string)</code><ul> <li>Note that often is useful to add <code>'</code> (single quotation mark) to fight     pesky spaces that make the value unclear, or to make the error as readable     as possible</li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#imports","title":"Imports","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#dont_use_evil_import","title":"Don'T Use Evil <code>import *</code>","text":"<ul> <li>Do not use in notebooks or code the evil <code>import *</code><ul> <li>Bad <code>python from helpers.hsql import *</code></li> <li>Good <code>python import helpers.hsql as hsql</code></li> </ul> </li> <li>The <code>from ... import *</code>:<ul> <li>Pollutes the namespace with the symbols and spreads over everywhere, making     it painful to clean up</li> <li>Obscures where each function is coming from, removing the context that comes     with the namespace</li> <li>Is evil in many other ways</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#cleaning_up_the_evil_import","title":"Cleaning Up the Evil <code>import *</code>","text":"<ul> <li>To clean up the mess you can:<ul> <li>For notebooks<ul> <li>Find &amp; replace (e.g., using jupytext and Pycharm)</li> <li>Change the import and run one cell at the time</li> </ul> </li> <li>For code<ul> <li>Change the import and use Linter on file to find all the problematic spots</li> </ul> </li> </ul> </li> <li>One of the few spots where the evil <code>import *</code> is ok is in the <code>__init__.py</code>     to tweak the path of symbols exported by a library<ul> <li>This is an advanced topic and you should rarely use it</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#avoid_from_import","title":"Avoid <code>from ... import ...</code>","text":"<ul> <li>Import should always start from <code>import</code>:     <code>python import library as short_name import library.sublibrary as short_name</code></li> <li>This rule applies to imports of third party libraries and our library</li> <li>Because of this rule we have to always specify a short import of a parent lib     before every code object that does not belong to the file:<ul> <li>Bad <code>python from helpers.hsql import get_connection, get_connection_from_env_vars, \\     DBConnection, wait_connection_from_db, execute_insert_query</code></li> <li>Good <code>python import helpers.hsql as hsql ... ... hsql.get_connection()</code></li> </ul> </li> <li>The problem with the <code>from ... import ...</code> is that it:<ul> <li>Creates lots of maintenance effort<ul> <li>E.g., anytime you want a new function you need to update the import     statement</li> </ul> </li> <li>Creates potential collisions of the same name<ul> <li>E.g., lots of modules have a <code>read_data()</code> function</li> </ul> </li> <li>Impairs debugging<ul> <li>Importing directly in the namespace loses information about the module</li> <li>E.g.,<code>read_documents()</code> is not clear: what documents?</li> <li><code>np.read_documents()</code> at least gives information of which packages is it     coming from and enables us to track it down to the code</li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#exceptions_to_the_import_style","title":"Exceptions to the Import Style","text":"<ul> <li>We try to minimize the exceptions to this rule to avoid to keep this rule     simple, rather than discussing about</li> <li>The current agreed upon exceptions are:<ul> <li>For <code>typing</code> it is ok to do:     <code>python from typing import Iterable, List</code>     in order to avoid typing everywhere, since we want to use type hints as much     as possible</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#always_import_with_a_full_path_from_the_root_of_the_repo_submodule","title":"Always Import with a Full Path From the Root of the Repo / Submodule","text":"<ul> <li>Bad <code>python import exchange_class</code></li> <li>Good <code>python import datapull.ccxt.data.extract.exchange_class</code><ul> <li>In this way your code can run without depending upon your current dir</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#baptizing_module_import","title":"Baptizing Module Import","text":"<ul> <li> <p>Each module that can be imported should have a docstring at the very beginning     (before any code) describing how it should be imported</p> <p>```python \"\"\" Import as:</p> </li> </ul> <p>import datapull.ccxt.data.client.ccxt_clients as imvcdccccl \"\"\"     ```</p> <ul> <li>The import abbreviations are called 'short imports' and usually consist of 7-9     first letters of all the words that comprise path to file</li> <li>DO NOT simply give a random short import name<ul> <li>Run Linter to generate short import for a file automatically</li> </ul> </li> <li>For some most files we specify short imorts by hand so thay may contain less     symbols, e.g., <code>hdbg</code></li> <li>The goal is to have always the same imports so it's easy to move code around,     without collisions</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#examples_of_imports","title":"Examples of Imports","text":"<ul> <li>Example 1<ul> <li>Bad <code>python from datapull.ccxt.data.client import ccxt_clients as ccxtcl</code></li> <li>Good <code>python import datapull.ccxt.data.client.ccxt_clients as imvcdccccl</code></li> </ul> </li> <li>Example 2<ul> <li>Bad <code>python from edgar.shared import headers_extractor as he</code></li> <li>Good <code>python import edgar.shared.headers_extractor as eshheext</code></li> </ul> </li> <li>Example 3<ul> <li>Bad <code>python from helpers import hdbg</code></li> <li>Good <code>python import helpers.hdbg as hdbg</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#scripts","title":"Scripts","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#use_python_and_not_bash_for_scripting","title":"Use Python and Not Bash for Scripting","text":"<ul> <li>We prefer to use Python instead of bash scripts with very few exceptions<ul> <li>E.g., scripts that need to modify the environment by setting env vars, like     <code>setenv.sh</code></li> </ul> </li> <li>The problem with bash scripts is that it's too easy to put together a sequence     of commands to automate a workflow</li> <li>Quickly things always become more complicated than what you thought, e.g.,<ul> <li>You might want to interrupt if one command in the script fails</li> <li>You want to use command line options</li> <li>You want to use logging to see what's going on inside the script</li> <li>You want to do a loop with a regex check inside</li> </ul> </li> <li>Thus you need to use the more complex features of bash scripting and bash     scripting is absolutely horrible, much worse than perl (e.g., just think of     <code>if [ ... ]</code> vs <code>if [[ ... ]]</code>)</li> <li>Our approach is to make simple to create scripts in Python that are equivalent     to sequencing shell commands, so that can evolve in complex scripts</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#template_for_a_script","title":"Template for a Script","text":"<ul> <li>The ingredients are:<ul> <li><code>/dev_scripts_helpers/coding_tools/script_template.py</code>:     a template to write simple scripts you can copy and modify it</li> <li><code>/helpers/hsystem.py</code>: a set of utilities that make     simple to run shell commands (e.g., capturing their output, breaking on     error or not, tee-ing to file, logging, ...)</li> <li><code>helpers</code> has lots of useful libraries</li> </ul> </li> <li>The official reference for a script is     <code>/dev_scripts_helpers/coding_tools/script_template.py</code><ul> <li>You can copy this file and change it</li> <li>A simple example is:     <code>/dev_scripts_helpers/git/gup.py</code></li> <li>A complex example is:     <code>/dev_scripts_helpers/system_tools/replace_text.py</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#some_useful_patterns","title":"Some Useful Patterns","text":"<ul> <li>Some useful patterns / idioms that are supported by the framework are:<ul> <li>Incremental mode: you skip an action if its outcome is already present     (e.g., skipping creating a dir, if it already exists and it contains all the     results)</li> <li>Non-incremental mode: clean and execute everything from scratch</li> <li>Dry-run mode: the commands are written to screen instead of being executed</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#use_scripts_and_not_notebooks_for_long-running_jobs","title":"Use Scripts and Not Notebooks for Long-Running Jobs","text":"<ul> <li>We prefer to use scripts to execute code that might take long time (e.g.,     hours) to run, instead of notebooks</li> <li>Pros of script<ul> <li>All the parameters are completely specified by a command line</li> <li>Reproducible and re-runnable</li> </ul> </li> <li>Cons of notebooks<ul> <li>Tend to crash / hang for long jobs</li> <li>Not easy to understand if the notebook is doing progress</li> <li>Not easy to get debug output</li> </ul> </li> <li>Notebooks are designed for interactive computing / debugging and not batch     jobs<ul> <li>You can experiment with notebooks, move the code into a library, and wrap it     in a script</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#follow_the_same_structure","title":"Follow the Same Structure","text":"<ul> <li>All Python scripts that are meant to be executed directly should:<ol> <li>Be marked as executable files with:  <pre><code>&gt; chmod +x foo_bar.py\n</code></pre></li> <li>Have the Python code should start with the standard Unix shebang notation:  ```python</li> </ol> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#usrbinenv_python","title":"!/usr/bin/env python","text":"<pre><code> ```\n- This line tells the shell to use the `python` defined in the environment\n- In this way you can execute directly without prepending with \"python\"\n3. Have a:\n ```python\n</code></pre> <p>if name == \"main\":         ...      <code>``     4. Ideally use</code>argparse` to have a minimum of customization</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#use_clear_names_for_the_scripts","title":"Use Clear Names for the Scripts","text":"<ul> <li>In general scripts (like functions) should have a name like \"action_verb\".<ul> <li>Bad<ul> <li>Examples of bad script names are <code>timestamp_extractor.py</code> and     <code>timestamp_extractor_v2.py</code><ul> <li>Which timestamp data set are we talking about?</li> <li>What type of timestamps are we extracting?</li> <li>What is the difference about these two scripts?</li> </ul> </li> </ul> </li> </ul> </li> <li>We need to give names to scripts that help people understand what they do and     the context in which they operate</li> <li>We can add a reference to the task that originated the work (to give more     context)<ul> <li>Good<ul> <li>E.g., for a script generating a dataset there should be an (umbrella) bug     for this dataset, that we refer in the bug name, e.g.,     <code>TaskXYZ_edgar_timestamp_dataset_extractor.py</code></li> </ul> </li> </ul> </li> <li>Also where the script is located should give some clue of what is related to</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#functions","title":"Functions","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#avoid_using_non-exclusive_bool_arguments","title":"Avoid Using Non-Exclusive <code>bool</code> Arguments","text":"<ul> <li>While a simple <code>True</code>/<code>False</code> switch may suffice for today's needs, very often     more flexibility is eventually needed</li> <li>If more flexibility is needed for a <code>bool</code> argument, you are faced with the     choice:<ul> <li>Adding another parameter (then parameter combinations grow exponentially and     may not all make sense)</li> <li>Changing the parameter type to something else</li> </ul> </li> <li>Either way, you have to change the function interface</li> <li>To maintain flexibility from the start, opt for a <code>str</code> parameter \"mode\",     which is allowed to take a small well-defined set of values.</li> <li>If an implicit default is desirable, consider making the default value of the     parameter <code>None</code>. This is only a good route if the default operation is     non-controversial / intuitively obvious.</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#try_to_make_functions_work_on_multiple_types","title":"Try to Make Functions Work on Multiple Types","text":"<ul> <li>We encourage implementing functions that can work on multiple related types:<ul> <li>Bad: implement <code>demean_series()</code>, <code>demean_dataframe()</code></li> <li>Good: implement a function <code>demean(obj)</code> that can work with <code>pd.Series</code>     and <code>pd.DataFrame</code><ul> <li>One convention is to call <code>obj</code> the variable whose type is not known until     run-time</li> </ul> </li> </ul> </li> <li>In this way we take full advantage of duck typing to achieve something similar     to C++ function overloading (actually even more expressive)</li> <li>Try to return the same type of the input, if possible<ul> <li>E.g., the function called on a <code>pd.Series</code> returns a <code>pd.Series</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#avoid_hard-wired_column_name_dependencies","title":"Avoid Hard-Wired Column Name Dependencies","text":"<ul> <li>When working with dataframes, we often want need handle certain columns     differently, or perform an operation on a strict subset of columns</li> <li>In these cases, it is tempting to assume that the special columns will have     specific names, e.g., <code>\"datetime\"</code></li> <li>The problem is that column names are<ul> <li>Rarely obvious (e.g., compare <code>\"datetime\"</code> vs <code>\"timestamp\"</code> vs <code>\"Datetime\"</code>)</li> <li>Tied to specific use cases<ul> <li>The function you are writing may be written for a specific use case today,     but what if it is more general</li> <li>If someone wants to reuse your function in a different setting where     different column names make sense, why should they have to conform to your     specific use case's needs?</li> </ul> </li> <li>May overwrite existing column names<ul> <li>For example, you may decided to call a column <code>\"output\"</code>, but what if the     dataframe already has a column with that name?</li> </ul> </li> </ul> </li> <li>To get around this, allow the caller to communicate to the function the names     of any special columns<ul> <li>Good <code>python def func(datetime_col: str):     ...</code></li> </ul> </li> <li>Make sure that you require column names only if they are actually used by the     function</li> <li>If you must use hard-write column names internally or for some application,     define the column name in the library file as a global variable, like     <code>python DATETIME_COL = \"datetime\"</code><ul> <li>Users of the library can now access the column name through imports</li> <li>This prevents hidden column name dependencies from spreading like a virus     throughout the codebase</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#single_exit_point_from_a_function","title":"Single Exit Point From a Function","text":"<ul> <li>Consider the following Bad function     <code>python def _get_zero_element(list_: List):             if not list_:                     return None             else:                     return list_[0]</code><ul> <li>Linter message is     <code>im.kibot/utils.py:394: [R1705(no-else-return), ExpiryContractMapper.extract_contract_expiry] Unnecessary \"else\" after \"return\"     [pylint]</code></li> </ul> </li> <li>Try to have a single exit point from a function, since this guarantees that     the return value is always the same</li> <li>In general returning different data structures from the same function (e.g., a     list in one case and a float in another) is indication of bad design<ul> <li>There are exceptions like a function that works on different types (e.g.,     accepts a dataframe or a series and then returns a dataframe or a series,     but the input and output is the same)</li> <li>Returning different types (e.g., float and string) is also bad</li> <li>Returning a type or <code>None</code> is typically ok</li> </ul> </li> <li>Try to return values that are consistent so that the client doesn't have to     switch statement, using <code>isinstance(...)</code><ul> <li>E.g., return a <code>float</code> and if the value can't be computed return <code>np.nan</code>     (instead of <code>None</code>) so that the client can use the return value in a uniform     way</li> </ul> </li> <li>Function examples with single exit point     <code>python def _get_zero_element(list_: List):         if not list_:                 ret = np.nan         else:                 ret = list_[0]         return ret</code>     or     <code>python def _get_zero_element(list_: List):         ret = np.nan if not list_ else list_[0]         return ret</code></li> <li>However in rare cases it is OK to have functions like:     <code>python def ...(...):         # Handle simple cases.         ...         if ...:                 return         # lots of code         ...         return</code></li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#order_of_function_parameters","title":"Order of Function Parameters","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#problem","title":"Problem","text":"<ul> <li>We want to have a standard, simple, and logical order for specifying the     arguments of a function</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#decision","title":"Decision","text":"<ul> <li>The preferred order is:<ul> <li>Input parameters</li> <li>Output parameters</li> <li>In-out parameters</li> <li>Default parameters</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#consistency_of_ordering_of_function_parameters","title":"Consistency of Ordering of Function Parameters","text":"<ul> <li>Try to:<ul> <li>Keep related variables close to each other</li> <li>Keep the order of parameters similar across functions that have similar     interface</li> </ul> </li> <li>Enforcing these rules is based on best effort</li> <li>Pycharm is helpful when changing order of parameters</li> <li>Use Linter to check consistency of types between function definition and     invocation</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#style_for_default_parameter","title":"Style for Default Parameter","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#problem_1","title":"Problem","text":"<ul> <li>How to assign default parameters in a function to make them clear and     distinguishable?</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#decision_1","title":"Decision","text":"<ul> <li>We make all the default parameters keyword-only<ul> <li>This means that we should always specify default parameters using a keyword</li> <li>When building a function, always put default parameters after <code>*</code></li> </ul> </li> <li>It's ok to use a default parameter in the interface as long as it is a Python     scalar (which is immutable by definition)<ul> <li>Good <code>python def function( value: int = 5, *, dir_name: str = \"hello_world\", ):</code></li> </ul> </li> <li>You should not use list, maps, objects, etc. as the default value but pass     <code>None</code> and then initialize the default param inside the function<ul> <li>Bad <code>python def function( *, obj: Object = Object(), list_: List[int] = [], ):</code></li> <li>Good <code>python def function( *, obj: Optional[Object] = None, list_: Optional[List[int]] = None, ): if obj is None:     obj = Object() if list_ is None:     list_ = []</code></li> </ul> </li> <li>We use a <code>None</code> default value when a function needs to be wrapped and the     default parameter needs to be propagated<ul> <li> <p>Good</p> <p>```python def function1(     ...,     *,     dir_name: Optional[str] = None, ):     dir_name = dir_name or \"/very_long_path\"</p> </li> </ul> </li> </ul> <p>def function2(     ...,     *,     dir_name: Optional[str] = None, ):     function1(..., dir_name=dir_name)         ```</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#rationale","title":"Rationale","text":"<ul> <li>Pros of the Good vs Bad style<ul> <li>When you wrap multiple functions, each function needs to propagate the     default parameters, which:<ul> <li>Violates DRY; and</li> <li>Adds maintenance burden (if you change the innermost default parameter,     you need to change all of them!)</li> <li>With the proposed approach, all the functions use <code>None</code>, until the     innermost function resolves the parameters to the default values</li> </ul> </li> <li>The interface is cleaner</li> <li>Implementation details are hidden (e.g., why should the caller know what is     the default path?)</li> <li>Mutable parameters can not be passed through (see     here))</li> </ul> </li> <li>Cons:<ul> <li>One needs to add <code>Optional</code> to the type hint</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#calling_functions_with_default_parameters","title":"Calling Functions with Default Parameters","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#problem_2","title":"Problem","text":"<ul> <li>You have a function     <code>python def func(     task_name : str,     dataset_dir : str,     *,     clobber : bool = clobber, ): ...</code></li> <li>How should it be invoked?</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#decision_2","title":"Decision","text":"<ul> <li>We prefer to<ul> <li>Assign directly the positional parameters</li> <li>Bind explicitly the parameters with a default value using their name</li> <li>Do not put actual parameter values to the function call but specify them     right before</li> <li>Bad <code>python func(\"some_task_name\", \"/dir/subdir\", clobber=False)</code></li> <li>Good <code>python task_name = \"some_task_name\" dataset_dir = \"/dir/subdir\" clobber = False func(task_name, dataset_dir, clobber=clobber)</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#rationale_1","title":"Rationale","text":"<ul> <li>Pros of Good vs Bad style<ul> <li>If a new parameter with a default value is added to the function <code>func</code>     before <code>clobber</code>:<ul> <li>The Good idiom doesn't need to be changed</li> <li>All instances of the Bad idiom need to be updated<ul> <li>The Bad idiom might keep working but with silent failures</li> <li>Of course <code>mypy</code> and <code>Pycharm</code> might point this out</li> </ul> </li> </ul> </li> <li>The Good style highlights which default parameters are being overwritten,     by using the name of the parameter<ul> <li>Overwriting a default parameter is an exceptional situation that should be     explicitly commented</li> </ul> </li> </ul> </li> <li>Cons:<ul> <li>None</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#dont_repeat_non-default_parameters","title":"Don'T Repeat Non-Default Parameters","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#problem_3","title":"Problem","text":"<ul> <li>Given a function with the following interface:     <code>python def mult_and_sum(multiplier_1, multiplier_2, sum_):         return multiplier_1 * multiplier_2 + sum_</code>     how to invoke it?</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#decision_3","title":"Decision","text":"<ul> <li>Positional arguments are not default, so not keyword-only for consistency<ul> <li>Bad <code>python a = 1 b = 2 c = 3 mult_and_sum(multiplier_1=a,          multiplier_2=b,          sum_=c)</code></li> <li>Good <code>python a = 1 b = 2 c = 3 mult_and_sum(a, b, c)</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#rationale_2","title":"Rationale","text":"<ul> <li>Pros of Good vs Bad<ul> <li>Non-default parameters in Python require all the successive parameters to be     name-assigned<ul> <li>This causes maintenance burden</li> </ul> </li> <li>The Bad approach is in contrast with our rule for the default parameters<ul> <li>We want to highlight which parameters are overriding the default</li> </ul> </li> <li>The Bad approach in practice requires all positional parameters to be     assigned explicitly causing:<ul> <li>Repetition in violation of DRY (e.g., you need to repeat the same     parameter everywhere); and</li> <li>Maintainance burden (e.g., if you change the name of a function parameter     you need to change all the invocations)</li> </ul> </li> <li>The Bad style is a convention used in no language (e.g., C, C++, Java)<ul> <li>All languages allow binding by parameter position</li> <li>Only some languages allow binding by parameter name</li> </ul> </li> <li>The Bad makes the code very wide, creating problems with our 80 columns     rule</li> </ul> </li> <li>Cons of Good vs Bad<ul> <li>One could argue that the Bad form is clearer<ul> <li>IMO the problem is in the names of the variables, which are uninformative,     e.g., a better naming achieves the same goal of clarity     <code>python mul1 = 1 mul2 = 2 sum_ = 3 mult_and_sum(mul1, mul2, sum_)</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#writing_clear_beautiful_code","title":"Writing Clear Beautiful Code","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#keep_related_code_close","title":"Keep Related Code Close","text":"<ul> <li>E.g., keep code that computes data close to the code that uses it.</li> <li>This holds also for notebooks: do not compute all the data structure and then     analyze them.</li> <li>It's better to keep the section that \"reads data\" close to the section that     \"processes it\". In this way it's easier to see \"blocks\" of code that are     dependent from each other, and run only a cluster of cells.</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#order_functions_in_topological_order","title":"Order Functions in Topological Order","text":"<ul> <li>Order functions / classes in topological order so that the ones at the top of     the files are the \"innermost\" and the ones at the end of the files are the     \"outermost\"<ul> <li>In this way, reading the code top to bottom one should not find a forward     reference that requires skipping back and forth</li> </ul> </li> <li>Linter reorders functions and classes in the topological order so make sure     you run it after adding new ones</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#distinguish_public_and_private_functions","title":"Distinguish Public and Private Functions","text":"<ul> <li>The public functions <code>foo_bar()</code> (not starting with <code>_</code>) are the ones that     make up the interface of a module and that are called from other modules and     from notebooks</li> <li>Use private functions like <code>_foo_bar()</code> when a function is a helper of another     private or public function</li> <li>Also follow the \"keep related code close\" close by keeping the private     functions close to the functions (private or public) that are using them</li> <li>Some references:<ul> <li>StackOverflow</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#keep_public_functions_organized_in_a_logical_order","title":"Keep Public Functions Organized in a Logical Order","text":"<ul> <li>Keep the public functions in an order related to the use representing the     typical flow of use, e.g.,<ul> <li>Common functions, used by all other functions</li> <li>Read data</li> <li>Process data</li> <li>Save data</li> </ul> </li> <li>You can use banners to separate layers of the code. Use the banner long 80     cols (e.g., I have a vim macro to create banners that always look the same)     and be consistent with empty lines before / empty and so on.</li> <li> <p>The banner is a way of saying \"all these functions belong together\".</p> <p>```python</p> </li> </ul> <p>def _helper1_to_func1(): ... def _helper2_to_func1(): ... def func1_read_data1():         _helper1_to_func1()         ...         _helper2_to_func2()</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#_3","title":"All.coding style.how to guide","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#read_data","title":"Read data.","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#_4","title":"All.coding style.how to guide","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#_5","title":"All.coding style.how to guide","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#process_data","title":"Process data.","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#_6","title":"All.coding style.how to guide","text":"<p>...</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#_7","title":"All.coding style.how to guide","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#save_data","title":"Save data.","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#_8","title":"All.coding style.how to guide","text":"<p>...     ```</p> <ul> <li>Ideally each section of code should use only sections above, and be used by     sections below (aka \"Unix layer approach\").</li> <li>If you find yourself using too many banners this is in indication that code     might need to be split into different classes or files<ul> <li>Although we don't have agreed upon rules, it might be ok to have large files     as long as they are well organized. E.g., in <code>pandas</code> code base, all the     code for DataFrame is in a single file long many thousands of lines (!), but     it is nicely separated in sections that make easy to navigate the code</li> <li>Too many files can become problematic, since one needs to start jumping     across many files: in other words it is possible to organize the code too     much (e.g. what if each function is in a single module?)</li> <li>Let's try to find the right balance.</li> </ul> </li> <li>It might be a good idea to use classes to split the code, but also OOP can     have a dark side<ul> <li>E.g., using OOP only to reorganize the code instead of introducing     \"concepts\"</li> <li>IMO the worst issue is that they don't play super-well with Jupyter     autoreload</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#do_not_make_tiny_wrappers","title":"Do Not Make Tiny Wrappers","text":"<ul> <li>Examples of horrible functions:<ul> <li>How many characters did we really save? If typing is a problem, learn to     touch type.     <code>python def is_exists(path: str) -&gt; None:     return os.path.exists(path)</code>     or     <code>python def make_dirs(path: str) -&gt; List[str]:     os.makedirs(path)</code></li> <li>This one can be simply replaced by <code>os.path.dirname</code> <code>python def folder_name(f_name: str) -&gt; str:     if f_name[-1] != \"/\":             return f_name + \"/\"     return f_name</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#regex","title":"Regex","text":"<ul> <li>The rule of thumb is to compile a regex expression, e.g.,     <code>python backslash_regex = re.compile(r\"\\\\\")</code>     only if it's called more than once, otherwise the overhead of compilation and     creating another var is not justified</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#do_not_introduce_another_concept_unless_really_needed","title":"Do Not Introduce Another \"concept\" Unless Really Needed","text":"<ul> <li>We want to introduce degrees of freedom and indirection only when we think     this can be useful to make the code easy to maintain, read, and expand.</li> <li>If we add degrees of freedom everywhere just because we think that at some     point in the future this might be useful, then there is very little advantage     and large overhead.</li> <li>Introducing a new variable, function, class introduces a new concept that one     needs to keep in mind. People that read the code, needs to go back and forth     in the code to see what each concept means.</li> <li>Think about the trade-offs and be consistent.</li> <li>Example 1     <code>python def fancy_print(txt):         print \"fancy: \", txt</code><ul> <li>Then people that change the code need to be aware that there is a function     that prints in a special way. The only reason to add this shallow wrapper is     that, in the future, we believe we want to change all these calls in the     code.</li> </ul> </li> <li>Example 2     <code>python SNAPSHOT_ID = \"SnapshotId\"</code><ul> <li>Another example is parametrizing a value used in a single function.</li> <li>If multiple functions need to use the same value, then this practice can be     a good idea. If there is a single function using this, one should at least     keep it local to the function.</li> <li>Still note that introducing a new concept can also create confusion. What if     we need to change the code to:     <code>python SNAPSHOT_ID = \"TigerId\"</code>     then the variable and its value are in contrast.</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#return_none_or_keep_one_type","title":"Return <code>None</code> or Keep One Type","text":"<ul> <li>Functions that return different types can make things complicated downstream,     since the callers need to be aware of all of it and handle different cases.     This also complicates the docstring, since one needs to explicitly explain     what the special values mean, all the types and so on.</li> <li>In general returning multiple types is an indication that there is a problem.</li> <li>Of course this is a trade-off between flexibility and making the code robust     and easy to understand, e.g.,</li> <li>In the following example it is better to either return <code>None</code> (to clarify that     something special happened) or an empty dataframe <code>pd.DataFrame(None)</code> to     allow the caller code being indifferent to what is returned.<ul> <li>Bad <code>python if \"Tags\" not in df.columns:     df[\"Name\"] = np.nan else:     df[\"Name\"] = df[\"Tags\"].apply(extract_name)</code></li> <li>Good <code>python if \"Tags\" not in df.columns:     df[\"Name\"] = None else:     df[\"Name\"] = df[\"Tags\"].apply(extract_name)</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#avoid_wall-of-text_functions","title":"Avoid Wall-Of-Text Functions","text":"<ul> <li>Bad <code>python def get_timestamp_data(raw_df: pd.DataFrame) -&gt; pd.DataFrame:         timestamp_df = get_raw_timestamp(raw_df)         documents_series = raw_df.progress_apply(he.extract_documents_v2, axis=1)         documents_df = pd.concat(documents_series.values.tolist())         documents_df.set_index(api.cfg.INDEX_COLUMN, drop=True, inplace=True)         documents_df = documents_df[                 documents_df[api.cfg.DOCUMENTS_DOC_TYPE_COL] != \"\"]         types = documents_df.groupby(                 api.cfg.DOCUMENTS_IDX_COL)[api.cfg.DOCUMENTS_DOC_TYPE_COL].unique()         timestamp_df[api.cfg.TIMESTAMP_DOC_TYPES_COL] = types         is_xbrl_series = raw_df[api.cfg.DATA_COLUMN].apply(he.check_xbrl)         timestamp_df[api.cfg.TIMESTAMP_DOC_ISXBRL_COL] = is_xbrl_series         timestamp_df[api.cfg.TIMESTAMP_DOC_EX99_COL] = timestamp_df[                 api.cfg.TIMESTAMP_DOC_TYPES_COL].apply(                         lambda x: any(['ex-99' in t.lower() for t in x]))         timestamp_df = timestamp_df.rename(columns=api.cfg.TIMESTAMP_COLUMN_RENAMES)         return timestamp_df</code><ul> <li>This function is correct but it has few problems (e.g., lack of a docstring,     lots of unclear concepts, abuse of constants).</li> </ul> </li> <li> <p>Good</p> <p>```python def get_timestamp_data(raw_df: pd.DataFrame) -&gt; pd.DataFrame:     \"\"\"     Get data containing timestamp information.</p> <pre><code>:param raw_df: input non-processed data\n:return: timestamp data\n\"\"\"\n# Get data containing raw timestamp information.\ntimestamp_df = get_raw_timestamp(raw_df)\n# Extract the documents with data type information.\ndocuments_series = raw_df.progress_apply(he.extract_documents_v2, axis=1)\ndocuments_df = pd.concat(documents_series.values.tolist())\ndocuments_df.set_index(api.cfg.INDEX_COLUMN, drop=True, inplace=True)\ndocuments_df = documents_df[\n        documents_df[api.cfg.DOCUMENTS_DOC_TYPE_COL] != \"\"\n]\ntypes = documents_df.groupby(\n        api.cfg.DOCUMENTS_IDX_COL\n)[api.cfg.DOCUMENTS_DOC_TYPE_COL].unique()\n# Set columns about types of information contained.\ntimestamp_df[api.cfg.TIMESTAMP_DOC_TYPES_COL] = types\nis_xbrl_series = raw_df[api.cfg.DATA_COLUMN].apply(he.check_xbrl)\ntimestamp_df[api.cfg.TIMESTAMP_DOC_ISXBRL_COL] = is_xbrl_series\ntimestamp_df[api.cfg.TIMESTAMP_DOC_EX99_COL] = timestamp_df[\n        api.cfg.TIMESTAMP_DOC_TYPES_COL\n].apply(lambda x: any([\"ex-99\" in t.lower() for t in x]))\n# Rename columns to canonical representation.\ntimestamp_df = timestamp_df.rename(columns=api.cfg.TIMESTAMP_COLUMN_RENAMES)\nreturn timestamp_df\n</code></pre> <p><code>`` - You should at least split the functions in chunks using</code>#` or even better     comment what each chunk of code does.</p> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#writing_robust_code","title":"Writing Robust Code","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#dont_let_your_functions_catch_the_default-itis","title":"Don'T Let Your Functions Catch the Default-Itis","text":"<ul> <li>Default-itis is a disease of a function that manifests itself by getting too     many default parameters.</li> <li>Default params should be used only for parameters that 99% of the time are     constant.</li> <li>In general we require the caller to be clear and specify all the params.</li> <li>Functions catch defaultitis when the programmer is lazy and wants to change     the behavior of a function without changing all the callers and unit tests.     Resist this urge! <code>grep</code> is friend. Pycharm does this refactoring     automatically.</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#explicitly_bind_default_parameters","title":"Explicitly Bind Default Parameters","text":"<ul> <li>It's best to explicitly bind functions with the default params so that if the     function signature changes, your functions doesn't confuse a default param was     a positional one.<ul> <li>Bad <code>python hdbg.dassert(     args.form or args.form_list,     \"You must specify one of the parameters: --form or --form_list\", )</code></li> <li>Good <code>python hdbg.dassert(     args.form or args.form_list,     msg=\"You must specify one of the parameters: --form or --form_list\", )</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#dont_hardwire_params_in_a_function_call","title":"Don'T Hardwire Params in a Function Call","text":"<ul> <li>Bad <code>python esa_df = universe.get_esa_universe_mapped(False, True)</code><ul> <li>It is difficult to read and understand without looking for the invoked     function (aka write-only code) and it's brittle since a change in the     function params goes unnoticed.</li> </ul> </li> <li>Good <code>python gvkey = False cik = True esa_df = universe.get_esa_universe_mapped(gvkey, cik)</code><ul> <li>It's better to be explicit (as usual)</li> <li>This solution is robust since it will work as long as gvkey and cik are the     only needed params, which is as much as we can require from the called     function.</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#make_if-elif-else_complete","title":"Make <code>if-elif-else</code> Complete","text":"<ul> <li>In general all the <code>if-elif-else</code> statements should to be complete, so that     the code is robust.</li> <li>Bad <code>python hdbg.dassert_in(         frequency,         [\"D\", \"T\"]         \"Only daily ('D') and minutely ('T') frequencies are supported.\", ) if frequency == \"T\":         ... if frequency == \"D\":         ...</code></li> <li>Good <code>python if frequency == \"T\":         ... elif frequency == \"D\":         ... else:         raise ValueError(\"The %s frequency is not supported\" % frequency)</code><ul> <li>This code is robust and correct</li> <li>Still the <code>if-elif-else</code> is enough and the assertion is not needed<ul> <li>DRY here wins: you don't want to have to keep two pieces of code in sync</li> <li>The last line is a catch-all that makes sure even if we modify the     previous</li> </ul> </li> <li>It makes sense to check early only when you want to fail before doing more     work</li> <li>E.g., sanity checking the parameters of a long running function, so that it     doesn't run for 1 hr and then crash because the name of the file is     incorrect</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#add_todos_when_needed","title":"Add Todos When Needed","text":"<ul> <li>When there is something that you know you should have done, but you didn't     have time to do, add a TODO, possibly using your github name e.g.,     ```python</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#todogp","title":"TODO(gp): ...","text":"<pre><code>```\n- In this way it's easy to grep for your TODOs, which becomes complicated when\n    using different names.\n</code></pre> <ul> <li>Be clear on the meaning of TODO<ul> <li>A <code>TODO(Batman): clean this up</code> can be interpreted as<ol> <li>\"Batman suggested to clean this up\"</li> <li>\"Batman should clean this up\"</li> <li>\"Batman has the most context to explain this problem or fix it\"</li> </ol> </li> <li>On the one hand, <code>git blame</code> will report who created the TODO, so the first     meaning is redundant.</li> <li>On the other hand, since we follow a shared ownership of the code, the     second meaning should be quite infrequent. In fact the code has mostly     <code>TODO(*)</code> todos, where <code>*</code> relates to all the team members</li> <li>Given pros and cons, the proposal is to use the first meaning.</li> <li>This is also what Google style guide suggests     here</li> </ul> </li> <li>If the TODO is associated with a Github issue, you can simply put the issue     number and description inside the TODO, e.g.,     ```python</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#todogrisha_handle_missing_tiles_cmtask_1775","title":"TODO(Grisha): \"Handle missing tiles\" CmTask #1775.","text":"<pre><code>```\n</code></pre> <ul> <li>You can create a TODO for somebody else, or you can create a Upsource comment     / review or Github bug, depending on how important the issue is</li> <li>If the TODO is general, e.g., anybody can fix it, then you can avoid to put a     name. This should not be abused since it creates a culture when people don't     take responsibility for their mistakes.</li> <li>You can use P1, P2 to indicate if the issue is critical or not. E.g., P0 is     the default for saying this is important, P1 is more of a \"nice to have\".     ```python</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#todosergey_p1_this_can_be_implemented_in_pandas_using_a_range_generation","title":"TODO(Sergey): P1 This can be implemented in pandas using a range generation.","text":"<pre><code>```\n</code></pre>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#common_python_mistakes","title":"Common Python Mistakes","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#vs_is","title":"<code>==</code> vs <code>is</code>","text":"<ul> <li><code>is</code> checks whether two variables point to the same object (aka reference     equality), while <code>==</code> checks if the two pointed objects are equivalent (value     equality).</li> <li>For checking against types like <code>None</code> we want to use <code>is</code>, <code>is not</code><ul> <li>Bad <code>python if var == None:</code></li> <li>Good <code>python if var is None:</code></li> </ul> </li> <li>For checking against values we want to use <code>==</code><ul> <li>Bad <code>python if unit is \"minute\":</code></li> <li>Good <code>python if unit == \"minute\":</code></li> </ul> </li> <li>For more info checks     here</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#type_vs_isinstance","title":"<code>type()</code> vs <code>isinstance()</code>","text":"<ul> <li><code>type(obj) == list</code> is worse since we want to test for reference equality (the     type of object is a list) and not the type of obj is equivalent to a list.</li> <li><code>isinstance</code> caters for inheritance (an instance of a derived class is an     instance of a base class, too), while checking for equality of type does not     (it demands identity of types and rejects instances of subtypes, AKA     subclasses).<ul> <li>Bad <code>python if type(obj) is list:</code></li> <li>Good <code>python if isinstance(obj, list):</code></li> </ul> </li> <li>For more info check     here</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#use_helpers","title":"Use <code>helpers</code>","text":"<ul> <li>The <code>helpers</code> dir contains libraries with a lot of useful code</li> <li>If you find yourself in need of a general-purpose/basic functionality, chances     are, it already exists in one of the <code>helpers</code> libraries. E.g.:<ul> <li>For anything related to filesystem operations, see     <code>/helpers/hio.py</code></li> <li>For constructing assertions, see <code>/helpers/hdbg.py</code></li> <li>For handling printing, see <code>/helpers/hprint.py</code></li> <li>For working with <code>pandas</code> dataframes, see     <code>/helpers/hpandas.py</code></li> <li>Etc etc</li> </ul> </li> <li>Before implementing something, always check first if it is already available     in <code>helpers</code></li> <li>Do not reinvent the wheel</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#unit_tests","title":"Unit Tests","text":"<ul> <li>Provide minimal end-to-end unit testing</li> <li>Usually we are happy with<ul> <li>Lightly testing the tricky functions</li> <li>Some end-to-end test to make sure the code is working</li> </ul> </li> <li>Use your common sense<ul> <li>E.g., no reason to test code that will be used only once</li> </ul> </li> <li>To run unit tests in a single file     <pre><code>&gt; pytest datetime_utils_test.py -x -s\n</code></pre></li> <li>For more information on our testing conventions and guidelines, see     <code>/docs/coding/all.write_unit_tests.how_to_guide.md</code></li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#refactoring","title":"Refactoring","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#when_moving_refactoring_code","title":"When Moving / Refactoring Code","text":"<ul> <li>If you move files, refactor code, move functions around make sure that:<ul> <li>Code and notebook work (e.g., imports and caller of the functions)</li> <li>Documentation is updated (this is difficult, so best effort is enough)</li> </ul> </li> <li> <p>If the change you made is renaming a function:</p> <ul> <li>Check all calls made to that function, but if it is in notebooks, update     ONLY in Master notebooks (name starts from <code>Master_...</code>)</li> <li>Double check that changes are done both in <code>.ipynb</code> and <code>.py</code> versions</li> <li>If you make changes directly in jupyter version, they will be automatically     pulled to its Python copy</li> <li>If you make changes in Python copy of the notebook, you'd have to pull     changes to related jupyter notebook with a script:     <code>&gt; jupytext --to ipynb {notebook name}.py</code></li> </ul> </li> <li> <p>For code find all the places that have been modified     <pre><code>&gt; grep -r \"create_dataframe\" *\nedgar/form_4/notebooks/Task252_EDG4_Coverage_of_our_universe_from_Forms4.ipynb:    \"documents, transactions = edu.create_dataframes(\\n\",\nedgar/form_4/notebooks/Task313_EDG4_Understand_Form_4_amendments.ipynb:    \"documents, transactions = edu.create_dataframes(\\n\",\nedgar/form_4/notebooks/Task193_EDG4_Compare_form4_against_Whale_Wisdom_and_TR.ipynb:    \"documents, transactions, owners, footnotes = edu.create_dataframes(\\n\",\n</code></pre></p> </li> <li>Or if you use mighty Pycharm, Ctrl + Mouse Left Click (Shows you all places     where this function or variable was used) and try to fix them, at least to     give your best shot at making things work<ul> <li>You can edit the notebooks directly without opening, or open and fix it.</li> </ul> </li> <li>But remember, you must know how to do it without fancy IDE like Pycharm.</li> <li>If it's important code:<ul> <li>Run unit tests</li> <li>Run notebooks</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#write_script_for_renamings","title":"Write Script for Renamings","text":"<ul> <li>When you need to rename any code object that is being used in many files, use     <code>/dev_scripts_helpers/system_tools/replace_text.py</code>     to write a script that will implement your task<ul> <li>Read the script docstring for detailed information about how to use it</li> </ul> </li> <li>You DO NOT use <code>replace_text.py</code> directly. Instead, create an executable <code>.sh</code>     script that uses <code>replace_text.py</code><ul> <li>Look for examples at <code>dev_scripts_helpers/cleanup_scripts</code></li> <li>Commit the created script to the mentioned folder so then your team members     can use it to implement renaming in other libs</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#architectural_and_design_pattern","title":"Architectural and Design Pattern","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#research_quality_vs_production_quality","title":"Research Quality vs Production Quality","text":"<ul> <li>Code belonging to top level libraries (e.g., <code>//amp/core</code>, <code>//amp/helpers</code>)     and production (e.g., <code>//.../db</code>, <code>vendors</code>) needs to meet high quality     standards, e.g.,<ul> <li>Well commented</li> <li>Following our style guide</li> <li>Thoroughly reviewed</li> <li>Good design</li> <li>Comprehensive unit tests</li> </ul> </li> <li>Research code in notebook and Python can follow slightly looser standards,     e.g.,<ul> <li>Sprinkled with some TODOs</li> <li>Not perfectly general</li> </ul> </li> <li>The reason is that:<ul> <li>Research code is still evolving and we want to keep the structure flexible</li> <li>We don't want to invest the time in making it perfect if the research     doesn't pan out</li> </ul> </li> <li>Note that research code still needs to be:<ul> <li>Understandable / usable by not authors</li> <li>Well commented</li> <li>Follow the style guide</li> <li>Somehow unit tested</li> </ul> </li> <li>We should be able to raise the quality of a piece of research code to     production quality when that research goes into production</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#always_separate_what_changes_from_what_stays_the_same","title":"Always Separate What Changes From What Stays the Same","text":"<ul> <li>In both main code and unit test it's not a good idea to repeat the same code</li> <li>Bad<ul> <li>Copy-paste-modify</li> </ul> </li> <li>Good<ul> <li>Refactor the common part in a function and then change the parameters used     to call the function</li> </ul> </li> <li>Example:<ul> <li>What code is clearer to you, VersionA or VersionB?</li> <li>Can you spot the difference between the 2 pieces of code?<ul> <li> <p>Version A</p> <p>```python stopwords = nlp_ut.read_stopwords_json(_STOPWORDS_PATH) texts = [\"a\", \"an\", \"the\"] stop_words = nlp_ut.get_stopwords(         categories=[\"articles\"], stopwords=stopwords ) actual_result = nlp_ut.remove_tokens(texts, stop_words=stop_words) expected_result = [] self.assertEqual(actual_result, expected_result)</p> </li> </ul> </li> </ul> </li> </ul> <p>... texts = [\"do\", \"does\", \"is\", \"am\", \"are\", \"be\", \"been\", \"'s\", \"'m\", \"'re\"] stop_words = nlp_ut.get_stopwords(         categories=[\"auxiliary_verbs\"], stopwords=stopwords, ) actual_result = nlp_ut.remove_tokens(texts, stop_words=stop_words) expected_result = [] self.assertEqual(actual_result, expected_result)             ```         - Version B</p> <pre><code>        ```python\n</code></pre> <p>def _helper(texts, categories, expected_result):         stopwords = nlp_ut.read_stopwords_json(_STOPWORDS_PATH)         stop_words = nlp_ut.get_stopwords(                 categories=categories, stopwords=stopwords         )         actual_result = nlp_ut.remove_tokens(texts, stop_words=stop_words)         expected_result = []         self.assertEqual(actual_result, expected_result)</p> <p>texts = [\"a\", \"an\", \"the\"] categories = [\"articles\"] expected_result = [] _helper(texts, categories, expected_result) ...</p> <p>texts = [\"do\", \"does\", \"is\", \"am\", \"are\", \"be\", \"been\", \"'s\", \"'m\", \"'re\"] categories = [\"auxiliary_verbs\"] expected_result = [] helper(texts, categories, expected_result)             ```         - Yes, Version A is _Bad and Version B is Good</p>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#organize_scripts_as_pipelines","title":"Organize Scripts as Pipelines","text":"<ul> <li>One can organize complex computations in stages of a pipeline<ul> <li>E.g., to parse EDGAR forms<ul> <li>Download -&gt; (raw data) -&gt; header parser -&gt; (pq data) -&gt; XBLR / XML / XLS     parser -&gt; (pq data) -&gt; custom transformation</li> </ul> </li> </ul> </li> <li>One should be able to run the entire pipeline or just a piece<ul> <li>E.g., one can run the header parser from the raw data, save the result to     file, then read this file back, and run the XBLR parser</li> </ul> </li> <li>Ideally one would always prefer to run the pipeline from scratch, but     sometimes the stages are too expensive to compute over and over, so using     chunks of the pipeline is better</li> <li>This can also mixed with the \"incremental mode\", so that if one stage has     already been run and the intermediate data has been generated, that stage is     skipped<ul> <li>Each stage can save files in a <code>tmp_dir/stage_name</code></li> </ul> </li> <li>The code should be organized to allow these different modes of operations, but     there is not always need to be super exhaustive in terms of command line     options<ul> <li>E.g., I implement the various chunks of the pipeline in a library,     separating functions that read / save data after a stage and then assemble     the pieces into a throw-away script where I hardwire the file names and so     on</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#make_filename_unique","title":"Make Filename Unique","text":"<ul> <li>Problem<ul> <li>We have a lot of structure / boilerplate in our project around RH     hypotheses.<ul> <li>E.g., there are corresponding files for all the RH like:<ul> <li><code>RHxyz/configs.py</code></li> <li><code>RHxyz/pipeline.py</code></li> </ul> </li> </ul> </li> <li>It is not clear if it's better to make filenames completely unique by     repeating the <code>RH</code>, e.g., <code>RH1E_configs.py</code>, or let the directories     disambiguate.</li> <li>Note that we are not referring to other common files like <code>utils.py</code>, which     are made unique by their position in the file system and by the automatic     shortening of the imports.</li> </ul> </li> <li>Decision<ul> <li>Invoking the principle of 'explicit is better than implicit', the proposal     is to repeat the prefix.<ul> <li>Bad: <code>RH1E/configs.py</code></li> <li>Good: <code>RH1E/RH1E_configs.py</code></li> </ul> </li> </ul> </li> <li>Rationale<ul> <li>Pros of the repetition (e.g., <code>RH1E/RH1E_configs.py</code>):<ul> <li>The filename is unique so there is no dependency on where you are</li> <li>Since pytest requires all files to be unique, we need to repeat the prefix     for the test names and the rule is \"always make the names of the files     unique\"</li> <li>We are going to have lots of these files and we want to minimize the risk     of making mistakes</li> </ul> </li> <li>Cons of the repetition:<ul> <li>Stuttering</li> <li>What happens if there are multiple nested dirs? Do we repeat all the     prefixes?<ul> <li>This seems to be an infrequent case</li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#incremental_behavior","title":"Incremental Behavior","text":"<ul> <li>Often we need to run the same code over and over<ul> <li>E.g., because the code fails on an unexpected point and then we need to     re-run from the beginning</li> </ul> </li> <li>We use options like:     <pre><code>--incremental\n--force\n--start_date\n--end_date\n--output_file\n</code></pre></li> <li>Check existence output file before start function (or a thread when using     parallelism) which handle data of the corresponding period<ul> <li>If <code>--incremental</code> is set and output file already exists then skip the     computation and report<ul> <li><code>_LOG.info(\"Skipping processing file %s as requested\", ...)</code></li> </ul> </li> <li>If <code>--incremental</code> is not set<ul> <li>If output file exists then we issue a <code>_LOG.warning</code> and abort the process</li> <li>If output file exists and param <code>--force</code>, then report a <code>_LOG.warning</code>     and rewrite output file</li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#run_end-to-end","title":"Run End-To-End","text":"<ul> <li>Try to run things end-to-end (and from scratch) so we can catch these     unexpected issues and code defensively<ul> <li>E.g., we found out that TR data is malformed sometimes and only running     end-to-end we can catch all the weird cases</li> <li>This also helps with scalability issues, since if takes 1 hr for 1 month of     data and we have 10 years of data is going to take 120 hours (=5 days) to     run on the entire data set</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#think_about_scalability","title":"Think About Scalability","text":"<ul> <li>Do experiments to try to understand if a code solution can scale to the     dimension of the data we have to deal with<ul> <li>E.g., inserting data by doing SQL inserts of single rows are not scalable     for pushing 100GB of data</li> </ul> </li> <li>Remember that typically we need to run the same scripts multiple times (e.g.,     for debug and / or production)</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#use_command_line_for_reproducibility","title":"Use Command Line for Reproducibility","text":"<ul> <li>Try to pass params through command line options when possible<ul> <li>In this way a command line contains all the set-up to run an experiment</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#structure_the_code_in_terms_of_filters","title":"Structure the Code in Terms of Filters","text":"<ul> <li>Focus on build a set of \"filters\" split into different functions, rather than     a monolithic flow</li> <li>Organize the code in terms of a sequence of transformations that can be run in     sequence, e.g.,<ol> <li>Create SQL tables</li> <li>Convert json data to csv</li> <li>Normalize tables</li> <li>Load csv files into SQL</li> <li>Sanity check the SQL (e.g., mismatching TR codes, missing dates)</li> <li>Patch up SQL (e.g., inserting missing TR codes and reporting them to us so  we can check with TR)</li> </ol> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#code_style_for_different_languages","title":"Code Style for Different Languages","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#sql","title":"SQL","text":"<ul> <li>You can use the package     https://github.com/andialbrecht/sqlparse     to format SQL queries</li> <li>There is also an on-line version of the same formatter at     https://sqlformat.org</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#conventions_addendum","title":"Conventions (Addendum)","text":""},{"location":"code_guidelines/all.coding_style.how_to_guide.html#be_patient","title":"Be Patient","text":"<ul> <li>For some reason talking about conventions makes people defensive and     uncomfortable, sometimes.</li> <li>Conventions are not a matter of being right or wrong, but to consider pros and     cons of different approaches, and make the decision only once instead of     discussing the same problem every time. In this way we can focus on achieving     the Ultimate Goal.</li> <li>If you are unsure or indifferent to a choice, be flexible and let other     persons that seem to be less flexible decide.</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#goal","title":"Goal","text":"<ul> <li>The goal of the conventions is to simplify our job by removing ambiguity</li> <li>There is no right or wrong: that's why it's a convention and not a law of     nature<ul> <li>On the flip-side, if there is a right and wrong, then what we are discussing     probably shouldn't be considered as a convention</li> </ul> </li> <li>We don't want to spend time discussing inconsequential points</li> <li>We don't want reviewers to pick lints instead of focusing on architectural     issues and potential bugs</li> <li>Remove cognitive burden of being distracted by \"this is an annoying lint\" (or     at least perceived lint)</li> <li>Once a convention is stable, we would like to automate enforcing it by Linter<ul> <li>Ideally Linter should fix our mistakes so we don't even have to think about     them, and reviewers don't have to be distracted with pointing out the lints</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#keep_the_rules_simple","title":"Keep the Rules Simple","text":"<ul> <li>E.g., assume that we accepted the following rules:<ul> <li>Git is capitalized if it refers to the tool and it's not capitalized when it     refers to the command (this is what Git documentation suggests)</li> <li>Python is written capitalized (this is what Python documentation suggests)</li> <li><code>pandas</code> is written lowercase, unless it is a beginning of the line in which     case it's capitalized, but it's better to try to avoid to start a sentence     with it (this is what <code>pandas</code> + English convention seems to suggest)</li> <li>Any other library could suggest a different convention based on the     preference of its author, who tries to finally force people to follow his /     her convention ...)</li> </ul> </li> <li>All these rules require mental energy to be followed and readers will spend     time checking that these rules are enforced, rather than focusing on bugs and     architecture.</li> <li>In this case we want to leverage the ambiguity of \"it's unclear what is the     correct approach\" by simplifying the rule<ul> <li>E.g., every name of tools or library is always capitalized</li> <li>This is simple to remember and automatically enforce</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#allow_turning_off_the_automatic_tools","title":"Allow Turning Off the Automatic Tools","text":"<ul> <li>We understand that tools can't always understand the context and the     subtleties of human thoughts, and therefore they yield inevitably to false     positives.</li> <li>Then we always want to permit disabling the automatic checks / fixes e.g., by     using directives in comments or special syntax (e.g., anything in a <code>...</code> or     <code>...</code> block should be left untouched)</li> <li>It can be tricky determining when an exception is really needed and when     overriding the tool becomes a slippery slope for ignoring the rules.</li> <li>Patience and flexibility is advised here.</li> </ul>"},{"location":"code_guidelines/all.coding_style.how_to_guide.html#make_the_spell-checker_happy","title":"Make the Spell-Checker Happy","text":"<ul> <li>The spell-checker is not always right: false positives are often very annoying</li> <li>We prefer to find a way to make the spell-checker happy rather than argue that     the spell-checker is wrong and ignore it</li> <li>The risk with overriding the spell-checker (and any other tool) is that the     decision is not binary anymore correct / not-correct and can't be automated     and requires mental energy to see if the flagged error is real or not.<ul> <li>E.g., <code>insample</code> is flagged as erroneous, so we convert it into <code>in-sample</code>.</li> </ul> </li> <li>The solution for the obvious cases of missing a word (e.g., a technical word)     is to add words to the vocabulary. This still needs to be done by everyone,     until we find a way to centralize the vocabulary.<ul> <li>E.g., untradable is a valid English word, but Pycharm's spell-checker     doesn't recognize it.</li> </ul> </li> <li>TODO(*): Should we add it to the dictionary or write it as \"un-tradable\"?</li> <li>Still we don't want to override the spell-checker when an alternative     lower-cost solution is available. E.g.,<ul> <li><code>in-sample</code> instead of <code>insample</code></li> <li><code>out-of-sample</code> instead of <code>oos</code></li> </ul> </li> <li>We decided that <code>hyper-parameter</code> can be written without hyphen:     <code>hyperparameter</code></li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html","title":"All.coding style guidelines.reference","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#all_style_guide","title":"All Style Guide","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#summary","title":"Summary","text":"<ul> <li>This document contains all the rules we enforce for code and documentation     through the <code>linter</code> and <code>ai_review.py</code></li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#general","title":"General","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#spelling","title":"Spelling","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm","title":"LLM","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter","title":"Linter","text":"<ul> <li>Spell commands in lower case and programs with the first letter in upper case<ul> <li>E.g., <code>git</code> as a command, <code>Git</code> as a program</li> <li>E.g., capitalize the first letter of <code>Python</code></li> </ul> </li> <li>Spell <code>Linter</code> with the first letter in upper case and do not use an article<ul> <li>E.g., <code>Linter</code> instead of <code>the Linter</code></li> </ul> </li> <li>Capitalize <code>JSON</code>, <code>CSV</code>, <code>DB</code> and other abbreviations</li> <li>Represent intervals with <code>[a, b), (a, b], (a, b), [a, b]</code>, not <code>[a, b[</code></li> <li>Write <code>hyperparameter</code> without a hyphen</li> <li>Use <code>Python</code> for scripting and automation tasks</li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#python","title":"Python","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#naming","title":"Naming","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_1","title":"LLM","text":"<ul> <li>Name functions using verbs and verbs/actions<ul> <li>Good: <code>download_data()</code>, <code>process_input()</code>, <code>calculate_sum()</code></li> <li>Good: Python internal functions as <code>__repr__</code>, <code>__init__</code> are valid</li> <li>Good: Functions names like <code>to_dict()</code>, <code>_parse()</code>, <code>_main()</code> are valid</li> </ul> </li> <li>Name classes using nouns<ul> <li>Good: <code>Downloader()</code>, <code>DataProcessor()</code>, <code>User()</code></li> <li>Bad: <code>DownloadStuff()</code>, <code>ProcessData()</code>, <code>UserActions()</code></li> </ul> </li> <li>Name decorators with an adjective or a past tense verb<ul> <li>Good: <code>timed</code>, <code>cached</code>, <code>logged</code></li> <li>Bad: <code>time</code>, <code>cache</code>, <code>log</code></li> </ul> </li> <li>Variable and function names should not reference implementation details, and     things that can change or details that are not important<ul> <li>E.g., the name of a variable should not include its type<ul> <li>Good: <code>embeddings</code></li> <li>Bad: <code>embeddings_list</code></li> <li>Good: <code>data</code></li> <li>Bad: <code>data_dict</code></li> </ul> </li> </ul> </li> <li>Abbreviations in the names of variables and functions should be avoided<ul> <li>Exceptions are the following<ul> <li><code>df</code> for dataframe</li> <li><code>srs</code> for series</li> <li><code>idx</code> for index</li> <li><code>id</code> for identifier</li> <li><code>val</code> for value</li> <li><code>var</code> for variable</li> <li><code>args</code> for arguments and <code>kwargs</code> for keyword arguments</li> <li><code>col</code> for columns and <code>row</code> for rows</li> </ul> </li> </ul> </li> <li>Do not repeat in a function name what is already included in the library name     avoiding \"code stutter\"<ul> <li>E.g., if using a library named <code>math</code>, avoid naming a function     <code>math_calculate()</code><ul> <li>Good: <code>calculate()</code></li> <li>Bad: <code>math_calculate()</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_1","title":"Linter","text":"<ul> <li>Name executable Python scripts using verbs and actions<ul> <li>E.g., <code>download.py</code> and not <code>downloader.py</code></li> </ul> </li> <li>Name non-executable files using nouns<ul> <li>E.g., <code>downloader.py</code></li> </ul> </li> <li>Use <code>dir</code> and not <code>directory</code> or <code>folder</code><ul> <li>E.g., <code>dir_path</code></li> </ul> </li> <li>Use <code>file_name</code> and not <code>filename</code><ul> <li>E.g., <code>file_name</code> for storing the name of a file</li> </ul> </li> <li>Use <code>dir_name</code> and not <code>dirname</code><ul> <li>E.g., <code>dir_name</code> for storing the name of a directory</li> </ul> </li> <li>Use <code>timestamp</code> and not <code>ts</code> or <code>datetime</code><ul> <li>E.g., <code>event_timestamp</code></li> </ul> </li> <li>To refer to the name of a column, use <code>..._col</code> and not <code>..._col_name</code> or     <code>..._column</code><ul> <li>E.g., <code>age_col</code> for a column storing age values</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#docstrings","title":"Docstrings","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_2","title":"LLM","text":"<ul> <li>All functions and methods must have a docstring<ul> <li>Good:     <pre><code>def add(a, b):\n    \"\"\"\n    Add two numbers and return the result\n    \"\"\"\n    return a + b\n</code></pre></li> <li>Bad:     <pre><code>def add(a, b):\n    return a + b\n</code></pre></li> </ul> </li> <li> <p>The docstring must describe the goal of the function, the interface, and what     the user needs to know to use the function</p> <ul> <li>Good: \"Calculate the sum of two numbers and return the result.\"</li> <li>Good     <pre><code>def get_repository_settings(\n        repo: github.Repository.Repository,\n) -&gt; Dict[str, Any]:\n        \"\"\"\n        Get the current settings of the repository.\n\n        :param repo: GitHub repository object\n        :return: dictionary containing repository settings\n        \"\"\"\n</code></pre></li> <li>When the output is a tuple indent like:     <pre><code>:param mode: format of the output:\n        - `list`: indents headers to create a nested list\n        - `headers`: uses Markdown header syntax (e.g., '#', '##', '###'`)\n</code></pre></li> </ul> </li> <li> <p>The docstring must use imperative form, whenever possible</p> <ul> <li>Good: \"Calculate the sum of two numbers and return the result.\"</li> <li>Bad: \"Calculates the sum of two numbers and returns the result.\"</li> </ul> </li> <li>The docstring should not describe implementation details that can be changed<ul> <li>Good: \"Sort the list of integers in ascending order.\"</li> <li>Bad: \"Use the quicksort algorithm to sort the list of integers in ascending     order.\"</li> </ul> </li> <li>Follow this example for indentation of parameter descriptions:<ul> <li>Good     ```python :param param1: a very very long param description that     continues into a second line :param param2: a param with two possible values<ul> <li>first value description</li> <li>second value description that is very long and     continues into a second line ```</li> </ul> </li> </ul> </li> <li>Adding examples (e.g., of input and output) to the docstring is encouraged<ul> <li>Good     <pre><code># Example usage:\nresult = add_numbers(3, 5)\n# The result is 8.\n</code></pre></li> </ul> </li> <li>References to variables, file paths, functions, classes, etc. should be     wrapped in backticks<ul> <li>Good: \"The <code>add_numbers()</code> function takes two arguments <code>a</code> and <code>b</code>.\"</li> <li>Bad: \"The add_numbers() function takes two arguments a and b.\"</li> </ul> </li> <li>References to values should be wrapped in single ticks<ul> <li>Good '//' with '# '</li> </ul> </li> <li>Multi-line representations of data structures (e.g., an output example) should     be wrapped in triple backticks<ul> <li>Good     <pre><code>{ \"name\": \"John\", \"age\": 30, \"city\": \"New York\" }\n</code></pre></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_2","title":"Linter","text":"<ul> <li>The first docstring line is followed by a blank line and then, optionally, by     a longer description (possibly on multiple lines) with a more detailed     explanation of what the function does</li> <li>The more detailed description is followed by a blank line and then the param     and return description section in reST style<ul> <li>Use lowercase after <code>:param XYZ: ...</code> / <code>:return:</code> unless the description     starts with a proper noun</li> </ul> </li> <li>Do not mention default values of parameters in parameter descriptions</li> <li>Docstrings should be wrapped in triple quotation marks (<code>\"\"\"</code>)<ul> <li>The opening and closing triple quotation marks should be located on their     own separate lines</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#comments","title":"Comments","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_3","title":"LLM","text":"<ul> <li>Add a comment for every logically distinct chunk of code, spanning 4-5 lines</li> <li> <p>Use comments to separate chunks of code instead of blank lines</p> <ul> <li>Good:     <pre><code>function1()\n# Then do something else.\nfunction2()\n</code></pre></li> <li>Bad:     <pre><code>function1()\n\nfunction2()\n</code></pre></li> </ul> </li> <li> <p>Do not use inline comments; every comment should be on its own separate line,     before the line it refers to</p> <ul> <li>Good:     <pre><code># Grant access to admin panel access_admin_panel().\nif user.is_admin():\n</code></pre></li> <li>Bad:     <pre><code>if user.is_admin(): # Check if the user is an admin access_admin_panel().\n</code></pre></li> <li>In <code>if-elif-else</code> statements, the comments are placed underneath each     statement in order to explain the code that belongs to each statement in     particular<ul> <li>Good:     <pre><code>if ...:\n    # Do this\nelse:\n    # Do that\n</code></pre></li> </ul> </li> </ul> </li> <li>Avoid referring to the type of a variable in the comments<ul> <li>Keeps comments focused on functionality rather than implementation specifics</li> <li>Good: \"Store the user's age for validation.\"</li> <li>Bad: \"Store the user's age as an integer for validation.\"</li> </ul> </li> <li>Do not include implementation details in comments<ul> <li>Describe \"what\" and \"why\" the code does something and not \"how\" the code     does it</li> <li>Ensures comments remain relevant even if the implementation changes</li> </ul> </li> <li>If some code is commented out in a PR, a comment should be added to explain     the reason why<ul> <li>Provides context for future reference and helps other developers understand     the decision</li> <li>E.g., \"This section is commented out due to a known bug that needs fixing\"     or \"Temporarily disabled for performance testing\"</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_3","title":"Linter","text":"<ul> <li>Avoid empty comments and line inside the code when possible</li> <li>Every comment should start with a capital letter</li> <li>Every comment should start with a verb in the imperative form</li> <li>Every comment should end with a period</li> <li>Comments with TODOs should have the format of <code># TODO(username): ...</code></li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#code_implementation","title":"Code Implementation","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_4","title":"LLM","text":"<ul> <li>Encode the assumptions made in the code using assertions and report as much     information as possible in an assertion to make it easy to debug the output<ul> <li>Good:     <pre><code>hdbg.dassert_lt(start_date, end_date,\n    msg=\"start_date needs to be before end_date\")\n</code></pre></li> <li>Ensure that assertions provide detailed information for debugging</li> <li>Use assertions to validate input parameters and preconditions</li> </ul> </li> <li> <p>Do not use f-strings in <code>hdbg.dassert()</code>, but use traditional string     formatting methods in assertions</p> <ul> <li>Good:     <code>hdbg.dassert_eq(len(list1), len(list2), \"Lists must be of equal length: %d vs %d\" % (len(list1), len(list2)))</code></li> </ul> </li> <li> <p>Add type hints only to the function definitions, if they are missing.</p> <ul> <li>Good:     <pre><code>def process_data(data, threshold=0.5):\n        results = []\n        for item in data:\n                if item &gt; threshold:\n                        results.append(item)\n        return results\n</code></pre></li> <li>Bad:     <pre><code>def process_data(data: List[float], threshold: float = 0.5) -&gt; List[float]:\n        results: List[float] = []\n        for item in data:\n                if item &gt; threshold:\n                        results.append(item)\n        return results\n</code></pre></li> </ul> </li> <li> <p>Avoid complex assignments into if-then-else statements.</p> <ul> <li>Good:     <pre><code>capitalized_parts = []\nfor w in parts:\n        if is_first_or_last or w.lower() not in small_words:\n                w_out = w.capitalize()\n        else:\n                w_out = w.lower()\ncapitalized_parts.append(w_out)\n</code></pre></li> <li> <p>Bad:     <pre><code>capitalized_parts = [\n        w.capitalize() if is_first_or_last or w.lower() not in small_words else w.lower()\n        for w in parts\n]\n</code></pre></p> <p>to:     - Good: <pre><code>if i == 0:\n        is_first_or_last = True\nelif i == len(tokens) - 1:\n        is_first_or_last = True\nelif i &gt; 0 and not re.search(r'\\w', tokens[i - 1]):\n        is_first_or_last = True\nelif i &lt; len(tokens) - 1 and not re.search(r'\\w', tokens[i + 1]):\n        is_first_or_last = True\nelse:\n        is_first_or_last = False\n</code></pre>     - Bad: <pre><code>is_first_or_last = (i == 0 or i == len(tokens) - 1 or\n                                (i &gt; 0 and not re.search(r'\\w', tokens[i - 1])) or\n                                (i &lt; len(tokens) - 1 and not re.search(r'\\w', tokens[i + 1])))\n</code></pre></p> </li> </ul> </li> <li> <p>Provide clear and informative error messages in exceptions using f-strings</p> <ul> <li>Good: <code>raise ValueError(f\"Invalid server_name='{server_name}'\")</code></li> <li>Good: <code>raise TypeError(f\"Expected type int, but got {type(var).__name__}\")</code></li> </ul> </li> <li>Use complete <code>if-elif-else</code> statements instead of a sequence of <code>if</code>     statements<ul> <li>Ensure logical flow and clarity in conditional statements</li> <li>Good:     ```python if condition1:</li> </ul> </li> <li>Compile a regex expression only if it's called more than once<ul> <li>Optimize performance by compiling regex expressions that are reused</li> <li>E.g.,     <pre><code>import re\npattern = re.compile(r'\\d+')\nif pattern.match(string):\n    # Do something.\n</code></pre></li> </ul> </li> <li>Use <code>if var is None</code> to check if <code>var</code> is <code>None</code> instead of <code>if not var</code><ul> <li>Good: <code>if my_variable is None:</code></li> <li>Bad: <code>if not my_variable:</code></li> </ul> </li> <li>Use <code>isinstance()</code> instead of <code>type()</code> to check the type of an object<ul> <li>Good: <code>if isinstance(obj, str):</code></li> <li>Bad: <code>if type(obj) == str:</code></li> </ul> </li> <li>Do not use <code>from ... import ...</code>, unless it is the <code>typing</code> package, e.g.,     <code>from typing import Iterable, List</code><ul> <li>Good: <code>from typing import Dict, Tuple</code></li> <li>Bad: <code>from os import path</code></li> </ul> </li> <li>Always import with a full path from the root of the repo / submodule<ul> <li>Good: <code>import myproject.module.submodule</code></li> <li>Bad: <code>from submodule import my_function</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#execute_block_for_condition1","title":"Execute block for condition1.","text":"<p>... elif condition2:</p>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#execute_block_for_condition2","title":"Execute block for condition2.","text":"<p>... else:</p>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#execute_block_if_none_of_the_above_conditions_are_met_or_raise_an","title":"Execute block if none of the above conditions are met or raise an","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#exception","title":"exception.","text":"<pre><code>```\n</code></pre>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_4","title":"Linter","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#code_design","title":"Code Design","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_5","title":"LLM","text":"<ul> <li>Follow DRY principle (Don't Repeat Yourself):<ul> <li>Factor out common code in a separate function/method</li> <li>Do not copy-and-paste parameter descriptions; instead, write them in only     one function and put a reference to it in the other functions where the same     parameters are used<ul> <li>E.g., \"See <code>func_name()</code> for the param description\"</li> </ul> </li> <li>Avoid redundancy in code logic and comments</li> </ul> </li> <li>Keep public functions in an order representing the typical flow of use:<ul> <li>Common functions, used by all other functions<ul> <li>E.g., utility functions like <code>log_message()</code>, <code>validate_input()</code></li> </ul> </li> <li>Read data<ul> <li>Good: <code>read_csv()</code>, <code>load_json()</code></li> </ul> </li> <li>Process data<ul> <li>Good: <code>clean_data()</code>, <code>transform_data()</code></li> </ul> </li> <li>Save data<ul> <li>Good: <code>write_csv()</code>, <code>export_json()</code></li> </ul> </li> </ul> </li> <li>Ensure that function names are descriptive and convey their purpose</li> <li>Use comments to explain complex logic or calculations</li> <li>Implement error handling to manage exceptions and edge cases</li> <li>Use inheritance or composition to reuse code in object-oriented programming</li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_5","title":"Linter","text":"<ul> <li>Order functions / classes in a topological order so that the ones at the top     of the files are the \"innermost\" and the ones at the end of the files are the     \"outermost\"</li> <li>Use banners to separate large sections of code, e.g.:     ```python</li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#_1","title":"All.coding style guidelines.reference","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#read_data","title":"Read data.","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#_2","title":"All.coding style guidelines.reference","text":"<pre><code>```\n- The text inside the banner should start with a capital letter and end with a\n    period\n</code></pre>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#imports","title":"Imports","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_6","title":"LLM","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_6","title":"Linter","text":"<ul> <li>All imports should be located at the top of the file</li> <li>Each module that can be imported should have a docstring at the very beginning     describing how it should be imported<ul> <li>Linter adds it automatically</li> </ul> </li> <li>No import cycles should be introduced by the changes in the PR</li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#type_annotations","title":"Type Annotations","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_7","title":"LLM","text":"<ul> <li>For type hints use use <code>List</code>, <code>Dict</code>, and <code>Tuple</code> to provide more explicit     type information and help with static type checking<ul> <li>E.g., <code>List[int]</code> instead of <code>list</code></li> <li>E.g., <code>List[str]</code> instead of <code>list</code></li> <li>Use <code>Dict</code> instead of <code>dict</code><ul> <li>E.g., <code>Dict[str, int]</code> instead of <code>dict</code></li> <li>E.g., <code>Dict[int, List[str]]</code> instead of <code>dict</code></li> </ul> </li> <li>Use <code>Tuple</code> instead of <code>tuple</code><ul> <li>E.g., <code>Tuple[int, str]</code> instead of <code>tuple</code></li> <li>E.g., <code>Tuple[str, List[int]]</code> instead of <code>tuple</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_7","title":"Linter","text":"<ul> <li>All functions and methods, including constructors, must have type annotations     for all the parameters and returned structures<ul> <li>Use <code>-&gt; None</code> if a function doesn't return anything</li> <li>The only exception are invoke tasks, i.e. functions with the <code>@task</code>     decorator, they shouldn't have type annotations</li> </ul> </li> <li>Type annotation <code>Any</code> should be avoided, if possible</li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#functions","title":"Functions","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_8","title":"LLM","text":"<ul> <li>Avoid pure functions without side effects, i.e., for the same input arguments,     the returned value should not change (in contrast to functions that rely upon     external state)</li> <li>Functions should not modify the function inputs<ul> <li>E.g., if a function <code>f()</code> accepts a dataframe <code>df</code> as its argument, then     <code>f()</code> will not modify <code>df</code> but make a copy and work on it</li> <li>This ensures that the original data remains unchanged and can be reused</li> </ul> </li> <li>To maintain clarity and consistency in function definitions, use the following     order of parameters in a function declaration:<ul> <li>Input parameters</li> <li>Output parameters</li> <li>In-out parameters</li> <li>Default parameters</li> </ul> </li> <li>Default parameters should be used sparingly and only for parameters that 99%     of the time are constant</li> <li>All the default parameters should be keyword-only<ul> <li>They should be separated from the other parameters by <code>*</code><ul> <li>Good: <code>def example_function(param1: str, *, default_param1: int = 10)</code></li> <li>Bad: <code>def example_function(param1: str, default_param1 : int =10)</code></li> </ul> </li> <li>This ensures that default parameters are always explicitly specified by     name, improving readability</li> </ul> </li> <li>Do not use mutable objects (such as lists, maps, objects) as default value for     functions; instead, pass <code>None</code> and then initialize the default parameter     inside the function<ul> <li>E.g., instead of using a list as a default parameter, use <code>None</code> and     initialize the list inside the function:</li> <li>Good:     <pre><code>def add_item(item: str, *, items: Optional[List[str]]) -&gt; List[str]:\n    if items is None:\n        items = []\n    items.append(item)\n    return items\n</code></pre></li> </ul> </li> <li>Do not use a boolean parameter as a switch controlling some function behavior;     instead, use a string parameter <code>mode</code>, which is allowed to take a small     well-defined set of values<ul> <li>Good: <code>def process_data(mode: str = 'fast'):</code> where <code>mode</code> can be <code>'fast'</code>,     <code>'slow'</code>, etc</li> </ul> </li> <li>For functions dealing with dataframes, avoid hard-wired column name     dependencies; instead, allow the caller to pass the column name to the     function as a parameter<ul> <li>E.g., <code>def calculate_average(df: pd.DataFrame, column_name: str):</code></li> </ul> </li> <li>Do not put computations of the output together in a <code>return</code> statement,     instead, compute the output first, assign it to a variable, and then return     this variable<ul> <li>Good     <pre><code>result = compute_value()\nreturn result\n</code></pre></li> <li>Bad     <pre><code>return compute_value()\n</code></pre></li> </ul> </li> <li>A function should have a single exit point, i.e., one single line with     <code>return</code><ul> <li>Good:     <code>python def calculate_total(price, tax):     total = price + (price * tax)     return total</code></li> <li>Bad:     <code>python def calculate_total(price, tax):     if price &gt; 0:             return price + (price * tax)     else:             return 0</code></li> </ul> </li> <li>A function should ideally return objects of only one type (or <code>None</code>)</li> <li>When calling a function, assign all the input parameter values to variables on     separate lines and then pass these variables to the function<ul> <li>Good:     <pre><code>param1 = 10\nparam2 = 11\nresult = my_function(param1, param2)\n</code></pre></li> <li>Bad:     <pre><code>result = my_function(10, 11)\n</code></pre></li> </ul> </li> <li>Explicitly bind default parameters, i.e., specify the parameter name when     calling a function, and do not bind non-default parameters<ul> <li>Good: <code>func(10, 20, param3=30)</code></li> <li>Bad: <code>func(10, 20, 30)</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_8","title":"Linter","text":"<ul> <li>Make a function private (e.g., <code>_foo_bar()</code>) when it is a helper of another     private or public function</li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#scripts","title":"Scripts","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_9","title":"LLM","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_9","title":"Linter","text":"<ul> <li>Use Python and not bash for scripting</li> <li>All Python scripts that are meant to be executed directly should:<ul> <li>Be marked as executable files with <code>&gt; chmod +x foo_bar.py</code></li> <li>Have the standard Unix shebang notation at the top: <code>#!/usr/bin/env python</code></li> <li>Use the following idiom at the bottom:     <code>python if __name__ == \"__main__\":     ...</code></li> <li>Use <code>argparse</code> for argument parsing</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#logging","title":"Logging","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_10","title":"LLM","text":"<ul> <li>Use logging <code>_LOG.debug()</code> and not <code>print()</code> for tracing execution<ul> <li>Good: <code>_LOG.debug(\"value=%s\", value)</code></li> <li>Bad: <code>print(\"value=%s\", value)</code></li> </ul> </li> <li>Use positional args in logging and not inline formatting<ul> <li>Good: <code>_LOG.debug(\"cmd=%s\", cmd1)</code></li> <li>Bad: <code>_LOG.debug(f\"cmd={cmd1}\")</code></li> </ul> </li> <li> <p>Use the following idiom to configure logging:</p> <p>```python import helpers.hdbg as hdbg</p> </li> </ul> <p>_LOG = logging.getLogger(name) ...</p> <p>hdbg.init_logger(verbosity=logging.DEBUG)     ```</p>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_10","title":"Linter","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#misc","title":"Misc","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_11","title":"LLM","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_11","title":"Linter","text":"<ul> <li>If a PR includes renaming a file, variable, parameter, function, class, etc.,     then all the instances and references to it throughout the codebase should be     updated</li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#unit_tests","title":"Unit Tests","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#rules","title":"Rules","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_12","title":"LLM","text":"<ul> <li>A test class should test only one function or class to help understanding test     failures</li> <li>A test method should only test a single case to ensures clarity and precision     in testing<ul> <li>E.g., \"for these inputs the function responds with this output\"</li> </ul> </li> <li>Adhere to the following conventions for naming:<ul> <li>Class <code>TestFooBar</code> tests the class <code>FooBar</code> and its methods<ul> <li><code>TestFooBar.test_method_a</code>, <code>TestFooBar.test_method_b</code> test the methods     <code>FooBar.method_a</code> and <code>FooBar.method_b</code></li> </ul> </li> <li>Class <code>Test_foo_bar</code> tests the function <code>foo_bar()</code><ul> <li>E.g., <code>Test_foo_bar.test_valid_input</code>, <code>Test_foo_bar.test_invalid_input</code>     for different cases / inputs</li> </ul> </li> <li><code>Test_foo_bar.test1</code>, <code>Test_foo_bar.test2</code> for different cases / inputs</li> </ul> </li> <li>A unit test should be independent of all the other unit tests<ul> <li>Ensures that tests do not affect each other and can be run in isolation</li> </ul> </li> <li>If there is a lot of common code across individual test methods, it should be     factored out in a helper method within the test class<ul> <li>Reduces redundancy and improves maintainability of the test code</li> <li>E.g., a <code>setUp</code> method to initialize common test data or configurations</li> </ul> </li> <li>If some code needs to be repeated at the beginning / end of each test method,     it should be moved to <code>set_up_test()</code> / <code>tear_down_test()</code> methods and the     following idiom should be added to the test class:     <code>python @pytest.fixture(autouse=True) def setup_teardown_test(self):         # Run before each test.         self.set_up_test()         yield         # Run after each test.         self.tear_down_test()</code></li> <li>Each test method should have a docstring describing briefly what case is being     tested<ul> <li>E.g., \"Tests the addition of two positive integers.\"</li> <li>E.g., \"Verifies that an exception is raised when dividing by zero.\"</li> </ul> </li> <li>Test methods should have type hint annotations<ul> <li>E.g., <code>def test_addition(self) -&gt; None:</code></li> </ul> </li> <li>Do not create temporary files for tests (e.g., with <code>tempfile</code>) but use     <code>hunittest.TestCase.get_scratch_space()</code> instead</li> <li>If the input to the test is a large piece of code/text, it should be moved to     a separate file in the <code>input</code> dir corresponding to the test<ul> <li>E.g., <code>outcomes/&lt;TestClassName.test_method_name&gt;/input</code> and read through the     function <code>self.get_input_dir()</code> of <code>TestCase</code></li> <li>This approach allows for easy updates and modifications to test inputs     without altering the test code itself</li> </ul> </li> <li>Do not use pickle files for test inputs<ul> <li>Use JSON, YAML, CSV files for test inputs as they are more secure and     human-readable</li> </ul> </li> <li>In every test method separate logically distinct code chunks to prepare the     inputs, run the tests, and check the outputs using comments like below:<ul> <li>E.g.,     <pre><code># Prepare inputs.\ninput_data = [1, 2, 3]\n# Run test.\nresult = my_function(input_data)\n# Check outputs.\nself.assert_equal(result, expected_output)\n</code></pre></li> </ul> </li> <li>Do not use <code>hdbg.dassert</code> in testing but use <code>self.assert*()</code> methods</li> <li>Prefer <code>self.assert_equal()</code> instead of <code>self.assertEqual()</code><ul> <li>Always use actual and then expected value</li> <li>E.g., <code>self.assert_equal(actual, expected)</code></li> </ul> </li> <li>Use strings to compare actual and expected outputs instead of data structures<ul> <li>E.g., use <code>self.assert_equal(str(actual_list), str(expected_list))</code></li> </ul> </li> <li>Use <code>self.check_string()</code> to compare the actual output to a golden output in     the <code>outcomes</code> dir, when the output is large or needs to be modified easily<ul> <li>E.g., <code>self.check_string(actual_output)</code></li> </ul> </li> <li>When testing for an assertion, check that you are getting the exact exception     that is expected     <pre><code># Make sure function raises an error.\nwith self.assertRaises(AssertionError) as cm:\n        config_list.configs = configs\nact = str(cm.exception)\nself.check_string(act, fuzzy_match=True)\n</code></pre></li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_12","title":"Linter","text":"<ul> <li>Unit tests should be placed in a <code>test_*.py</code> file in the <code>test</code> directory,     close to the library / code it tests<ul> <li>Test file <code>test_file_name.py</code> testing the library <code>file_name.py</code></li> </ul> </li> <li>Every test class should inherit from <code>hunitest.TestCase</code></li> <li>We use <code>pytest</code> as test harness so do not add the following idiom in the     testing file     <code>python if __name__ == \"__main__\":         unittest.main()</code></li> <li>If a unit test is renamed or removed in a PR, the corresponding files in the     <code>outcomes</code> dir should also be renamed or removed</li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#notebooks","title":"Notebooks","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#general_1","title":"General","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_13","title":"LLM","text":"<ul> <li>The code in the notebook should adhere to the same style and formatting     guidelines as the code in libraries and scripts</li> <li>Common or general-purpose code should be factored out in functions and moved     from the notebook to a Python library, which would then be imported in the     notebook<ul> <li>E.g., create a <code>utils.py</code> file for helper functions</li> </ul> </li> <li>Notebook cells should be idempotent, i.e., able to be executed multiple times     without changing their output value<ul> <li>Avoid side effects such as modifying global variables or external states</li> <li>Ensure that cell execution order does not affect the results</li> </ul> </li> <li>If the data is transformed, display a few lines to show the outcome<ul> <li>E.g., <code>df.head(3)</code> to preview the first three rows of a DataFrame</li> </ul> </li> <li>If any data is discarded/filtered, display the percentage of the rows dropped<ul> <li>E.g.,     <code>print(f\"Percentage of rows dropped: {dropped_rows / total_rows * 100:.2f}%\")</code></li> <li>Provides insight into data cleaning and filtering processes</li> </ul> </li> <li>Progress bars should be added where applicable<ul> <li>Use libraries like <code>tqdm</code> to show progress in loops or data processing tasks</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_13","title":"Linter","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#plotting","title":"Plotting","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_14","title":"LLM","text":"<ul> <li>Each plot should have a descriptive title to understand the context of the     plot at a glance<ul> <li>E.g., \"Monthly Sales Data for 2023\" instead of just \"Sales Data\"</li> </ul> </li> <li>Each plot should have axes labels<ul> <li>E.g., label the x-axis as \"Months\" and the y-axis as \"Revenue in USD\"</li> </ul> </li> <li>If there are several multiple data series on the same plot, it should have a     legend</li> <li>In a plotting function, <code>plt.show()</code> should not be added at the end<ul> <li>This allows for further customization or saving of the plot before     displaying</li> <li>E.g., users might want to save the plot using <code>plt.savefig('plot.png')</code>     before showing it</li> </ul> </li> <li>In a plotting function, the <code>ax</code> parameter should be exposed to allow users to     customize the plot further<ul> <li>E.g., users can modify the axes limits or add additional annotations</li> </ul> </li> <li>If a function plots multiple plots, they should be generally plotted in a     single figure<ul> <li>E.g., use <code>plt.subplots()</code> to create a grid of plots within a single figure</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_14","title":"Linter","text":"<ul> <li>The name of a notebook should generally be the same as the branch name, unless     it's a Master notebook</li> <li>All notebooks should have a table of contents<ul> <li>Linter automatically adds and updates the table of contents</li> </ul> </li> <li>At the top of the notebook there should be a Markdown cell <code># Description</code>,     followed by a Markdown cell with an explanation of the notebook's goal, what     it does, etc.</li> <li>Immediately below the description, there should be a Markdown cell     <code># Imports</code>, followed by a code cell importing all the needed libraries<ul> <li>It should include autoreload modules to keep the local code updated in real     time:     <code>python %load_ext autoreload %autoreload 2</code></li> <li>All the imports should be located in a single cell</li> </ul> </li> <li>Below the cell with the imports, there should be a code cell that configures     the logging and notebook style, and reports execution info:     ```python</li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#configure_logger","title":"Configure logger.","text":"<p>hdbg.init_logger(verbosity=logging.INFO) _LOG = logging.getLogger(name)</p>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#print_system_signature","title":"Print system signature.","text":"<p>_LOG.info(\"%s\", henv.get_system_signature()[0])</p>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#configure_the_notebook_style","title":"Configure the notebook style.","text":"<p>hprint.config_notebook()     ``` - The rest of the notebook should be clearly organized using Markdown cells with     headings of different levels - There should be no errors in the executed notebook - Ideally, there should be no warnings in the executed notebook</p>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#jupytext","title":"Jupytext","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_15","title":"LLM","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_15","title":"Linter","text":"<ul> <li>Each notebook must have an accompanying Python file, linked via <code>jupytext</code>,     which contains a synchronized copy of the notebook's code</li> <li>The notebook and its paired Python file should share the same name, differing     only in their file extensions</li> <li>Ensure that the code in the notebook and its paired Python file remains     synchronized at all times</li> <li>If you update or delete the notebook, you must also update or delete its     paired Python file, and vice versa</li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#markdown","title":"Markdown","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#general_2","title":"General","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_16","title":"LLM","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_16","title":"Linter","text":"<ul> <li> <p>Names of documentation files should follow the format     <code>docs/{component}/{audience}.{topic}.{diataxis_tag}.md</code> to help in organizing     and categorizing documentation files effectively where:</p> <ul> <li>The <code>{component}</code> part specifies the part of the project the documentation     is related to</li> <li>The <code>{audience}</code> part indicates who the documentation is intended for</li> <li>The <code>{topic}</code> part describes the subject matter of the documentation</li> <li>The <code>{diataxis_tag}</code> part categorizes the documentation according to the     Di\u00e1taxis framework (e.g., explanation, tutorial)</li> <li>E.g., <code>docs/documentation_meta/all.diataxis.explanation.md</code></li> </ul> </li> <li> <p>All Markdown files should have a table of contents</p> <ul> <li>The linter automatically adds and updates the table of contents</li> </ul> </li> <li> <p>There should be one and only one level 1 heading (with one <code>#</code>) in a Markdown</p> <ul> <li>The level 1 heading:<ul> <li>Should clearly convey the primary topic or purpose of the document</li> <li>Serves as the main title of the document</li> <li>Should be the first line and located above the table of contents</li> </ul> </li> </ul> </li> <li> <p>Wrap file paths, names of variables, functions, and classes in backticks</p> <ul> <li>E.g., <code>file_path</code>, <code>variable_name</code>, <code>function_name()</code>, <code>ClassName</code></li> </ul> </li> <li>Commands should be prepended by <code>&gt;</code><ul> <li>Example     <pre><code>&gt; notes_to_pdf.py \\\n    --input lectures_source/Lesson5-Theory_Statistical_learning.txt \\\n    --output Lesson5.pdf \\\n    --type slides \\\n    --toc_type navigation \\\n    --debug_on_error \\\n    --skip_action cleanup_after\n</code></pre></li> </ul> </li> <li>Commands should be prepended by <code>docker&gt;</code> if they need to be run inside Docker</li> <li>Avoid using screenshots whenever possible and instead copy-and-paste text with     the right highlighting<ul> <li>E.g., instead of a screenshot of a terminal command, provide the command     text: <code>&gt; ls -la</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#headers","title":"Headers","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_17","title":"LLM","text":"<ul> <li>Do not use bold or italics in headings</li> <li>Use headers so that it's easy to refer to something by link</li> <li>Do not make the chunk of text in a header too small since we don't want to     have too many headers<ul> <li>E.g., there should be at least 5-10 lines in each header</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_17","title":"Linter","text":"<ul> <li>Headings are capitalized as a title<ul> <li>E.g., <code>Data schema</code> instead of <code>Data Schema</code></li> <li>The linter automatically formats them</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#text","title":"Text","text":""},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#llm_18","title":"LLM","text":"<ul> <li> <p>We use bullet point lists</p> <ul> <li>For the items, <code>-</code> should be used instead of <code>*</code> or circles</li> <li>Items in bullet point lists should not end with a period</li> </ul> </li> <li> <p>Boldface and italics should be used sparingly throughout the text</p> </li> <li> <p>Structure the text so that bullet points of higher level correspond to     \"nesting\" in the concept</p> </li> <li> <p>Examples should go in a sub-bullet</p> <ul> <li>Good     <pre><code>- We typically increment the revision, likely a minor one\n    - E.g., from `v0.3` to `v0.3.1`\n</code></pre></li> </ul> </li> <li> <p>Use \"you\" and not \"we\" or \"one\"</p> <ul> <li>Let's just be direct: no need to be passive-aggressive</li> </ul> </li> <li> <p>Text should be reflowed to the maximum of 80 columns per line</p> <ul> <li>The linter performs this operation automatically</li> </ul> </li> <li> <p>Use active voice most of the time and use passive voice sparingly</p> <ul> <li>Good: \"The user updates the file\"</li> <li>Bad: \"The file is updated by the user\"</li> </ul> </li> <li> <p>Be efficient</p> <ul> <li>Do not explain things in a repetitive way</li> <li>Rewrite long-winded AI-generated texts in a concise way</li> <li>E.g.,<ul> <li>Good: \"Update the software by following these steps\"</li> <li>Bad: \"The process of updating the software can be done by following these     steps\"</li> </ul> </li> </ul> </li> <li> <p>When describing a tool the format should be the following:</p> <ul> <li>A description of what the tool does</li> <li>A list of examples of invocations of a tool with:<ul> <li>A comment on the command line</li> <li>The command line</li> <li>Its output if possible</li> </ul> </li> <li>A copy-paste version of the tool interface running <code>-h</code></li> </ul> </li> <li> <p>When nesting code blocks under list items in Markdown, we align the code block     to the previous block without empty lines     <pre><code>- Clone the super-repo locally\n    ```bash\n    &gt; git clone --recursive git@github.com:causify-ai/{repo_name}.git ~/src/{repo_name}{index}\n    ```\n- Line2\n</code></pre></p> <ul> <li>The rendering stage makes sure that the output is correctly indented and     spaced</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.coding_style_guidelines.reference.html#linter_18","title":"Linter","text":"<ul> <li>Code blocks should always be accompanied by language markers<ul> <li>E.g., <code>bash</code>, <code>python</code>, <code>text</code>, <code>markdown</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html","title":"All.reading other people code.how to guide","text":""},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html#reading_other_people_code","title":"Reading Other People Code","text":""},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html#reading_other_people_code_1","title":"Reading Other People Code","text":"<ul> <li> <p>People don't like reading other people's code</p> <ul> <li>Still reading existing code needs to be done</li> <li>Nobody can code in a vacuum</li> </ul> </li> <li> <p>When done with the right attitude, reading code can be enjoyable, and you can     actually learn and improve as a coder</p> <ul> <li>E.g., writers read and study other writers' book to improve</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html#what_not_to_do","title":"What Not to Do","text":""},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html#rewrite_coding","title":"Rewrite Coding","text":"<ul> <li> <p>You think \"This code is a complete ugly mess. It needs to be rewritten\"</p> <ul> <li>The answer is: ABSOLUTELY NO!</li> </ul> </li> <li> <p>The best case of a code rewrite is to have:</p> <ul> <li>The same code (in reality is likely that new bugs entered the system)</li> <li>With a different complexity that you only now understand</li> <li>After a long time and effort</li> </ul> </li> <li> <p>In other terms, there is no reason to believe that you are going to do a     better job than others did</p> </li> </ul>"},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html#incremental_renovation","title":"Incremental Renovation","text":"<ul> <li> <p>The first thing that programmers want to do is to bulldoze the place flat and     build something great</p> </li> <li> <p>Nobody is excited about incremental renovation:</p> <ul> <li>Improving</li> <li>Refactoring</li> <li>Cleaning out</li> <li>Adding unit tests</li> </ul> </li> <li>In reality, 99.9% of work is incremental</li> </ul>"},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html#its_harder_to_read_code_than_to_write_it","title":"It'S Harder to Read Code Than to Write It","text":"<ul> <li>For this reason code reuse is hard</li> <li>For this reason, everybody on the team has the same function to do the same     thing</li> <li>It's easier and more fun to write new code than figuring out how the old code     works</li> </ul>"},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html#respect_old_code","title":"Respect Old Code!","text":"<ul> <li> <p>When you think \"the old code is a mess\", you are probably wrong</p> </li> <li> <p>The idea that new code is better than old code is absurd</p> <ul> <li>Old code has been used</li> <li>Old code has been tested</li> <li>Lots of bugs in old code have been found and fixed</li> </ul> </li> <li> <p>When the code looks a mess is because it handles many corner cases you didn't     even think about, you didn't even know were possible</p> <ul> <li>Each of that bug took a long time to be discovered and fixed it</li> </ul> </li> <li> <p>When you throw away code and start from scratch, you are throwing away all the     knowledge, all the bug fixes, all the hard thinking</p> </li> </ul>"},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html#what_makes_code_a_mess","title":"What Makes Code a Mess?","text":"<ul> <li> <p>What makes the code a \"mess\" (at least according to your expert opinion as     world-class coder):</p> </li> <li> <p>Architectural problems</p> </li> <li> <p>E.g.,</p> <ul> <li>Code is not split into pieces in a way that makes sense</li> <li>Interfaces that are too broad and brittle</li> </ul> </li> <li> <p>These problems can be easily fixed!</p> </li> <li> <p>Inefficiency</p> </li> <li> <p>Profile and find what is the problem and fix that</p> </li> <li> <p>Ugly</p> </li> <li>E.g., horrible variable and function names</li> <li> <p>It takes 5 minutes of search-and-replace</p> </li> <li> <p>All these problems can be easily fixed in 100x less time than rewriting</p> </li> </ul>"},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html#what_to_do","title":"What to Do","text":""},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html#get_into_the_right_attitude","title":"Get Into the Right Attitude","text":"<ol> <li>Assume that whoever wrote the code knew what he/she was doing</li> <li>If that's not the case, he/she would have already been fired from the team</li> <li> <p>Therefore he/she is as competent than you</p> </li> <li> <p>Sorry for the bad news, but no, you are not the best coder on planet Earth</p> </li> <li> <p>So be humble</p> </li> <li> <p>\"Why is the code so complicated? I would have done XYZ and make it much    simpler?\"</p> </li> <li>There is no reason to believe that you can write the code in a simpler way</li> <li>The complexity is almost always needed to solve the complex problem we have</li> </ol>"},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html#reading_other_people_code_is_painful","title":"Reading Other People Code Is Painful","text":"<ul> <li> <p>The problem is that code reflects the thought process of the person who wrote     the code</p> <ul> <li>The goal of the style guide, code writing guide, Linter is precisely to push     us to write code consistently so that it's less painful to read</li> </ul> </li> <li> <p>When you write code first hand, you think about it, and you build your mental     model</p> <ul> <li>You see the problems, understand them, and then appreciate why a complex     solution is needed</li> </ul> </li> <li> <p>Maybe some constraints and specs were not adequately documented</p> </li> <li>Maybe there were multiple iterations and compromise between different     solutions</li> <li>Maybe several people were involved</li> <li>Maybe a hack solution needed to be added to ship and get the $1m from the     customers</li> </ul>"},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html#suggestions_on_how_to_read_code","title":"Suggestions on How to Read Code","text":"<ul> <li> <p>Use <code>git blame</code> to understand who wrote the code and over what period of time</p> <ul> <li>Knowing the author can help you ask him/her questions directly</li> </ul> </li> <li> <p>Use the same approach as for a code review</p> </li> <li> <p>Budget some time, like a few hours and stick to the process for that amount of     time</p> <ul> <li>Otherwise, after 5 mins you are like \"Argh! I can't do this!\" and you give     up</li> </ul> </li> <li> <p>Read the specs</p> <ul> <li>What is the code supposed to do?</li> <li>What are the edge cases to handle?</li> <li>How is it integrated into the rest of the code base?</li> </ul> </li> <li> <p>Skim through the entire code, top to bottom without reading line-by-line</p> <ul> <li>What's the goal?</li> <li>What are the specs?</li> <li>What are the functions?</li> <li>What are the interfaces?</li> <li>What is the structure?</li> </ul> </li> <li> <p>Read and execute the unit tests, if present</p> </li> <li> <p>Run the code with debug output <code>-v DEBUG</code> on simple examples to see what it     does</p> </li> <li> <p>Use PyCharm to navigate the code and jump around</p> </li> <li> <p>Add comments, when missing, to functions, to chunks of code, to each file</p> <ul> <li>Watch out for confusing comments</li> <li>Sometimes a comment can be out of date</li> </ul> </li> <li> <p>Add TODOs in the code for yourself</p> </li> <li> <p>Remember the coding conventions:</p> <ul> <li>Global variables are capital letters</li> <li>Functions starting with <code>_</code> are just for internals</li> <li>We have all the conventions to convey information about the thought process     of who wrote the code</li> </ul> </li> <li> <p>Take down notes about the code</p> <ul> <li>Write down the questions about what you don't understand<ul> <li>Maybe you will find the answer later (feel free to congratulate yourself!)</li> <li>Send an email to the author with the questions</li> </ul> </li> </ul> </li> <li> <p>Approach reading code as an active form</p> <ul> <li>Start writing unit tests for each piece that is not unit tested</li> <li>Step through the code with PyCharm</li> </ul> </li> <li> <p>Factor out the code</p> <ul> <li>Make sure you have plenty of unit tests before touching the code</li> </ul> </li> <li> <p>Expect to find garbage</p> </li> <li> <p>Don't feel bad when you get lost</p> <ul> <li>Reading code is not linear, like reading a book</li> <li>Instead, it's about building a mental model of how the code is structured,     how it works and why it's done in a certain way</li> </ul> </li> <li> <p>The more code you read, the more comfortable you will become</p> </li> </ul>"},{"location":"code_guidelines/all.reading_other_people_code.how_to_guide.html#refs","title":"Refs","text":"<ul> <li>How to Read Code (Eight Things to Remember)</li> <li>Things you should never do</li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html","title":"All.submit code for review.how to guide","text":""},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#first_review_process","title":"First Review Process","text":"<p>We understand that receiving feedback on your code can be a difficult process, but it is an important part of our development workflow. Here we have gathered some helpful tips and resources to guide you through your first review.</p>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#read_python_style_guide","title":"Read Python Style Guide","text":"<ul> <li>Before submitting your code for review, we highly recommend that you read our     Python Style Guide,     which outlines the major conventions and best practices for writing Python     code.</li> <li>Adhering to these standards will help ensure that your code is easy to read,     maintain, and understand for other members of the team.</li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#run_linter","title":"Run Linter","text":"<ul> <li>Linter is a tool that checks (and tries to fix automatically) your code for     syntax errors, style violations, and other issues.</li> <li>Run it on all the changed files to automatically catch any code issues before     filing any PR or before requesting a review!</li> <li>Run Linter with <code>invoke</code> command (which is abbreviated as <code>i</code>) and pass all     the files you need to lint in quotation marks after the <code>--files</code> option,     separated by a space</li> <li>The command should be run from the root of the repo you are developing in</li> <li>The file paths should be relative to the repo root<ul> <li>Command example: <pre><code>&gt; i lint --files=\"docs/coding/all.str_to_df.how_to_guide.md linters/utils.py\"\n</code></pre></li> <li>Output example:     <pre><code>docs/coding/all.str_to_df.how_to_guide.md: 'docs/coding/all.str_to_df.how_to_guide.md' is not referenced in README.md [check_md_reference]\ndocs/coding/all.str_to_df.how_to_guide.md:79: 'figs/str_to_df/image1.png' does not follow the format 'figs/all.str_to_df.how_to_guide.md/XYZ' [fix_md_links]\nlinters/utils.py:294: [R0916(too-many-boolean-expressions), get_dirs_with_missing_init] Too many boolean expressions in if statement (6/5) [pylint]\n</code></pre></li> <li><code>i lint</code> has options for many workflows. E.g., you can automatically lint     all the files that you touched in your PR with <code>--branch</code>, the files in the     last commit with <code>--last-commit</code>. You can look at all the options with:     <pre><code>&gt; i lint --help\n</code></pre></li> </ul> </li> <li>Fix the lints<ul> <li>No need to obsessively fix all of them - just crucial and obvious ones</li> </ul> </li> <li>Running Linter on a file also applies some formatting fixes to it     automatically and stages the updated file for commit</li> <li>If Linter introduces extensive changes in a PR, causing difficulty in reading     the diff, a new pull request should be created exclusively for the Linter     changes, based on the branch of the original PR.</li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#compare_your_code_to_example_code","title":"Compare Your Code to Example Code","text":"<ul> <li>To get an idea of what well-formatted and well-organized code looks like, we     suggest taking a look at some examples of code that adheres to our standards.</li> <li>We try to maintain universal approaches to all the parts of the code, so when     looking at a code example, check for:<ul> <li>Code style</li> <li>Docstrings and comments</li> <li>Type hints</li> <li>Dir structure</li> </ul> </li> <li>Here are some links to example code:<ul> <li>Classes, functions and scripts:<ul> <li><code>/import_check/show_imports.py</code></li> <li><code>/linters/amp_fix_md_links.py</code></li> <li><code>/helpers/lib_tasks_lint.py</code></li> </ul> </li> <li>Unit tests:<ul> <li><code>/import_check/test/test_show_imports.py</code></li> <li><code>/linters/test/test_amp_fix_md_links.py</code></li> <li><code>/helpers/test/test_lib_tasks_lint.py</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#edit_codetext_written_by_ai","title":"Edit Code/Text Written by AI","text":"<ul> <li>We do not mind if the AI writes the first version of the code or text for you</li> <li>We do mind if you simply copy-and-paste its output and submit if for our     review as-is</li> <li>Take whatever is produced by AI as the first draft: go over it, revise it,     make sure it's readable and relevant, adjust it to fit our specific     conventions</li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#save_reviewer_time","title":"Save Reviewer Time","text":"<ul> <li>Follow the instructions given in     <code>PR workflows</code></li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#make_sure_checks_are_green","title":"Make Sure Checks Are Green","text":"<ul> <li>Before requesting review, make sure that all the checks performed by GitHub     Actions pass<ul> <li>The checks and their status can be seen at the bottom of the PR page or in     the \"Checks\" tab</li> </ul> </li> <li>Clicking on a failed check will take you to the extended report with the full     failure stacktrace</li> <li>If the Linter check fails with \"The Git client is not clean\", then run Linter     on the files reported by the check (it will automatically update them with     formatting fixes), commit and push them</li> <li>In rare cases it's okay to submit a PR for review with some of the checks     failing:<ul> <li>If the tests are already broken in master</li> <li>If a genuine bug in Linter causes the check to fail or requires reverting     the automatic fixes<ul> <li>Check if this bug is already tracked in an issue, and if not, open a new     issue to report it</li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#review_your_own_pr","title":"Review Your Own PR","text":"<ul> <li>Before requesting review, take a final look at the \"Files changed\" tab</li> <li>Make sure there are<ul> <li>No changes you haven't intended</li> <li>No leftovers from debugging</li> <li>No files added by mistake (such as tmp files)</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#assign_reviewers","title":"Assign Reviewers","text":"<ul> <li>Make sure to select a Reviewer in a corresponding GitHub field so he/she gets     notified<ul> <li></li> <li>Junior contributors should assign Team Leaders (e.g., Grisha, DanY, Samarth,     ...) to review their PR<ul> <li>Team Leaders will assign integrators (GP &amp; Paul) themselves after all     their comments have been addressed</li> </ul> </li> <li>Ping the assigned Reviewer in the issue if nothing happens in 24 hours</li> <li>If you want to keep someone notified about changes in the PR but do not want     to make him/her a Reviewer, type <code>FYI @github_name</code> in the comment section</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#mention_the_issue","title":"Mention the Issue","text":"<ul> <li>Mention the corresponding issue in the PR description to ease navigation<ul> <li>E.g., see an     example<ul> <li></li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#resolve_conversations","title":"Resolve Conversations","text":"<ul> <li>When you've addressed a comment from a Reviewer, press <code>Resolve conversation</code>     button so the Reviewer knows that you actually took care of it<ul> <li></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#merge_master_into_your_branch","title":"Merge Master Into Your Branch","text":"<ul> <li>Before any PR review request do <code>i git_merge_master</code> in order to keep the code     updated<ul> <li>Resolve conflicts if there are any</li> <li>Do not forget to push it since this action is a commit itself</li> </ul> </li> <li>Actually, a useful practice is to merge master to your branch every time you     get back to work on it<ul> <li>This way you make sure that your branch is always using relevant code and     avoid huge merge conflicts</li> </ul> </li> <li>You can also easily merge master into your branch by clicking on \"Update     branch\" button on the PR page     </li> <li>NEVER press <code>Squash and merge</code> button yourself<ul> <li>You need to merge master branch into your branch - not vice verca!</li> <li>This is a strictly Team Leaders' and Integrators' responsibility</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#ask_for_reviews","title":"Ask for Reviews","text":"<ul> <li>When you've addressed all the comments and need another round of review:<ul> <li>Press the circling arrows sign next to the Reviewer for the ping<ul> <li></li> </ul> </li> <li>Remove <code>PR_for_authors</code> and add the <code>PR_for_reviewers</code> label (see     here for     the description of available labels)<ul> <li></li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#do_not_use_screenshots","title":"Do Not Use Screenshots","text":"<ul> <li>Stack traces and logs are much more convenient to use for debugging</li> <li>Screenshots are often too small to capture both input and return logs while     consuming a lot of basically useless memory</li> <li>Reviewers and collaborators cannot copy from the screenshot, which means that     if they want to reproduce the error, they need to manually type the code shown     in the screenshot, which is very inconvenient and error-prone</li> <li>The exceptions are plots and non-code information</li> <li>Examples:<ul> <li> <p>Bad</p> <p>     - Good</p> <p>Input:</p> <p>```python type_ = \"supply\" supply_curve1 = ddcrsede.get_supply_demand_discrete_curve( type_, supply_orders_df1 ) supply_curve1 <pre><code>Error:\n\n```text\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\nCell In [5], line 2\n            1 type_ = \"supply\"\n----&gt; 2 supply_curve1 = ddcrsede.get_supply_demand_discrete_curve(\n            3     type_, supply_orders_df1\n            4 )\n            5 supply_curve1\n\nNameError: name 'ddcrsede' is not defined\n</code></pre></p> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#report_bugs_correctly","title":"Report Bugs Correctly","text":"<ul> <li>Whenever you face any errors, put as much information about the problem as     possible, e.g.,:<ul> <li>What you are trying to achieve</li> <li>Command line you ran, e.g.,     <pre><code>&gt; i lint -f defi/tulip/test/test_dao_cross_sol.py\n</code></pre></li> <li>Copy-paste the error and the stack trace from the cmd line, no     screenshots, e.g.,     <pre><code>Traceback (most recent call last):\n    File \"/venv/bin/invoke\", line 8, in &lt;module&gt;\n        sys.exit(program.run())\n    File \"/venv/lib/python3.8/site-packages/invoke/program.py\", line 373, in run\n        self.parse_collection()\nValueError: One and only one set-up config should be true:\n</code></pre></li> <li>The log of the run<ul> <li>Maybe the same run using <code>-v DEBUG</code> to get more info on the problem</li> </ul> </li> <li>What the problem is</li> <li>Why the outcome is different from what you expected</li> <li>E.g. on how to report any issues<ul> <li>https://github.com/kaizen-ai/kaizenflow/issues/370#issue-1782574355</li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#stick_to_smaller_prs","title":"Stick to Smaller Prs","text":"<ul> <li>It's better to push frequently and ask for feedback early to avoid large     refactoring</li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#talk_through_code_and_not_github","title":"Talk Through Code and Not Github","text":"<ul> <li>PR authors should, as a rule, talk to reviewers not through GitHub but through     code<ul> <li>E.g., if there is something you want to explain to the reviewers, you should     not comment on your own PR, but instead add comments in the code itself, or     improve the code so that it doesn't need explanation</li> <li>Everything on GitHub is lost once the PR is closed, so all knowledge needs     to go inside the code or the documentation</li> </ul> </li> <li>Of course it's ok to respond to questions on GitHub</li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#look_at_examples_of_first_reviews","title":"Look at Examples of First Reviews","text":"<ul> <li>It can be helpful to review some examples of previous first reviews to get an     idea of what common issues are and how to address them.</li> <li>Here are some links to a few \"painful\" first reviews:<ul> <li>Adding unit tests:<ul> <li>https://github.com/kaizen-ai/kaizenflow/pull/166</li> <li>https://github.com/kaizen-ai/kaizenflow/pull/186</li> </ul> </li> <li>Writing scripts:<ul> <li>https://github.com/kaizen-ai/kaizenflow/pull/267</li> <li>https://github.com/kaizen-ai/kaizenflow/pull/276</li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.submit_code_for_review.how_to_guide.html#checklist","title":"Checklist","text":"<p>Post this checklist in a PR and check the boxes when the PR meets the requirements</p> <ul> <li>[ ] The branch is named following the format             <code>RelatedIssueTag_Normalized_issue_title</code><ul> <li>E.g., <code>HelpersTask123_Provide_branch_name_example</code>, if the branch is for     working on the issue #123 in the <code>helpers</code> repo with the title \"Provide     branch name example\"</li> </ul> </li> <li>[ ] Commit messages are short and informative<ul> <li>Ideally, they follow the format     <code>RelatedIssueTag: High-level commit description</code></li> <li>E.g., <code>HelpersTask123: Add example</code></li> <li>They do not mention the name of the file that has been changed by the commit</li> </ul> </li> <li>[ ] The title of the PR matches the name of the branch</li> <li>[ ] The starting post of the PR briefly describes the content of the PR on a             high level</li> <li>[ ] The issue related to the PR is mentioned in the starting post of the PR</li> <li>[ ] The PR is not linked to any issues under the <code>Development</code> section</li> <li>[ ] At least one reviewer is assigned under <code>Reviewers</code></li> <li>[ ] The PR author is listed under <code>Assignees</code></li> <li>[ ] All the checks performed by GitHub Actions pass<ul> <li>If they do not and it can't be fixed, explain why in a comment</li> <li>E.g., \"The fast tests failure is also present in <code>master</code> and is unrelated     to this PR\"</li> </ul> </li> <li>[ ] The branch is up to date with the master branch</li> <li>[ ] There are no conflicts with the master branch</li> <li>[ ] There are no files checked in by mistake (such as tmp and log files)</li> <li>[ ] All checked in files are checked and formatted by Linter in the latest             commit</li> <li>[ ] No files larger than 500 KB are checked in</li> <li>[ ] Screenshots are not used in PR posts to describe the situation or report             an error (if needed, copy-and-paste is used instead)</li> <li>[ ] Label <code>PR_for_reviewers</code> is present if a review is requested</li> <li>[ ] Fixes addressing a review comment are applied everywhere, not just where             the reviewer pointed out the issue</li> <li>[ ] After addressing review comments, all corresponding conversations are             marked as <code>resolved</code></li> <li>[ ] After all review comments are resolved, <code>re-request review</code> button is used             to request another round of review</li> </ul>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html","title":"All.type hints.how to guide","text":""},{"location":"code_guidelines/all.type_hints.how_to_guide.html#type_hints","title":"Type Hints","text":""},{"location":"code_guidelines/all.type_hints.how_to_guide.html#type_hints_1","title":"Type Hints","text":""},{"location":"code_guidelines/all.type_hints.how_to_guide.html#why_we_use_type_hints","title":"Why We Use Type Hints","text":"<ul> <li>We use Python 3 type hints to:<ul> <li>Improve documentation</li> <li>Allow mypy to perform static checking of the code, looking for bugs</li> <li>Enforce the type checks at run-time, through automatic assertions (not     implemented yet)</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#what_to_annotate_with_type_hints","title":"What to Annotate with Type Hints","text":"<ul> <li>We expect all new library code (i.e., that is not in a notebook) to have type     annotations</li> <li>We annotate the function signature</li> <li>We don't annotate the variables inside a function unless <code>mypy</code> reports that     it can't infer the type</li> <li>We strive to get no errors / warnings from Linter, including <code>mypy</code></li> </ul>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#conventions","title":"Conventions","text":""},{"location":"code_guidelines/all.type_hints.how_to_guide.html#empty_return","title":"Empty Return","text":"<ul> <li>Return <code>-&gt; None</code> if your function doesn't return<ul> <li>Pros:<ul> <li><code>mypy</code> checks functions only when there is at least an annotation: so     using <code>-&gt; None</code> enables mypy to do type checking</li> <li>It reminds us that we need to use type hints</li> </ul> </li> <li>Cons:<ul> <li><code>None</code> is the default value and so it might seem redundant</li> </ul> </li> </ul> </li> </ul>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#invoke_tasks","title":"Invoke Tasks","text":"<ul> <li> <p>For some reason <code>invoke</code> does not like type hints, so we</p> <ul> <li>Omit type hints for <code>invoke</code> tasks, i.e. functions with the <code>@task</code>     decorator</li> <li>Put <code># type: ignore</code> so that <code>mypy</code> does not complain</li> </ul> </li> <li> <p>Example:     <code>python @task def run_qa_tests( # type: ignore     ctx,     stage=\"dev\",     version=\"\", ):</code></p> </li> </ul>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#annotation_for_kwargs","title":"Annotation for <code>kwargs</code>","text":"<ul> <li>We use <code>kwargs: Any</code> and not <code>kwargs: Dict[str, Any]</code></li> <li><code>*</code> always binds to a <code>Tuple</code>, and <code>**</code> always binds to a <code>Dict[str, Any]</code>.     Because of this restriction, type hints only need you to define the types of     the contained arguments. The type checker automatically adds the     <code>Tuple[_, ...]</code> and <code>Dict[str, _]</code> container types.</li> <li>Reference article</li> </ul>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#any","title":"<code>Any</code>","text":"<ul> <li><code>Any</code> type hint = no type hint</li> <li>We try to avoid it everywhere when possible</li> </ul>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#nparray_and_npndarray","title":"<code>np.array</code> and <code>np.ndarray</code>","text":"<ul> <li>If you get something like the following lint:     <pre><code>dataflow/core/nodes/sklearn_models.py:537:[amp_mypy] error: Function \"numpy.core.multiarray.array\" is not valid as a type [valid-type]\n</code></pre></li> <li>Then the problem is probably that a parameter that the lint is related to has     been typed as <code>np.array</code> while it should be typed as <code>np.ndarray</code>:     <code>python `x_vals: np.array` -&gt; `x_vals: np.ndarray`</code></li> </ul>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#handling_the_annoying_incompatible_types_in_assignment","title":"Handling the Annoying <code>Incompatible types in assignment</code>","text":"<ul> <li><code>mypy</code> assigns a single type to each variable for its entire scope</li> <li>The problem is in common idioms where we use the same variable to store     different representations of the same data     ```python output : str = ... output = output.split(\"\\n\") ...</li> </ul>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#process_output","title":"Process output.","text":"<p>... output = \"\\n\".join(output)     <code>- Unfortunately the proper solution is to use different variables</code>python output : str = ... output_as_array = output.split(\"\\n\") ...</p>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#process_output_1","title":"Process output.","text":"<p>... output = \"\\n\".join(output_as_array)     <code>- Another case could be:</code>python from typing import Optional def test_func(arg: bool): ... var: Optional[bool] = ... dbg.dassert_is_not(var, None) test_func(arg=var)     <code>- Sometimes `mypy` doesn't pick up the `None` check, and warns that the function     expects a `bool` rather than an `Optional[bool]`. In that case, the solution     is to explicitly use `typing.cast` on the argument when passing it in, note     that `typing.cast` has no runtime effects and is purely for type checking. - Here're the relevant [docs](https://mypy.readthedocs.io/en/stable/casts.html) - So the solution would be:</code>python from typing import cast ... ... test_func(arg=cast(bool, var))     ```</p>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#handling_the_annoying_none_has_no_attribute","title":"Handling the Annoying <code>\"None\" has no attribute</code>","text":"<ul> <li>In some model classes <code>self._model</code> parameter is being assigned to <code>None</code> in     ctor and being set after calling <code>set_fit_state</code> method</li> <li>The problem is that statically it's not possible to understand that someone     will call <code>set_fit_state</code> before using <code>self._model</code>, so when a model's method     is applied:     ```python self._model = self._model.fit(...)     <pre><code>the following lint appears:\n```bash\ndataflow/core/nodes/sklearn_models.py:155:[amp_mypy] error: \"None\" has no attribute \"fit\"\n</code></pre></li> <li>A solution is to<ul> <li>Type hint when assigning the model parameter in ctor:     <code>python self._model: Optional[sklearn.base.BaseEstimator] = None</code></li> <li>Cast a type to the model parameter after asserting that it is not <code>None</code>:     <code>python hdbg.dassert_is_not(self._model, None) self._model = cast(sklearn.base.BaseEstimator, self._model)</code></li> </ul> </li> </ul>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#disabling_mypy_errors","title":"Disabling <code>mypy</code> Errors","text":"<ul> <li>If <code>mypy</code> reports an error and you don't understand why, please ping one of     the Python experts asking for help</li> <li>If you are sure that you understand why <code>mypy</code> reports and error and that you     can override it, you disable this <code>error</code></li> <li>When you want to disable an error reported by <code>mypy</code>:<ul> <li>Add a comment reporting the <code>mypy</code> error</li> <li>Explain why this is not a problem</li> <li>Add <code># type: ignore</code> with two spaces as usual for the inline comment</li> <li>Example     ```python</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#mypy_cannot_find_module_named_pyannotate_runtime","title":"mypy: Cannot find module named 'pyannotate_runtime'","text":""},{"location":"code_guidelines/all.type_hints.how_to_guide.html#pyannotate_is_not_always_installed","title":"pyannotate is not always installed","text":"<p>from pyannotate_runtime import collect_types # type: ignore         ```</p>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#what_to_do_when_you_dont_know_what_to_do","title":"What to Do When You Don'T Know What to Do","text":"<ul> <li>Go to the     <code>mypy</code> official cheat sheet</li> <li>Use <code>reveal_type</code><ul> <li>To find out what type <code>mypy</code> infers for an expression anywhere in your     program, wrap it in <code>reveal_type()</code></li> <li><code>mypy</code> will print an error message with the type; remove it again before     running the code</li> <li>See     the official <code>mypy</code> documentation</li> </ul> </li> </ul>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#library_without_types","title":"Library Without Types","text":"<ul> <li><code>mypy</code> is unhappy when a library doesn't have types</li> <li>Lots of libraries are starting to add type hints now that Python 2 has been     deprecated     <pre><code>*.py:14: error: No library stub file for module 'sklearn.model_selection' [mypy]\n</code></pre></li> <li>You can go in <code>mypy.ini</code> and add the library (following the alphabetical     order) to the list</li> <li>Note that you need to ensure that different copies of <code>mypy.ini</code> in different     sub projects are equal     <pre><code>&gt; vimdiff mypy.ini amp/mypy.ini\nor\n&gt; cp mypy.ini amp/mypy.ini\n</code></pre></li> </ul>"},{"location":"code_guidelines/all.type_hints.how_to_guide.html#inferring_types_using_unit_tests","title":"Inferring Types Using Unit Tests","text":"<ul> <li>Sometimes it is possible to infer types directly from unit tests. We have used     this flow to annotate the code when we switched to Python3 and it worked fine     although there were various mistakes. We still prefer to annotate by hand     based on what the code is intended to do, rather than automatically infer it     from how the code behaves.<ul> <li>Install <code>pyannotate</code> <pre><code>&gt; pip install pyannotate\n</code></pre></li> <li>To enable collecting type hints run     <pre><code>&gt; export PYANNOTATE=True\n</code></pre></li> <li>Run <code>pytest</code>, e.g., on a subset of unit tests:</li> <li>Run <code>pytest</code>, e.g., on a subset of unit tests like <code>helpers</code>:     <pre><code>&gt; pytest helpers\n</code></pre></li> <li>A file <code>type_info.json</code> is generated</li> <li>Annotate the code with the inferred types:     <pre><code>&gt; pyannotate -w --type-info type_info.json . --py3\n</code></pre></li> </ul> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html","title":"All.architecture diagrams.explanation","text":""},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#architecture_diagrams","title":"Architecture Diagrams","text":""},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#architecture_diagrams_1","title":"Architecture Diagrams","text":""},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#summary","title":"Summary","text":"<ul> <li>We use C4 as a way to describe graphically software architecture together with     some conventions</li> <li>Both Mermaid and PlantUML support C4 diagrams</li> <li>Mermaid is preferred since it can be rendered natively by GitHub</li> <li>PlantUML can be rendered through some of our scripts in regular markdown</li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#brief_introduction_to_c4","title":"Brief Introduction to C4","text":"<ul> <li> <p>A detailed description of C4 is https://C4model.com</p> </li> <li> <p>C4 stands for \"context, container, component, code\" (the 4 Cs)</p> </li> <li> <p>C4 model helps developers describe software architecture</p> <ul> <li>It maps code at various level of detail</li> <li>It is useful for both software architects and developers</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#different_levels_of_detail","title":"Different Levels of Detail","text":"<ul> <li>The 4 levels of detail are:<ol> <li>(System) Context system</li> <li>How the system fits in the world</li> <li>Container</li> <li>High-level technical blocks</li> <li>Component</li> <li>Show the components inside a container (i.e., a high-level block)</li> <li>Code</li> <li>Show how components are implemented</li> <li>Represented in terms of UML class diagrams</li> </ol> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#system_context_level_1","title":"(System) Context (Level 1)","text":"<ul> <li> <p>A system context describes something that delivers value to its users</p> <ul> <li>Typically a system is owned by a single software development team</li> </ul> </li> <li> <p>System context diagram shows the big picture of how the software system     interacts with users and other systems in the IT environment</p> </li> <li> <p>The focus is not on:</p> <ul> <li>Technologies</li> <li>Protocols</li> <li>Low-level details</li> </ul> </li> <li> <p>Audience:</p> <ul> <li>Both technical and non-technical people</li> <li>Both inside and outside the software development team</li> </ul> </li> <li> <p>A system system is made up of one or more containers</p> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#container_level_2","title":"Container (Level 2)","text":"<ul> <li> <p>A container represents an application</p> <ul> <li>E.g.,<ul> <li>Server-side web application (e.g., Tomcat running Java EE web application,     Ruby on Rails application)</li> <li>Client-side web application (e.g., JavaScript running in a web browser,     e.g., using Angular)</li> <li>Client-side desktop application (e.g., an macOS application)</li> <li>Mobile app (e.g., an iOS or Android app)</li> <li>Server-side console application</li> <li>Server-less function (e.g., AWS Lambda)</li> <li>Database (e.g., MySQL, MongoDB)</li> <li>Content-store (e.g., AWS S3)</li> <li>File-system (e.g., a local filesystem)</li> <li>Shell script</li> </ul> </li> </ul> </li> <li> <p>A container runs some code and stores some data</p> <ul> <li>Typically each container runs in its own process space</li> <li>Containers communicate through inter-process communication</li> </ul> </li> <li> <p>A container diagram shows the high-level shape of the software architecture     and how responsibilities are distributed across it</p> </li> <li> <p>A container is the sum of components</p> <ul> <li>All components inside a container execute together</li> <li>Components can't be deployed as separate units</li> </ul> </li> <li> <p>Audience:</p> <ul> <li>Technical people</li> <li>Inside and outside of the software development team</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#component_level_3","title":"Component (Level 3)","text":"<ul> <li> <p>Component is a group of related functionality encapsulated behind a     well-defined interface</p> <ul> <li>E.g., collection of classes behind an interface</li> </ul> </li> <li> <p>A component diagram decomposes each container to identify major structural     building blocks and interactions</p> </li> <li> <p>Audience</p> <ul> <li>Software architects and developers</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#code_level_4","title":"Code (Level 4)","text":"<ul> <li> <p>Code is the implementation of the software system</p> <ul> <li>Each component can represented in terms of UML class diagrams, entity     relationship diagrams, etc.</li> <li>This diagram should be generated automatically from code</li> </ul> </li> <li> <p>Audience</p> <ul> <li>Software architects and developers</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#our_conventions_for_c4_diagrams","title":"Our Conventions for C4 Diagrams","text":""},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#mapping_c4_and_code_structure","title":"Mapping C4 and Code Structure","text":"<ul> <li>To simplify, we map the 4 levels of C4 in the code structure</li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#system_context_level_2","title":"(System) Context (Level 1)","text":"<ul> <li>= big picture of how the system interacts with users and other systems</li> <li>Mapped onto a code repository</li> <li>E.g.,<ul> <li><code>//...</code> is a system providing data and analytics for commodity</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#container_level_3","title":"Container (Level 2)","text":"<ul> <li>= high-level software architecture and how responsibilities are split in the     system</li> <li>Mapped onto the first level of directories in a repo</li> <li>E.g., in <code>//...</code><ul> <li><code>automl</code>: application for automatic machine learning for commodity analysis</li> <li><code>edgar</code>: application to handle EDGAR data</li> <li><code>etl3</code>: back-end db for time series with real-time and point-in-time     semantics</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#component_level_4","title":"Component (Level 3)","text":"<ul> <li>= a group of related functionality encapsulated behind a well-defined     interface (e.g., collection of classes behind an interface)</li> <li>Mapped onto the second level of directory</li> <li>E.g., in <code>//.../edgar</code><ul> <li><code>api</code>: real-time system storing the data from EDGAR</li> <li><code>company_commodity_mapping</code>: data pipeline to process mapping between     commodities and companies</li> <li><code>form8</code>: data pipeline processing form 8</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#component_level_5","title":"Component (Level 4)","text":"<ul> <li>= OOP classes</li> <li>Typically we organize multiple related classes in files</li> <li>E.g., in <code>//.../edgar/form8</code><ul> <li><code>analyze_results.py</code>: classes and functions to analyze results from the data     pipeline</li> <li><code>extract_tables.py</code>: class <code>TableExtractor</code> extracting tables from Form 8</li> <li><code>filter_tables.py</code>: class <code>TableFilterer</code></li> <li><code>match_targets.py</code></li> <li><code>normalize_table.py</code></li> </ul> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#use_classes","title":"Use Classes!","text":"<ul> <li> <p>In order to be able to describe the system with C4 it is best to use classes     to separate responsibilities and package code</p> </li> <li> <p>Using classes has the following advantages:</p> <ul> <li>Organizes the code in cohesive parts</li> <li>Makes clear what is a public interface vs a private interface (e.g.,     helpers)</li> <li>Highlights responsibility (e.g., builder, annotation, processor, analyzer)</li> <li>Simplifies the interface of functions by sharing state in the object</li> </ul> </li> <li> <p>Note that classes still allow our favorite functional style of programming</p> <ul> <li>E.g., pandas is implemented with classes and it allows functional style</li> <li>The difference is going from:     <code>python f(ton of arguments)</code>     to     <code>python o(some argument).f(other arguments)</code></li> </ul> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#generating_class_diagram","title":"Generating Class Diagram","text":"<ul> <li>To generate a class diagram (level 4 of C4), you can run     <pre><code>&gt; dev_scripts/create_class_diagram.sh\n</code></pre></li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#mermaid","title":"Mermaid","text":""},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#class_diagram","title":"Class Diagram","text":"<ul> <li>See https://mermaid.js.org/syntax/classDiagram.html</li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#support_for_c4","title":"Support for C4","text":"<ul> <li>Mermaid supports most features of C4<ul> <li>See https://mermaid.js.org/syntax/c4.html</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#render_on-line","title":"Render On-Line","text":"<ul> <li>See https://mermaid.live/edit</li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#plantuml","title":"PlantUML","text":"<ul> <li> <p>Unified Modeling Language (UML) is a modeling language for software     engineering to provide a standard way to visualize design of a system</p> </li> <li> <p>We use mainly Class Diagrams</p> <ul> <li>For information on some class diagram convention see     https://en.wikipedia.org/wiki/Class_diagram</li> </ul> </li> <li> <p>You can refer to the PDF guide at http://plantuml.com/guide for an extensive     description of what PlantUML can do</p> <ul> <li>We are mainly interested in the \"Class diagram\" section</li> </ul> </li> <li> <p>The website https://structurizr.com has lots of information on using tools for     C4 and lots of examples</p> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#plantuml_is_markdown","title":"PlantUML is Markdown","text":"<ul> <li> <p>We use PlantUML for rendering diagrams in our documentation</p> <ul> <li>For interactive use you can rely on online tools like:<ul> <li>Online editors:<ul> <li>planttext</li> <li>liveuml</li> <li>PlantUML Web Server</li> </ul> </li> <li>PyCharm plugin (create and edit <code>.puml</code> file locally):<ul> <li>PlantUML integration</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>We create <code>README.md</code> and <code>architecture.md</code> markdown files to document     software. <code>README.md</code> is for general content, <code>architecture.md</code> is for code     architecture description. You can embed the diagrams in <code>architecture.md</code> file     in a correspondent folder.</p> </li> <li> <p>To render PlantUML in our markdown files instead of <code>@startuml</code> you need to     use the tag:     <pre><code>```plantuml\n...\n```\n</code></pre></p> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#our_conventions","title":"Our Conventions","text":"<ul> <li> <p>Names</p> <ul> <li> <p>Each name in mappings should be exactly the same (maybe without some invalid     chars, like <code>.</code>) to not create a cognitive burden to the reader. It's better     to optimize for readability rather than by the number of chars. E.g.,</p> <p><pre><code>[build_configs.py] as build_configs_py\n[TableExtractor] as TableExtractor\n</code></pre>     - We keep components / classes in alphabetical order, so we can find them quickly in the code</p> </li> </ul> </li> <li> <p>Notes</p> <ul> <li> <p>Put notes describing some components / classes inside the blocks they refer     to. E.g.,</p> <p><pre><code>node mapping as map {\n[CIK&lt;-&gt;Ticker] as ctmap\nnote top of ctmap: My useful note.\n[CIK&lt;-&gt;GVKEY] as cgmap\n}\n</code></pre>     - We use conventions for notes as for the code comments: - Start a note with a capital and end with <code>.</code>. In this way, it may be even     easier to visually distinguish notes from arrow labels. - Put notes straight after their related component definition, so a note     will look like a comment in the code</p> </li> </ul> </li> <li> <p>Arcs</p> <ul> <li> <p>The direction of the arcs represents the direction of the action. E.g.,</p> <p><pre><code>apple --&gt; ground : falls to\n</code></pre>     - We use the third person for describing actions</p> </li> </ul> </li> <li> <p>We use comments as headers to organize the <code>architecture.md</code>. Note that the     comments in <code>plantuml</code> are introduced with <code>'</code>. Some frequently used headers     are:</p> <ul> <li><code>' Components</code></li> <li><code>' Databases</code></li> <li><code>' Containers</code></li> <li><code>' Edge labels</code></li> <li><code>' Notes</code></li> </ul> </li> <li> <p>An example of acceptable C4 diagram plantuml snippet:</p> <pre><code>    ' Components\n    component [Edgar API] as Edgar_API\n    note top of Edgar_API : System storing the real-time\\nand historical data from EDGAR.\n    component [Headers dataset] as Headers_dataset\n\n    ' Databases\n    database \"Compustat DB\" as Compustat_DB\n    note top of Compustat_DB : Third-party database\\nwith financial data.\n\n    ' Containers\n    node Form8 as form8 {\n [analyze_results.py] as analyze_results_py\n note left of analyze_results_py: Computes matching statistics.\n [build_configs.py] as build_configs_py\n [edgar_utils.py] as edgar_utils_py\n [run_pipeline.py] as run_pipeline_py\n [TableExtractor]\n note right of TableExtractor: Extracts forms tables.\n [TableNormalizer]\n note right of TableNormalizer: Normalizes extracted tables.\n [TableFilterer]\n note right of TableFilterer: Takes only financial tables\\nfrom normalized tables.\n [TargetMatcher]\n note right of TargetMatcher: Matches financial values in tables.\n    }\n    node mapping as mapping {\n [CIK&lt;-&gt;Ticker] as CIK_Ticker\n [CIK&lt;-&gt;GVKEY] as CIK_GVKEY\n    }\n    node universe as universe{\n [S&amp;P400]\n [S&amp;P500]\n [S&amp;P600]\n [S&amp;P1500]\n    }\n    note left of universe: Universe of companies\\n as Tickers/GVKEYs.\n\n    ' Edge labels\n    Edgar_API --&gt; edgar_utils_py: provides filings payloads to\n    Compustat_DB --&gt; run_pipeline_py: provides target\\nvalues to match on to\n    build_configs_py --&gt; run_pipeline_py: provides pipeline\\nparameters to\n    edgar_utils_py --&gt; TableExtractor: provides universe filings to\n    analyze_results_py --&gt; run_pipeline_py: provides functions\\nto run the matching in to\n    mapping --&gt; edgar_utils_py: provides mapping to construct\\n universe as CIKs to\n    Headers_dataset --&gt; analyze_results_py: provides filing\\ndates to\n    TableExtractor --&gt; TableNormalizer: provides tables to be normalized to\n    TableFilterer --&gt; run_pipeline_py: provides forms\\n values to be matched to\n    TargetMatcher --&gt; analyze_results_py: matches values in\n    TableNormalizer --&gt; TableFilterer: provides tables to be filtered to\n    universe --&gt; mapping: provides universe of companies to\n</code></pre> <p>You can find the correspondent <code>architecture.md</code> file here.</p> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#plotting_online","title":"Plotting Online","text":"<ul> <li>Plantuml on-line</li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#uml_-_unified_modeling_language","title":"UML - Unified Modeling Language","text":"<ul> <li> <p>The Unified Modeling Language (UML) serves as a versatile visual modeling     language designed to offer a standard way to visualize the design of a system</p> </li> <li> <p>UML employs a standardized notation for various diagram types, broadly     categorized into three primary groups:</p> <ul> <li>Structure diagrams: These diagrams depict the static elements within the     system, highlighting essential components necessary in the modeled system.     As they focus on system structure, they are extensively utilized in     documenting software architecture</li> <li>Behavior diagrams: These diagrams portray the dynamic aspects of the     system, emphasizing the actions and processes required within the modeled     system. Given their role in illustrating system behavior, they are     extensively used to describe the functionality of software systems</li> <li>Interaction diagrams: A subset of behavior diagrams, these emphasize the     flow of data and control among the components within the modeled system</li> </ul> <p></p> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#uml_class_diagrams","title":"UML Class Diagrams","text":"<ul> <li>The UML Class Diagram is a graphical notation used to construct and visualize     object-oriented systems</li> <li>A class diagram in the Unified Modeling Language (UML) is a type of static     structure diagram that describes the structure of a system by showing the     system's:<ul> <li>Classes</li> <li>Attributes</li> <li>Methods</li> <li>Relationships among objects</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#class_notation","title":"Class Notation","text":"<ul> <li>A class represents a concept which encapsulates state (attributes) and     behavior (methods)</li> <li>The class name is the only mandatory information</li> <li> <p>The class diagram consists of</p> <ul> <li>Class Name:<ul> <li>The name of the class appears in the first partition</li> <li>The first letter is capitalized</li> </ul> </li> <li>Class Attributes:<ul> <li>Attributes are shown in the second partition</li> <li>The attribute type is shown after the colon</li> <li>The first letter is lowercase</li> <li>Attributes map onto member variables (data members) in code</li> </ul> </li> <li>Class Methods:<ul> <li>Methods are shown in the third partition. They are services the class     provides</li> <li>The return type of a method is shown after the colon at the end of the     method signature</li> <li>The return type of method parameters are shown after the colon following     the parameter name</li> <li>The first letter is lowercase</li> <li>Methods map onto class methods in code</li> </ul> </li> <li>Class Visibility:<ul> <li>The <code>+, -, #</code> symbols before an attribute and operation name in a class     denote the visibility of the attribute and operation</li> <li><code>+</code> denotes public attributes or methods</li> <li><code>-</code> denotes private attributes or methods</li> <li><code>#</code> denotes protected attributes or methods</li> </ul> </li> </ul> </li> <li> <p>An example of a Class Diagram is below</p> <pre><code>classDiagram\n\nclass BankAccount{\n    #owner: str\n    +balance: int\n    +deposit(amount: float) bool\n    +withdrawal(amount: float) int\n    -checkBalance(account_number: int) float\n}</code></pre> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#class_relationships","title":"Class Relationships","text":"<ul> <li>Classes can engage in multiple relationships with other classes</li> <li>Relationships in UML class diagrams can be defined in several distinct types</li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#inheritancegeneralization","title":"Inheritance/Generalization","text":"<ul> <li>It indicates that:<ul> <li>One of the two related classes (the subclass) is considered to be a     specialized form of the other (the superclass) and</li> <li>The superclass is considered a generalization of the subclass</li> </ul> </li> <li>Each instance of the subclass is also an indirect instance of the superclass</li> <li>Represents an \"is-a\" relationship</li> <li> <p>An abstract class name is shown in italics</p> </li> <li> <p>Example: in the given diagram, class <code>Animal</code> is the superclass and class     <code>Duck</code> and <code>Fish</code> are its subclass</p> <pre><code>classDiagram\n\nAnimal &lt;|-- Duck\nAnimal &lt;|-- Fish\nAnimal : +int age\nAnimal: +isMammal()\nclass Duck{\n    +String beakColor\n    +swim()\n}\nclass Fish{\n    -int sizeInFeet\n    -canEat()\n}</code></pre> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#association","title":"Association","text":"<ul> <li>Associations are relationships between classes in a UML Class Diagram</li> <li>They are represented by a solid line between classes</li> <li> <p>Simple Association</p> <ul> <li>A structural link between two peer classes</li> <li>There is an association between Class1 and Class2</li> </ul> <pre><code>classDiagram\n\nClass1 --&gt; Class2</code></pre> </li> <li> <p>Aggregation</p> <ul> <li>A special type of association which represents a \"part of\" relationship</li> <li>Variant of the \"has-a\" association relationship</li> <li>Many instances (denoted by the diamond) of <code>Duck</code> can be associated with     <code>Pond</code></li> <li><code>Duck</code> is part of <code>Pond</code></li> <li>Objects of <code>Pond</code> and <code>Duck</code> have separate lifetimes</li> <li>In the given e.g., a Pond has zero or more Ducks, and a Duck has at most one     Pond (at a time). Duck can exist separately from a Pond</li> </ul> <pre><code>classDiagram\n\nPond o-- Duck</code></pre> </li> <li> <p>Composition</p> <ul> <li>A special type of aggregation where parts are destroyed when the whole is     destroyed</li> <li>Objects of <code>Class2</code> live and die with <code>Class1</code></li> <li><code>Class2</code> cannot stand by itself</li> <li>In the given e.g., a <code>Car</code> has exactly one <code>Carburetor</code>, and a <code>Carburetor</code></li> <li>Is a part of one <code>Car</code>. <code>Carburetor</code>s cannot exist as separate parts,     detached from a specific <code>Car</code></li> </ul> <pre><code>classDiagram\n\nCar *-- Carburetor</code></pre> </li> <li> <p>Dependency</p> <ul> <li>An object of one class might use an object of another class in the code of a     method. If the object is not stored in any field, then this is modeled as a     dependency relationship</li> <li>Exists between two classes if changes to the definition of one may cause     changes to the other (but not the other way around)</li> <li><code>Class1</code> depends on <code>Class2</code></li> </ul> <pre><code>classDiagram\n\nClass1 ..&gt; Class2</code></pre> </li> <li> <p>Realization</p> <ul> <li>It is a relationship between the blueprint class and the object containing     its respective implementation level details</li> <li>This object is said to realize the blueprint class</li> <li>For e.g., the <code>Owner</code> interface might specify methods for acquiring property     and disposing of property. The <code>Person</code> and <code>Corporation</code> classes need to     implement these methods, possibly in very different ways</li> </ul> <pre><code>classDiagram\n\nclass Owner{\n    &lt;&lt;interface&gt;&gt;\n    +accquire(property: str) bool\n    +dispose(property: str) bool\n}\n\nclass Person{\n    -real\n    -tangible\n    +accquire(property: str) bool\n    +dispose(property: str) bool\n}\n\nclass Corporation{\n    -current\n    -fixed\n    -longterm\n    +accquire(property: str) bool\n    +dispose(property: str) bool\n}\n\nPerson ..|&gt; Owner\nCorporation ..|&gt; Owner</code></pre> </li> </ul>"},{"location":"documentation_meta/all.architecture_diagrams.explanation.html#complete_example","title":"Complete Example","text":"<pre><code>\nclassDiagram\n        class Animal {\n                - String name\n                - int age\n                + Animal(name: String, age: int)\n                + setName(name: String): void\n                + setAge(age: int): void\n                + getName(): String\n                + getAge(): int\n                + makeSound(): void\n        }\n\n        class Dog {\n                - String breed\n                + Dog(name: String, age: int, breed: String)\n                + setBreed(breed: String): void\n                + getBreed(): String\n                + makeSound(): void\n        }\n\n        class Cat {\n                - boolean isLazy\n                + Cat(name: String, age: int, isLazy: boolean)\n                + setIsLazy(isLazy: boolean): void\n                + getIsLazy(): boolean\n                + makeSound(): void\n        }\n\n        class Car {\n                - String manufacturer\n                - String model\n                + Car(manufacturer: String, model: String)\n                + setManufacturer(manufacturer: String): void\n                + setModel(model: String): void\n                + getManufacturer(): String\n                + getModel(): String\n                + startEngine(): void\n        }\n\n        class Person {\n                - String name\n                - int age\n                - List&lt;Car&gt; ownedCars\n                + Person(name: String, age: int)\n                + setName(name: String): void\n                + setAge(age: int): void\n                + getName(): String\n                + getAge(): int\n                + addCar(car: Car): void\n                + removeCar(car: Car): void\n                + getOwnedCars(): List&lt;Car&gt;\n        }\n\n        Animal &lt;|-- Dog\n        Animal &lt;|-- Cat\n        Person \"1\" *-- \"*\" Car : owns\n\n        class SoundMaker {\n                &lt;&lt;interface&gt;&gt;\n                + makeSound(): void\n        }\n\n        SoundMaker &lt;|-- Animal\n        SoundMaker &lt;|-- Dog\n        SoundMaker &lt;|-- Cat\n\n        class Zoo {\n                - List&lt;Animal&gt; animals\n                + Zoo()\n                + addAnimal(animal: Animal): void\n                + removeAnimal(animal: Animal): void\n                + getAnimals(): List&lt;Animal&gt;\n        }\n\n        Zoo \"1\" *-- \"*\" Animal : contains</code></pre>"},{"location":"documentation_meta/all.diataxis.explanation.html","title":"All.diataxis.explanation","text":""},{"location":"documentation_meta/all.diataxis.explanation.html#diataxis","title":"Diataxis","text":""},{"location":"documentation_meta/all.diataxis.explanation.html#diataxis_a_framework_to_write_documentation","title":"Diataxis: a Framework to Write Documentation","text":"<p>For more information look https://diataxis.fr/</p> <p>There are 4 modes of documentation</p> <ul> <li>Tutorial</li> <li>How-to guide</li> <li>Reference</li> <li>Explanation</li> </ul> <p></p>"},{"location":"documentation_meta/all.diataxis.explanation.html#tutorial","title":"Tutorial","text":"<ul> <li>Learning oriented</li> <li>Is a playground for users to learn something about the product by completing a     set of steps and achieving a meaningful result</li> <li>Helps the user/client achieve more understanding of the product</li> <li>Assumes the user does not have prior knowledge of the features used in the     tutorial</li> <li>Food analogy: teaching a child how to cook starting from cutting carrots,     celery, and onions for lasagna \"battuto\"</li> <li>File suffix: <code>.tutorial.md</code></li> <li>Example:     datapull/ck.create_airflow_dag.tutorial.md</li> </ul>"},{"location":"documentation_meta/all.diataxis.explanation.html#how-to_guide","title":"How-To Guide","text":"<ul> <li>Goal oriented</li> <li>Is a guide to complete a real-world task</li> <li>Assumes the user has some knowledge about the background of used technology</li> <li>Food analogy: a recipe for cooking lasagna</li> <li>File suffix: <code>.how_to_guide.md</code></li> <li>Example:     work_tools/all.pycharm.how_to_guide.md</li> </ul>"},{"location":"documentation_meta/all.diataxis.explanation.html#reference","title":"Reference","text":"<ul> <li>Information oriented</li> <li>Provide a technical description of a component/piece of infra. The emphasis is     on completeness and accuracy</li> <li>Is difficult to keep everything up to date, so mostly rely on code and     docstring</li> <li>Food analogy: a reference encyclopaedia article about ingredients used in     lasagna (e.g., tomatoes, basil)</li> <li>File suffix: <code>.reference.md</code></li> <li>Example:     datapull/ck.ccxt_exchange_timestamp_interpretation.reference.md</li> </ul>"},{"location":"documentation_meta/all.diataxis.explanation.html#explanation","title":"Explanation","text":"<ul> <li>Understanding oriented</li> <li>Is used in our documentation to explain design decisions and choices,     architecture of components, how components interacted<ul> <li>E.g., high level broker explanation (what kind of behavior the broker class     encapsulates)</li> </ul> </li> <li>Does not provide specifications or instruction</li> <li>Food analogy: an article on culinary social history</li> <li>File suffix: <code>.explanation.md</code></li> <li>Example:     documentation_meta/all.architecture_diagrams.explanation.md</li> </ul>"},{"location":"documentation_meta/all.gdocs.how_to_guide.html","title":"All.gdocs.how to guide","text":""},{"location":"documentation_meta/all.gdocs.how_to_guide.html#gdoc_-_markdown_conversion","title":"Gdoc &lt;-&gt; Markdown Conversion","text":""},{"location":"documentation_meta/all.gdocs.how_to_guide.html#converting_gdocs_to_markdown","title":"Converting Gdocs to Markdown","text":"<ul> <li>Use bullet lists to organize the whole Markdown for consistency with other     docs. See     all.coding_style.how_to_guide.md     or any other published Markdown format as reference</li> <li>Add missing \"```\" around code blocks. These could be missing in the original     Google doc. Also adjust code block indentations if needed</li> <li> <p>The generated markdown may convert http links as <code>html</code> <code>&lt;span&gt;</code> objects. This     hinders the readability of the <code>md</code> file. In this case, manually convert to a     standard <code>http://</code> link: -     <code>[&lt;span class=\"underline\"&gt;https://www.sorrentum.org/&lt;/span&gt;](https://www.sorrentum.org/)</code>     -&gt; <code>https://www.sorrentum.org/</code></p> </li> <li> <p>Remove empty lines manually</p> <pre><code>:'&lt;,'&gt;! perl -ne 'print if /\\S/'\n</code></pre> </li> <li> <p>Run Linter</p> <ul> <li>Usage:     <pre><code>&gt; i lint --files=\"docs/documentation_meta/all.writing_docs.how_to_guide.md\"\n</code></pre></li> <li>What Linter will do:<ul> <li>Build TOC automatically</li> <li>Adjust the indentation to improve the Markdown's format (but the     precondition is that you have properly adjusted the indentation levels).</li> <li>Remove extra empty lines under headings.</li> <li>Adjust text layout.</li> </ul> </li> <li>Do not mix manual edits and Linter runs</li> <li>If Linter messes up the text<ul> <li>File bugs in <code>helpers</code> with examples what Linter does incorrectly</li> </ul> </li> </ul> </li> <li>Last steps<ul> <li>Compare the generated markdown file with the original Gdoc from top to     bottom to ensure accurate rendering.</li> <li>Review the markdown file on GitHub to make sure it looks good, as it may     slightly differ from the preview in your local markdown editor</li> </ul> </li> <li>When a gdoc becomes obsolete, delete it</li> </ul>"},{"location":"documentation_meta/all.gdocs.how_to_guide.html#other_approaches","title":"Other Approaches","text":"<ul> <li>Best for a large document</li> <li>Approach 1 - Chrome Docs to Markdown extension:<ul> <li>Use the Docs to Markdown     extension<ul> <li>Install     the extension     from the G Suite marketplace</li> <li>User guide     for the extension</li> </ul> </li> <li>One needs to accept/reject all suggestions in a gdoc as the extension works     poorly when a document is edited in the suggestion mode</li> </ul> </li> <li> <p>Approach 2 - Online converter:</p> <ul> <li>Google-docs-to-markdown/</li> </ul> </li> <li> <p>Also need to go through     Cleaning up converted markdown</p> </li> <li>You might need to remove artifacts manually</li> </ul>"},{"location":"documentation_meta/all.gdocs.how_to_guide.html#converting_markdown_to_gdoc","title":"Converting Markdown to Gdoc","text":"<ul> <li>Approach 1:<ul> <li>Run     <pre><code>&gt; pandoc MyFile.md -f markdown -t odt -s -o MyFile.odt\n</code></pre></li> <li>Download the     template     in odt format</li> <li>Run     <pre><code>&gt; pandoc code_organization.md -f markdown -t odt -s -o code_org.odt --reference-doc /Users/saggese/Downloads/Gdoc\\ -\\ Template.odt\n</code></pre></li> <li>Open it with TextEdit, copy-paste to Gdoc</li> </ul> </li> <li>Approach 2:<ul> <li>Instead of copy-paste the markdown into Gdocs, you can copy the rendered     markdown in a Gdoc<ul> <li>Gdocs does a good job of maintaining the formatting, levels of the     headers, the links, and so on</li> </ul> </li> </ul> </li> <li>Approach 3:<ul> <li>https://markdownlivepreview.com/</li> <li>TODO(gp): Check if the roundtrip works</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html","title":"All.google technical writing.how to guide","text":""},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#google_technical_writing","title":"Google Technical Writing","text":"<p>// From https://developers.google.com/tech-writing/one/</p>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#googles_technical_writing_part_1","title":"Google'S Technical Writing: Part 1","text":""},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#define_new_or_unfamiliar","title":"Define New or Unfamiliar","text":"<ul> <li>If your document introduces a term, define the term</li> <li>If the term already exists, link to a good existing explanation</li> </ul>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#use_terms_consistently","title":"Use Terms Consistently","text":"<ul> <li>Don't change the name of something while talking about it<ul> <li>E.g., <code>Protocol Buffers</code> vs <code>protobufs</code></li> </ul> </li> <li>You can do something like:     <pre><code>Protocol Buffers (or protobufs for short)\n</code></pre></li> </ul>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#use_acronyms_properly","title":"Use Acronyms Properly","text":"<ul> <li>On the initial use of an unfamiliar acronym spell out the full term</li> <li>E.g., <code>Telekinetic Tactile Network (TTN) ...</code></li> <li>Acronyms take attention to be expanded in their full form</li> <li>Sometimes acronyms develop their own identity (e.g., HTML)</li> <li>An acronym should be significantly shorter than the full term</li> <li>Don't define acronyms that will be used only a few times</li> </ul>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#use_strong_verbs","title":"Use Strong Verbs","text":"<ul> <li>Choose precise, strong, and specific verbs<ul> <li>Weak verbs are \"be\", \"occur\", \"happen\"</li> </ul> </li> </ul> <p>Good <pre><code>Dividing by zero raises the exception.\n</code></pre></p> <p>Bad <pre><code>The exception occurs when dividing by zero.\n</code></pre></p>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#use_short_sentences","title":"Use Short Sentences","text":"<ul> <li>Each sentence should convey a single idea, thought, concept<ul> <li>Break long sentences into single-idea sentences</li> </ul> </li> <li>Convert long sentences into bulleted list<ul> <li>E.g., \"and\", \"or\" suggest to refactor into a bulleted list</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#remove_fillers","title":"Remove Fillers","text":"<p>Good <pre><code>This design document describes Project Frambus.\n</code></pre></p> <p>Bad <pre><code>This design document provides a detailed description of Project Frambus.\n</code></pre></p>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#focus_each_paragraph_on_a_single_topic","title":"Focus Each Paragraph on a Single Topic","text":"<ul> <li>A paragraph is an independent unit of logic</li> <li>Ruthlessly delete sentence that doesn't relate to the current topic</li> </ul>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#avoid_wall-of-text","title":"Avoid Wall-Of-Text","text":"<ul> <li>Readers often ignore long paragraphs</li> <li>Paragraphs should contain 3 to 5 sentences</li> </ul>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#answer_what_why_and_how","title":"Answer What, Why, and How","text":"<ul> <li> <p>Good paragraphs answer the following questions</p> <ul> <li>What: what are you trying to tell your reader?</li> <li>Why: why is it important for the reader to know this?</li> <li>How: how should the reader use this knowledge</li> </ul> </li> <li> <p>E.g.,</p> <ul> <li>[What]: The <code>garp()</code> function returns the delta between a dataset's mean and     median.</li> <li>[Why]: Many people believe unquestioningly that a mean always holds the     truth. However, a mean is easily influenced by a few very large or very     small data points.</li> <li>[How]: Call <code>garp()</code> to help determine whether a few very large or very     small data points are influencing the mean too much. A relatively small     <code>garp()</code> value suggests that the mean is more meaningful than when the     <code>garp()</code> value is relatively high.</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#know_your_audience","title":"Know Your Audience","text":"<ul> <li>Your document needs to provide information that your audience needs but     doesn't already have<ul> <li>Define your audience<ul> <li>E.g., software engineers vs program managers</li> <li>E.g., graduate students vs first-year undergraduate students</li> </ul> </li> <li>Determine what your audience needs to learn<ul> <li>E.g.,     <pre><code>After reading the documentation, the audience will know how to do the\nfollowing tasks\n- Use ...\n- Do ...\n...\n</code></pre></li> </ul> </li> <li>Fit documentation to your audience<ul> <li>Avoid the \"curse of knowledge\": experts forget that novices don't know     what you already know</li> </ul> </li> </ul> </li> </ul>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#state_documents_scope","title":"State Document'S Scope","text":"<ul> <li>A good document begins by defining its scope and its non-scope, e.g.,     <pre><code>This document describes the design of Project Frambus, but not the related\ntechnology Froobus.\n</code></pre></li> </ul>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#summarize_the_key_points_at_the_start","title":"Summarize the Key Points at the Start","text":"<ul> <li>Ensure that the start of your document answers your readers' essential     questions</li> <li>The first page of a document determines if the readers makes it to page two</li> </ul> <p>// From https://developers.google.com/tech-writing/two</p>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#googles_technical_writing_part_2","title":"Google'S Technical Writing: Part 2","text":""},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#adopt_a_style_guide","title":"Adopt a Style Guide","text":"<ul> <li>Many companies and large open source projects adopt a style guide for     documentation<ul> <li>E.g., https://developers.google.com/style</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#think_like_your_audience","title":"Think Like Your Audience","text":"<ul> <li>Step back and try to read your draft from the point of view of your audience</li> </ul>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#come_back_to_it_later","title":"Come Back to It Later","text":"<ul> <li>After you write your first (or second or third) draft, set it aside</li> <li>Come back later and read it with fresh eyes to find things you can improve</li> </ul>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#organizing_large_docs","title":"Organizing Large Docs","text":"<ul> <li>You can organize a collection of information into<ul> <li>A longer standalone document; or</li> <li>Set of shorter interconnected documents (e.g., website, wiki)<ul> <li>Pros: easy to find information searching in the single back</li> </ul> </li> </ul> </li> </ul> <p>// TODO</p>"},{"location":"documentation_meta/all.google_technical_writing.how_to_guide.html#resources","title":"Resources","text":"<ul> <li>[https://developers.google.com/tech-writing/overview]</li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html","title":"All.markdown tools.explanation","text":""},{"location":"documentation_meta/all.markdown_tools.explanation.html#_1","title":"All.markdown tools.explanation","text":"<ul> <li>We use the following tools for documentation and blogging</li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html#mkdocs","title":"MkDocs","text":"<ul> <li>MkDocs: Static site generator for project     documentation</li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html#jupyter_book","title":"Jupyter Book","text":"<ul> <li>Jupyter Book: Useful for books with code and     notebooks</li> <li>It's based on CommonMark (a Markdown standard) but adds syntax for scientific     and technical publishing</li> <li>It's designed to map closely to reStructuredText (reST) features so that     Markdown can be used in the Sphinx ecosystem</li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html#pandoc","title":"Pandoc","text":"<ul> <li> <p>Pandoc: Combine Markdown into PDF, ePub, or other     formats</p> <ul> <li>Aims for maximum portability: you write in Pandoc Markdown and convert to     HTML, PDF, LaTeX, DOCX, and more</li> <li>Supports multiple dialects: Pandoc Markdown, Markdown Extra, GitHub-Flavored     Markdown (GFM)</li> </ul> </li> <li> <p>https://executablebooks.org/en/latest/gallery </p> </li> <li>https://bvanderlei.github.io/jupyter-guide-to-linear-algebra/intro.html </li> <li>https://github.com/executablebooks/cookiecutter-jupyter-book</li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html#material_for_mkdocs","title":"Material for MkDocs","text":"<ul> <li> <p>Material for MkDocs is a     popular theme and extension for MkDocs, which is a static site generator for     project documentation written in Markdown</p> <ul> <li>MkDocs = turns Markdown files into a static documentation website</li> <li>Material for MkDocs = makes that website look beautiful and adds powerful features.</li> </ul> </li> <li> <p>Inspired by Google's Material Design guidelines, i.e., clean, modern, responsive</p> </li> <li> <p>Lots of color palettes, light/dark modes, and logo customization</p> </li> <li> <p>Advanced navigation:</p> <ul> <li>Auto-generated sidebar and table of contents</li> <li>Breadcrumbs and sticky navigation</li> <li>Tabs, sections, version dropdowns, etc</li> </ul> </li> <li> <p>Markdown extensions:</p> <ul> <li>Syntax highlighting for code blocks</li> <li>Admonitions (!!! note blocks) and callouts</li> <li>Built-in support for math (MathJax), Mermaid diagrams, and more</li> <li>Works great with the MyST plugin, too!</li> </ul> </li> <li> <p>Search:</p> <ul> <li>Instant full-text search across your docs</li> <li>Works offline with lunr.js</li> </ul> </li> <li> <p>Plugins &amp; Integrations:</p> <ul> <li>Works well with MkDocs plugins for blogging, versioning, PDF export, etc</li> <li>Excellent support for custom JS/CSS</li> <li>Good support for GitHub Pages deployment</li> </ul> </li> <li> <p>Great for docs-as-code:         Used by open-source projects, scientific documentation, knowledge bases, internal wikis, and more</p> </li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html#other_tools","title":"Other tools","text":""},{"location":"documentation_meta/all.markdown_tools.explanation.html#mdbooks","title":"mdBooks","text":"<ul> <li>mdBook: Inspired by GitBook,     ideal for technical books.</li> <li>Rust book example </li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html#sphinx","title":"Sphinx","text":"<ul> <li>Purpose<ul> <li>Designed for Python documentation</li> <li>Supports general technical docs</li> </ul> </li> <li>Input Format<ul> <li>Primarily reStructuredText (<code>.rst</code>)</li> <li>Supports Markdown with plugins (<code>myst-parser</code>)</li> </ul> </li> <li>Features<ul> <li>Rich cross-referencing</li> <li>Automatic API docs (<code>autodoc</code>)</li> <li>Extensions for LaTeX, PDF output</li> <li>Theming system (ReadTheDocs theme popular)</li> </ul> </li> <li>Output Formats<ul> <li>HTML</li> <li>PDF (via LaTeX)</li> <li>EPUB</li> </ul> </li> <li>Complexity<ul> <li>Steeper learning curve</li> <li>More configuration options</li> </ul> </li> <li>Ecosystem<ul> <li>Large extension ecosystem</li> <li>Widely used in Python community</li> </ul> </li> </ul> Feature Sphinx MkDocs Input Format reStructuredText, MD Markdown Output Formats HTML, PDF, EPUB HTML Extensions Large ecosystem Smaller, plugins available Learning Curve Steeper Easier Theming Custom, RTD theme Material theme popular Best For API docs, Python libs Project websites, wikis"},{"location":"documentation_meta/all.markdown_tools.explanation.html#markdown_dialects","title":"Markdown Dialects","text":"<ul> <li>Markdown: Lightweight markup language for plain-text formatting<ul> <li>Dialects: Variants that extend or tweak core Markdown features</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html#commonmark","title":"CommonMark","text":"<ul> <li>Standardized version of original Markdown</li> <li>Clear spec to reduce inconsistencies</li> <li>Many dialects are based on CommonMark</li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html#github_flavored_markdown_gfm","title":"GitHub Flavored Markdown (GFM)","text":"<ul> <li>Based on CommonMark with extensions for GitHub.<ul> <li>Syntax highlighting for fenced code blocks.</li> <li>Tables:</li> <li>Task Lists:     <pre><code>- [ ] Task\n- [x] Done\n</code></pre></li> <li>Strikethrough: <code>~~text~~</code></li> <li>Autolinks for URLs.</li> </ul> </li> <li>Widely used in README.md, issues, PRs.</li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html#pandoc_markdown","title":"Pandoc Markdown","text":"<ul> <li>Very flexible, used by Pandoc converter</li> <li>Supports multiple extensions:<ul> <li>Footnotes:</li> <li>Citations</li> <li>Tables, definition lists, math.</li> <li>Customizable with <code>+extension</code> flags.</li> </ul> </li> <li> <p>Used for converting Markdown to LaTeX, PDF, HTML, DOCX.</p> </li> <li> <p>It supports many extra features not in standard Markdown: citations, footnotes,     tables, definition lists, math (via LaTeX), fenced code blocks with attributes,     etc.</p> </li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html#myst_markdown","title":"MyST Markdown","text":"<ul> <li>MyST = \"MarkedlY Structured Text\"</li> <li> <p>Extensions:</p> <ul> <li>Directive blocks (like reST) using {% directive %} blocks     <pre><code>```{note}\nThis is a note directive.\n</code></pre>     ```</li> <li>Roles (inline extensions) using {role} syntax     <pre><code>{ref}`section-name`\n</code></pre></li> <li>Better support for equations, citations, figures, and complex structures.</li> <li>Equations: <code>$E=mc^2$</code> or <code>$$...$$</code></li> <li>Citations &amp; bibliography integration</li> <li>YAML metadata and configuration.</li> </ul> </li> <li> <p>Built for scientific/technical docs (Jupyter, Sphinx)</p> </li> <li> <p>Bridges Markdown with reStructuredText features</p> </li> <li> <p>MkDocs doesn't natively support the full MyST spec, but you can add it with     the mkdocs-myst-plugin</p> <ul> <li>TODO</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html#preprocessor_for_markdown_dialects","title":"Preprocessor for Markdown Dialects","text":"<ul> <li>To render Markdown we want to perform some transformations</li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html#lint_for_markdown_dialects","title":"Lint for Markdown dialects","text":""},{"location":"documentation_meta/all.markdown_tools.explanation.html#render_to_pdf","title":"Render to PDF","text":"<ul> <li> <p>How to generate a PDF from jupyterbook and from mkdocs</p> </li> <li> <p>Render mkdocs as PDFs</p> <ul> <li>Plug-in mkdocs-with-pdf</li> </ul> </li> <li> <p>Use pandoc</p> </li> </ul>"},{"location":"documentation_meta/all.markdown_tools.explanation.html#how_to_do_a_blog_with_mkdocs","title":"How to do a blog with mkdocs","text":""},{"location":"documentation_meta/all.plotting_in_latex.how_to_guide.html","title":"All.plotting in latex.how to guide","text":"<p>For plotting a certain classes of drawings (e.g., diagrams, graph) one should use frameworks like dot, mermaid, plantuml</p> <p>For technical drawing there are several solutions, as described below</p>"},{"location":"documentation_meta/all.plotting_in_latex.how_to_guide.html#tikz","title":"Tikz","text":"<ul> <li>Language for producing vector graphics from a textual description</li> <li> <p>Several drawing programs can export figures as Tikz format (e.g., Inkspace,     matplotlib, gnuplot)</p> </li> <li> <p>Refs</p> <ul> <li>Https://en.wikipedia.org/wiki/PGF/TikZ</li> <li>Https://tikz.net/</li> <li>Https://tikz.org/</li> <li>Examples<ul> <li>Https://tikz.dev/</li> <li>Https://texample.net/tikz/examples/</li> <li>Https://tex.stackexchange.com/questions/175969/block-diagrams-using-tikz</li> </ul> </li> <li>Web application<ul> <li>Https://tikzmaker.com/editor</li> </ul> </li> <li>Local editor<ul> <li>Https://tikzit.github.io/</li> </ul> </li> <li>Misc<ul> <li>Https://tex.stackexchange.com/?tags=tikz-pgf</li> </ul> </li> </ul> </li> </ul>"},{"location":"documentation_meta/all.plotting_in_latex.how_to_guide.html#pgfplots","title":"Pgfplots","text":"<ul> <li>Plots functions directly in Tex/Latex</li> <li> <p>Based on TikZ</p> </li> <li> <p>Refs</p> <ul> <li>Https://ctan.math.washington.edu/tex-archive/graphics/pgf/contrib/pgfplots/doc/pgfplots.pdf</li> <li>Https://www.overleaf.com/learn/latex/Pgfplots_package</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.plotting_in_latex.how_to_guide.html#asymptote","title":"Asymptote","text":"<ul> <li>A descriptive vector graphics language</li> <li>Provide a coordinate-based framework for technical drawing</li> <li> <p>It has a Python frontend</p> </li> <li> <p>Refs</p> <ul> <li>Https://en.wikipedia.org/wiki/Asymptote_(vector_graphics_language)</li> <li>Https://asymptote.sourceforge.io/</li> <li>Gallery<ul> <li>Https://asymptote.sourceforge.io/gallery/</li> </ul> </li> <li>Asymptote web application<ul> <li>Http://asymptote.ualberta.ca/</li> </ul> </li> </ul> </li> </ul>"},{"location":"documentation_meta/all.plotting_in_latex.how_to_guide.html#plotting_in_markdown","title":"Plotting in Markdown","text":""},{"location":"documentation_meta/all.plotting_in_latex.how_to_guide.html#how_to_draw_in_markdown","title":"How to Draw in Markdown","text":"<p>We would like to use the same plots for both Latex and Markdown documents</p> <p>We can use pandoc</p> <p>TODO(gp): Consider extending ./dev_scripts_helpers/documentation/render_images.py to render also complex Latex, tikz</p> <p>https://tex.stackexchange.com/questions/586285/pandoc-markdown-drawing-circuit-diagrams-using-circuitikz</p>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html","title":"All.writing docs.how to guide","text":""},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#writing_docs","title":"Writing Docs","text":""},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#summary","title":"Summary","text":"<ul> <li> <p>This document describes how to write markdown for:</p> <ul> <li>Internal documentation</li> <li>Blog entries</li> <li>Tutorials</li> </ul> </li> <li> <p>This document is geared towards humans, while the style guide      [<code>//helpers/docs/code_guidelines/all.coding_style_guidelines.reference.md</code>]     is for non-human users (e.g., <code>linter</code> and <code>ai_review.py</code>)</p> </li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#meta","title":"Meta","text":"<ul> <li>Each of the suggestions below should be a level 3 heading so that it's easy to     point to it with a link</li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#conventions","title":"Conventions","text":""},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#layout_rules","title":"Layout Rules","text":"<ul> <li> <p>Visual Structure</p> <ul> <li>Use clear headings</li> <li>Use nested bullets for hierarchy<ul> <li>1 idea per bullet</li> </ul> </li> <li>Separate sections logically</li> </ul> </li> <li> <p>Clarity</p> <ul> <li>Use simple language</li> <li>Define terms immediately</li> <li>Avoid ambiguous phrasing</li> </ul> </li> <li> <p>Headings</p> <ul> <li>Use <code>#</code> for main topics</li> <li>Use <code>##</code> for subtopics</li> <li>Keep headings short and descriptive</li> </ul> </li> <li> <p>Bullets</p> <ul> <li><code>-</code> for main bullets</li> <li>Indent for sub-bullets</li> <li>Each bullet = 1 idea</li> </ul> </li> <li> <p>Diagrams</p> <ul> <li>Use diagrams instead of wordy explanations</li> <li>Use <code>mermaid</code>, <code>graphviz</code>, or <code>tikz</code> fenced code blocks</li> <li>Prefer flowcharts, sequence diagrams, or graphs</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#make_no_assumptions_on_the_users_knowledge","title":"Make no assumptions on the user's knowledge","text":"<ul> <li>Nothing is obvious to somebody who doesn't know</li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#hold_users_hand","title":"Hold user's hand","text":"<ul> <li>Add ways to verify if a described process worked<ul> <li>E.g., \"do this and that, if this and that is correct should see this\"</li> </ul> </li> <li>Have a trouble-shooting procedure<ul> <li>One approach is to always start from scratch</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#always_use_linter","title":"Always use Linter","text":"<ul> <li> <p>Most cosmetic suggestions are handled by our Linter</p> <ul> <li>Run it after changes</li> <li>Use <code>i lint --files=\"your_file_name\"</code></li> </ul> </li> <li> <p>Avoid mixing manual edits and Linter runs</p> <ul> <li>Run Linter and commit changes separately</li> </ul> </li> <li> <p>Add a table of contents</p> <ul> <li>Markdown doesn't auto-generate TOC</li> <li>Run Linter to build TOC and place it at the top</li> </ul> </li> <li> <p>If Linter errors occur, file an issue with examples</p> </li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#format_of_each_doc","title":"Format of each doc","text":"<ul> <li>There should be only one level 1 header with the title of the document<ul> <li>The title is used by <code>mkdocs</code></li> </ul> </li> <li> <p>There should be a summary with a short summary in bullets of the document</p> </li> <li> <p>Good:     <pre><code># &lt;Title&gt;\n\n## Summary\n- This document contains ...\n\n## Resources\n\n## Last review\n- GP on 2024-04-20\n- Paul on 2024-03-10\n</code></pre></p> </li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#use_80_columns_formatting_for_markdown_files","title":"Use 80 columns formatting for markdown files","text":"<ul> <li>The <code>linter</code> takes care of reflowing the text</li> <li><code>vim</code> has a <code>:gq</code> command to reflow the comments</li> <li>There are plugins for PyCharm and VisualStudio</li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#use_good_vs_bad","title":"Use good vs bad","text":"<ul> <li> <p>Make examples of \"good\" ways of doing something and contrast them with \"bad\"     ways using the following format, e.g.,</p> <pre><code>- Good:\n    ```markdown\n    ...\n    ```\n\n- Bad:\n    ```markdown\n    ...\n    ```\n</code></pre> </li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#use_an_empty_line_after_heading","title":"Use an empty line after heading","text":"<ul> <li> <p>Leave an empty line after a heading to make it more visible, e.g.,</p> <ul> <li> <p>Good <pre><code># Very important title\n- Less important text\n</code></pre></p> </li> <li> <p>Bad <pre><code># Coming through! I've big important things to do!\n- ... and his big important wheels got STUCK!\n</code></pre></p> </li> </ul> </li> <li> <p>Our Linter automatically takes care of this</p> </li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#bullet_lists","title":"Bullet lists","text":"<ul> <li>Use bullet lists since they represent the thought process, force people to     focus on short sentences (instead of rambling wall-of-text), and relation     between sentences</li> <li>E.g.,     <pre><code>- This is thought #1\n    - This is related to thought #1\n- This is thought #2\n    - Well, that was cool!\n    - But this is even better\n</code></pre></li> <li>Use <code>-</code> instead of <code>*</code> or circles</li> <li>Linter automatically enforces this</li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#use_the_right_syntax_highlighting","title":"Use the right syntax highlighting","text":"<ul> <li>When using a block of code use the write syntax highlighting<ul> <li>Code (```python)</li> <li>Dirs (e.g.,<code>/home/users</code>)</li> <li>Command lines (e.g., <code>&gt; git push</code> or <code>docker&gt; pytest</code>)</li> <li>Bash     <pre><code>&gt; git push\n</code></pre></li> <li>Python     <code>python if __name__ == \"__main__\":     predict_the_future()     print(\"done!\")</code></li> <li>Markdown     <pre><code>...\n</code></pre></li> <li>Nothing     <pre><code>....\n</code></pre></li> </ul> </li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#indent_code_style","title":"Indent <code>code</code> style","text":"<ul> <li>GitHub / Pandoc seems to render incorrectly a code block unless it's indented     over the previous line</li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#embed_screenshots_only_when_strictly_necessary","title":"Embed screenshots only when strictly necessary","text":"<ul> <li>Avoid to use screenshots whenever possible and use copy-paste of text with the     right highlighting</li> <li>Sometimes you need to use screenshots (e.g., plots, website interface)</li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#improve_your_written_english","title":"Improve your written English","text":"<ul> <li>Use English spell-checker</li> <li>Type somewhere where you can use several choices:<ul> <li>Grammarly</li> <li>ChatGPT</li> <li>LanguageTool</li> </ul> </li> <li>This is super-useful to improve your English since you see the error and the     correction<ul> <li>Otherwise you will keep making the same mistakes forever</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#make_sure_your_markdown_looks_good","title":"Make sure your markdown looks good","text":"<ul> <li> <p>Compare your markdown with others already published</p> </li> <li> <p>You can:</p> <ul> <li>Check in the code in a branch and use GitHub to render it</li> <li>Use IDEs to edit, which also renders it side-by-side</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#capitalize_headings","title":"Capitalize headings","text":"<ul> <li>Headings titles should be like <code>Data Schema</code> not <code>Data schema</code><ul> <li>This is automatically enforced by the <code>linter</code></li> </ul> </li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#update_the_last_review_tag","title":"Update the <code>Last review</code> tag","text":"<ul> <li>When you read/refresh a file update the last line of the text     <pre><code>## Last review\n    - GP on 2024-04-20\n    - Paul on 2024-03-10\n</code></pre></li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#comment_the_code_structure","title":"Comment the code structure","text":"<ul> <li>When you want to describe and comment the code structure do something like     this     <pre><code>&gt; tree.sh -p data_schema\ndata_schema/\n|-- dataset_schema_versions/\n|   `-- dataset_schema_v3.json\n    Description of the current schema\n|-- test/\n|   |-- __init__.py\n|   `-- test_dataset_schema_utils.py\n|-- __init__.py\n|-- changelog.txt\n    Changelog for dataset schema updates\n|-- dataset_schema_utils.py\n    Utilities to parse schema\n`-- validate_dataset_signature.py*\n    Script to test a schema\n</code></pre></li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#convention_for_file_names","title":"Convention for file names","text":"<ul> <li>Each file name should have a format like     <code>docs/{component}/{audience}.{topic}.{diataxis_tag}.md</code><ul> <li>E.g., <code>docs/documentation_meta/all.diataxis.explanation.md</code></li> </ul> </li> <li>Where<ul> <li><code>component</code> is one of the software components (e.g., <code>datapull</code>, <code>dataflow</code>)</li> <li><code>audience</code> is the target audience (e.g., <code>all</code>, <code>ck</code>)</li> <li><code>topic</code> is the topic of the file</li> <li>The topic of a \"how to guide\" should have a verb-object format<ul> <li>E.g., <code>docs/oms/broker/ck.generate_broker_test_data.how_to_guide.md</code></li> </ul> </li> <li>The topic of a \"reference\" is often just a name<ul> <li>E.g., <code>docs/oms/broker/ck.binance_terms.reference.md</code></li> </ul> </li> </ul> </li> </ul> <p>// From https://opensource.com/article/20/3/documentation</p>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#use_active_voice","title":"Use active voice","text":"<ul> <li>Use active voice most of the time and use passive voice sparingly</li> <li>Active voice is shorter than passive voice</li> <li> <p>Readers convert passive voice to active voice</p> </li> <li> <p>Good: \"You can change these configuration by ...\"</p> </li> <li>Bad: \"These configurations can be changed by ...\"</li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#format_for_easy_reading","title":"Format for easy reading","text":"<ul> <li>Use headings, bullet points, and links to break up information into chunks     instead of long explanatory paragraphs</li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#keep_it_visual","title":"Keep it visual","text":"<ul> <li>Use tables and diagrams, together with text, whenever possible</li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#be_efficient","title":"Be efficient","text":"<ul> <li>Nobody wants to read meandering paragraphs in documentation</li> <li>Engineers want to get technical information as efficiently as possible</li> <li>Do not add \"fluff\"</li> <li>Do not explain things in a repetitive way</li> <li>Focus on how we do, why we do, rather than writing AI-generated essays</li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#do_not_add_redundancy","title":"Do not add redundancy","text":"<ul> <li>Always point to documentation on the web instead of summarizing it</li> <li>If you want to summarize some doc (e.g., so that people don't have to read too     much), add it to a different document instead of mixing with our documentation</li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#resources","title":"Resources","text":"<ul> <li>https://opensource.com/article/20/3/documentation</li> <li>Markdown cheatsheet</li> <li>Google guide to Markdown<ul> <li>TODO(gp): Make sure it's compatible with our Linter</li> </ul> </li> </ul>"},{"location":"documentation_meta/all.writing_docs.how_to_guide.html#last_review","title":"Last review","text":"<ul> <li>GP on 2025-07-15</li> </ul>"},{"location":"general_background/all.common_abbreviations.reference.html","title":"All.common abbreviations.reference","text":""},{"location":"general_background/all.common_abbreviations.reference.html#common_abbreviations","title":"Common abbreviations","text":"<ul> <li>-&gt; room, -&gt; = \"let's go to the conference room\" (typically the one pinned in     the chat)</li> <li>AFAIK = as far as I know</li> <li>AFK, AFTK = away from (the) keyboard</li> <li>BM = Build-meister</li> <li>BRB = be right back</li> <li>CWR = call when ready</li> <li>GH = GitHub</li> <li>IMO = in my opinion</li> <li>KG = knowledge graph</li> <li>KG-OG = KG Original Gangsta</li> <li>KG-fication = The process of turning something in a KG</li> <li>KOTH = King Of The Hill (the best model so far)</li> <li>OOO, OOTO = Out Of The Office</li> <li>PR = Pull Request (we prefer this to MR = merge request)</li> <li>PTAL = please take a look</li> <li>SO = stack overflow</li> <li>Skateboard = getting something working end-to-end even with hacks (as long as     reversible)</li> <li>TBH = to be honest</li> <li>TTYL = talk to you later</li> <li>WFH = working from home</li> <li>WIP = work in progress</li> <li>Windows = the worst OS ever made</li> <li>Np = no problem</li> <li>Sg = sounds good</li> <li>Vim = the best editor ever made</li> </ul>"},{"location":"general_background/all.glossary.reference.html","title":"All.glossary.reference","text":""},{"location":"general_background/all.glossary.reference.html#glossary","title":"Glossary","text":""},{"location":"general_background/all.glossary.reference.html#meta","title":"Meta","text":"<ul> <li>Keep the terms in alphabetical order</li> <li>People can add terms that they are not clear and others can add definitions</li> <li>Always use \"suggestion\" mode for adding new terms or new definitions</li> </ul>"},{"location":"general_background/all.glossary.reference.html#definitions","title":"Definitions","text":"<ul> <li> <p>Asset</p> <ul> <li>A financial instrument with an associated price that changes over time</li> <li>Aka: symbol, name, ticker</li> <li>E.g., bitcoin, ethereum, Apple stock (US equity), orange futures</li> </ul> </li> <li> <p>FM (Financial Instrument)</p> <ul> <li>Financial instruments are monetary contracts between parties</li> </ul> </li> <li> <p>GH (GitHub)</p> </li> <li> <p>HLD (High Level Design)</p> <ul> <li>Is a general system design and includes the description of the System     architecture and design</li> </ul> </li> <li> <p>IM (Instrument Master)</p> <ul> <li>A software component that associates symbolic names to assets and their     prices</li> </ul> </li> <li> <p>Integrator</p> <ul> <li>Someone on the team that is in charge of merging code to the main line of     development</li> <li>Aka: master</li> </ul> </li> <li> <p>OHLCV bar</p> <ul> <li>An open-high-low-close chart (also OHLC) is a type of chart     typically used to illustrate movements in the price of a financial     instrument over time</li> </ul> </li> <li> <p>OMS (Order Management System)</p> <ul> <li>A software component in charge of placing and monitoring trading orders to     market or broker</li> </ul> </li> <li> <p>PR (Pull Request)</p> <ul> <li>Request to merge code in GitHub</li> </ul> </li> <li> <p>RP (Responsible Party)</p> <ul> <li>Someone on the team that helps following our process</li> <li>Aka: tech lead</li> </ul> </li> </ul>"},{"location":"general_background/all.literature_review.reference.html","title":"All.literature review.reference","text":""},{"location":"general_background/all.literature_review.reference.html#literature_review","title":"Literature Review","text":""},{"location":"general_background/all.literature_review.reference.html#meta","title":"Meta","text":"<ul> <li>Year - Title</li> <li>Paper authors:</li> <li>Link to the paper (ideally on gdrive)</li> <li>Review author / date</li> <li>Score in [0, 5], where:<ul> <li>5/5: Must-read</li> <li>4/5: Some interesting ideas we can reuse</li> <li>3/5: Pretty much what one would have done as first experiment</li> <li>2/5: ...</li> <li>1/5: Horrible: same bullet-proof logic as in a politician speech</li> </ul> </li> <li>Summary:<ul> <li>At most 5-10 bullet points explaining what the paper tries to accomplish</li> <li>Describe the data used, setup, model formulation, ...</li> <li>Good references</li> </ul> </li> <li>Praises:<ul> <li>At most 5 bullet points</li> <li>Focus on what is different, interesting, and not on the obvious</li> </ul> </li> <li>Critiques:<ul> <li>At most 5 bullet points</li> <li>Explain what is not solid in the analysis, suggestions on how to improve</li> </ul> </li> <li>Next steps:<ul> <li>What next steps should we take, if any, e.g.,<ul> <li>Read the bibliography</li> <li>Try experiments</li> </ul> </li> </ul> </li> </ul>"},{"location":"general_background/all.literature_review.reference.html#to_cut_and_paste","title":"To cut and paste","text":"<pre><code>### Year - Title\n- Paper authors:\n- [Link]()\n- Review author / date:\n- Score:\n- Summary:\n- Praises:\n- Critiques:\n- Next steps:\n</code></pre>"},{"location":"general_background/all.literature_review.reference.html#news_for_commodity_prediction","title":"News for commodity prediction","text":""},{"location":"general_background/all.literature_review.reference.html#2015_-_the_role_of_news_in_commodity_markets","title":"2015 - The role of news in commodity markets","text":"<ul> <li>Paper authors: Borovkova</li> <li>Link</li> <li>Review author / date: GP, 2019-11-22</li> <li>Score: 4/5</li> <li>Summary:<ul> <li>Dataset: prepackaged Thomson-Reuters sentiment (TRNA)</li> <li>Studies the effect of sentiment on commodities through event studies</li> <li>Forecast prices and volatility</li> </ul> </li> <li>Praises:<ul> <li>Decent statistics about the data set</li> <li>States that one needs to understand if the sentiment is attached to demand     and supply<ul> <li>Not sure if TR actually does that</li> </ul> </li> <li>Confirms our point about \"momentum-related news\" (i.e., news about the fact     that the price is going up)</li> <li>Confirms periodicity we are aware of</li> <li>Interesting local level model to extract the hidden sentiment<ul> <li>Very similar to what we thought to do (including the idea of using Kalman     smoother)</li> </ul> </li> </ul> </li> <li>Critiques:<ul> <li>Nothing really</li> </ul> </li> <li>Next steps:<ul> <li>Understand if TR considers sentiment distinguishing supply or demand<ul> <li>We should do this (not sure how PR does that)</li> </ul> </li> <li>Remove carefully momentum-related news</li> <li>Remove or count carefully repeated news (maybe use a measure of similarity     between articles)</li> <li>How to deliver \"event study\" models to customers? Should we \"unroll the     model\" for them providing a stream of predictions?</li> </ul> </li> </ul>"},{"location":"general_background/all.literature_review.reference.html#social_sentiment","title":"Social sentiment","text":""},{"location":"general_background/all.literature_review.reference.html#2015_predicting_global_economic_activity_with_media_analytics","title":"2015, Predicting global economic activity with media analytics","text":"<ul> <li>Paper authors: Peterson et al.</li> <li>Link: In <code>Tech/papers</code></li> <li>Review author / date: GP, 2019/12/08</li> <li>Score: 2/5</li> <li>Summary:<ul> <li>Predict PMI indices (which are related to the</li> </ul> </li> <li>Praises:<ul> <li>Interesting approach for going beyond polarity in sentiment considering</li> </ul> </li> <li>Critiques:<ul> <li>No seasonal component</li> <li>Usual problems with methodology OOS</li> </ul> </li> <li>Next steps:<ul> <li>Consider the TRMI \"indices\" (optimism, fear, joy, trust, violence)</li> <li>Consider the difference in professional news vs social news sentiment<ul> <li>What does it mean if there are large statistically significant difference?</li> </ul> </li> </ul> </li> </ul>"},{"location":"general_background/all.literature_review.reference.html#2018_-_twitter_investor_sentiment_and_capital_markets_what_do_we_know","title":"2018 - Twitter, Investor Sentiment and Capital Markets, what do we know?","text":"<ul> <li>Paper authors:</li> <li>Review author: GP, 2019-08-21</li> <li>Link:</li> <li>Score: 3 / 5</li> <li>Summary:<ul> <li>Good survey of the literature about social sentiment used for finance</li> <li>Most authors report predictivity of social sentiment for:</li> <li>Different metrics (returns, risk, trading volume)</li> <li>Assets (US stocks, exchange rates, commodities)</li> <li>Events (IPO, earnings)</li> </ul> </li> <li>Next steps:<ul> <li>Read all the bibliography and reproduce some of the results</li> </ul> </li> <li>TODO: Update this to new template</li> </ul>"},{"location":"general_background/all.literature_review.reference.html#time_series","title":"Time series","text":""},{"location":"general_background/all.literature_review.reference.html#on-line_learning_of_linear_dynamical_systems_exponential_forgetting_in_kalman_filters","title":"On-Line Learning of Linear Dynamical Systems: Exponential Forgetting in Kalman Filters","text":"<ul> <li>Paper authors: Mark Kozdoba, Jakub Marecek, Tigran Tchrakian, and Shie Mannor</li> <li>Review author: Paul, 2019-12-02</li> <li>arXiv,     AAAI</li> <li>Score: 4/5</li> <li>Summary:<ul> <li>Interesting insight into how to approximate a non-convex optimization     problem with an approximate convex one</li> <li>Shows that for observable Linear Dynamical Systems with non-degenerate     noise, the dependence of the Kalman filter on the past decays exponentially</li> <li>For this class of systems, predictions may be modeled as autoregressions. In     practice, not many terms are needed for a \"good\" approximation.</li> <li>The algorithm is on-line</li> <li>Comparison to the Kalman filter is formalized with regret bounds</li> <li>IBM / Technion research</li> <li>The setting is one where we are learning the best fixed but unknown     autoregression coefficients (rather than one where we are interested in     truly dynamic updates)<ul> <li>The learning rate decays like \\(1 / \\sqrt{t}\\), and so under some mild     constraints on the time series being modeled, the autoregression     coefficients converge</li> <li>The linear dynamical system setup considered is one where the state     transition matrix and the observation direction are time-independent</li> </ul> </li> </ul> </li> <li>Praises:<ul> <li>References standard big works in the time series literature, like West and     Harrison (1997) and Hamilton (1994)</li> <li>Introduces a relatively simple online technique that competes well with the     more complex Kalman filter</li> </ul> </li> <li>Critiques:<ul> <li>Bounds / constants aren't quantitative</li> </ul> </li> <li>Next steps:<ul> <li>Look at the code accompanying the paper:     https://github.com/jmarecek/OnlineLDS</li> <li>Implement and compare to, e.g., z-scoring (a particularly simple case of     Kalman filtering)</li> <li>If we have a long history, it may be better to perform a single     autoregression over the whole history<ul> <li>This suggests</li> </ul> </li> <li>What if we keep the learning rate fixed over time?<ul> <li>This would effectively allow for \"drifting\" dynamics</li> <li>The proofs of the results of the paper would no longer apply</li> <li>It isn't obvious how the learning rate ought to be chosen</li> </ul> </li> </ul> </li> </ul>"},{"location":"general_background/all.literature_review.reference.html#predictive_state_smoothing_press_scalable_non-parametric_regression_for_high-dimensional_data_with_variable_selection","title":"Predictive State Smoothing (PRESS): Scalable non-parametric regression for high-dimensional data with variable selection","text":"<ul> <li>Paper author: Georg M. Goerg</li> <li>Review author: Paul, 2019-12-03</li> <li>Link</li> <li>Score: 4/5</li> <li>Summary:<ul> <li>A kernel smoother, but unlike traditional ones, it<ul> <li>Allows non-local (with respect to the x-var space) pooling</li> <li>Is scalable (e.g., computationally efficient)</li> </ul> </li> <li>PRESS is a generative, probabilistic model</li> <li>States are interpretable</li> <li>Compatible with deep neural networks (though experiments referenced in the     paper suggest depth doesn't help, e.g., a wide net with one softmax is     enough)</li> <li>Competitive with SVMs, Random Forests, and DNN</li> <li> <p>Predictive state representations are statistically and computationally     &gt; efficient for obtaining optimal forecasts of non-linear dynamical systems     &gt; (Shalizi and Crutchfield, 2001). Examples include time series forecasting     &gt; via epsilon-machines (Shalizi and Shalizi, 2004)...</p> </li> </ul> </li> <li>Praises:<ul> <li>Combines some clever insights</li> <li>References a TensorFlow implementation and suggests that implementing in     various frameworks is straightforward</li> </ul> </li> <li>Critiques:<ul> <li>No pointers to actual implementations</li> <li>Time series applications are referenced in Section 2, but many relevant (to     our work) practical ts-specific points are not developed in the paper</li> </ul> </li> <li>Next steps:<ul> <li>See if someone has already implemented PRESS publicly</li> <li>If no implementation is available, scope out how much work a minimal     pandas-compatible implementation would require</li> </ul> </li> </ul>"},{"location":"general_background/all.literature_review.reference.html#2019_high-dimensional_multivariate_forecasting_with_low-rank_gaussian_copula_processes","title":"2019, High-Dimensional Multivariate Forecasting with Low-Rank Gaussian Copula Processes","text":"<ul> <li>Paper authors: David Salinas, Michael Bohlke-Schneider, Laurent Callot,     Roberto Medico, Jan Gasthaus</li> <li>Review author: Paul, 2019-12-28</li> <li>arXiv</li> <li>Score: 4/5</li> <li>Summary:<ul> <li>Learns covariance structure and model together</li> <li>Handles series with time-varying, high-dimensional covariance structure</li> <li>Simultaneously handles series at different scales (in terms of the range)</li> <li>Uses a non-linear, deterministic state space model with transition dynamics     parametrized using an LSTM-RNN</li> </ul> </li> <li>Praises:<ul> <li>Implemented in GluonTS (https://github.com/awslabs/gluon-ts/pull/497) by one     of the coauthors who works on time series forecasting at AWS</li> <li>Code for the paper at     https://github.com/mbohlkeschneider/gluon-ts/tree/mv_release</li> <li>Good choice of baselines comparisons</li> <li>Demonstrates the importance of data transformations</li> </ul> </li> <li>Next steps:<ul> <li>Use in cases where we have a large number of time series known to have     meaningful correlations</li> </ul> </li> </ul>"},{"location":"general_background/all.literature_review.reference.html#2014_the_topology_of_macro_financial_flow_using_stochastic_flow_diagrams","title":"2014, The topology of macro financial flow using stochastic flow diagrams","text":"<ul> <li>Paper authors: Calkin, De Prado</li> <li>Link</li> <li>Review author / date: GP, 2020-01-17</li> <li>Score: 1 / 5</li> <li>Summary:</li> <li>Praises:<ul> <li>PCA on futures sectors</li> <li>Interesting graphical representation<ul> <li>Width of the arc represents strength of relationship (in terms of \\(R^2\\))</li> <li>Color (green / red) and intensity represent sign and magnitude</li> <li>Lags are delays</li> <li>Geometric topology represents relationships better than tables</li> <li>Connectivity of a vertex represents importance</li> </ul> </li> <li>Agreed that econometrics as it is, is close to a pseudo-science that more     complex techniques are needed than inverting a matrix</li> </ul> </li> <li>Critiques:<ul> <li>Various inflammatory remarks and very little content</li> </ul> </li> <li>Next steps:<ul> <li>None</li> </ul> </li> </ul>"},{"location":"general_background/all.literature_review.reference.html#computer_engineering","title":"Computer engineering","text":""},{"location":"general_background/all.literature_review.reference.html#2015_hidden_technical_debt_in_machine_learning_systems","title":"2015, Hidden technical debt in machine learning systems","text":"<ul> <li>Paper authors: Sculler et al.</li> <li>Link</li> <li>Review author / date: GP, 2020-01-07</li> <li>Score: 4/5</li> <li>Summary:<ul> <li>Many interesting little observations about ML practices and engineering</li> </ul> </li> <li>Praises:<ul> <li>Validates how approach of minimizing technical debt and paying it off the     interest, e.g.,<ul> <li>Treat configuration as code, as we do</li> <li>Design abstraction carefully</li> <li>Routinely clean up the code</li> <li>No distinction in quality between research and production</li> <li>Use a single language for everything</li> <li>Need for committing to the healthy engineering practices</li> </ul> </li> </ul> </li> <li>Critiques:<ul> <li>None</li> </ul> </li> <li>Next steps:<ul> <li>None</li> </ul> </li> </ul>"},{"location":"general_background/all.reading_list.reference.html","title":"All.reading list.reference","text":""},{"location":"general_background/all.reading_list.reference.html#reading_list","title":"Reading List","text":""},{"location":"general_background/all.reading_list.reference.html#reading_list_1","title":"Reading List","text":""},{"location":"general_background/all.reading_list.reference.html#git","title":"Git","text":"<ul> <li>Short tutorial</li> <li>Pro Git book<ul> <li>To achieve mastery</li> </ul> </li> </ul>"},{"location":"general_background/all.reading_list.reference.html#bash_linux","title":"Bash / Linux","text":"<ul> <li>Short tutorial</li> <li>Missing semester of CS</li> </ul>"},{"location":"general_background/all.reading_list.reference.html#coding","title":"Coding","text":"<ul> <li> <p>The Pragmatic Programmer</p> <ul> <li>Aka the Black Book</li> <li>Reading and (really) understanding this is equivalent to accumulate 20 years     of coding</li> <li>It will change your life</li> </ul> </li> <li> <p>The Joel Test</p> <ul> <li>We should probably listen to the guy that started StackOverflow</li> <li>Today the 12 steps are obvious, but in 2000 these simple ideas were     revolutionary</li> <li>And, yes you are correct noticing that Joel is holding the table tennis     racquet incorrectly in the picture</li> </ul> </li> </ul>"},{"location":"general_background/all.reading_list.reference.html#data_analysis","title":"Data analysis","text":"<ul> <li>Python for Data Analysis<ul> <li>Reading is not enough: you should have tried all the examples of the book</li> <li>Remember: whatever you want to do, there is a more effective pandas way to     do it in one line</li> </ul> </li> </ul>"},{"location":"general_background/all.reading_list.reference.html#sre","title":"SRE","text":"<ul> <li>Site Reliability Engineering<ul> <li>\"Members of the SRE team explain how their engagement with the entire     software lifecycle has enabled Google to build, deploy, monitor, and     maintain some of the largest software systems in the world.\"</li> <li>An outstanding reference drawing on a wealth of experience</li> </ul> </li> </ul>"},{"location":"general_background/all.reading_list.reference.html#arbitrage","title":"Arbitrage","text":"<ul> <li>Trading and Arbitrage in Cryptocurrency Markets</li> </ul>"},{"location":"onboarding/all.dev_must_read_checklist.reference.html","title":"All.dev must read checklist.reference","text":""},{"location":"onboarding/all.dev_must_read_checklist.reference.html#must-read_documents_for_a_new_team_member","title":"Must-read documents for a new team member","text":""},{"location":"onboarding/all.dev_must_read_checklist.reference.html#org","title":"Org","text":"<ul> <li>[ ] General rules of collaboration</li> </ul>"},{"location":"onboarding/all.dev_must_read_checklist.reference.html#coding","title":"Coding","text":"<ul> <li>[ ] Coding style guide</li> <li>[ ] How to write unit tests</li> <li>[ ] How to run unit tests</li> <li>[ ] Creating a Jupyter Notebook</li> </ul>"},{"location":"onboarding/all.dev_must_read_checklist.reference.html#submitting_your_code_for_review","title":"Submitting your code for review","text":"<ul> <li>[ ] What to do before opening a PR</li> <li>[ ] Code review process</li> </ul>"},{"location":"onboarding/all.dev_must_read_checklist.reference.html#github","title":"Git(Hub)","text":"<ul> <li>[ ] Git workflows and best practices</li> <li>[ ] GitHub organization</li> </ul>"},{"location":"onboarding/all.dev_must_read_checklist.reference.html#buildmeister_duties","title":"Buildmeister duties","text":"<ul> <li>[ ] Buildmeister Guide</li> </ul>"},{"location":"onboarding/all.dev_must_read_checklist.reference.html#writing_docs","title":"Writing docs","text":"<ul> <li>[ ] Tips for writing documentation</li> </ul>"},{"location":"onboarding/all.dev_must_read_checklist.reference.html#beyond_the_must-read","title":"Beyond the must-read","text":"<ul> <li>There are many, many more docs in our knowledge base than the ones listed     above</li> <li>Feel free to browse and read them at your leisure</li> <li>If you have a question, first try to find the answer in one of the docs<ul> <li>You can, for example, <code>grep</code> for relevant keywords</li> </ul> </li> <li>If the answer is not in the docs, reach out to your team leader, and, if it is     deemed useful for other (future) team members, file a PR to update the docs</li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html","title":"All.development.how to guide","text":""},{"location":"onboarding/all.development.how_to_guide.html#development","title":"Development","text":""},{"location":"onboarding/all.development.how_to_guide.html#setting_up_git_credentials","title":"Setting up Git credentials","text":""},{"location":"onboarding/all.development.how_to_guide.html#preamble","title":"Preamble","text":"<ul> <li>Git allows setting credentials at different \"levels\":<ul> <li>System (set for all the users in <code>/etc/git</code>)</li> <li>Global (set for a single user in <code>$HOME/.gitconfig</code> or     <code>$HOME/.config/git/config</code>)</li> <li>Local (set on a per client basis in <code>.git/config</code> in the repo root)</li> <li>Git uses a hierarchical config approach in which settings of a broader scope     are inherited if not overridden.</li> </ul> </li> <li>Refs:<ul> <li>How to customize Git:     https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration</li> <li>Details on <code>git config</code>: https://git-scm.com/docs/git-config</li> </ul> </li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#check_git_credentials","title":"Check Git credentials","text":"<ul> <li>You can check the Git credentials that will be used to commit in a client by     running:     <pre><code>&gt; git config -l | grep user\nuser.name=saggese\nuser.email=saggese@gmail.com\ngithub.user=gpsaggese\n</code></pre></li> <li>To know at which level each variable is defined, run     <pre><code>&gt; git config --show-origin user.name\nfile:/Users/saggese/.gitconfig saggese\n</code></pre></li> <li>You can see all the <code>Authors</code> in a Git repo history with:     <pre><code>&gt; git log | grep -i Author | sort | uniq\n...\n</code></pre></li> <li> <p>Git doesn't do any validation of <code>user.name</code> and <code>user.email</code> but it just uses     these values to compose a commit message like:</p> <pre><code>&gt; git log -2\ncommit 31052d05c226b1c9834d954e0c3d5586ed35f41e (HEAD -&gt;\nAmpTask1290_Avoid_committing_to_master_by_mistake)\nAuthor: saggese &lt;saggese@gmail.com&gt;\nDate: Mon Jun 21 16:22:25 2021\n\nUpdate hooks\n</code></pre> </li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#setting_git_credentials","title":"Setting Git credentials","text":"<ul> <li>To keep things simple and avoid variability, our convention is to use:<ul> <li>As <code>user.name</code> our Linux user name on the local computer we are using to     commit which is returned by <code>whoami</code> (e.g., <code>user.name=saggese</code>)</li> <li>As <code>user.email</code> the email that corresponds to that user (e.g,.     <code>user.email=saggese@gmail.com</code>)</li> </ul> </li> <li>To accomplish the set-up above you can:<ul> <li>Use in <code>/Users/saggese/.gitconfig</code> the values for our open-source account,     so that they are used by default <pre><code>&gt; git config --global user.name $(whoami)\n&gt; git config --global user.email YOUR_EMAIL\n</code></pre></li> </ul> </li> <li>Use the correct user / email in the repos that are not open-source     <pre><code>&gt; cd $GIT_ROOT\n&gt; git config --local user.name $(whoami)\n&gt; git config --local user.email YOUR_EMAIL\n</code></pre></li> <li>Note that you need to set these local values on each Git client that you have     cloned, since Git doesn't version control these values</li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#enforcing_git_credentials","title":"Enforcing Git credentials","text":"<ul> <li>We use Git hooks to enforce that certain emails are used for certain repos     (e.g., we should commit to our open-source repos only using our personal     non-corporate email).</li> <li>You need to install the hooks in each Git client that you use. Conceptually     this step is part of <code>git clone</code>: every time you clone a repo locally you need     to set the hooks.</li> <li> <p>TODO(gp): We could create a script to automate cloning a repo and setting it     up.</p> <pre><code>&gt; cd //amp\n&gt; ./dev_scripts/git/git_hooks/install_hooks.py --action install\n&gt; cd //lem\n&gt; ./amp/dev_scripts/git/git_hooks/install_hooks.py --action install\n</code></pre> </li> <li> <p>This procedure creates some links from <code>.git/hook</code> to the scripts in the repo.</p> </li> <li>You can also use the action <code>status</code> to see the status and <code>remove</code> to the     hooks.</li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#create_the_thin_env","title":"Create the thin env","text":"<ul> <li> <p>You can follow the</p> <pre><code># Build the client env.\n&gt; dev_scripts/client_setup/build.sh 2&gt;&amp;1 | tee tmp.build.log\n&gt; source dev_scripts/setenv_amp.sh\n</code></pre> </li> <li> <p>The installation is successful if you see at the end of the output</p> <pre><code>...\n# Installation\n# Configure your client with:\n&gt; source dev_scripts/setenv_amp.sh\n</code></pre> </li> <li> <p>To configure each shell, you should run:     <pre><code>&gt; source dev_scripts/setenv_amp.sh\n</code></pre>     which should output     <pre><code>...\nalias w='which'\n# Enable invoke autocompletion.\n==&gt; SUCCESS &lt;==\n</code></pre></p> </li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#publish_a_notebook","title":"Publish a notebook","text":"<ul> <li><code>publish_notebook.py</code> is a little tool that allows to:<ol> <li>Opening a notebook in your browser (useful for read-only mode)</li> <li>E.g., without having to use Jupyter notebook (which modifies the file in    your client) or github preview (which is slow or fails when the notebook    is too large)</li> <li>Sharing a notebook with others in a simple way</li> <li>Pointing to detailed documentation in your analysis Google docs</li> <li>Reviewing someone's notebook</li> <li>Comparing multiple notebooks against each other in different browser  windows</li> <li>Taking a snapshot / checkpoint of a notebook as a backup or before making  changes</li> <li>This is a lightweight alternative to \"unit testing\" to capture the    desired behavior of a notebook</li> <li>One can take a snapshot and visually compare multiple notebooks    side-by-side for changes</li> </ol> </li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#detailed_instructions","title":"Detailed instructions","text":"<ul> <li> <p>You can get details by running:</p> <pre><code>&gt; dev_scripts/notebooks/publish_notebook.py -h\n</code></pre> </li> <li> <p>Plug-in for Chrome     my-s3-browser</p> </li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#publish_notebooks","title":"Publish notebooks","text":"<ul> <li> <p>Make sure that your environment is set up properly</p> <pre><code>&gt; more ~/.aws/credentials\n[ck]\naws_access_key_id=**\naws_secret_access_key=**\n\n&gt; printenv | grep CK_\nCSFY_AWS_PROFILE=ck\n</code></pre> </li> <li> <p>If you don't have them, you need to re-run <code>source dev_scripts/setenv.sh</code> in     all the shells. It might be easier to kill that tmux session and restart it</p> <pre><code>&gt; tmux kill-session --t limeXYZ\n\n&gt; ~/go_lem.sh XYZ\n</code></pre> </li> <li> <p>Inside or outside a Docker bash run</p> <pre><code>&gt; publish_notebook.py --file http://127.0.0.1:2908/notebooks/notebooks/Task40_Optimizer.ipynb --action publish_on_s3\n</code></pre> </li> <li> <p>The file is copied to S3</p> <pre><code>Copying './Task40_Optimizer.20210717_010806.html' to\n's3://alphamatic-data/notebooks/Task40_Optimizer.20210717_010806.html'\n</code></pre> </li> <li> <p>You can also save the data locally:</p> <pre><code>&gt; publish_notebook.py --file\namp/oms/notebooks/Master_forecast_processor_reader.ipynb --action publish_on_s3\n--aws_profile saml-spm-sasm\n</code></pre> </li> <li> <p>You can also use a different path or profile by specifying it directly</p> <pre><code>&gt; publish_notebook.py \\\n--file http://127.0.0.1:2908/notebooks/notebooks/Task40_Optimizer.ipynb \\\n--action publish_on_s3 \\\n--s3_path s3://alphamatic-data/notebooks \\\n--aws_profile am\n</code></pre> </li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#open_a_published_notebook","title":"Open a published notebook","text":""},{"location":"onboarding/all.development.how_to_guide.html#start_a_server","title":"Start a server","text":"<ul> <li> <p><code>(cd /local/home/share/html/published_notebooks; python3 -m http.server 8000)</code></p> </li> <li> <p>Go to the page in the local browser</p> </li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#using_the_dev_box","title":"Using the dev box","text":"<ul> <li> <p>To open a notebook saved on S3, *outside* a Docker container run:</p> <pre><code>&gt; publish_notebook.py --action open --file\ns3://alphamatic-data/notebooks/Task40_Optimizer.20210717_010806.html\n</code></pre> </li> <li> <p>This opens a Chrome window through X-windows.</p> </li> <li> <p>To open files faster you can open a Chrome window in background with</p> <pre><code>&gt; google-chrome\n</code></pre> </li> <li> <p>And then navigate to the path (e.g.,     <code>/local/home/share/html/published_notebooks/Master_forecast_processor_reader.20220810-112328.html</code>)</p> </li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#using_windows_browser","title":"Using Windows browser","text":"<ul> <li> <p>Another approach is:</p> <pre><code>&gt; aws s3 presign --expires-in 36000\ns3://alphamatic-data/notebooks/Task40_Optimizer.20210716_194400.html | xclip\n</code></pre> </li> <li> <p>Open the link saved in the clipboard in the Windows browser</p> </li> <li>For some reason, Chrome saves the link instead of opening, so you need to     click on the saved link</li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#how_to_create_a_private_fork","title":"How to create a private fork","text":"<ul> <li>Https://stackoverflow.com/questions/10065526/github-how-to-make-a-fork-of-public-repository-private</li> <li> <p>From     https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/duplicating-a-repository</p> <pre><code>&gt; git clone --bare git@github.com:alphamatic/amp.git amp_bare\n\n&gt; git push --mirror https://github.com/cryptomtc/cmamp.git\n</code></pre> </li> <li> <p>It worked only as cryptomtc, but not using my key</p> </li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#integrate_public_to_private_amp_-_cmamp","title":"Integrate public to private: <code>amp</code> -&gt; <code>cmamp</code>","text":""},{"location":"onboarding/all.development.how_to_guide.html#set-up","title":"Set-up","text":"<pre><code>&gt; git remote add public git@github.com:alphamatic/amp\n\n## Go to cmamp\n&gt; cd /data/saggese/src/cmamp1\n&gt; cd /Users/saggese/src/cmamp1\n\n## Add the remote\n## git remote add public https://github.com/exampleuser/public-repo.git\n&gt; git remote add public git@github.com:alphamatic/amp\n\n&gt; git remote -v\norigin https://github.com/cryptomtc/cmamp.git (fetch)\norigin https://github.com/cryptomtc/cmamp.git (push)\npublic git@github.com:alphamatic/amp (fetch)\npublic git@github.com:alphamatic/amp(push)\n</code></pre>"},{"location":"onboarding/all.development.how_to_guide.html#ours_vs_theirs","title":"Ours vs theirs","text":"<ul> <li> <p>From     https://stackoverflow.com/questions/25576415/what-is-the-precise-meaning-of-ours-and-theirs-in-git/25576672</p> </li> <li> <p>When merging:</p> <ul> <li>Ours = branch checked out (git checkout *ours*)</li> <li>Theirs = branch being merged (git merge *theirs*)</li> </ul> </li> <li>When rebasing the role is swapped<ul> <li>Ours = branch being rebased onto (e.g., master)</li> <li>Theirs = branch being rebased (e.g., feature)</li> </ul> </li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#sync_the_repos_after_double_integration","title":"Sync the repos (after double integration)","text":"<pre><code>&gt; git fetch origin; git fetch public\n\n## Pull from both repos\n\n&gt; git pull public master -X ours\n\n## You might want to use `git pull -X theirs` or `ours`\n\n&gt; git pull -X theirs\n\n&gt; git pull public master -s recursive -X ours\n\n## When there is a file added it is better to add\n\n&gt; git diff --name-status --diff-filter=U | awk '{print $2}'\n\nim/ccxt/db/test/test_ccxt_db_utils.py\n\n## Merge branch\n\n&gt; gs\n+ git status\nOn branch AmpTask1786_Integrate_20211128_02 Your branch and 'origin/AmpTask1786_Integrate_20211128_02' have diverged, and have 861 and 489\ndifferent commits each, respectively. (use \"git pull\" to merge the remote branch into yours)\n\nYou are in a sparse checkout with 100% of tracked files present.\n\nnothing to commit, working tree clean\n\n&gt; git pull -X ours\n\n### Make sure it's synced at ToT\n\n&gt; rsync --delete -r /Users/saggese/src/cmamp2/ /Users/saggese/src/cmamp1\n--exclude='.git/'\n\n&gt; diff -r --brief /Users/saggese/src/cmamp1 /Users/saggese/src/cmamp2 | grep -v \\.git\n</code></pre>"},{"location":"onboarding/all.development.how_to_guide.html#updated_sync","title":"Updated sync","text":"<pre><code>&gt; git fetch origin; git fetch public\n</code></pre>"},{"location":"onboarding/all.development.how_to_guide.html#check_that_things_are_fine","title":"Check that things are fine","text":"<pre><code>&gt; git diff origin/master... &gt;patch.txt\n\n&gt; cd /Users/saggese/src/cmamp2\n\n## Create a branch\n\n&gt; git checkout -b Cmamp114_Integrate_amp_cmamp_20210928\n&gt; git apply patch.txt\n\n## Compare branch with references\n\n&gt; dev_scripts/diff_to_vimdiff.py --dir1 /Users/saggese/src/cmamp1/im --dir2\n/Users/saggese/src/cmamp2/im\n\n&gt; diff -r --brief /Users/saggese/src/lemonade3/amp \\~/src/cmamp2 | grep -v \"/im\"\n\n## Creates a merge commit\n&gt; git push origin master\n</code></pre>"},{"location":"onboarding/all.development.how_to_guide.html#integrate_private_to_public_cmamp_-_amp","title":"Integrate private to public: <code>cmamp</code> -&gt; <code>amp</code>","text":"<pre><code>&gt; cd /data/saggese/src/cmamp1\n&gt; tar cvzf patch.tgz $(git diff --name-onlyorigin/master public/master | grep -v repo_config.py)\n\n&gt; cd /Users/saggese/src/amp1 git remote add cmamp\n&gt; git@github.com:cryptomtc/cmamp.git\n\n&gt; GIT_SSH_COMMAND=\"ssh -i \\~/.ssh/cryptomatic/id_rsa.cryptomtc.github\" git fetch\n&gt; git@github.com:cryptomtc/cmamp.git\n\n&gt; git checkout -b Integrate_20210928\n\n&gt; GIT_SSH_COMMAND=\"ssh -i \\~/.ssh/cryptomatic/id_rsa.cryptomtc.github\" git pull\n&gt; cmamp master -X ours\n</code></pre>"},{"location":"onboarding/all.development.how_to_guide.html#squash_commit_of_everything_in_the_branch","title":"Squash commit of everything in the branch","text":"<ul> <li> <p>From     https://stackoverflow.com/questions/25356810/git-how-to-squash-all-commits-on-branch</p> <pre><code>&gt; git checkout yourBranch\n&gt; git reset $(git merge-base master $(git branch\n--show-current))\n&gt; git add -A\n&gt; git commit -m \"Squash\"\n&gt; git push --force\n</code></pre> </li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#double_integration_cmamp_--_amp","title":"Double integration <code>cmamp</code> &lt; -- &gt; <code>amp</code>","text":"<ul> <li>The bug is https://github.com/alphamatic/amp/issues/1786</li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#script_set-up","title":"Script set-up","text":"<pre><code>&gt; vi /Users/saggese/src/amp1/dev_scripts/integrate_repos/setup.sh\nUpdate the date\n\n&gt; vi /Users/saggese/src/amp1/dev_scripts/integrate_repos/*\n\n&gt; cd \\~/src/amp1\n&gt; source /Users/saggese/src/amp1/dev_scripts/integrate_repos/setup.sh\n\n&gt; cd \\~/src/cmamp1\n&gt; source /Users/saggese/src/amp1/dev_scripts/integrate_repos/setup.sh\n</code></pre>"},{"location":"onboarding/all.development.how_to_guide.html#manual_set-up_branches","title":"Manual set-up branches","text":"<pre><code>## Go to cmamp1\n&gt; go_amp.sh cmamp 1\n\n## Set up the env vars in both clients\n&gt; export AMP_DIR=/Users/saggese/src/amp1; export\nCMAMP_DIR=/Users/saggese/src/cmamp1; echo \"$AMP_DIR\"; ls\n$AMP_DIR; echo \"$CMAMP_DIR\"; ls $CMAMP_DIR\n\n## Create two branches\n&gt; export BRANCH_NAME=AmpTask1786_Integrate_20211010 export BRANCH_NAME=AmpTask1786_Integrate_2021117\n...\n&gt; cd $AMP_DIR\n\n## Create automatically\n&gt; i git_create_branch -b $BRANCH_NAME\n\n## Create manually\n&gt; git checkout -b $BRANCH_NAME\n&gt; git push --set-upstream origin $BRANCH_NAME\n\n&gt; cd $CMAMP_DIR\n&gt; i git_create_branch -b $BRANCH_NAME\n</code></pre>"},{"location":"onboarding/all.development.how_to_guide.html#high-level_plan","title":"High-level plan","text":"<ul> <li>SUBDIR=im<ul> <li>Typically <code>cmamp</code> is copied on top of <code>amp</code></li> </ul> </li> <li>SUBDIR=devops<ul> <li><code>cmamp</code> and <code>amp</code> need to be different (until we unify the Docker flow)</li> </ul> </li> <li>Everything else<ul> <li>Typically <code>amp</code> -&gt; <code>cmamp</code></li> </ul> </li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#sync_im_cmamp_-_amp","title":"Sync <code>im</code> <code>cmamp</code> -&gt; <code>amp</code>","text":"<pre><code>SUBDIR=im\n\n## Check different files\n&gt; diff -r --brief $AMP_DIR/$SUBDIR $CMAMP_DIR/$SUBDIR | grep -v .git\n\n## Diff the entire dirs with vimdiff\n&gt; dev_scripts/diff_to_vimdiff.py --dir1 $AMP_DIR/$SUBDIR --dir2 $CMAMP_DIR/$SUBDIR\n\n## Find different files\n&gt; find $AMP_DIR/$SUBDIR -name \"*\"; find $CMAMP_DIR/$SUBDIR -name \"*\" sdiff\n/tmp/dir1 /tmp/dir2\n\n## Copy cmamp -&gt; amp\n&gt; rsync --delete -au $CMAMP_DIR/$SUBDIR/ $AMP_DIR/$SUBDIR\n-a = archive\n-u = ignore newer\n\n## Add all the untracked files\n&gt; cd $AMP_DIR/$SUBDIR &amp;&amp; git add $(git ls-files -o --exclude-standard)\n\n## Check that there are no differences after copying\n&gt; dev_scripts/diff_to_vimdiff.py --dir1 $AMP_DIR/$SUBDIR --dir2 $CMAMP_DIR/$SUBDIR\n\n==========\n\n&gt; rsync --delete -rtu $AMP_DIR/$SUBDIR/ $CMAMP_DIR/$SUBDIR\n\n&gt; rsync --dry-run -rtui --delete $AMP_DIR/$SUBDIR/ $CMAMP_DIR/$SUBDIR/ .d..t.... ./\n&gt; f..t.... __init__.py\ncd+++++++ features/\n&gt; f+++++++ features/__init__.py\n&gt; f+++++++ features/pipeline.py\ncd+++++++ features/test/\n&gt; f+++++++ features/test/test_feature_pipeline.py\ncd+++++++ features/test/TestFeaturePipeline.test1/\ncd+++++++ features/test/TestFeaturePipeline.test1/output/\n&gt; f+++++++ features/test/TestFeaturePipeline.test1/output/test.txt\n.d..t.... price/\n.d..t.... real_time/\n&gt; f..t.... real_time/__init__.py\n.d..t.... real_time/notebooks/\n&gt; f..t.... real_time/notebooks/Implement_RT_interface.ipynb\n&gt; f..t.... real_time/notebooks/Implement_RT_interface.py\n.d..t.... real_time/test/\ncd+++++++ real_time/test/TestRealTimeReturnPipeline1.test1/\ncd+++++++ real_time/test/TestRealTimeReturnPipeline1.test1/output/\n&gt; f+++++++ real_time/test/TestRealTimeReturnPipeline1.test1/output/test.txt\n.d..t.... returns/\n&gt; f..t.... returns/__init__.py\n&gt; f..t.... returns/pipeline.py\n.d..t.... returns/test/\n&gt; f..t.... returns/test/test_returns_pipeline.py\n.d..t.... returns/test/TestReturnsBuilder.test_equities1/\n.d..t.... returns/test/TestReturnsBuilder.test_equities1/output/\n.d..t.... returns/test/TestReturnsBuilder.test_futures1/\n.d..t.... returns/test/TestReturnsBuilder.test_futures1/output/\n\n&gt; rsync --dry-run -rtui --delete $CMAMP_DIR/$SUBDIR/ $AMP_DIR/$SUBDIR/\n&gt; f..t.... price/__init__.py\n&gt; f..t.... price/pipeline.py\n&gt; f..t.... real_time/pipeline.py\n&gt; f..t.... real_time/test/test_dataflow_amp_real_time_pipeline.py\n&gt; f..t.... returns/test/TestReturnsBuilder.test_equities1/output/test.txt\n&gt; f..t.... returns/test/TestReturnsBuilder.test_futures1/output/test.txt\n</code></pre>"},{"location":"onboarding/all.development.how_to_guide.html#sync_everything","title":"Sync everything","text":"<pre><code>## Check if there is anything in cmamp more recent than amp\n&gt; rsync -au --exclude='.git' --exclude='devops' $CMAMP_DIR/ $AMP_DIR\n\n## vimdiff\n&gt; dev_scripts/diff_to_vimdiff.py --dir1 $AMP_DIR --dir2\n$CMAMP_DIR\n\nF1: skip\nF9: choose left (i.e., amp)\nF10: choose right (i.e,. cmamp)\n\n## Copy\n\n&gt; rsync -au --delete --exclude='.git' --exclude='devops' --exclude='im'\n$AMP_DIR/\n$CMAMP_DIR\n\n## Add all the untracked files\n\n&gt; (cd $CMAMP_DIR/$SUBDIR &amp;&amp; git add $(git ls-files -o --exclude-standard))\n\n&gt; diff -r --brief $AMP_DIR $CMAMP_DIR | grep -v .git | grep Only\n</code></pre>"},{"location":"onboarding/all.development.how_to_guide.html#files_that_need_to_be_different","title":"Files that need to be different","text":"<ul> <li> <p><code>amp</code> needs an <code>if False</code> <code>helpers/lib_tasks.py</code></p> </li> <li> <p><code>amp</code> needs two tests disabled <code>im/ccxt/data/load/test/test_loader.py</code></p> <p><code>im/ccxt/data/load/test/test_loader.py</code></p> </li> </ul> <p>TODO(gp): How to copy files in vimdiff including last line?</p> <ul> <li>Have a script to remove all the last lines</li> <li>Some files end with an <code>0x0a</code></li> <li> <p><code>tr -d '\\\\r'</code></p> <pre><code>&gt; find . -name \"\\*.txt\" | xargs perl -pi -e 's/\\\\r\\\\n/\\\\n/g'\n# Remove `No newline at end of file`\n&gt; find . -name \"\\*.txt\" | xargs perl -pi -e 'chomp if eof'\n</code></pre> </li> </ul>"},{"location":"onboarding/all.development.how_to_guide.html#testing","title":"Testing","text":"<ul> <li>Run <code>amp</code> on my laptop (or on the server)</li> <li>IN PROGRESS: Get <code>amp</code> PR to pass on GH</li> <li>IN PROGRESS: Run lemonade on my laptop</li> <li>Run <code>cmamp</code> on the dev server</li> <li>Get <code>cmamp</code> PR to pass on GH</li> </ul>"},{"location":"onboarding/all.development_documents.reference.html","title":"All.development documents.reference","text":""},{"location":"onboarding/all.development_documents.reference.html#development_documents","title":"Development Documents","text":""},{"location":"onboarding/all.development_documents.reference.html#on-boarding","title":"On-boarding","text":"<ul> <li>Signing up for KaizenFlow</li> </ul>"},{"location":"onboarding/all.development_documents.reference.html#how_to_start_developing","title":"How to start developing","text":"<p>This contains the absolute minimal amount of info to start developing</p> <ul> <li> <p>General Rules of Collaboration</p> </li> <li> <p>Quick start for developing</p> </li> <li> <p>Set up the development environment</p> </li> <li> <p>How to organize your work</p> </li> <li> <p>First Review Process</p> </li> <li> <p>KaizenFlow Python coding style guide</p> </li> <li> <p>Jupyter notebook best practices</p> </li> <li> <p>Writing unit tests</p> </li> <li> <p>Running unit tests</p> </li> </ul>"},{"location":"onboarding/all.development_documents.reference.html#project_management","title":"Project management","text":"<ul> <li> <p>Contributor Feedback</p> <ul> <li>How we give feedback to contributors</li> </ul> </li> <li> <p>Code review</p> <ul> <li>PR review workflow from the code author and code reviewer points of view</li> </ul> </li> <li> <p>Development workflow</p> <ul> <li>Extended instructions on how to deploy your working environment and interact     with it</li> </ul> </li> <li> <p>GitHub workflows</p> <ul> <li>How to use GitHub, file a PR, review GitHub workflows</li> </ul> </li> <li> <p>Git workflow and best practices</p> <ul> <li><code>git</code> workflows, branch management, troubleshooting, common procedures</li> </ul> </li> <li> <p>Documentation about guidelines</p> <ul> <li>How to write guidelines, format documentation, convert Gdocs to markdown     files and vice versa</li> </ul> </li> <li> <p>Imports and packages</p> <ul> <li>How to import code, use packages, and resolve circular dependencies</li> </ul> </li> <li> <p>How to integrate repos</p> <ul> <li>Detailed instruction on how to integrate repos</li> </ul> </li> </ul>"},{"location":"onboarding/all.development_documents.reference.html#learn_how_to_become_efficient_at_developing","title":"Learn how to become efficient at developing","text":"<p>This contains a set of resources that over time will make 10x more productive</p> <ul> <li> <p>Docker</p> </li> <li> <p>Reading List</p> </li> <li> <p>Design Philosophy</p> </li> <li> <p>Codebase Clean-up</p> </li> <li> <p>Scrum Methodology</p> </li> </ul>"},{"location":"onboarding/all.development_documents.reference.html#in-depth_docs","title":"In-depth docs","text":"<ul> <li> <p>Buildmeister process</p> </li> <li> <p>Profiling</p> </li> <li> <p>Visual Studio Code</p> </li> <li> <p>Gsheet into pandas</p> </li> <li> <p>Email</p> </li> <li> <p>Glossary</p> </li> <li> <p>Type Hints</p> </li> <li> <p>PyCharm</p> </li> </ul>"},{"location":"onboarding/all.development_documents.reference.html#defi","title":"DeFi","text":"<ul> <li> <p>DeFi README</p> </li> <li> <p>From 0 to Web3</p> </li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html","title":"All.development setup.how to guide","text":""},{"location":"onboarding/all.development_setup.how_to_guide.html#development_setup","title":"Development Setup","text":""},{"location":"onboarding/all.development_setup.how_to_guide.html#high-level_view","title":"High-level view","text":"<ul> <li> <p>In order to develop in <code>cmamp</code> you must run on one of our <code>dev</code> servers, by     creating a VPN connection to our VPC and then ssh-ing to a <code>dev</code> server from     your laptop</p> </li> <li> <p>Don't waste time trying to setting up the dev env on your laptop since certain     resources (e.g., AWS resources, DBs, etc) are not visible outside our VPN</p> </li> <li> <p>If there is a problem with the <code>dev</code> servers (e.g., too slow, tools that you     want that don't work, etc) we can make your dev env better, so that everyone     can benefit</p> </li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#configure_bash_for_your_laptop","title":"Configure bash for your laptop","text":"<ul> <li>Make sure you are connected to the VPN before proceeding</li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#linux_and_macos","title":"Linux and MacOS","text":"<ul> <li> <p>Locally on your laptop tweak your <code>.bashrc</code> to add your server credentials:</p> <pre><code>&gt; vi .bashrc\n\n# Append at the end.\nexport CM_SSH_KEY=~/.ssh/cryptomatic.pem\n# E.g., export CM_SSH_KEY=~/.ssh/ck/saggese-cryptomatic.pem\n\n# XYZ for your remote Linux username, e.g., saggese, danya, maxs\nexport CM_USER=saggese\nexport CM_IP=172.30.2.136\n</code></pre> </li> <li> <p>For MacOS you might want to tweak <code>.bash_profile</code>. After tweaking your bashrc,     you need to restart the shell session with <code>exit; bash</code> or do <code>source ~/.bash</code></p> </li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#windows","title":"Windows","text":"<ul> <li> <p>Download and install <code>putty.exe</code>, <code>pscp.exe</code>, and <code>puttygen.exe</code> from the     PuTTY Download Page</p> </li> <li> <p>Open <code>PuTTYgen</code> and click on the load button     </p> </li> <li> <p>Locate the private SSH key that you have downloaded</p> </li> <li> <p>Click the Save private key button to create the ppk file     </p> </li> <li> <p>Open <code>PuTTY</code>, under Session, enter your Hostname i.e. our server IP:     172.30.2.136</p> <p></p> </li> <li> <p>Under Connection, click Data and Enter your username as the Auto-login     username </p> </li> <li> <p>Under SSH, choose 2 from the Preferred SSH Protocol Version     </p> </li> <li> <p>Under SSH -&gt; Auth -&gt; Credentials, you will need to specify where your private     key can be found</p> </li> <li> <p>Remember, this is the ppk file you generated using <code>PuTTygen</code> earlier</p> </li> <li> <p>Click the Browse to locate the file on your computer     </p> </li> <li> <p>Under Sessions, type a name (such as \"my site\") in the Saved Sessions box and     then click Save. Hit Open to Run the session</p> </li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#configure_ssh_for_your_laptop","title":"Configure .ssh for your laptop","text":"<ul> <li>To connect to the server use your previously generated private key, i.e. not     the public key that the Infra team sends you back</li> <li>Move the public-private key pair to <code>~/.ssh</code> and set <code>pem</code> as the private key     extension, see     more about <code>pem</code> extension. E.g.,     <code>~/.ssh/cryptomatic.pem</code> (private key) that you will use to connect.</li> <li>Set the permissions for your private key     <pre><code>laptop&gt; chmod 600 ~/.ssh/cryptomatic.pem\n</code></pre></li> <li> <p>Now you can connect to the server through a VPN (see     <code>/docs/onboarding/ck.setup_vpn_and_dev_server_access.how_to_guide.md</code>)</p> <pre><code>laptop&gt; ssh -i $CM_SSH_KEY $CM_USER@$CM_IP\n\nE.g.,\nlaptop&gt; ssh -i ~/.ssh/cryptomatic.pem $CM_USER@$CM_IP\n</code></pre> </li> <li> <p>You can also pass the user and IP manually, but adding those exports above     saves time in the long run.</p> </li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#configure_ssh_for_the_server","title":"Configure .ssh for the server","text":"<ul> <li><code>ssh</code> into the server with     <pre><code>laptop&gt; ssh -i $CM_SSH_KEY $CM_USER@$CM_IP\n</code></pre></li> <li>Your home directory should be under <code>/data</code> <pre><code>server&gt; echo $HOME\n/data/saggese\n</code></pre></li> <li>The directory on the server should look like:     <pre><code>server&gt; ls -l ~/.ssh/\ntotal 16\n-rw------- 1 saggese saggese  382 Nov 19 18:15 authorized_keys\n-rw------- 1 saggese saggese  381 Nov 25 17:41 cryptomatic.pem.pub\n-rw-r--r-- 1 saggese saggese  666 Nov 25 17:43 known_hosts\n</code></pre></li> <li>(Optional step) If that's not the case, talk to IT to copy the public ssh key     to the server from your laptop.</li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#configure_bash_for_the_server_advanced","title":"Configure bash for the server (advanced)","text":""},{"location":"onboarding/all.development_setup.how_to_guide.html#configure_bash","title":"Configure bash","text":""},{"location":"onboarding/all.development_setup.how_to_guide.html#linux_and_macos_1","title":"Linux and MacOS","text":"<ul> <li>Now you want to configure the server <code>~/.bash</code> and the environment to your     preference.</li> <li> <p>E.g., you might want to copy <code>.vimrc</code>, pimp <code>.bashrc</code></p> <pre><code>## Copy your hub keys to the dev server\nlaptop&gt; export CM_SSH_KEY=~/.ssh/cryptomatic/saggese-cryptomatic.pem\nlaptop&gt; export CM_USER=saggese\nlaptop&gt; export CM_IP=172.30.2.136\n\nlaptop&gt; scp -i $CM_SSH_KEY ~/.ssh/id_rsa $CM_USER@$CM_IP:/data/$CM_USER/.ssh/id_rsa.gpsaggese.hub\n\nlaptop&gt; scp -i ~/.ssh/cryptomatic/saggese-cryptomatic.pem ~/.ssh/id_rsa.pub saggese@172.30.2.136:/data/saggese/.ssh/id_rsa.gpsaggese.hub.pub\n\nlaptop&gt; scp -i ~/.ssh/cryptomatic/saggese-cryptomatic.pem ~/.ssh/cryptomatic/id_rsa.cryptomtc.hub saggese@172.30.2.136:/data/saggese/.ssh/id_rsa.cryptomtc.github\n\nlaptop&gt; scp -i ~/.ssh/cryptomatic/saggese-cryptomatic.pem ~/.ssh/cryptomatic/id_rsa.cryptomtc.hub.pub saggese@172.30.2.136:/data/saggese/.ssh/id_rsa.cryptomtc.github.pub\n</code></pre> </li> <li> <p>Tweak permissions on the server     <pre><code>server&gt; ls -l ~/.ssh\ntotal 32\n-rw------- 1 saggese saggese  382 Nov 19 18:15 authorized_keys\n-r-------- 1 saggese saggese 1679 Nov 25 17:40 cryptomatic.pem\n-r-------- 1 saggese saggese  381 Nov 25 17:41 cryptomatic.pem.pub\n-r-------- 1 saggese saggese 3243 Nov 30 17:54 id_rsa.cryptomtc.hub\n-r-------- 1 saggese saggese  732 Nov 30 17:54 id_rsa.cryptomtc.hub.pub\n-r-------- 1 saggese saggese 1675 Nov 30 17:48 id_rsa.gpsaggese.hub\n-r-------- 1 saggese saggese  389 Nov 30 17:50 id_rsa.gpsaggese.hub.pub\n-rw-r--r-- 1 saggese saggese  888 Nov 30 17:43 known_hosts\n</code></pre></p> </li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#windows_1","title":"Windows","text":"<ul> <li> <p>Use the above steps from Configure bash of Linux and MacOS. Just use scp in     the following way:</p> <pre><code>laptop&gt; scp -i $CM_SSH_KEY ~/.ssh/id_rsa $CM_USER@$CM_IP:/data/$CM_USER/.ssh/id_rsa.gpsaggese.hub\n\nlaptop&gt; pscp -scp -i $PPK_KEY_GENERATED_USING_PUTTYGEN ~/.ssh/id_rsa $CM_USER@$CM_IP:/data/$CM_USER/.ssh/id_rsa.gpsaggese.hub\n</code></pre> </li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#configure_tmux_optional","title":"Configure tmux (optional)","text":"<ul> <li> <p>Create this file under <code>~/.tmux.conf</code> on the server. The prefix is <code>CTRL-g</code>.     Copy-paste the code below into the <code>.tmux.conf</code> and save the changes.</p> <pre><code># Use C-x.\n#set -g prefix C-x\nset -g prefix C-g\nunbind-key C-b\nbind-key C-g send-prefix\n\n# Set status bar.\nset -g status-bg black\nset -g status-fg white\nset -g status-left '#[fg=green]#H'\n\n# Use vi shortcuts.\nset-window-option -g mode-keys vi\n\n# set -g status-right \"#[fg=blue]#S #I:#P #[fg=yellow]:: %d %b %Y #[fg=green]:: %l:%M %p :: #(date -u | awk '{print $4}')::\"\n\n# 100k lines\nset-option -g history-limit 100000\n\n# Highlight active window.\n# set-window-option -g window-status-current-bg red\nset -g window-status-current-style bg=red\n\n# Try to speed up the processing of shortcuts.\nset-option -g repeat-time 0\nset -sg escape-time 0\n\n# To get notification when a command is done.\n# TODO: This seems to give problems with my mac and being removed.\n# set -g visual-content on\n# setw -g monitor-content CMD_DONE\n\n# For Mac only.\n# Workaround to 'LSOpenURLsWithRole() failed with error -10810'.\n# set -g default-command \"reattach-to-user-namespace -l /bin/bash\"\n# set-option -g default-command \"which reattach-to-user-namespace &gt; /dev/null &amp;&amp; #reattach-to-user-namespace -l $SHELL || $SHELL\"\n</code></pre> </li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#spruce_up_your_environment","title":"Spruce up your environment","text":"<ul> <li> <p>If you have multiple users, you can decide which one to use</p> <pre><code># Test hub connection\n&gt; ssh -i ~/.ssh/id_rsa.gpsaggese.hub -T git@github.com\n&gt; _SSH_COMMAND=\"ssh -i ~/.ssh/id_rsa.gpsaggese.github\" git clone git@github.com:gpsaggese/dotted_files.git\n\n&gt; _SSH_COMMAND=\"ssh -i ~/.ssh/id_rsa.gpsaggese.github\" git clone --recurse git@github.com:alphamatic/amp.git amp1\n</code></pre> </li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#set_up_aws","title":"Set up AWS","text":"<ul> <li> <p>We use AWS profile called <code>ck</code></p> <ul> <li>It is used to access S3 bucket data and other AWS resources</li> <li>API credentials are included in the <code>zip</code> archive sent via e-mail during     on-boarding process</li> <li>Ask the Infra team if you have not obtained the credentials</li> </ul> </li> <li> <p>Create dir with proper permissions:     <pre><code>&gt; mkdir ~/.aws; chmod 700 ~/.aws\n</code></pre></p> </li> <li> <p>Put the following into <code>~/.aws/config</code>:</p> <pre><code>[profile ck]\nregion = eu-north-1\n</code></pre> </li> <li> <p>Put the following into <code>~/.aws/credentials</code>:</p> <pre><code>[ck]\naws_access_key_id=***\naws_secret_access_key=***\naws_s3_bucket=cryptokaizen-data\n</code></pre> </li> <li> <p>Note that AWS uses <code>[profile XYZ]</code> vs <code>[XYZ]</code> in the two types of files     (config and credentials), yes, this is insane</p> </li> <li>Change permissions to ready-only and only for your user since it contains     credentials:     <pre><code>&gt; chmod 400 ~/.aws/*\n</code></pre></li> <li> <p>You should get to permissions that look like:</p> <pre><code>saggese@ip-172-30-2-136:~$ ls -ld ~/.aws\ndrwx------ 2 saggese saggese 4096 Dec  3 17:09 /data/saggese/.aws\n\nsaggese@ip-172-30-2-136:~$ ls -l ~/.aws\ntotal 8\n-r-------- 1 saggese saggese  32 Dec  3 17:08 config\n-r-------- 1 saggese saggese 403 Dec  3 17:09 credentials\n</code></pre> </li> <li> <p>Test the access to the S3 bucket</p> <ul> <li>For the ck:     <pre><code>&gt; aws s3 ls s3://cryptokaizen-data --profile ck\n PRE daily_staged/\n PRE db_archive/\n PRE historical/\n PRE reorg/\n PRE unit_test/\n</code></pre></li> </ul> </li> <li> <p>Test accessing AWS ECR to pull containers:</p> <pre><code>&gt; eval $(aws ecr get-login --profile am --no-include-email --region us-east-1)\nWARNING! Using --password via the CLI is insecure. Use --password-stdin.\nWARNING! Your password will be stored unencrypted in /data/saggese/.docker/config.json.\nConfigure a credential helper to remove this warning. See\nhttps://docs.docker.com/engine/reference/commandline/login/#credentials-store\n\nLogin Succeeded\n</code></pre> </li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#clone_the_hub_repo","title":"Clone the Hub repo","text":""},{"location":"onboarding/all.development_setup.how_to_guide.html#ssh_keys","title":"SSH Keys","text":"<ul> <li>For hub you can use your key otherwise you can generate an ssh key for hub</li> <li>Note:<ul> <li>You can use any SSH key, even a \"personal\" one that one uses for his/her     projects</li> <li>In practice, the logic is \"user authenticates with GH, we tell GH to grant     access to a private repo, GH is happy\"</li> </ul> </li> <li>Typically you can save the Hub authentication in <code>~/.ssh/id_rsa</code> and     <code>~/.ssh/id_rsa.pub</code></li> <li>Note: make sure permissions are read-only, otherwise change permissions, e.g.,     <code>chmod 400 ~/.ssh/id_ed25519</code></li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#git_clone","title":"Git clone","text":"<ul> <li>In order to use our automation scripts, the path to local copy of the repos     needs look like this <code>${HOME}/src/{REPO_NAME}{IDX}</code>, e.g.,     <code>/data/saggese/src/cmamp1</code>.</li> <li>Clone a repo using an SSH key, we do not use HTTPS</li> <li>Clone the repo with:     <pre><code>&gt; mkdir ~/src\n&gt; cd ~/src\n# In general form.\n&gt; git clone --recursive git@github.com:causify-ai/{repo_name}.git ~/src/{repo_name}{index}\n# Example for cmamp.\n&gt; git clone --recursive git@github.com:causify-ai/cmamp.git ~/src/cmamp1\n</code></pre></li> <li>You can have multiple cloned repos like <code>cmamp2</code>, <code>cmamp3</code> and so on to work     on unrelated changes at the same time</li> <li> <p>If the repo contains submodules we need to checkout master in all submodules.</p> <pre><code># Before.\n&gt; git status\nHEAD detached at bd69850bb\nnothing to commit, working tree clean\n# In general form.\n&gt; cd {submodule}\n&gt; git checkout master\n&gt; git pull\n# Example for `orange` which contains `cmamp` which contains `helpers`.\n&gt; cd amp\n&gt; git checkout master\n&gt; git pull\n&gt; cd helpers_root\n&gt; git checkout master\n&gt; git pull\n# After.\n&gt; git status\nOn branch master\nYour branch is up to date with 'origin/master'.\n\nChanges not staged for commit:\n    (use \"git add &lt;file&gt;...\" to update what will be committed)\n    (use \"git restore &lt;file&gt;...\" to discard changes in working directory)\n                modified:   helpers_root (new commits)\n</code></pre> </li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#set_up_the_thin_environment","title":"Set up the thin environment","text":"<ul> <li>Build the thin environment we use to call invoke and Docker. For all the repos     we use the thin environment from the <code>helpers</code> repo, i.e. to build one we need     to run:     <pre><code>    &gt; cd amp (only if amp is submodule)\n    &gt; cd helpers_root\n    &gt; ./dev_scripts_helpers/thin_client/build.py\n</code></pre></li> <li>This script to build the environment is run rarely when the dependencies are     changed.</li> <li>This environment is shared by multiple repos (e.g., all the <code>cmamp</code> and     <code>tutorials</code>), so once you build the environment you can use it for all the     repos and for multiple clients</li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#activate_the_thin_environment","title":"Activate the thin environment","text":"<ul> <li>It is okay to skip this step as long as you use <code>tmux</code>. The thin environment     is activated automatically within a <code>tmux</code> session.</li> <li>To activate the thin environment, run the <code>setenv.sh</code> script. The script is     located under <code>dev_scripts_{repo_name}/thin_client</code>, e.g.:     <pre><code>&gt; source dev_scripts_cmamp/thin_client/setenv.sh\n&gt; source dev_scripts_orange/thin_client/setenv.sh\n</code></pre></li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#create_a_tmux_session","title":"Create a tmux session","text":"<ul> <li> <p>Create a soft link. The cmd below will create a file <code>~/go_{repo_name}.py</code></p> <pre><code>&gt; dev_scripts_{repo_name}/thin_client/tmux.py --create_global_link\n</code></pre> </li> <li> <p>Create a tmux session. Choose <code>index</code> based on the dir name, e.g., <code>--index 1</code>     if the dir name is <code>~/src/cmamp1</code>.</p> <pre><code>&gt; dev_scripts_{repo_name}/thin_client/tmux.py --index 1\n</code></pre> </li> <li> <p>You need to create the tmux environment once per client and then you can     re-connect with:</p> <pre><code># Check the available environments.\n&gt; tmux ls\ncmamp1: 4 windows (created Fri Dec  3 18:27:09 2021) (attached)\n\n# Attach an environment.\n&gt; tmux attach -t cmamp1\n</code></pre> </li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#configure_gh","title":"Configure <code>gh</code>","text":"<ul> <li> <p>We enjoy using Hub CLI</p> <ul> <li>Create a Personal Access Token (classic) on Hub following the official guide</li> <li> <p>Put the following permissions:</p> <p></p> </li> </ul> </li> <li> <p>Create personal access token (aka PAT) as done above and save it to     <code>~/hub_pat.txt</code></p> </li> <li>You can login with a single command     <pre><code>&gt; cat ~/hub_pat.txt | gh auth login --hostname github.com --with-token\n</code></pre></li> <li>Sometimes you need to create the file to make <code>gh</code> happy     <pre><code>&gt; touch ~/.config/gh/config.yml\n</code></pre></li> <li>Check the current authentication status of <code>gh</code>:     <pre><code>&gt; gh auth status\nhub.com\n    \u2713 Logged in to hub.com as gpsaggese (/Users/saggese/.config/gh/hosts.yml)\n    \u2713  operations for github.com configured to use ssh protocol.\n    \u2713 Token: *******************\n</code></pre></li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#fix_permissions","title":"Fix permissions","text":"<ul> <li>Sometimes for whatever reason a file is created by <code>root</code> which prevents     executing certain commands being a non-root user w/o sudo privileges</li> <li>To change permissions we need sudo privileges that we do not have outside a     Docker container but we have inside a Docker container     <pre><code>(amp.client_venv) dan@ip-172-31-12-40:~/src/cmamp1$ gh auth login\n? What account do you want to log into? Hub.com\n? What is your preferred protocol for  operations? SSH\n? Upload your SSH public key to your Hub account? Skip\n? How would you like to authenticate Hub CLI? Paste an authentication token\nTip: you can generate a Personal Access Token here https://hub.com/settings/tokens\nThe minimum required scopes are 'repo', 'read:org'.\n? Paste your authentication token: ****************************************\n- gh config set -h hub.com git_protocol ssh\n\u2713 Configured  protocol\nopen /data/dan/.config/gh/config.yml: permission denied\n(amp.client_venv) dan@ip-172-31-12-40:~/src/cmamp1$ cat ~/hub_pat.txt | gh auth login --hostname github.com --with-token\nopen /data/dan/.config/gh/config.yml: permission denied\n</code></pre><ul> <li>Get inside the docker container using <code>i docker_bash</code></li> <li>Change dir using <code>cd ~/.config</code></li> <li>Run <code>sudo chown -R username:username gh</code> where username is your username     inside the container, e.g. <code>user_1022:user_1022</code></li> <li>Run <code>ls -l gh | grep root</code> if nothing, it's a good sign</li> <li>Close container printing <code>exit</code> or ctrl+D</li> <li>Log in again using <code>gh auth login</code> and follow the instructions above</li> <li>Check your auth status using <code>gh auth status</code></li> </ul> </li> </ul>"},{"location":"onboarding/all.development_setup.how_to_guide.html#begin_working","title":"Begin working","text":"<ul> <li>Conceptually the steps are:<ul> <li>Clone a repo in <code>~/src/...</code><ul> <li>You can have as many clients as you want (<code>cmamp1</code>, <code>cmamp2</code>, ...,     <code>helpers1</code>, ...)</li> </ul> </li> <li>Build the \"thin\" environment:<ul> <li>Needs to be done only once for all your clients     <pre><code>&gt; cd helpers_root\n&gt; ./dev_scripts_helpers/thin_client/build.py\n</code></pre></li> </ul> </li> <li>Start a tmux session<ul> <li>Choose <code>index</code> based on folder name, e.g., <code>--index 1</code> if repo name is     <code>~/src/cmamp1</code> <pre><code>&gt; dev_scripts_{repo_name}/thin_client/tmux.py --index 1\n</code></pre></li> </ul> </li> <li>Activate environment:<ul> <li>It is activated automatically in all the tmux sessions</li> <li>Otherwise, run:     <pre><code>&gt; source dev_scripts_{repo_name}/thin_client/setenv.sh\n</code></pre></li> </ul> </li> <li>Pull <code>cmamp</code> docker images:<ul> <li>This image is shared all your clients (actually all users on the server     use the same image)     <pre><code>&gt; i docker_pull\nDigest: sha256:308d52a0354845d1a2aa2014282efa66864329e7e22bf15dad518c219b5d5a3d\nStatus: Downloaded newer image for 665840871993.dkr.ecr.us-east-1.amazonaws.com/cmamp:dev\n665840871993.dkr.ecr.us-east-1.amazonaws.com/cmamp:dev\n</code></pre></li> </ul> </li> <li>Check <code>docker_bash</code>:     <pre><code>&gt; i docker_bash\nINFO: &gt; cmd='/data/saggese/src/venv/helpers.client_venv/bin/invoke docker_bash'\n## docker_bash:\nIMAGE=665840871993.dkr.ecr.us-east-1.amazonaws.com/helpers:dev \\\n                docker-compose \\\n                --file /data/saggese/src/helpers1/devops/compose/docker-compose.yml \\\n                --env-file devops/env/default.env \\\n                run \\\n                --rm \\\n                --user $(id -u):$(id -g) \\\n                app \\\n                bash\n        user_1005@9e4373e01213:/app$\n</code></pre><ul> <li>Exit the container with <code>exit</code> and get back to the server prompt</li> </ul> </li> <li>Run regressions:     <pre><code>&gt; i run_fast_tests\n</code></pre><ul> <li>If you can run all the regressions without errors, then you are totally     set up to start developing</li> </ul> </li> </ul> </li> </ul>"},{"location":"onboarding/all.hiring_process.how_to_guide.html","title":"All.hiring process.how to guide","text":""},{"location":"onboarding/all.hiring_process.how_to_guide.html#hiring_process","title":"Hiring process","text":""},{"location":"onboarding/all.hiring_process.how_to_guide.html#pre-hiring_bounty","title":"Pre-hiring: Bounty","text":"<ul> <li>We have hundreds of candidates who want to contribute to our projects and work     with us, but we can't easily find the ones that have the right skills to join     the team</li> <li>One approach is for us to go through the applications, rank the candidates,     on-board them and help them achieve the quality of code we expect from team     members</li> <li>Another approach is to let the candidates show that they can deliver through     bounty hunting</li> <li>The idea is to have challenging projects (bounties) that potential hires can     take on<ul> <li>From a couple of days to ~2 weeks of work</li> <li>Lots of coding with clear specs</li> <li>Not on the critical path, \"nice to have\" projects that will become useful in     the future</li> </ul> </li> <li>Those who excel at the bounties get paid and get onto the     hiring path</li> <li>More information and instructions for bounty hunters are provided in     <code>/docs/onboarding/bounty.onboarding_checklist.reference.md</code></li> </ul>"},{"location":"onboarding/all.hiring_process.how_to_guide.html#hiring_stages","title":"Hiring stages","text":"<ul> <li>We separate the hiring process into the following stages:</li> <li>Intern<ul> <li>Not a part of the company</li> <li>Paid, but not through the company payroll</li> <li>Interns only have access to public repos (e.g., <code>helpers</code>, <code>tutorials</code>)</li> <li>Can be full-time or part-time<ul> <li>Since most are students, during summer they can work full-time</li> <li>In any case we expect at least 20 hrs/week</li> </ul> </li> <li>Interns go through     \"light\" on-boarding<ul> <li>Read the \"must-read\" docs about how we do things</li> <li>Set up for development on their laptops</li> </ul> </li> <li>Interns get simple tasks to work on, so that we can assess     how well they can follow directions and work independently<ul> <li>The tasks would be most likely related to Linter, documentation, AI, DS</li> <li>How to test potential hires to the Infra team? We decide case by case</li> </ul> </li> <li>Ideal goal: minimal effort for us to give a chance to somebody, high     probability of failing</li> <li>Interns are managed only by the hiring team without any input from team     leaders</li> <li>Interns receive feedback on various skills every 2 weeks (see more     below)</li> <li>After 1-2 months (or whenever we feel we have enough information to make an     informed decision), we decide whether the intern can move on to the     following stage of the hiring pipeline</li> </ul> </li> <li>3-month trial<ul> <li>Before an intern can turn into a permanent team member, they go through a     3-month trial period</li> <li>At this stage, they work full-time and have all the markings of a Causify     team member</li> <li>They go through     full on-boarding,     receiving company e-mail, server access, access to private repos, etc.</li> <li>They receive feedback on various skills every month to make sure they are     adapting and improving in the way we expect</li> <li>After 3 months, we make a decision whether to make an offer or not<ul> <li>The probability of failing at this stage should be low</li> </ul> </li> <li>This stage is run by the hiring team with some input from team leaders</li> <li>During this stage, we decide which team they go on: Infra, Dev, DS, AI</li> </ul> </li> <li>Permanent team member<ul> <li>Successful candidates receive an offer for a permanent full-time position     after the 3-month trial</li> <li>At this point they should already be fully on-boarded and ready to hit the     ground running</li> <li>They get assigned to a particular team/project and start being managed by     the corresponding team leader</li> <li>For now, we don't consider hiring new people to part-time positions since     it's too difficult to plan their involvement in projects</li> </ul> </li> </ul>"},{"location":"onboarding/all.hiring_process.how_to_guide.html#hiringmeister","title":"HiringMeister","text":"<ul> <li>Members of the hiring team alternate being the HiringMeister for 2 weeks</li> <li>To see who is the HiringMeister now, refer to     Rotation Meisters</li> <li>HiringMeister's duties include:<ul> <li>Organizing the hiring and onboarding process (see below for     more details)</li> <li>Communicating with applicants by email</li> <li>Supervising interns and people on a 3-month trial period</li> <li>Keeping all the relevant documentation up-to-date</li> <li>Improving the process when needed</li> <li>Managing the hiring project on Asana</li> </ul> </li> <li>In other words, HiringMeister is the first point of contact for triaging,     making sure nothing falls through the cracks</li> </ul>"},{"location":"onboarding/all.hiring_process.how_to_guide.html#step_by_step","title":"Step by step","text":"<ul> <li> <p>We look for candidates based on the specific hiring needs in our     teams/projects. There are several avenues:</p> <ul> <li>Emails to CS and related depts<ul> <li>Especially for PhD students</li> </ul> </li> <li>Using our LinkedIn pipeline<ul> <li>We are going to start targeting graduates from top schools</li> </ul> </li> <li>Job postings on LinkedIn</li> <li>Job postings on Upwork</li> </ul> </li> <li> <p>HiringMeister/GP: send an email to the applicant with a link to the     questionnaire     to gather information about them</p> </li> <li> <p>(Optional) HiringMeister/GP: send an email inviting the applicant to     participate in bounty hunting</p> <ul> <li>All further steps are put on hold while the applicant works on bounty tasks</li> </ul> </li> <li> <p>Hiring team: decide whether we take on the applicant as an intern</p> <ul> <li>Decided at a review meeting that takes place every 2 weeks</li> <li>We want to increase the quality of the collaborators, so if there is a red     flag (e.g., no GitHub, low GPA, undergrad) we can decide not to offer the     internship</li> <li>The goal is to avoid onboarding people that will likely disappoint us</li> <li>If we receive a single candidate application and find no red flags in the     profile, we should proceed further in the process</li> <li>It's ok to ask more team members to take a look</li> <li>If the candidate is a no-go, GP sends an email of rejection</li> <li>If we decide to on-board the candidate, continue with the steps below</li> </ul> </li> <li> <p>HiringMeister/GP: send an email asking to confirm if they are still interested     and ready to go</p> <ul> <li>Proceed with the steps below only if they respond with a confirmation</li> </ul> </li> <li> <p>HiringMeister: create a task on Asana in the     Hiring     project</p> <ul> <li>The task goes in the \"Onboarding\" section</li> <li>The name of the task is the name of the intern</li> <li> <p>In the task description, use the following template:</p> <p><pre><code>Pronoun:\nPersonal email:\nWork status (e.g., when graduates):\n\nGitHub:\n    Onboarding issue:x\n    Issues:\n    PRs:\n\nHiring info:\n    Google Form:\n    CV:\n    LinkedIn:\n    GitHub user:\n    TG:\n    Working hours / week:\n    Best piece of code:\n    How good (1-5):\n</code></pre>     - Fill in the template based on their questionnaire responses     - We use this Asana task to communicate about the intern</p> </li> </ul> </li> <li> <p>HiringMeister/GP: send invitations to GitHub repos with <code>write</code> permissions:</p> <ul> <li><code>helpers</code></li> <li><code>tutorials</code></li> </ul> </li> <li> <p>HiringMeister: create a GitHub issue for onboarding the intern</p> <ul> <li>Follow the instructions in     <code>intern.onboarding_checklist.reference.md</code></li> </ul> </li> <li> <p>HiringMeister: regularly check the updates made by the intern in the     onboarding issue and help resolve any errors they face</p> <ul> <li>This \"light\" onboarding process should take 2-3 days max</li> <li>The goal is to make sure that all the mechanisms for developing are tested     and working, so that we can focus on the next stages (\"can the intern fix a     simple bug?\", \"can the intern write more complex code?\", etc.)</li> </ul> </li> <li> <p>HiringMeister: once the onboarding is complete, assign a     warm-up issue to the intern</p> <ul> <li>If an intern shows lack of progress on their assigned warm-up task, ping     them twice for updates. If no progress is made, reassign the task to a more     promising intern</li> <li>Once the intern submits a pull request, review it to ensure adherence to our     processes. Provide constructive feedback on areas for improvement and     ascertain if the task's objectives have been fully met</li> <li>If the task is completed, assign a new one</li> </ul> </li> <li> <p>Hiring team: after 1 month, decide whether we should continue to collaborate     with the intern or not</p> </li> <li> <p>HiringMeister: when the intern moves on to the 3-month trial period,     create a GitHub issue for further onboarding</p> <ul> <li>Follow the instructions in     <code>all.onboarding_checklist.reference.md</code></li> </ul> </li> <li> <p>HiringMeister: once the full onboarding is complete, organize more complex     tasks to test their development and problem-solving skills</p> <ul> <li>This is done together with team leaders</li> </ul> </li> <li> <p>Hiring team: after 3 months, decide whether we want to offer a permanent     position on the team</p> <ul> <li>If the offer is made, decide which team/project the new team member is     joining, based on their background, skills, performance during internship     and 3-month trial, and, last but not least, company needs</li> </ul> </li> </ul>"},{"location":"onboarding/all.hiring_process.how_to_guide.html#warm-up_tasks","title":"Warm-up tasks","text":"<ul> <li>The HiringMeister should collaborate with the team to identify potential     warm-up tasks to give to the interns upon completion of their onboarding     process</li> <li>The goal of a warm-up issue is to write a bit of code and show they can follow     the process, the goal is not to check if they can solve a complex coding     problem</li> <li>It should take 1-2 days to get it done</li> <li>This helps us understand if they can<ul> <li>Follow the process (or at least show that they have read the docs and     somehow internalized them)</li> <li>Solve some trivial problems</li> <li>Write Python code</li> <li>Interact on GitHub</li> <li>Communicate with the team</li> </ul> </li> <li>The warm-up tasks should be straightforward to integrate, immediately     beneficial, unrelated to new features, and should not rely on the code in     private repos</li> <li>It is important that specs are provided in a manner that is easy to be     understood by interns, and any queries they may have regarding the task are     addressed quickly by the HiringMeister or another permanent team member</li> <li>Warm-up tasks are collected in advance:<ul> <li>Issues marked with the \"good first issue\" label on GH<ul> <li>Extremely simple (e.g., changing a few lines of code, converting Gdoc to     Markdown...)</li> <li>The goal is to practice following our procedure</li> </ul> </li> <li>Issues marked with the \"good second issue\" label on GH<ul> <li>Still simple but require a little bit more coding than the first issue</li> <li>The goal is to start testing the skills as well as confirm the     understanding of our process</li> </ul> </li> <li>Outsourceable issues gdoc</li> </ul> </li> </ul>"},{"location":"onboarding/all.hiring_process.how_to_guide.html#giving_feedback","title":"Giving feedback","text":"<ul> <li>Every 2 weeks interns are provided feedback that includes scores given to     their skills and performance</li> <li>The process and scoring criteria are defined in     <code>all.contributor_feedback.how_to_guide.md</code></li> <li>Scoring should be done by all members of the hiring team</li> <li>Interns with a low score should be let go</li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html","title":"All.onboarding checklist.reference","text":""},{"location":"onboarding/all.onboarding_checklist.reference.html#onboarding_checklist","title":"Onboarding Checklist","text":""},{"location":"onboarding/all.onboarding_checklist.reference.html#onboarding_process_for_a_new_team_member","title":"Onboarding Process for a New Team Member","text":""},{"location":"onboarding/all.onboarding_checklist.reference.html#meta","title":"Meta","text":""},{"location":"onboarding/all.onboarding_checklist.reference.html#make_on-boarding_automatic","title":"Make On-Boarding Automatic","text":"<ul> <li>We want to make the onboarding process as automatic as possible</li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html#be_patient","title":"Be Patient","text":"<ul> <li>Let's use all the communication tools we have (screen sharing, Google Meet,     phone, Slack, email) to keep the process smooth and personal</li> <li>There are many (hidden) dependencies in the process, so something will     inevitably go wrong<ul> <li>Let's all be patient with each other</li> </ul> </li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html#ask_for_confirmation","title":"Ask for Confirmation","text":"<ul> <li>Use checklists any time to make sure things get done</li> <li>Ask for confirmation of all the actions, e.g.,<ul> <li>\"Does this and that work?\"</li> <li>\"Did you receive the email?\"</li> <li>\"Can you log in?\"</li> </ul> </li> <li>Make the new team member follow the instructions so that they can get familiar     with the systems</li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html#make_on-boarding_similar_to_our_work_routine","title":"Make On-Boarding Similar to Our Work Routine","text":"<ul> <li> <p>Provide tools for interacting with the team</p> <ul> <li>During the process the new teammate will ask questions and he / she should     use the appropriate tools for each type of communication<ul> <li>Slack: only for interactive communications</li> <li>GitHub issues: for coding related things</li> <li>Asana tasks: for business/high-level tasks</li> <li>Email: everything else</li> </ul> </li> </ul> </li> <li> <p>We want to nudge a new hire to operate through the tools we use during our     daily work</p> <ul> <li>That is why we asking him to create a first issue about his / her experience     with the process</li> <li>He / she should put his / her notes in the GH issue while proceeding during     the onboarding process</li> </ul> </li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html#improve_on-boarding_process","title":"Improve On-Boarding Process","text":"<ul> <li> <p>Review, improve, clarify process</p> <ul> <li>We want to point the new team member to a document rather than explaining     over and over the same things</li> <li>Always keep this document updated, ask candidates to follow it carefully,     and update it with a PR</li> <li>We want to use each new team-member experience to improve our workflow</li> <li>We want new team-members to improve the existing documentation using our     standard GitHub process</li> </ul> </li> <li> <p>Have the new team member:</p> <ul> <li>Open the first GitHub bug on the first day</li> <li>Open the first PR by the second day</li> </ul> </li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html#people_involved_in_the_on-boarding","title":"People Involved in the On-Boarding","text":"<ul> <li>Each task is performed by one of the persons involved in the on-boarding<ul> <li>Team leader (e.g., GP, Paul, Grisha, Samarth)</li> <li>Team member (i.e., the person on-boarded)</li> <li>IT (e.g., Shayan)</li> <li>HR (e.g., Rose)</li> </ul> </li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html#checklist","title":"Checklist","text":"<ul> <li>Source:     <code>all.onboarding_checklist.reference.md</code></li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html#before_the_start_date","title":"Before the Start Date","text":"<ul> <li> <p>[ ] Team leader: talk to the teams about the new team member joining</p> </li> <li> <p>[ ] Team leader: Send some information to the new team member as a preview</p> <ul> <li>E.g., some documentation</li> </ul> </li> <li> <p>[ ] Team leader: establish contact with the new hire with a few words             about the next steps</p> </li> <li> <p>[ ] Team leader: do a proper intro with an email to the team:</p> <ul> <li>\"Hi team, please join me in welcoming XYZ to the team\"</li> <li>Whom is going to report to</li> <li>What is going to work on initially</li> <li>LinkedIn link</li> </ul> </li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html#the_first_day","title":"The First Day!","text":""},{"location":"onboarding/all.onboarding_checklist.reference.html#team_member_info","title":"Team Member Info","text":"<ul> <li> <p>[ ] Team member: send the following information to your team leader</p> <ul> <li>Full name:</li> <li>Aka:</li> <li>Personal email:</li> <li>Github user:</li> <li>Laptop OS: Windows, Linux, or Mac</li> <li>Physical location and timezone</li> <li>User's SSH public key</li> </ul> </li> <li> <p>[ ] Team member: Set a profile picture where your face is clearly visible,             and use your @mention name as your display name on GitHub and other             communication channels.</p> </li> <li> <p>[ ] Team leader: update the             Team member info gdoc</p> </li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html#nda","title":"NDA","text":"<ul> <li> <p>[ ] HR: send the team member an NDA to sign             NDAs Development Team</p> </li> <li> <p>[ ] Team member: send back signed copy of the NDA</p> </li> <li>[ ] HR: store in             signed directory</li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html#hubstaff","title":"Hubstaff","text":"<ul> <li> <p>[ ] HR: Update Hubstaff</p> <ul> <li>Add user here</li> <li>We respect our own privacy by not using any of the screenshot or typing     things BS</li> <li>We use it only to track the time automatically and as HR</li> </ul> </li> <li> <p>[ ] Team member:</p> <ul> <li>Confirm access to Hubstaff</li> <li>Read     Instructions for Hubstaff</li> </ul> </li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html#it_setup","title":"IT Setup","text":"<ul> <li> <p>[ ] Team leader: File an issue with this checklist</p> <ul> <li>The title is \"Onboarding {{Name}}\"</li> <li>Copy-and-paste the whole checklist starting from here</li> </ul> </li> <li> <p>[ ] IT: create account info bundle following             New team member addition - admin side tutorial</p> <ul> <li>TODO(Shayan): convert this into Markdown</li> </ul> </li> <li> <p>[ ] IT: send the following information to team member</p> <ul> <li>Linux user: name + first letter of last name</li> <li>Send the account info bundle</li> </ul> </li> <li> <p>[ ] IT: create company email <code>@causify.ai</code></p> <ul> <li>Exchange username and password</li> </ul> </li> <li> <p>[ ] IT: Add team member to mailing lists</p> <ul> <li><code>all@causify.ai</code> mailing lists<ul> <li>https://groups.google.com/my-groups</li> <li>https://admin.google.com/ac/groups/01qoc8b13iwic0z/info</li> </ul> </li> </ul> </li> <li> <p>[ ] Team member: Confirm receipt of emails to <code>all@</code>/<code>eng@</code></p> </li> <li> <p>[ ] IT: Add the team member to the company's Slack workspace</p> </li> <li> <p>[ ] Team member: Confirm access to the company's Slack workspace</p> </li> <li> <p>[ ] Team member: Confirm monthly all-hands meeting (usually on Monday             morning)</p> <ul> <li>This happens automatically through <code>all@causify.ai</code></li> <li>https://calendar.google.com/calendar/u/0/r</li> </ul> </li> <li> <p>[ ] Team member: Confirm access to the Google Drive documentation</p> <ul> <li>This should be automatically granted as being in <code>all@causify.ai</code></li> <li>Tech</li> <li>Process</li> </ul> </li> <li> <p>[ ] Team member: Set up the laptop to connect to the server following             VPN and dev server access setup instructions</p> </li> <li> <p>[ ] Team member: Configure your server environment following             Development setup instructions</p> </li> <li> <p>[ ] Team member (On per-need basis): We have implemented a             self-registration process for our Airflow on Kubernetes deployment. Please             register and create your personal accounts as we will no longer be using             the shared Airflow Admin user. Make sure to use the same username that you             have on the dev servers.</p> <ul> <li>Airflow - Registration</li> <li>TODO(Shayan): Update this</li> </ul> </li> <li> <p>[ ] IT: Add team member to all GitHub repos:</p> <ul> <li>[ ] kaizenflow</li> <li>[ ] helpers</li> <li>[ ] tutorials</li> <li>[ ] cmamp</li> <li>[ ] orange (On per-need basis)</li> <li>[ ] UMD_data605 (On per-need             basis)</li> </ul> </li> <li> <p>[ ] Team member: Confirm access to GitHub repos</p> </li> <li> <p>[ ] IT: Server set-up</p> <ul> <li>We use the personal laptop as a thin client only to connect to the servers,     where the work is typically carried out. We don't check out code on our     laptop</li> </ul> </li> <li> <p>[ ] IT: Create the Linux user on all the servers</p> <ul> <li>Create a keypair and share it with the new team member</li> </ul> </li> <li> <p>[ ] Team member: Check whether he / she can log in on one of the servers</p> <ul> <li>TODO(Shayan): How?</li> </ul> </li> <li> <p>[ ] IT: Create AWS UI credentials</p> <ul> <li>Only if necessary, for developer just starting, this is usually not needed     (CK login)</li> </ul> </li> <li> <p>[ ] Team member: check access to AWS on the server</p> <ul> <li><code>&gt; aws s3 --profile ck ls s3://cryptokaizen-unit-test/</code></li> <li><code>&gt; aws s3 --profile ck ls s3://cryptokaizen-data/</code></li> </ul> </li> <li> <p>[ ] Team member: Add your photo to the Slack and GitHub accounts</p> <ul> <li>Please use the same photo in all accounts with a recognizable Gravatar</li> <li>We use the picture to select Issues and conversations</li> <li>Please use a picture where you look somehow professional (e.g., not a     picture of you on the beach taking Tequila shots): the best picture is just     one of your face, so we can virtually get to know each other</li> </ul> </li> <li> <p>[ ] Team member: Make sure you have access to the             OOTO / Vacation calendar</p> <ul> <li>The link should be accessible and you should see the calendar in the list of     calendars at calendar.google.com (when accessing via your corporate email)</li> </ul> </li> <li> <p>[ ] Team member: Add your usual working hours by going to             calendar.google.com (using your corporate email), heading to the settings             section by clicking the gear icon on top right</p> <ul> <li></li> </ul> </li> <li> <p>[ ] Team member: Confirm you can access the anonymous form to ask anything             https://forms.gle/KMQgobqbyxhoTR9n6</p> </li> <li> <p>[ ] Team member: File your first Issue on GitHub</p> <ul> <li>It should be called \"Document review while onboarding $TEAM_MEMBER\"</li> <li>Track what is not clear in the onboarding process / documentation and what     should / could be improved</li> </ul> </li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html#quick_checklists_to_verify_that_everything_works","title":"Quick Checklists to Verify That Everything Works","text":"<ul> <li>Team member<ul> <li>[ ] VPN to dev server</li> <li>[ ] ssh into the dev server</li> <li>[ ] Check access to AWS on the server (refer to instructions above)</li> <li>[ ] Clone the code from Git</li> <li>[ ] Connect to server with VisualStudio Code or PyCharm<ul> <li>There is an extension for VSCode, which allows to develop remotely     Remote - SSH</li> <li>Follow     this instruction     on how to set it up in your Visual Studio Code</li> </ul> </li> <li>[ ] Run the unit tests and make sure they all pass</li> <li>[ ] Run a docker container     <pre><code>&gt; i docker_bash\n</code></pre></li> <li>[ ] Run a jupyter notebook<ul> <li>Follow     this instruction     on how to access the Jupyter server running on the remote server through     your local machine <pre><code>&gt; i docker_jupyter\n</code></pre></li> </ul> </li> </ul> </li> </ul>"},{"location":"onboarding/all.onboarding_checklist.reference.html#the_second_day","title":"The Second Day","text":"<ul> <li> <p>[ ] Team member: carefully study all the documents in             the must-read list</p> <ul> <li>[ ] General rules of collaboration</li> <li>[ ] Coding style guide</li> <li>[ ] How to write unit tests</li> <li>[ ] How to run unit tests</li> <li>[ ] Creating a Jupyter Notebook</li> <li>[ ] What to do before opening a PR</li> <li>[ ] Code review process</li> <li>[ ] Git workflows and best practices</li> <li>[ ] GitHub organization</li> <li>[ ] Tips for writing documentation</li> <li>They will help you get up to speed with our practices and development style</li> <li>Read them carefully one by one</li> <li>Ask questions</li> <li>Memorize / internalize all the information</li> <li>Take notes</li> <li>Mark the reading as done</li> <li>Use your first Issue to document all the improvements to the documentation</li> </ul> </li> <li> <p>[ ] Team member: Do PRs following the process to improve documentation</p> <ul> <li>Do not be shy</li> </ul> </li> <li> <p>[ ] Team member: exercise all the important parts of the systems</p> <ul> <li>[ ] Create a GitHub issue</li> <li>[ ] Check out and pull the latest version of the code on the server</li> <li>[ ] Create a branch</li> <li>[ ] Run regressions on the server (<code>i run_fast_tests</code>)</li> <li>[ ] Start a Docker container on the server (<code>i docker_bash</code>)</li> <li>[ ] Start a Jupyter server (<code>i docker_jupyter</code>) from the server</li> <li>[ ] Run Linter on the server (<code>i lint --files=\"...\"</code>)</li> <li>[ ] Do a PR</li> </ul> </li> </ul>"},{"location":"onboarding/all.organize_email.how_to_guide.html","title":"All.organize email.how to guide","text":""},{"location":"onboarding/all.organize_email.how_to_guide.html#organize_email","title":"Organize Email","text":""},{"location":"onboarding/all.organize_email.how_to_guide.html#email","title":"Email","text":""},{"location":"onboarding/all.organize_email.how_to_guide.html#mailing_lists","title":"Mailing lists","text":"<ul> <li><code>all@</code> is the mailing list with everybody at the company</li> <li><code>contributors@</code> is the mailing list with every open-source contributor/intern</li> </ul>"},{"location":"onboarding/all.organize_email.how_to_guide.html#organizing_email_flow","title":"Organizing email flow","text":"<ul> <li>We receive tons of emails, and the inflow is going to keep increasing<ul> <li>At a large company you can get 10k emails per day (no kidding)</li> </ul> </li> <li>The goal is to read all the emails and always be on top of it</li> <li>How can one do that?<ul> <li>As usual the answer is get organized</li> <li>Filter emails in folders</li> <li>Separate emails in folders based on the action that they require (e.g.,     ignore, just read and be aware of it, read and respond)</li> <li>Read email and decide what to do about each of it:<ul> <li>No reply needed</li> <li>Reply right away</li> <li>Follow up later (e.g., to read, reply, think about it)</li> </ul> </li> <li>Use flags to distinguish what needs to be followed up later or if you are     waiting for a response</li> </ul> </li> <li>A possible organization in folders is:<ul> <li>GitHub<ul> <li>Commits in all the repos (be aware of it)</li> <li>Issue updates (read and respond)</li> <li>PRs</li> <li>Commits directly to <code>master</code> (read and review)</li> <li>Commits into <code>documents</code> dir of <code>master</code> (read and review)</li> <li>Emails generated by my GH activities (ignore and mark as read)</li> </ul> </li> <li>Asana<ul> <li>Daily activities assigned report</li> <li>New comment/activity</li> <li>New task assignment</li> </ul> </li> </ul> </li> </ul>"},{"location":"onboarding/all.organize_email.how_to_guide.html#anatomy_of_email_messages_from_infra","title":"Anatomy of email messages from infra","text":"<ul> <li>The goal is to classify emails so that we can filter email effectively</li> </ul>"},{"location":"onboarding/all.organize_email.how_to_guide.html#filtering_emails_with_gmail","title":"Filtering emails with Gmail","text":"<ul> <li>Personally (GP) I prefer an email client (Mozilla Thunderbird and more     recently Apple Mail) rather than using Gmail web interface<ul> <li>People are able to use it</li> </ul> </li> <li>Personally I prefer to use filters on the Gmail (server) side<ul> <li>Pros<ul> <li>I don't get emails on my cell phone continuously</li> <li>The emails are organized as they arrive</li> <li>Folders are on the server side, so my client can simply sync</li> </ul> </li> <li>Cons<ul> <li>The Gmail interface for filtering emails is horrible</li> </ul> </li> </ul> </li> <li>The web interface is     https://mail.google.com/mail/u/0/#settings/filters</li> <li>Note that Gmail distinguish different email accounts using different indices,     e.g.,     https://mail.google.com/mail/u//#inbox"},{"location":"onboarding/all.organize_email.how_to_guide.html#notifications_from_github","title":"Notifications from GitHub","text":"<ul> <li>https://help.github.com/en/categories/receiving-notifications-about-activity-on-github</li> </ul>"},{"location":"onboarding/all.organize_email.how_to_guide.html#github_pull_requests","title":"GitHub pull requests","text":"<ul> <li> <p>These emails look like:</p> <pre><code>        Samarth KaPatel &lt;notifications@github.com&gt;\n        to cryptokaizen/orange, Subscribed\n\n        cryptokaizen/cmamp#4765\n        - Refactoring amp_path on orange\n        - PR in cmamp - cryptokaizen/cmamp#4788\n        ________________________________________________________________\n\n        You can view, comment on, or merge this pull request online at:\n        https://github.com/cryptokaizen/orange/pull/411\n\n        Commit Summary\n        - B2b4940 orange fix\n        - 850b2b2 amp\n\n        File Changes (2 files)\n        - M amp (2)\n        - M dataflow_orange/system/Cx/test/test_master_pnl_real_time_observer_notebook.py (5)\n\n        Patch Links:\n        - Https://github.com/cryptokaizen/orange/pull/411.patch\n        - Https://github.com/cryptokaizen/orange/pull/411.diff\n</code></pre> </li> <li> <p>These emails have the words: \"You can view, comment on, or merge this pull     request online at:\" in the body of the email</p> </li> </ul>"},{"location":"onboarding/all.organize_email.how_to_guide.html#github_issue_activity","title":"GitHub issue activity","text":"<ul> <li> <p>These emails look like:</p> <pre><code>        Samarth KaPatel &lt;notifications@github.com&gt;\n        to Review, kaizen-ai/kaizenflow\n\n        @samarth9008 requested your review on: #436 Update Signing_up_for_Kaizenflow.md.\n        __\n        Reply to this email directly, view it on GitHub, or unsubscribe.\n        You are receiving this because your review was requested.\n</code></pre> <p>or:</p> <pre><code>        Grigorii Pomazkin &lt;notifications@github.com&gt;\n        to cryptokaizen/cmamp, Mention\n\n        @PomazkinG commented on this pull request.\n        ________________________________________________________________________\n\n        In helpers/lib_tasks_pytest.py:\n\n        &gt; @@ -671,17 +671,25 @@ def run_coverage_report(  # type: ignore\n     :param aws_profile: the AWS profile to use for publishing HTML report\n     \"\"\"\n     # TODO(Grisha): allow user to specify which tests to run.\n     ...\n        obsolete, resolving\n        __\n        Reply to this email directly, view it on GitHub, or unsubscribe.\n        You are receiving this because you were mentioned.\n</code></pre> </li> <li> <p>These emails can be recognized by the fact that have the words \"You are     receiving this because\" in the email body</p> </li> </ul>"},{"location":"onboarding/all.organize_email.how_to_guide.html#commits","title":"Commits","text":"<ul> <li> <p>These emails look like:</p> <pre><code>        Grigorii Pomazkin &lt;notifications@github.com&gt;\n        to cryptokaizen/cmamp, Push\n\n        @PomazkinG pushed 1 commit.\n        - 65496bb Merge branch 'master' into CmTask4707_fix_coverage_test\n        __\n        View it on GitHub or unsubscribe.\n        You are receiving this because you are subscribed to this thread.\n</code></pre> </li> <li> <p>These emails can be recognized by the fact that have the words \"pushed commit\"     in the email body</p> </li> </ul>"},{"location":"onboarding/all.organize_email.how_to_guide.html#gdocs","title":"Gdocs","text":"<ul> <li>These emails have <code>comments-noreply@docs.google.com</code> or (Google Docs) in the     \"subject\" field</li> </ul>"},{"location":"onboarding/all.organize_email.how_to_guide.html#todo_emails","title":"TODO emails","text":"<ul> <li>These emails have TODO in the subject</li> </ul>"},{"location":"onboarding/all.organize_email.how_to_guide.html#asana","title":"Asana","text":"<ul> <li>These emails are received from <code>no-reply@asana.com</code> address</li> <li>These emails may contain:<ul> <li>List of tasks assigned to you for today</li> <li>New activities in the tasks assigned to you</li> <li>New task assignment</li> </ul> </li> </ul>"},{"location":"onboarding/all.receive_crypto_payment.how_to_guide.html","title":"All.receive crypto payment.how to guide","text":""},{"location":"onboarding/all.receive_crypto_payment.how_to_guide.html#receive_crypto_payment","title":"Receive Crypto Payment","text":""},{"location":"onboarding/all.receive_crypto_payment.how_to_guide.html#choose_a_crypto_wallet_type","title":"Choose a crypto wallet type","text":"<ul> <li>Https://academy.binance.com/en/articles/crypto-wallet-types-explained</li> <li>Https://www.blockchain-council.org/blockchain/types-of-crypto-wallets-explained/</li> </ul>"},{"location":"onboarding/all.receive_crypto_payment.how_to_guide.html#public_private_keys","title":"Public / private keys","text":"<p>See the explanation here</p> <p>TLDR:</p> <ul> <li>Send a public key to receive a transaction, see it as a wallet address</li> <li>Private key is needed to prove ownership or spend the funds associated with     your public address, see it as a password</li> </ul>"},{"location":"onboarding/all.receive_crypto_payment.how_to_guide.html#what_do_people_in_the_team_use","title":"What do people in the team use","text":""},{"location":"onboarding/all.receive_crypto_payment.how_to_guide.html#beginner","title":"Beginner","text":"<p>Mobile / desktop hot wallet Exodus</p> <p>Pros:</p> <ul> <li>Easy to set up</li> <li>Has a mobile app which is easy to use</li> <li>Built-in exchange (e.g., allows to exchange BTC to ETH inside the app)</li> <li>Allows to sell crypto and receive fiat money to a bank account via the app,     see     here</li> <li>Customer support</li> </ul> <p>Cons:</p> <ul> <li>A swap may include a     spread</li> <li>As any hot wallet is vulnerable to hackers attacks<ul> <li>It is not recommended to store significant amount of money</li> </ul> </li> </ul>"},{"location":"onboarding/all.receive_crypto_payment.how_to_guide.html#advanced","title":"Advanced","text":"<p>If you are experienced and / or own a lot of crypto you might want to have a cold wallet on your laptop, holding the bulk of your bitcoin and transfer among different website on-line wallets.</p> <p>https://bitcoin.org/en/choose-your-wallet</p>"},{"location":"onboarding/all.receive_crypto_payment.how_to_guide.html#choose_a_crypto_currency_to_receive_money_in","title":"Choose a crypto currency to receive money in","text":"<ul> <li>One can either receive a payment in BTC or in one of the Stablecoins (USDT is     a preference)</li> <li>People in the team prefer to use Stablecoins since Stablecoins pursue price     stability</li> </ul>"},{"location":"onboarding/all.receive_crypto_payment.how_to_guide.html#send_a_crypto_wallet_address","title":"Send a crypto wallet address","text":"<p>Send your crypto wallet address to GP together with an invoice via email. E.g., <pre><code>Hi GP,\n\nPlease find my invoice for the period [a, b] attached. I would like to receive the money in USDT ERC20.\n\nMy crypto wallet address is: 0x5ce3d650703f745B9C0cf20E322204b00bF59205\n</code></pre></p>"},{"location":"onboarding/all.receive_crypto_payment.how_to_guide.html#do_a_test_transfer","title":"Do a test transfer","text":"<p>For the first time GP sends a test transfer (e.g., 100$) just to confirm that a wallet address provided works.</p> <p>After a wallet address is \"verified\" send the full amount (exluding the test transfer amount).</p>"},{"location":"onboarding/all.receive_crypto_payment.how_to_guide.html#cash_out_crypto","title":"Cash out crypto","text":""},{"location":"onboarding/all.receive_crypto_payment.how_to_guide.html#bank_account","title":"Bank account","text":"<p>There are some 3rd party services that buy crypto money from you and send fiat money to your bank account</p> <p>E.g.,</p> <ul> <li>Built-in Exodus crypto withdrawal service</li> <li>Coinbase cash out serivce</li> <li>Binance P2P</li> </ul>"},{"location":"onboarding/all.receive_crypto_payment.how_to_guide.html#cash","title":"Cash","text":"<p>There are some crypto ATMs in the USA, see here</p>"},{"location":"onboarding/all.track_time_with_hubstaff.how_to_guide.html","title":"All.track time with hubstaff.how to guide","text":""},{"location":"onboarding/all.track_time_with_hubstaff.how_to_guide.html#track_time_with_hubstaff","title":"Track Time With Hubstaff","text":""},{"location":"onboarding/all.track_time_with_hubstaff.how_to_guide.html#hubstaff","title":"Hubstaff","text":""},{"location":"onboarding/all.track_time_with_hubstaff.how_to_guide.html#general","title":"General","text":"<ul> <li>Hubstaff is a tool for remote working that automates:<ul> <li>Time tracking</li> <li>Invoice creation</li> <li>Payment</li> </ul> </li> <li>The goal is to use Hubstaff for automatically getting paid for the worked hours.</li> </ul>"},{"location":"onboarding/all.track_time_with_hubstaff.how_to_guide.html#time_tracking","title":"Time Tracking","text":""},{"location":"onboarding/all.track_time_with_hubstaff.how_to_guide.html#privacy","title":"Privacy","text":"<ul> <li>We have decided to turn off the feature of taking screenshots of the laptop as     proof-as-work, URL, and app tracking.<ul> <li></li> </ul> </li> <li>Although this seems to be standard practice for remote teams (e.g., it's     default for UpWork), we don't believe in surveilling people, rather we prefer     to assume that people do the right thing (until proven wrong, of course).<ul> <li></li> <li></li> </ul> </li> <li>We left enabled \"the keyboard and mouse activity\" since this is used to     automatically track the worked time. The tool does not store what you type,     only if you type as a proxy for \"working\".<ul> <li>     We let people decide if they want to monitor the usage of programs or not.     Some people like it (I do since it gives an insight on which program I spend     my time)</li> <li></li> </ul> </li> <li>You can change your mind over time.</li> </ul>"},{"location":"onboarding/all.track_time_with_hubstaff.how_to_guide.html#tracking_time_automatically","title":"Tracking time automatically","text":"<ul> <li>You can use the desktop App<ul> <li>I prefer this since it's completely automated</li> <li>For Linux (Ubuntu) follow this     guide</li> </ul> </li> <li>Both options update the time information to Hubstaff automatically.<ul> <li></li> <li></li> </ul> </li> <li>See     https://hubstaff.com/how-tracking-works</li> </ul>"},{"location":"onboarding/all.track_time_with_hubstaff.how_to_guide.html#tracking_time_manually","title":"Tracking time manually","text":"<ul> <li>You can track time using the     Google Chrome extension:<ul> <li>Chrome Time Tracking - Hubstaff Time Tracker</li> <li>Start the timer when you start the work</li> <li>Stop the timer when the work is paused</li> </ul> </li> </ul>"},{"location":"onboarding/all.track_time_with_hubstaff.how_to_guide.html#overriding_time_tracking","title":"Overriding time tracking","text":"<ul> <li>In case you forgot to turn on the timer or you are tracking time manually, go     to<ul> <li>     and fill the timesheet for the past day</li> <li></li> </ul> </li> <li>See the     official guide     for a lot of details</li> </ul>"},{"location":"onboarding/bounty.onboarding_checklist.reference.html","title":"Bounty.onboarding checklist.reference","text":""},{"location":"onboarding/bounty.onboarding_checklist.reference.html#bounty_hunters_onboarding","title":"Bounty hunters onboarding","text":""},{"location":"onboarding/bounty.onboarding_checklist.reference.html#checklist","title":"Checklist","text":"<ul> <li> <p>Source:     <code>bounty.onboarding_checklist.reference.md</code></p> </li> <li> <p>[ ] Contributor: Clone the repos</p> <ul> <li>[ ] helpers</li> <li>[ ] tutorials</li> </ul> </li> <li>[ ] Contributor: Set up the development environment following instructions             in             <code>intern.set_up_development_on_laptop.how_to_guide.md</code></li> <li>[ ] Contributor: Carefully study all the documents in the must-read list:<ul> <li>[ ] Carefully study all the documents in             the must-read list</li> <li>[ ] General rules of collaboration</li> <li>[ ] Coding style guide</li> <li>[ ] How to write unit tests</li> <li>[ ] How to run unit tests</li> <li>[ ] Creating a Jupyter Notebook</li> <li>[ ] What to do before opening a PR</li> <li>[ ] Code review process</li> <li>[ ] Git workflows and best practices</li> <li>[ ] GitHub organization</li> <li>[ ] Tips for writing documentation</li> <li>They will help you get up to speed with our practices and development style</li> <li>Read them carefully one by one</li> <li>Ask questions</li> <li>Memorize / internalize all the information</li> <li>Take notes</li> <li>Mark the reading as done</li> <li>Open a GH issue/PR to propose improvements to the documentation</li> </ul> </li> </ul>"},{"location":"onboarding/bounty.onboarding_checklist.reference.html#final_checks","title":"Final checks","text":"<ul> <li>[ ] Contributor: Exercise all the important parts of the systems<ul> <li>[ ] Check out and pull the latest version of the repo code</li> <li>[ ] Create a branch</li> <li>[ ] Run regressions (<code>i run_fast_tests</code>)</li> <li>[ ] Run Linter (<code>i lint --files=\"...\"</code>)</li> <li>[ ] Start a Docker container (<code>i docker_bash</code>)</li> <li>[ ] Start a Jupyter server (<code>i docker_jupyter</code>)</li> </ul> </li> </ul>"},{"location":"onboarding/bounty.onboarding_checklist.reference.html#instructions","title":"Instructions","text":""},{"location":"onboarding/bounty.onboarding_checklist.reference.html#general_organization","title":"General organization","text":"<ul> <li>All the collaboration happens on GitHub as a typical open-source project</li> <li>The bounties are published in a     Gdoc with specs<ul> <li>We are going to be adding more and more bounties depending on the demand</li> </ul> </li> <li>There is a     sign-up sheet     for the bounties<ul> <li>There can be at most 2 people working on each bounty</li> <li>If 2 people are working on the same bounty, they are competing with each     other<ul> <li>You get paid only if you do the task better than the other person</li> </ul> </li> <li>At some point (e.g., the task is close to being done) we reserve the right     to make the bounty \"locked\", meaning that other people can no longer take it     on</li> </ul> </li> <li>There will be minimal interaction from us<ul> <li>In general we don't answer questions, contributors need to figure things out     themselves</li> <li>If they believe there is a genuine bug somewhere in the codebase, they     should<ul> <li>Check the existing issues in case this bug has already been reported</li> <li>If not, file an issue with a proper report and ideally propose a fix too</li> </ul> </li> </ul> </li> <li>If a contributor succeeds, we pay the bounty $XYZ as a bank transfer or in     Tether<ul> <li>If both sides agree, the contributor gets a paid internship / RA / TA</li> <li>We then on-board the contributors as part of our team and dedicate our time     to train them</li> </ul> </li> </ul>"},{"location":"onboarding/bounty.onboarding_checklist.reference.html#working_on_a_bounty","title":"Working on a bounty","text":"<ul> <li>Take time to peruse the description of the bounty<ul> <li>No need to rush, there is always time and work to do</li> </ul> </li> <li>Before any implementation, the contributor should create an issue for the task     and post a detailed plan of action there<ul> <li>By default the contributor is then free to proceed according to their plan     (implement, file a PR)</li> <li>We reserve the right to review and propose changes at any point</li> </ul> </li> <li>For each bounty, the contributor should spend ~1 hour looking for a package or     already existing solutions on GitHub<ul> <li>One should report the findings even if nothing has been found (e.g.,     explaining how the search was done)</li> <li>It's totally ok (and actually recommended) to re-use packages and other     people's work to get stuff done</li> <li>If you find an implementation of the bounty in the wild, congrats, you made     money with very little work</li> </ul> </li> <li>All code needs to be written using our coding style<ul> <li>See <code>code_template.py</code>,     coding style doc,     examples of good code</li> <li>We provide our Linter and our AI code-styler / reviewer (once available) to     help with formatting and style fixes</li> </ul> </li> <li>All code needs to be unit tested according to our     standards and infrastructure</li> <li>The project needs to be documented in the way we     document software</li> <li>To get used to our process, for the first couple of PRs post the     PR checklist     in a comment and check the boxes when the requirements are met</li> </ul>"},{"location":"onboarding/intern.onboarding_checklist.reference.html","title":"Intern.onboarding checklist.reference","text":""},{"location":"onboarding/intern.onboarding_checklist.reference.html#intern_onboarding_checklist","title":"Intern onboarding checklist","text":""},{"location":"onboarding/intern.onboarding_checklist.reference.html#intern_onboarding_vs_full_onboarding","title":"Intern onboarding vs. full onboarding","text":"<ul> <li>The onboarding process documented here is intended for people who have not     become permanent members of the team yet, i.e., interns</li> <li>Upon completing this onboarding, the intern will be able to develop in our     common environment, open GitHub issues and PRs, use our extensive coding     toolchain</li> <li>However, some of the steps of the     full onboarding process     (like creating a company email) are postponed until the intern \"graduates\" to     a permanent position</li> </ul>"},{"location":"onboarding/intern.onboarding_checklist.reference.html#checklist","title":"Checklist","text":"<ul> <li>Source:     <code>intern.onboarding_checklist.reference.md</code></li> </ul>"},{"location":"onboarding/intern.onboarding_checklist.reference.html#org","title":"Org","text":"<ul> <li> <p>[ ] HiringMeister: File an issue with this checklist</p> <ul> <li>The title is \"Onboarding {{Name}}\"</li> <li>Copy-and-paste the whole checklist starting from here</li> <li>The issue should be assigned to the intern</li> </ul> </li> <li> <p>[ ] Intern: Join the Telegram channel -             https://t.me/+DXZXsWoEHR1mNWIx</p> </li> <li> <p>[ ] HiringMeister: Establish contact by email or Telegram with the intern             with a few words about the next steps</p> </li> <li> <p>[ ] Intern: Post your laptop's OS (Windows, Linux, Mac) in the comments of             this issue</p> <ul> <li>Our dev environment is only adapted for Linux and Mac. Windows users have to     install dual boot or a VM with Linux (Ubuntu)</li> </ul> </li> <li> <p>[ ] Intern: Confirm access to the public GH repos</p> <ul> <li>[ ] helpers</li> <li>[ ] tutorials</li> </ul> </li> <li> <p>[ ] HiringMeister: Give the intern write access to the current             Intern-focused project on GH</p> </li> <li> <p>[ ] IT: @Shayawnn Add the intern to the mailing group             <code>contributors@causify.ai</code> so that they can send             morning TODO emails</p> <ul> <li>The intern's personal e-mail address can be found in the corresponding Asana     task in the     Hiring project</li> </ul> </li> <li> <p>[ ] HiringMeister: Update the             Access Tracker             spreadsheet</p> <ul> <li>Put \"Yes\" in the columns that the intern now has access to</li> </ul> </li> </ul>"},{"location":"onboarding/intern.onboarding_checklist.reference.html#it_setup","title":"IT setup","text":"<ul> <li>[ ] Intern: Set up the development environment following instructions in             <code>intern.set_up_development_on_laptop.how_to_guide.md</code><ul> <li>We expect the intern to independently solve all the problems they encounter     through trial and error, googling and ChatGPT-ing</li> <li>If you cannot solve some problem no matter how hard you try:<ul> <li>Check if the problem has already been reported and discussed in one of the     existing issues</li> <li>If not, create a new issue and provide a full report<ul> <li>Describe your problem in detail, including the full context to reproduce     (e.g., copy-and-paste the command you ran and the output you got; do not     use screenshots)</li> <li>Describe what you have already tried to fix it and what was the result</li> <li>Tag the hiring team</li> </ul> </li> </ul> </li> <li>After the problem is resolved, then, if applicable, do a PR to fix the bug /     add a description of the problem and the solution to the docs</li> <li>See also     <code>Collaboration for problem solving</code></li> </ul> </li> </ul>"},{"location":"onboarding/intern.onboarding_checklist.reference.html#must-read","title":"Must-read","text":"<ul> <li>[ ] Intern: Carefully study all the documents in             the must-read list<ul> <li>[ ] General rules of collaboration</li> <li>[ ] Coding style guide</li> <li>[ ] How to write unit tests</li> <li>[ ] How to run unit tests</li> <li>[ ] Creating a Jupyter Notebook</li> <li>[ ] What to do before opening a PR</li> <li>[ ] Code review process</li> <li>[ ] Git workflows and best practices</li> <li>[ ] GitHub organization</li> <li>[ ] Tips for writing documentation</li> <li>They will help you get up to speed with our practices and development style</li> <li>Read them carefully one by one</li> <li>Ask questions</li> <li>Memorize / internalize all the information</li> <li>Take notes</li> <li>Mark the reading as done</li> <li>Open a GH issue/PR to propose improvements to the documentation</li> </ul> </li> </ul>"},{"location":"onboarding/intern.onboarding_checklist.reference.html#final_checks","title":"Final checks","text":"<ul> <li>[ ] Intern: Exercise all the important parts of the systems<ul> <li>[ ] Create a GitHub issue</li> <li>[ ] Check out and pull the latest version of the repo code</li> <li>[ ] Create a branch</li> <li>[ ] Run regressions (<code>i run_fast_tests</code>)</li> <li>[ ] Run Linter (<code>i lint --files=\"...\"</code>)</li> <li>[ ] Start a Docker container (<code>i docker_bash</code>)</li> <li>[ ] Start a Jupyter server (<code>i docker_jupyter</code>)</li> <li>[ ] Do a PR</li> </ul> </li> <li>Tip: a good approach to the \"final checks\" is to perform all the steps     (opening an issue, creating a branch, filing a PR) for something very small     but useful -- like fixing a typo in the docs.</li> <li>To get used to our process, for the first couple of PRs post the     PR checklist     in a comment and check the boxes when the requirements are met</li> </ul>"},{"location":"onboarding/intern.prepare_for_development.how_to_guide.html","title":"Intern.prepare for development.how to guide","text":""},{"location":"onboarding/intern.prepare_for_development.how_to_guide.html#prepare_for_development_in_kaizenflow","title":"Prepare for development in KaizenFlow","text":""},{"location":"onboarding/intern.prepare_for_development.how_to_guide.html#introduction","title":"Introduction","text":"<p>This document outlines the steps to take in order to start contributing to KaizenFlow. Documenting this set up, we aim to streamline the information flow and make the contribution process seamless by creating a collaborative and efficient coding environment for all contributors.</p> <p>Happy coding!</p>"},{"location":"onboarding/intern.prepare_for_development.how_to_guide.html#technologies_used","title":"Technologies used","text":"<ul> <li>UMD DATA605 Big Data Systems     contains     lectures and     tutorials     about most of the technologies we use in KaizenFlow, e.g., Dask, Docker,     Docker Compose, Git, github, Jupyter, MongoDB, Pandas, Postgres, Apache Spark</li> <li>You can go through the lectures and tutorials on a per-need basis, depending     on what it's useful for you to develop</li> <li>As an additional resource to become proficient in using Linux and shell, you     can refer to     The Missing Semester of Your CS Education</li> </ul>"},{"location":"onboarding/intern.prepare_for_development.how_to_guide.html#set_up_the_dev_environment","title":"Set up the dev environment","text":"<ul> <li>Set up the development environment following the instructions in     <code>intern.set_up_development_on_laptop.how_to_guide.md</code></li> </ul>"},{"location":"onboarding/intern.prepare_for_development.how_to_guide.html#coding_style","title":"Coding style","text":"<ul> <li>Adopt the coding style outlined     here</li> <li>Internalize the guidelines to maintain code consistency</li> </ul>"},{"location":"onboarding/intern.prepare_for_development.how_to_guide.html#linter","title":"Linter","text":"<ul> <li>Linter is in charge of reformatting the code according to our conventions and     reporting potential problems</li> </ul>"},{"location":"onboarding/intern.prepare_for_development.how_to_guide.html#run_linter_and_check_results","title":"Run Linter and check results","text":"<ul> <li> <p>Run Linter on the changed files in the PR branch</p> <pre><code>&gt; i lint --files=\"file1 file2...\"\n</code></pre> </li> <li> <p>More information about Linter can be found     here</p> </li> </ul>"},{"location":"onboarding/intern.prepare_for_development.how_to_guide.html#writing_and_contributing_code","title":"Writing and contributing code","text":"<ul> <li>If needed, always start with creating an issue first, providing a summary of     what you want to implement and assign it to yourself and your team</li> <li>Create a branch of your assigned issues/bugs<ul> <li>E.g., for a GitHub issue with the name: \"Expose Linter container to     KaizenFlow contributors #63\", The GitHub issue and the branch name should be     called <code>SorrTask63_Expose_linter_container_to_Kaizenflow_contributors</code></li> </ul> </li> <li>Implement the code based on the requirements in the assigned issue</li> <li>Run Linter on your code before pushing</li> <li>Do <code>git commit</code> and <code>git push</code> together so the latest changes are readily     visible</li> <li>Make sure your branch is up-to-date with the master branch</li> <li>Create a Pull Request (PR) from your branch</li> <li>Add your assigned reviewers for your PR so that they are informed of your PR</li> <li>After being reviewed, the PR will be merged to the master branch by your     reviewers</li> <li>Do not respond to emails for replies to comments in issues or PRs. Use the     GitHub GUI instead, as replying through email adds unwanted information</li> </ul>"},{"location":"onboarding/intern.running_causify_on_virtual_machine.how_to_guide.html","title":"Intern.running causify on virtual machine.how to guide","text":""},{"location":"onboarding/intern.running_causify_on_virtual_machine.how_to_guide.html#running_causify_on_virtual_machine_how-to-guide","title":"Running Causify On Virtual Machine How-to-Guide","text":""},{"location":"onboarding/intern.running_causify_on_virtual_machine.how_to_guide.html#step_1_download_vmware_workstation_pro","title":"Step 1: Download VMware Workstation Pro","text":"<ul> <li> <p>There are a lot of errors while setting up the Oracle VirtualBox, so it is     recommended to go ahead with VMWare Workstation Pro</p> </li> <li> <p>Go to the official     VMware Workstation and Fusion     page</p> </li> <li>Click on <code>Download Fusion or Workstation</code></li> <li>The user will be redirected to the Broadcom registration page.     Register and     Login yourself on the     website</li> <li>Once logged in, go to the     Downloads Homepage. Under     <code>My Downloads</code>, click on <code>Free Software Downloads available HERE</code></li> <li>Select <code>VMware Workstation Pro</code> and choose the latest release (or 17.6.3)</li> <li>Fill out few details and proceed to download</li> <li>Follow the installation prompts to set up VMware on the system</li> </ul>"},{"location":"onboarding/intern.running_causify_on_virtual_machine.how_to_guide.html#step_2_set_up_a_new_virtual_machine","title":"Step 2: Set Up a New Virtual Machine","text":"<ul> <li> <p>Before proceeding, ensure that you have downloaded the latest version or     Ubuntu (24.04.2 LTS) ISO file. It can be downloaded     here</p> </li> <li> <p>Open VMware Workstation Pro and click on <code>New Virtual Machine</code></p> </li> <li>Choose the <code>Typical (Recommended)</code> configuration</li> <li>Under the <code>Installer disc image file (iso)</code> option, browse and select the path     to your downloaded Ubuntu ISO file</li> <li>Set the disk size to 35GB and select <code>Store virtual disk as a single file</code><ul> <li>If you select <code>Split virtual disk into multiple files</code>, the 35GB will be     split, so you might need to allocate more space for your section in the     future but it works fine as well</li> </ul> </li> <li>Completing the setup will take you directly to the Ubuntu installation screen</li> </ul>"},{"location":"onboarding/intern.running_causify_on_virtual_machine.how_to_guide.html#step_3_install_ubuntu","title":"Step 3: Install Ubuntu","text":"<ul> <li>Choose <code>English</code> as your preferred language</li> <li>Select <code>Use wired connection</code>, even if you plan to use Wi-Fi</li> <li>Begin the installation and choose <code>Interactive Installation</code> option</li> <li>Proceed with the <code>Default Selection</code> during the installation</li> <li>Select both:<ul> <li><code>Install third-party software for graphics and Wi-Fi hardware</code></li> <li><code>Download and install support for additional media formats</code></li> </ul> </li> <li>Choose the <code>Erase disk and Install Ubuntu</code> option</li> <li> <p>Set up your <code>name</code>, <code>password</code>, and <code>timezone</code> as per your preferences</p> </li> <li> <p>In case the installation fails or asks to report the issue, simply restart the     virtual machine and repeat the process. It should work on the second try</p> </li> </ul>"},{"location":"onboarding/intern.running_causify_on_virtual_machine.how_to_guide.html#step_4_check_internet_connection","title":"Step 4: Check Internet Connection","text":"<ul> <li>Check your internet connection in the browser. If it works, you can skip this     section!</li> </ul>"},{"location":"onboarding/intern.running_causify_on_virtual_machine.how_to_guide.html#recommended_method","title":"Recommended Method","text":"<ul> <li>Shutdown the virtual machine</li> <li>In VMware Workstation, go to <code>Edit</code> in the top menu and select     <code>Virtual Network Editor</code></li> <li>Click <code>Change Settings</code> and ensure the following:<ul> <li><code>VMnet0</code>: Bridged</li> <li><code>VMnet1</code>: Host-only</li> <li><code>VMnet8</code>: NAT</li> <li>Both <code>VMnet1</code> and <code>VMnet8</code> should be connected and enabled</li> </ul> </li> <li>For <code>VMnet0</code>, set the <code>Bridged to: Automatic</code> option and click on     <code>Automatic Settings</code>. Uncheck all options except the one corresponding to your     Wi-Fi address (you can find it in your host system's <code>Network Connections</code>)     and apply the changes</li> </ul>"},{"location":"onboarding/intern.running_causify_on_virtual_machine.how_to_guide.html#alternative_1","title":"Alternative 1","text":"<ul> <li>Instead of using <code>Automatic</code> for Bridged, manually select your Wi-Fi network     from the dropdown list and apply the changes. Always restart the VM after any     modifications</li> </ul>"},{"location":"onboarding/intern.running_causify_on_virtual_machine.how_to_guide.html#alternative_2","title":"Alternative 2","text":"<ul> <li>Before starting the VM, go to <code>Network Adapter</code> under <code>Devices</code>, select     <code>Bridged</code>, and check the option <code>Replicate physical network connection state</code></li> <li>If it doesn't work, change to <code>NAT</code> and apply the settings. Restart the VM     after each change</li> </ul>"},{"location":"onboarding/intern.running_causify_on_virtual_machine.how_to_guide.html#conclusion","title":"Conclusion","text":"<ul> <li>After completing these steps, you should have VMware Workstation Pro running     Ubuntu with internet connectivity, ready to set up Docker</li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html","title":"Intern.set up development on laptop.how to guide","text":""},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#set_up_development_environment_locally","title":"Set up development environment locally","text":"<ul> <li>One only develops locally on their laptop during the intern stage. All     permanent members of the team should develop on our server. Interns will get     access to the server once they \"graduate\" to a permanent position.</li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#clone_the_code","title":"Clone the code","text":"<ul> <li> <p>To clone the repo, use the cloning command described in the official GitHub     documentation</p> </li> <li> <p>Example of the cloning command:</p> <p><pre><code>&gt; git clone --recursive git@github.com:causify-ai/{repo_name}.git ~/src/{repo_name}1\n</code></pre> - The previous command might not work sometimes, in which case try the     alternative command using HTTP instead of SSH:</p> <pre><code>&gt; git clone --recursive https://github.com/causify-ai/{repo_name}.git ~/src/{repo_name}1\n</code></pre> </li> <li> <p>All the source code should go under <code>~/src</code> (e.g., <code>/Users/&lt;YOUR_USER&gt;/src</code> on     a Mac)</p> </li> <li>The path to the local repo folder should look like this     <code>~/src/{REPO_NAME}{IDX}</code> where<ul> <li><code>REPO_NAME</code> is a name of the repository</li> <li>IDX is an integer</li> </ul> </li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#set_up_github_ssh_access_and_personal_access_token_pat","title":"Set up GitHub SSH access and personal access token (PAT)","text":"<ul> <li> <p>To generate a new SSH key, follow the official     GitHub instructions</p> </li> <li> <p>Ensure that you save the SSH key with the below name format and at the     specified location</p> <p>File location: <code>~/.ssh/id_rsa.causify-ai.github</code></p> <p>Example command to generate SSH key:</p> <pre><code>&gt; ssh-keygen -t ed25519 -C \"your_email@example.com\" -f ~/.ssh/id_rsa.causify-ai.github\n</code></pre> </li> <li> <p>To create a Personal Access Token (classic) with necessary scopes like <code>repo</code>,     <code>workflow</code>, etc., go to     https://github.com/settings/tokens and     click \"Generate new token (classic)\".</p> </li> <li> <p>After obtaining the token, store it in a file named     <code>github_pat.causify-ai.txt</code> at the specified path</p> <p>File location: <code>~/.ssh/github_pat.causify-ai.txt</code></p> <p>Example command to save using <code>vim</code>:</p> <pre><code>&gt; vim ~/.ssh/github_pat.causify-ai.txt\n</code></pre> </li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#build_and_activate_the_thin_environment","title":"Build and activate the thin environment","text":"<ul> <li> <p>Create the \"thin environment\" which contains the minimum set of dependencies     needed for running our Dev Docker container</p> </li> <li> <p>Build the thin environment; this is done once per client</p> <ul> <li> <p>If you are in the <code>helpers</code> repo:</p> <p><pre><code>&gt; ./dev_scripts_helpers/thin_client/build.py\n</code></pre>     - Otherwise:</p> <pre><code>&gt; cd helpers_root\n&gt; ./dev_scripts_helpers/thin_client/build.py\n</code></pre> </li> </ul> </li> <li> <p>While building the thin environment, the     GitHub CLI will also be installed system-wide</p> </li> <li> <p>NB! You can skip the rest of this section if you use tmux.</p> </li> <li> <p>Activate the thin environment; make sure it is always activated</p> <p><pre><code>&gt; source dev_scripts_{repo_name}/thin_client/setenv.sh\n</code></pre> - E.g.,</p> <pre><code>&gt; source dev_scripts_tutorials/thin_client/setenv.sh\n</code></pre> </li> <li> <p>If you see output like below, your environment is successfully built!     <pre><code>...\nalias sp='echo '\\''source ~/.profile'\\''; source ~/.profile'\nalias vi='/usr/bin/vi'\nalias vim='/usr/bin/vi'\nalias vimdiff='/usr/bin/vi -d'\nalias vip='vim -c \"source ~/.vimrc_priv\"'\nalias w='which'\n==&gt; SUCCESS &lt;==\n</code></pre></p> </li> <li>If you encounter any issues, please post them by creating a new issue on     GitHub and assign it to @gpsaggese<ul> <li>You should report as much information as possible: what was the command,     what is your platform, output of the command (copy-and-paste, do not use     screenshots)</li> </ul> </li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#install_and_test_docker","title":"Install and test Docker","text":""},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#supported_os","title":"Supported OS","text":"<ul> <li>Our systems support Mac (both x86 and Apple Silicon) and Linux Ubuntu</li> <li>For Linux Ubuntu, we actively test and support development on:<ul> <li>Operating System: Ubuntu 24.04 LTS</li> <li>Docker: v28</li> </ul> </li> <li>We do not support Windows and WSL: we have tried several times to port the     toolchain to it, but there are always subtle incompatible behaviors that drive     everyone crazy<ul> <li>If you are using Windows, we suggest to use dual boot with Linux or use a     virtual machine with Linux</li> <li>Install VMWare software</li> <li>Reference video for     installing Ubuntu on VMWare software</li> <li>Make sure you set up your git and github</li> <li>Install     docker     on your Ubuntu VM</li> </ul> </li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#install_docker","title":"Install Docker","text":"<ul> <li> <p>Get familiar with Docker if you are not, e.g.,     https://docs.docker.com/get-started/overview/</p> </li> <li> <p>We work in a Docker container that has all the required dependencies installed</p> <ul> <li>You can use PyCharm / VSCode on your laptop to edit code, but you want to     run code inside the dev container since this makes sure everyone is running     with the same system, and it makes it easy to share code and reproduce     problems</li> </ul> </li> <li> <p>Install Docker Desktop on your PC</p> <ul> <li>Links:<ul> <li>Mac</li> <li>Linux</li> </ul> </li> </ul> </li> <li> <p>Follow     https://docs.docker.com/engine/install/</p> </li> <li> <p>For Mac you can also install <code>docker-cli</code> without the GUI using</p> <pre><code>&gt; brew install docker\n&gt; brew link docker\n&gt; brew install colima\n</code></pre> </li> <li> <p>After installing, make sure Docker works on your laptop (of course the version     will be newer)</p> <p>```bash</p> <p>docker version Client:    Cloud integration: v1.0.24    Version:           20.10.17    API version:       1.41    Go version:        go1.17.11    Git commit:        100c701    Built:             Mon Jun  6 23:04:45 2022    OS/Arch:           darwin/amd64    Context:           default    Experimental:      true</p> <p>Server: Docker Desktop 4.10.1 (82475)    Engine:     Version:          20.10.17     API version:      1.41 (minimum version 1.12)     Go version:       go1.17.11     Git commit:       a89b842     Built:            Mon Jun  6 23:01:23 2022     OS/Arch:          linux/amd64     Experimental:     false    containerd:     Version:          1.6.6     GitCommit:        10c12954828e7c7c9b6e0ea9b0c02b01407d3ae1    runc:     Version:          1.1.2     GitCommit:        v1.1.2-0-ga916309    docker-init:     Version:          0.19.0     GitCommit:        de40ad0 ```</p> </li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#checking_docker_installation","title":"Checking Docker installation","text":"<ul> <li>Check the installation by running:     <pre><code>&gt; docker pull hello-world\nUsing default tag: latest\nlatest: Pulling from library/hello-world\nDigest: sha256:fc6cf906cbfa013e80938cdf0bb199fbdbb86d6e3e013783e5a766f50f5dbce0\nStatus: Image is up to date for hello-world:latest\ndocker.io/library/hello-world:latest\n</code></pre></li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#docker_installation_troubleshooting","title":"Docker installation troubleshooting","text":"<ul> <li>Common problems with Docker<ul> <li>Mac DNS problem, try step 5 from the     article     and repeat the cmd below:     <pre><code>&gt; docker pull hello-world\nError response from daemon: net/http: request canceled while waiting for connection (Client.Timeout exceeded while awaiting headers)\n</code></pre></li> <li>Linux sudo permission denied problem, see     here     for the solution     <pre><code>&gt; docker pull hello-world\nGot permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get   http://%2Fvar%2Frun%2Fdocker.sock/v1.40/containers/json: dial unix /var/run/docker.sock: connect: permission denied\n</code></pre></li> </ul> </li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#add_user_to_docker_group_and_sudoers","title":"Add user to Docker group and sudoers","text":"<ul> <li>This section only applies to Linux, macOS users can skip this. Docker Desktop     handles permissions automatically on Mac.</li> <li> <p>Add your user to the <code>docker</code> group to run Docker without <code>sudo</code></p> <p>```bash</p> <p>sudo usermod -aG docker $USER</p> </li> </ul> <p># Restart your shell session (log out and log back in), or run:</p> <p>newgrp docker     ```</p> <ul> <li>Add yourself to the sudoers file     <pre><code>&gt; sudo visudo\n</code></pre><ul> <li>Add this line to the file(replace <code>your_username</code>):     <pre><code>your_username ALL=(ALL) NOPASSWD:ALL\n</code></pre></li> </ul> </li> <li>You should see <code>docker</code> in the output     <pre><code>&gt; groups\nyour_username sudo ... docker\n</code></pre></li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#tmux","title":"Tmux","text":"<ul> <li> <p>Using tmux is optional but recommended</p> </li> <li> <p>The thin environment is activated     automatically within a tmux session. Ensure you have already run the     <code>/dev_scripts_helpers/thin_client/build.py</code>     command as outlined in the     thin environment setup</p> </li> <li> <p>Create a soft link. The command below will create a file <code>~/go_{repo_name}.py</code></p> <pre><code>&gt; dev_scripts_{repo_name}/thin_client/tmux.py --create_global_link\n</code></pre> </li> <li> <p>Create a tmux session. Choose <code>index</code> based on the dir name, e.g., <code>--index 1</code>     if the dir name is <code>~/src/tutorials1</code>.</p> <pre><code>&gt; dev_scripts_{repo_name}/thin_client/tmux.py --index 1\n</code></pre> </li> <li> <p>You need to create the tmux environment once per client and then you can     re-connect with:</p> <pre><code># Check the available environments.\n&gt; tmux ls\ntutorials1: 4 windows (created Fri Dec  3 18:27:09 2021) (attached)\n\n# Attach an environment.\n&gt; tmux attach -t tutorials1\n</code></pre> </li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#shell_support","title":"Shell support","text":"<ul> <li>We only support <code>bash</code>, no other shells like <code>zsh</code>, etc.</li> <li>We recommended that you make <code>bash</code> the default shell on your system, to avoid     possible compatibility issues</li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#set_up_aws_credentials","title":"Set up AWS credentials","text":"<ul> <li>NB! This section is only for interns/collaborators who have been assigned     tasks that require access to data on AWS S3</li> <li> <p>NB! Skip this section if you haven't been assigned an AWS user with us yet</p> </li> <li> <p>Create dir with proper permissions:</p> <pre><code>&gt; mkdir ~/.aws; chmod 700 ~/.aws\n</code></pre> </li> <li> <p>Place the following into <code>~/.aws/config</code>:</p> <pre><code>[profile ck]\nregion = eu-north-1\n</code></pre> </li> <li> <p>Place the following into <code>~/.aws/credentials</code> and populate the values with     your credentials:</p> <pre><code>[ck]\naws_access_key_id=***\naws_secret_access_key=***\n</code></pre> </li> <li> <p>Test access to the S3 bucket:     <pre><code>&gt; aws s3 ls s3://causify-data-collaborators --profile ck\n                                                    PRE causal_automl/\n</code></pre></p> </li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#some_useful_workflows","title":"Some useful workflows","text":"<ul> <li> <p>Check the installation by running:</p> <pre><code>&gt; docker pull hello-world\nUsing default tag: latest\n</code></pre> </li> <li> <p>Pull the latest image; this is done once</p> <pre><code>&gt; i docker_pull\n</code></pre> </li> <li> <p>Pull the latest <code>helpers</code> image containing Linter; this is done once</p> <pre><code>&gt; i docker_pull_helpers\n</code></pre> </li> <li> <p>Get the latest version of <code>master</code></p> <pre><code># To update your feature branch with the latest changes from master, run\n# the cmd below from a feature branch, i.e. not from master.\n&gt; i git_merge_master\n# If you are on `master`, just pull the remote changes.\n&gt; i git_pull\n</code></pre> </li> <li> <p>Run Linter</p> <pre><code>&gt; i lint --files=\"dir1/file1.py dir2/file2.py\"\n</code></pre> </li> <li> <p>Start a Docker container</p> <pre><code>&gt; i docker_bash\n</code></pre> </li> <li> <p>You can ignore all the warnings that do not prevent you from running the     tests, e.g.,</p> <pre><code>WARNING: The AM_AWS_ACCESS_KEY_ID variable is not set. Defaulting to a blank string.\nWARNING: The AM_AWS_DEFAULT_REGION variable is not set. Defaulting to a blank string.\nWARNING: The AM_AWS_SECRET_ACCESS_KEY variable is not set. Defaulting to a blank string.\nWARNING: The AM_FORCE_TEST_FAIL variable is not set. Defaulting to a blank string.\nWARNING: The CK_AWS_ACCESS_KEY_ID variable is not set. Defaulting to a blank string.\nWARNING: The CK_AWS_DEFAULT_REGION variable is not set. Defaulting to a blank string.\nWARNING: The CK_AWS_SECRET_ACCESS_KEY variable is not set. Defaulting to a blank string.\nWARNING: The CK_TELEGRAM_TOKEN variable is not set. Defaulting to a blank string.\n-----------------------------------------------------------------------------\nThis code is not in sync with the container:\ncode_version='1.4.1' != container_version='1.4.0'\n-----------------------------------------------------------------------------\nYou need to:\n- merge origin/master into your branch with `invoke git_merge_master`\n- pull the latest container with `invoke docker_pull`\n</code></pre> </li> <li> <p>If you are prompted to enter sudo password, do not enter anything and press     Ctrl-C to resolve</p> <pre><code>WARN  hserver.py _raise_invalid_host:342   Don't recognize host: host_os_name=Linux, am_host_os_name=None\n[sudo] password for ubuntu:\n</code></pre> </li> <li> <p>Start a Jupyter server</p> <pre><code>&gt; i docker_jupyter\n</code></pre> </li> <li> <p>To open a Jupyter notebook in a local web-browser:</p> <ul> <li>In the output from the cmd above find an assigned port, e.g.,     <pre><code>[I 14:52:26.824 NotebookApp] http://0044e866de8d:10091/ -&gt; port is 10091\n</code></pre></li> <li>Add the port to the link like so: <code>http://localhost:10091/</code> or     <code>http://127.0.0.1:10091</code></li> <li>Copy-paste the link into a web-browser and update the page</li> </ul> </li> </ul>"},{"location":"onboarding/intern.set_up_development_on_laptop.how_to_guide.html#hack_use_a_local_container_if_needed","title":"Hack: use a local container if needed","text":"<ul> <li> <p>If the commands above do not work for you, then, as     a temporary workaround, you can run the commands in a local Docker container</p> </li> <li> <p>Build a local container (the version number is not that important but make     sure it follows the format of <code>NUM.NUM.NUM</code>)</p> </li> </ul> <pre><code>&gt; i docker_build_local_image --version 1.1.0\n</code></pre> <ul> <li>Run all the commands with the flags     <code>--stage local --version &lt;YOUR_VERSION_NUMBER&gt;</code>, e.g.:</li> </ul> <pre><code># Starting bash in a Docker container.\n&gt; i docker_bash --stage local --version 1.1.0\n# Starting a Jupyter server.\n&gt; i docker_jupyter --stage local --version 1.1.0\n# Running Linter.\n&gt; i lint --stage local --version 1.1.0 --files=\"dir1/file1.py dir2/file2.py\"\n</code></pre> <ul> <li>The hack is only there to unblock you and shouldn't be relied on forever. File     an issue to figure out why the commands don't work for you as-is</li> </ul>"},{"location":"onboarding/intern.signing_up.how_to_guide.html","title":"Intern.signing up.how to guide","text":""},{"location":"onboarding/intern.signing_up.how_to_guide.html#signing_up_to_the_project","title":"Signing up to the project","text":"<ul> <li> <p>Look around the repo and make sure that you are really interested in what we     are doing, and you have time to contribute</p> <ul> <li>Ponder on the IMPORTANT note about committing to contribute to the     project here</li> <li>Please fork, star, watch the KaizenFlow repo so that GitHub promotes our     repo (this will help us promote our effort)</li> </ul> </li> <li> <p>Fill out the     Contributor Info form.</p> <ul> <li>It's meant to just get basic contact info and technical skills about you</li> <li>Don't worry: by working with us, you will quickly become a coding machine</li> </ul> </li> <li> <p>Communication with the project teams happens through:</p> <ul> <li>GitHub on the repo like in any     open-source development</li> <li>Slack IM channel for higher bandwidth discussion</li> <li>Through the KaizenFlow mailing list</li> </ul> </li> <li> <p>Accept the invite from GitHub that we will send you</p> <ul> <li>Again please don't forget to fork, star, watch the KaizenFlow repo so that     GitHub promotes our repo</li> </ul> </li> <li> <p>Accept the invite to join the Google Drive that we will send you</p> </li> <li> <p>On-boarding Tasks</p> <ul> <li>Once the invitation is accepted, an issue will be created by the title     <code>On-board \\&lt;YOUR FIRST NAME LAST NAME\\&gt; Aka &lt;YOUR GITHUB_HANDLE&gt;</code>. If not     assinged, assign it to yourself and go through the particular checklist from     the issue one-by-one, marking each item as done when it's actually done.</li> </ul> </li> </ul>"},{"location":"tools/all.ai_review.how_to_guide.html","title":"All.ai review.how to guide","text":""},{"location":"tools/all.ai_review.how_to_guide.html#operations","title":"Operations","text":"<ul> <li> <p>There are several operations we want to perform using LLMs:</p> <ul> <li>Apply a transformation to a chunk of text<ul> <li>E.g., create a unit test</li> </ul> </li> <li>Create comments and lints in the form of a <code>cfile</code><ul> <li>E.g., lint or AI review based on certain criteria</li> </ul> </li> <li>Apply modifications from a <code>cfile</code> to a set of files<ul> <li>E.g., from linter and AI review</li> </ul> </li> <li>Add TODOs from a <code>cfile</code> to Python or markdown files</li> <li>Apply a set of transformations to an entire Python file<ul> <li>E.g., styling / formatting code</li> </ul> </li> <li>Rewrite an entire markdown to fix English mistakes without changing its     structure<ul> <li>E.g., styling / formatting a markdown</li> </ul> </li> </ul> </li> <li> <p>You should always commit your code before applying automatic transforms, in the     same way that we run the <code>linter</code> on a clean tree</p> <ul> <li>In this way, modifying a file is a separate commit and it's easy to review</li> </ul> </li> </ul>"},{"location":"tools/all.ai_review.how_to_guide.html#use_templates","title":"Use templates","text":"<ul> <li> <p>We use templates for code and documentation to show and describe how a document     or code should look like, e.g.,</p> <ul> <li><code>docs/ai_coding/code_template.py</code> shows our coding style</li> <li><code>docs/ai_coding/unit_test_template.py</code> shows how our unit tests look like</li> <li><code>all.how_to_guide_template_doc.md</code> shows how a Diataxis how to guide should     be structured and look like (same for <code>explanation</code>, <code>tutorial</code>, <code>reference</code>)</li> </ul> </li> <li> <p>The same templates can have multiple applications for:</p> <ul> <li>Humans:<ul> <li>Understand how to write documentation and code</li> <li>As boilerplate<ul> <li>E.g., \"copy the template and customize it to achieve a certain goal\"</li> </ul> </li> </ul> </li> <li>LLMs:<ul> <li>As reference style to apply transforms</li> <li>To report violations of coding styles</li> <li>As boilerplate<ul> <li>E.g., \"explain this piece of code using this template\"</li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/all.ai_review.how_to_guide.html#tools","title":"Tools","text":""},{"location":"tools/all.ai_review.how_to_guide.html#llm_transformpy","title":"<code>llm_transform.py</code>","text":"<ul> <li> <p>There are several classes of transforms:</p> <ul> <li><code>code_*</code>: transform Python code<ul> <li><code>code_fix_*</code>: fix a specific chunk of code according to a prompt</li> <li><code>code_transform_*</code>: apply a series of transformations</li> <li><code>code_write_*</code>: write from scratch</li> </ul> </li> <li><code>latex_*</code>: process Latex code</li> <li><code>md_*</code>: process markdown <code>md</code> text and <code>txt</code> notes</li> <li><code>review_*</code>: process Python code to extract reviews</li> <li><code>scratch_*</code>: misc and one-off transforms</li> <li><code>slide_*</code>: process markdown slides in <code>txt</code> format</li> <li><code>text_*</code>: process free form (not markdown) text</li> </ul> </li> <li> <p>You can list the available transformations with:</p> <pre><code>&gt; llm_transform.py -p list\n# Available prompt tags:\ncode_fix_by_using_f_strings\ncode_fix_by_using_perc_strings\ncode_fix_code\ncode_fix_comments\ncode_fix_complex_assignments\ncode_fix_docstrings\n...\n</code></pre> </li> </ul>"},{"location":"tools/all.ai_review.how_to_guide.html#transform_notespy","title":"<code>transform_notes.py</code>","text":"<ul> <li> <p>Some transformations don't need LLMs and are implemented as code</p> </li> <li> <p>You can see the available transforms with:</p> <pre><code>&gt; transform_notes.py -a list\ntest: compute the hash of a string to test the flow\nformat_headers: format the headers\nincrease_headers_level: increase the level of the headers\nmd_list_to_latex: convert a markdown list to a latex list\nmd_remove_formatting: remove the formatting\nmd_clean_up: clean up removing all weird characters\nmd_only_format: reflow the markdown\nmd_colorize_bold_text: colorize the bold text\nmd_format: reflow the markdown and colorize the bold text\n</code></pre> </li> </ul>"},{"location":"tools/all.ai_review.how_to_guide.html#ai_reviewpy","title":"<code>ai_review.py</code>","text":"<ul> <li>The rules for AI are saved in the file     ./docs/code_guidelines/all.coding_style_guidelines.reference.md</li> <li>This file has a special structure:     <pre><code>&gt; extract_toc_from_txt.py -i ./docs/code_guidelines/all.coding_style_guidelines.reference.md --max_level 2\n- All Style Guide\n    - Summary\n- General\n    - Spelling\n- Python\n    - Naming\n    - Docstrings\n    - Comments\n    - Code Implementation\n    - Code Design\n    - Imports\n    - Type Annotations\n    - Functions\n    - Scripts\n    - Logging\n    - Misc\n- Unit Tests\n    - Rules\n- Notebooks\n    - General\n    - Plotting\n    - Jupytext\n- Markdown\n    - General\n    - Headers\n    - Text\n</code></pre><ul> <li>The first level represents the target language (e.g. <code>General</code>, <code>Python</code>)</li> <li>The second level represents a rule topic (e.g., <code>Imports</code>, <code>Functions</code>)</li> <li>The third level represents instructions for an LLM vs Linter, since some     instructions:<ul> <li>Are easier to enforce by an LLM</li> <li>While others should be enforced by the <code>linter</code> (even if they are temporary not     enforced by the <code>linter</code> but by LLM or by humans)</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/all.ai_review.how_to_guide.html#inject_todospy","title":"<code>inject_todos.py</code>","text":""},{"location":"tools/all.ai_review.how_to_guide.html#apply_todospy","title":"<code>apply_todos.py</code>","text":""},{"location":"tools/all.ai_review.how_to_guide.html#some_typical_workflows","title":"Some typical workflows","text":""},{"location":"tools/all.ai_review.how_to_guide.html#a_transform_workflow","title":"A transform workflow","text":"<ul> <li>There are 3 types of transforms and review tasks<ul> <li><code>llm</code>: executed by an LLM since they are difficult to implement otherwise<ul> <li>E.g., \"apply this style to a certain file\"</li> </ul> </li> <li><code>linter_llm</code>: executed by an LLM for now to get something in place, even if     they should be moved to code / linter<ul> <li>E.g., mainly formatting tasks</li> </ul> </li> <li><code>linter</code>: executed by the Linter using code and regex</li> </ul> </li> </ul>"},{"location":"tools/all.ai_review.how_to_guide.html#an_editing_workflow","title":"An editing workflow","text":"<ul> <li>Use <code>llm_transform.py</code> to:<ul> <li>Edit files manually applying specific transformations to chunks of code</li> <li>Apply transforms to an entire file</li> <li>Read and apply a list of transforms (from a <code>cfile</code>) and apply them</li> <li>Format the style of a template to a file</li> </ul> </li> </ul>"},{"location":"tools/all.ai_review.how_to_guide.html#a_reviewer_workflow","title":"A reviewer workflow","text":"<ul> <li> <p>This workflow can be used by the author of the code directly or by a reviewer</p> <ul> <li>Initially, reviewers use these tools as part of dogfooding of the workflows</li> <li>The goal is to make these tools robust enough so that they can be used     directly by the author and potentially integrated in the <code>linter</code> flow     itself</li> </ul> </li> <li> <p>Go to the Git branch with the code to review</p> </li> <li> <p>Check which files are modified</p> <pre><code>&gt; invoke git_branch_diff_with -t base --only-print-files\n</code></pre> </li> <li> <p>Run <code>ai_review.py</code> on each file to generate a list of comments on the code</p> <ul> <li>This is equivalent to running a <code>review</code> target with <code>llm_transform.py</code>     (e.g., <code>llm_transform.py -p review_*</code>) but it is a separated flow for     clarify</li> <li>It generates a <code>cfile</code> with a list of comments</li> </ul> </li> <li> <p>Review the TODOs using cfile to jump around files:</p> <p><pre><code>&gt; vim -c \"cfile cfile\"\n</code></pre> - You can fix the code according to the TODOs directly - Discard a TODO as a false positive or not important</p> </li> <li> <p>Run <code>inject_todos.py</code> to add TODOs to the files for someone (human or LLM)     else to fix it later</p> <ul> <li>E.g., in a code review you want to ask the author to perform that task</li> </ul> </li> <li> <p>Run <code>apply_todos.py</code> to automatically apply the TODOs using an LLM</p> <ul> <li>This can be a risky move</li> </ul> </li> </ul>"},{"location":"tools/all.ai_review.how_to_guide.html#example","title":"Example","text":"<ul> <li> <p>There are multiple targets for the <code>ai_review.py</code></p> <pre><code># Specify the target prompt for ai_review.py.\n&gt; PROMPT=review_llm\n&gt; PROMPT=review_correctness\n&gt; PROMPT=review_linter\n&gt; PROMPT=review_architecture\n\n# Specify the target file.\n&gt; FILE=dev_scripts_helpers/github/dockerized_sync_gh_repo_settings.py\n</code></pre> </li> <li> <p>Run the <code>ai_review.py</code> tool:     <pre><code># Run.\n&gt; ai_review.py -i $FILE -p $PROMPT\n</code></pre></p> </li> <li> <p>Sometimes you want to edit the tools in a different client while running it on     a different client:     <pre><code># To copy all the reviewer code.\n&gt; \\cp -f /Users/saggese/src/helpers1/helpers/lib_tasks_lint.py helpers &amp;&amp; \\\n    i lint_sync_code &amp;&amp; ai_review.py -i $FILE -p $PROMPT\n</code></pre></p> </li> <li> <p>Review and apply the changes:     <pre><code>&gt; vi -c \"cfile cfile\"\n\n&gt; inject_todos.py --cfile cfile\n\n&gt; llm_transform.py -i $FILE -p code_fix_code\n</code></pre></p> </li> </ul>"},{"location":"tools/all.ai_review.how_to_guide.html#how_to_improve_the_reviewing_tools_while_reviewing","title":"How to improve the reviewing tools while reviewing","text":"<ul> <li> <p>Problem: we often want to improve one of our tools (e.g., <code>linter.py</code>,     <code>ai_review.py</code>) while reviewing somebody's else code</p> </li> <li> <p>There are two use cases</p> <ol> <li>When the code to review is in a different repo than <code>//helpers</code></li> <li>Solution:</li> <li>Create a branch in <code>//helpers</code></li> <li>Modify the code for the tools in place</li> <li>When the code to review is in the repo <code>//helpers</code></li> <li>Solution:</li> <li>Use a different Git client to develop and edit the tools</li> <li>Automatically copy <code>linter.py</code> / <code>ai_review.py</code> code from the client we      are developing in to the one we are reviewing      <pre><code>&gt; \\cp -f /Users/saggese/src/helpers1/helpers/lib_tasks_lint.py helpers &amp;&amp; i lint_sync_code\n</code></pre></li> <li>Run the tools in the different client</li> <li>Before committing the review, we then revert the      <code>linter.py / ai_review.py</code> code      <pre><code>&gt; i lint_sync_code -r\n</code></pre></li> </ol> </li> </ul>"},{"location":"tools/all.bfg_repo_cleaner.how_to_guide.html","title":"All.bfg repo cleaner.how to guide","text":""},{"location":"tools/all.bfg_repo_cleaner.how_to_guide.html#bfg_repo-cleaner","title":"BFG Repo-Cleaner","text":"<p>BFG dockerized.</p>"},{"location":"tools/all.bfg_repo_cleaner.how_to_guide.html#build","title":"Build","text":"<pre><code>docker build . --tag bfg\n</code></pre>"},{"location":"tools/all.bfg_repo_cleaner.how_to_guide.html#usage","title":"Usage","text":"<p>You could run BFG in a container by executing the following <code>docker</code> command.</p> <pre><code>docker run -it --rm \\\n    --volume \"$PWD:/home/bfg/workspace\" \\\n    koenrh/bfg \\\n    --delete-files id_rsa\n</code></pre> <p>You could make this command more easily accessible by putting it in an executable, and make sure that it is available in your <code>$PATH</code>. Alternatively, you could create wrapper functions for your <code>docker run</code> commands (example).</p> <pre><code>bfg() {\n    docker run -it --rm \\\n        --volume \"$PWD:/home/bfg/workspace\" \\\n        --name bfg \\\n        koenrh/bfg \"$@\"\n}\n</code></pre>"},{"location":"tools/all.chatgpt_api.how_to_guide.html","title":"All.chatgpt api.how to guide","text":""},{"location":"tools/all.chatgpt_api.how_to_guide.html#chatgpt_api","title":"Chatgpt Api","text":""},{"location":"tools/all.chatgpt_api.how_to_guide.html#openai_assistant_runner_manager","title":"OpenAI Assistant Runner &amp; Manager","text":""},{"location":"tools/all.chatgpt_api.how_to_guide.html#what_is_openai_assistant","title":"What is OpenAI Assistant","text":"<ul> <li>An assistant is similar to a modified GPT that has mastered some knowledge and     is able to use that knowledge for future tasks</li> <li> <p>The official OpenAI documentation is at     https://platform.openai.com/docs/assistants/overview</p> </li> <li> <p>Normally you \"chat\" with ChatGPT, that means anything you send to it is     treated as input</p> </li> <li>GPT will forget what you previously said or files uploaded as the total length     of the conversation grows</li> <li>By creating an Assistant, you build a new \"instance\" of ChatGPT and can give     it some knowledge to learn</li> <li>This knowledge can be in many formats and up to 20 files (512MB each) at a     time</li> <li>With an instruction string, you define its behavior about how it should make     use of those knowledge</li> <li>When talking to an assistant, you can still add files in the message</li> <li>These files does not count towards its 20 files' knowledge limit, as they are     considered as input and will be forgotten eventually</li> </ul>"},{"location":"tools/all.chatgpt_api.how_to_guide.html#general_pattern","title":"General pattern","text":"<ul> <li>Creation:<ul> <li>Send some guideline or example files for one type of task to the Assistant     itself as knowledge</li> <li>Send an instruction about how it should deal with tasks using those     knowledge</li> </ul> </li> <li>Running:<ul> <li>Whenever a specific task comes, send the task and its data files in the     message as input</li> <li>Let the assistant solve the task based on the knowledge it learned</li> <li>It will forget everything in this task, and be ready for the next task like     this one never happens</li> </ul> </li> <li>Chatting:<ul> <li>You can continue the conversation if you are not satisfied with its reply</li> <li>Chatting is not yet implemented in our code, since command line scripts     cannot save conversations.</li> </ul> </li> </ul>"},{"location":"tools/all.chatgpt_api.how_to_guide.html#code_organization","title":"Code organization","text":"<ul> <li> <p>Libraries are under <code>helpers</code>, e.g.,</p> <ul> <li><code>helpers/hchatgpt.py</code></li> <li><code>helpers/hchatgpt_instructions.py</code></li> </ul> </li> <li> <p>Scripts are under <code>dev_scripts/chatgpt</code>, e.g.,</p> <ul> <li><code>dev_scripts/chatgpt/manage_chatgpt_assistant.py</code></li> <li><code>dev_scripts/chatgpt/run_chatgpt.py</code></li> </ul> </li> </ul>"},{"location":"tools/all.chatgpt_api.how_to_guide.html#how_to_use","title":"How to use","text":"<ul> <li>Add the API KEY     <pre><code>&gt; export OPENAI_API_KEY=&lt;your secret key&gt;\n</code></pre></li> <li>Each API key can be bound to an OpenAI Organization</li> <li>Assistants are organization-wide, an assistant created under our Org can be     accessed by any API key that belongs to our Org</li> </ul>"},{"location":"tools/all.chatgpt_api.how_to_guide.html#assistant_manager","title":"Assistant Manager","text":"<ul> <li> <p>The interface is like:</p> <pre><code>&gt; manage_chatgpt_assistant.py -h\nManage the ChatGPT Assistants in our OpenAI Organization\n\noptional arguments:\n    -h, --help            show this help message and exit\n    --create CREATE_NAME  Name of the assistant to be created\n    --edit EDIT_NAME      Name of the assistant to be edited\n    --delete DELETE_NAME  Name of the assistant to be deleted, will ignore all other arguments\n    --new_name NEW_NAME   New name for the assistant, only used in -e\n    --model MODEL         Model used by the assistant\n    --instruction_name INSTRUCTION_NAME\n                                                Name of the instruction for the assistant, as shown in helpers.hchatgpt_instructions\n    --input_files [INPUT_FILE_PATHS ...]\n                                                Files needed for the assistant, use relative path from project root\n    --retrieval_tool, --no-retrieval_tool\n                                                Enable the retrieval tool. Use --no-r to disable\n    --code_tool, --no-code_tool\n                                                Enable the code_interpreter tool. Use --no-c to disable\n    --function FUNCTION   Apply certain function tool to the assistant, not implemented yet\n    -v {TRACE,DEBUG,INFO,WARNING,ERROR,CRITICAL}\n                                                Set the logging level\n</code></pre> </li> <li> <p>Use this script to create, modify, or delete an assistant in our Org</p> </li> <li>A set of instructions are in <code>helpers/hchatgpt_instructions.py</code></li> <li>Feel free to add more instructions for different tasks here</li> <li> <p>For better understanding, the name of an assistant created should be related     to its instruction name</p> </li> <li> <p>E.g., create a doc writer assistant with name <code>DocWriter-1</code> and use     <code>instruction=DocWriter</code> from <code>helpers/hchatgpt_instructions.py</code> <pre><code>&gt; manage_chatgpt_assistant.py \\\n        --create DocWriter-1 \\\n        --model \"gpt-4-1106-preview\" \\\n        --instruction_name DocWriter \\\n        --input_files docs/work_tools/all.bfg_repo_cleaner.how_to_guide.md docs/marketing/dropcontact.how_to_guide.md docs/coding/all.hplayback.how_to_guide.md \\\n        --retrieval_tool --code_tool\n</code></pre></p> </li> </ul>"},{"location":"tools/all.chatgpt_api.how_to_guide.html#running_assistant","title":"Running Assistant","text":"<ul> <li> <p>The script <code>dev_scripts/chatgpt/run_chatgpt.py</code> runs an assistant</p> </li> <li> <p>The interface is like:</p> <pre><code>&gt; run_chatgpt.py -h\nUse ChatGPT Assistant to process a file or certain text.\n\noptional arguments:\n    -h, --help            show this help message and exit\n    --list                Show all currently available assistants and exit\n    --assistant_name ASSISTANT_NAME\n                                                Name of the assistant to be used\n    --input_files [INPUT_FILE_PATHS ...]\n                                                Files needed in this run, use relative path from project root\n    --model MODEL         Use specific model for this run, overriding existing assistant config\n    --output_file OUTPUT_FILE\n                                                Redirect the output to the given file\n    --input_text INPUT_TEXT\n                                                Take a text input from command line as detailed instruction\n    --vim                 Disable -i (but not -o), take input from stdin and output to stdout forcely\n    -v {TRACE,DEBUG,INFO,WARNING,ERROR,CRITICAL}\n                                                Set the logging level\n</code></pre> </li> <li> <p><code>dev_scripts/run_chatgpt.py -l</code> will show all the available assistants in our     Org.</p> </li> <li> <p>Refer to <code>helpers/hchatgpt_instructions.py</code> to see how they are instructed</p> <pre><code>&gt; python dev_scripts/chatgpt/run_chatgpt.py \\\n    -n MarkdownLinter \\ # Use the assistant \"MarkdownLinter\"\n    -f dev_scripts/chatgpt/example_data/corrupted_dropcontact.how_to_guide.md \\ # Give this corrupted markdown file\n    -o dev_scripts/chatgpt/example_data/gpt_linted_dropcontact.how_to_guide.md # Redirect its output to this file\n</code></pre> </li> </ul>"},{"location":"tools/all.chatgpt_api.how_to_guide.html#api_library","title":"API library","text":"<ul> <li><code>helpers/hchatgpt.py</code> provides methods that wrap and interact with OpenAI API</li> <li> <p>By using these methods, you can easily build an assistant and chat to it with     our files</p> </li> <li> <p>Key functionalities include:</p> <ul> <li>Uploading and removing files from OpenAI</li> <li>Adding and removing files for an assistant</li> <li>Creating threads and messages for user input</li> <li>Running threads with certain assistants</li> <li>End-to-end communication method between users and the assistant</li> </ul> </li> </ul>"},{"location":"tools/all.chatgpt_api.how_to_guide.html#usage","title":"Usage","text":"<p>The following snippets provide a basic overview of the code usage.</p>"},{"location":"tools/all.chatgpt_api.how_to_guide.html#file_structure","title":"File structure","text":"<ul> <li>Since OpenAI File manager does not hold folder structure, you use a cache     dictionary to save the relation between our file (with folder) and OpenAI File     IDs</li> <li>This dictionary will be constantly accessed and saved back to     <code>project_root/gpt_id.json</code></li> <li>If you find anything buggy, try deleting this cache file and rerun the code so     that it can be regenerated from scratch</li> </ul>"},{"location":"tools/all.chatgpt_api.how_to_guide.html#uploading_and_retrieving_files","title":"Uploading and retrieving Files","text":"<ul> <li> <p>To upload a file to OpenAI, which you can later attach to messages/assistants:</p> <p><code>python file_id = upload_to_gpt('path_to_your_file')</code></p> </li> <li> <p>If you want to retrieve a file that has been uploaded to OpenAI by its path or     ID:     <code>python file_object = get_gpt_file_from_path('path_to_your_file')</code>     or     <code>python file_object = get_gpt_file_from_id(file_id)</code></p> </li> </ul>"},{"location":"tools/all.chatgpt_api.how_to_guide.html#managing_assistants","title":"Managing Assistants","text":"<p>You can specify files an assistant should constantly use (like guidelines):</p> <pre><code>set_assistant_files_by_name('assistant_name', ['file_path_1', 'file_path_2'])\n</code></pre> <p>Add or remove specific files to/from an existing assistant by file paths or IDs:</p> <pre><code>add_files_to_assistant_by_name('assistant_name', ['new_file_path'])\ndelete_file_from_assistant_by_name('assistant_name', 'file_path_to_remove')\n</code></pre>"},{"location":"tools/all.chatgpt_api.how_to_guide.html#chatgpt_communication","title":"ChatGPT communication","text":"<ul> <li> <p>Create a thread and send a message, with or without attaching files:</p> <p><code>python thread_id = create_thread() message_id = create_message_on_thread_with_file_names(thread_id, 'Your message content', ['file_name_1'])</code></p> </li> <li> <p>Run a thread on an assistant to get the Assistant's response:     <code>python run_id = run_thread_on_assistant_by_name('assistant_name', thread_id) response_messages = wait_for_run_result(thread_id, run_id)</code></p> </li> </ul>"},{"location":"tools/all.chatgpt_api.how_to_guide.html#e2e_assistant_runner","title":"E2E assistant runner","text":"<ul> <li>Interact with an assistant conveniently with the <code>e2e_assistant_runner</code>     function</li> <li>This function can take user input, send it to the assistant, and manage file     attachments in one call:     ```python response = e2e_assistant_runner(         'assistant_name',         'Your question or statement here',         input_file_names=['file_name_1'])</li> </ul>"},{"location":"tools/all.chatgpt_api.how_to_guide.html#outputs_the_assistants_response","title":"Outputs the assistant's response.","text":"<p>print(response)     ```</p>"},{"location":"tools/all.code_coverage.how_to_guide.html","title":"All.code coverage.how to guide","text":""},{"location":"tools/all.code_coverage.how_to_guide.html#python_code_coverage","title":"Python Code Coverage","text":""},{"location":"tools/all.code_coverage.how_to_guide.html#overview","title":"Overview","text":"<ul> <li>Code coverage is a metric used to measure how much of your source code is     exercised during test execution</li> <li>In Python, combining <code>pytest</code> (a testing framework) with the <code>coverage</code> module     allows you to assess and improve the quality of your tests</li> </ul>"},{"location":"tools/all.code_coverage.how_to_guide.html#tools_required","title":"Tools Required","text":"<ul> <li>pytest: A framework for writing and running Python tests.</li> <li> <p>coverage.py: A tool to measure code coverage of Python programs.</p> </li> <li> <p>Install both using pip:     <pre><code>&gt; pip install pytest coverage pytest-cov\n</code></pre></p> </li> </ul>"},{"location":"tools/all.code_coverage.how_to_guide.html#basic_workflow","title":"Basic Workflow","text":"<ul> <li> <p>Assume you have a <code>test_math.py</code> containing unit tests:</p> <p>```python from my_module import add</p> </li> </ul> <p>def test_add():         assert add(2, 3) == 5     ```</p> <ul> <li>Run tests with coverage and collects coverage data:     <pre><code>&gt; pytest --cov=test_math.py\n</code></pre>     or     <pre><code>&gt; coverage run -m pytest\n</code></pre></li> <li> <p>The options for <code>pytest coverage</code> are:     <pre><code>coverage reporting with distributed testing support:\n    --cov=[SOURCE]        Path or package name to measure during execution (multi-\n                                                                                            allowed). Use --cov= to not do any source filtering and\n                                                                                            record everything.\n    --cov-reset           Reset cov sources accumulated in options so far.\n    --cov-report=TYPE     Type of report to generate: term, term-missing,\n                                                                                            annotate, html, xml, json, lcov (multi-allowed). term,\n                                                                                            term-missing may be followed by \":skip-covered\".\n                                                                                            annotate, html, xml, json and lcov may be followed by\n                                                                                            \":DEST\" where DEST specifies the output location. Use\n                                                                                            --cov-report= to not generate any output.\n    --cov-config=PATH     Config file for coverage. Default: .coveragerc\n    --no-cov-on-fail      Do not report coverage if test run fails. Default: False\n    --no-cov              Disable coverage report completely (useful for\n                                                                                            debuggers). Default: False\n    --cov-fail-under=MIN  Fail if the total coverage is less than MIN.\n    --cov-append          Do not delete coverage but append to current. Default:\n                                                                                            False\n    --cov-branch          Enable branch coverage.\n    --cov-precision=COV_PRECISION\n                                                                                            Override the reporting precision.\n    --cov-context=CONTEXT\n                                                                                            Dynamic contexts to use. \"test\" for now.\n</code></pre></p> </li> <li> <p>After running the tests, display a coverage summary in the terminal:</p> <pre><code>&gt; coverage report\n\nName           Stmts   Miss  Cover\n------------------------------\nmy_module.py      10      2    80%\n</code></pre> </li> <li> <p>To view a detailed coverage report in your browser:     <pre><code>&gt; coverage html\n</code></pre></p> </li> <li>This generates an htmlcov directory containing an index.html file you can open     in a browser     <pre><code>&gt; coverage --help\nCoverage.py, version 7.8.0 with C extension\nMeasure, collect, and report on code coverage in Python programs.\n\nusage: coverage &lt;command&gt; [options] [args]\n\nCommands:\n            annotate    Annotate source files with execution information.\n            combine     Combine a number of data files.\n            debug       Display information about the internals of coverage.py\n            erase       Erase previously collected coverage data.\n            help        Get help on using coverage.py.\n            html        Create an HTML report.\n            json        Create a JSON report of coverage results.\n            lcov        Create an LCOV report of coverage results.\n            report      Report coverage stats on modules.\n            run         Run a Python program and measure code execution.\n            xml         Create an XML report of coverage results.\n\nUse \"coverage help &lt;command&gt;\" for detailed help on any command.\nFull documentation is at https://coverage.readthedocs.io/en/7.8.0\n</code></pre></li> </ul>"},{"location":"tools/all.code_coverage.how_to_guide.html#use_examples","title":"Use Examples","text":"<ul> <li> <p>You want to measure the coverage of the codebase from a given unit tests     <pre><code>&gt; pytest helpers/test/test_hmarkdown*.py --cov 2&gt;&amp;1 | tee log.txt\n...\ncollected 117 items\n\nhelpers/test/test_hmarkdown.py::Test_header_list_to_vim_cfile1::test_get_header_list1 (0.00 s) PASSED [  0%]\nhelpers/test/test_hmarkdown.py::Test_header_list_to_markdown1::test_mode_headers1 (0.00 s) PASSED [  1%]\nhelpers/test/test_hmarkdown.py::Test_header_list_to_markdown1::test_mode_list1 (0.00 s) PASSED [  2%]\nhelpers/test/test_hmarkdown.py::Test_replace_fenced_blocks_with_tags1::test1 (0.00 s) PASSED [  3%]\n...\n\n================================ tests coverage ================================\n_______________ coverage: platform linux, python 3.12.3-final-0 ________________\n\nName                                     Stmts   Miss Branch BrPart  Cover\n--------------------------------------------------------------------------\n__init__.py                                  0      0      0      0   100%\nconftest.py                                 79     38     18      7    49%\nhelpers/__init__.py                          0      0      0      0   100%\nhelpers/hcoverage.py                        69     53     14      0    19%\nhelpers/hdbg.py                            394    267    136     23    29%\nhelpers/hdocker.py                         564    510    102      0     8%\nhelpers/henv.py                            216     92     46      4    50%\nhelpers/hgit.py                            573    491    130      0    12%\nhelpers/hintrospection.py                  125    102     48      0    13%\nhelpers/hio.py                             345    244    118     12    25%\n...\nhelpers/test/test_hmarkdown_bullets.py     132      0      2      0   100%\n--------------------------------------------------------------------------\nTOTAL                                     6956   3824   1700    168    41%\n</code></pre></p> </li> <li> <p>Generate the coverage for only certain target code (e.g.,     <code>helpers/hmarkdown*.py</code>)</p> <pre><code>&gt; coverage report --include=helpers/hmarkdown*.py\nName                                 Stmts   Miss Branch BrPart  Cover\n----------------------------------------------------------------------\nhelpers/hmarkdown.py                     9      0      0      0   100%\nhelpers/hmarkdown_bullets.py            91     24     42      5    68%\nhelpers/hmarkdown_coloring.py           60     19     16      2    62%\nhelpers/hmarkdown_comments.py           28     12     10      4    53%\nhelpers/hmarkdown_fenced_blocks.py      55      0     14      0   100%\nhelpers/hmarkdown_filtering.py          53     43      6      0    17%\nhelpers/hmarkdown_formatting.py        101     34     18      1    69%\nhelpers/hmarkdown_headers.py           226      6     88      7    96%\nhelpers/hmarkdown_rules.py             101     19     42      3    80%\nhelpers/hmarkdown_slides.py             52      2     16      4    91%\n----------------------------------------------------------------------\nTOTAL                                  776    159    252     26    78%\n</code></pre> </li> <li> <p>Generate the coverage sorted by % covered</p> <pre><code>&gt; coverage report --include=helpers/hmarkdown*.py --sort=cover\nName                                 Stmts   Miss Branch BrPart  Cover\n----------------------------------------------------------------------\nhelpers/hmarkdown_filtering.py          53     43      6      0    17%\nhelpers/hmarkdown_comments.py           28     12     10      4    53%\nhelpers/hmarkdown_coloring.py           60     19     16      2    62%\n...\nhelpers/hmarkdown.py                     9      0      0      0   100%\nhelpers/hmarkdown_fenced_blocks.py      55      0     14      0   100%\n----------------------------------------------------------------------\nTOTAL                                  776    159    252     26    78%\n</code></pre> </li> <li> <p>Analyze the coverage through browser:     <pre><code>&gt; coverage html --include=helpers/hmarkdown*.py\n&gt; open htmlcov/index.html\n</code></pre></p> </li> </ul>"},{"location":"tools/all.code_coverage_subprocess.how_to_guide.html","title":"All.code coverage subprocess.how to guide","text":""},{"location":"tools/all.code_coverage_subprocess.how_to_guide.html#enhanced_pytest_coverage_for_subprocesses_and_docker","title":"Enhanced Pytest Coverage for Subprocesses and Docker","text":""},{"location":"tools/all.code_coverage_subprocess.how_to_guide.html#overview","title":"Overview","text":"<p>This guide provides comprehensive test coverage for Python subprocesses and Dockerized applications using coverage hooks and parallel data collection.</p>"},{"location":"tools/all.code_coverage_subprocess.how_to_guide.html#quick_start","title":"Quick Start","text":"<p>For most use cases, use the automated invoke task:</p> <pre><code># Run Coverage for Entire Project\ninvoke run_coverage_subprocess\n\n# Run Coverage for Specific Directory\ninvoke run_coverage_subprocess --target-dir=dev_scripts_helpers/llms\n\n# Generate HTML Report\ninvoke run_coverage_subprocess --generate-html-report\n</code></pre> <p>This task automatically:</p> <ul> <li>Installs coverage hooks</li> <li>Sets up subprocess environment</li> <li>Runs all tests with coverage tracking</li> <li>Combines coverage data from all processes</li> <li>Generates reports (text, XML, and optionally HTML)</li> <li>Cleans up hooks when finished</li> </ul>"},{"location":"tools/all.code_coverage_subprocess.how_to_guide.html#manual_setup_advanced","title":"Manual Setup (Advanced)","text":""},{"location":"tools/all.code_coverage_subprocess.how_to_guide.html#prerequisites","title":"Prerequisites","text":"<ul> <li>Python project with pytest tests</li> <li><code>coverage</code>, <code>pytest</code>, <code>pytest-cov</code> packages</li> <li>Docker installed (if testing containerized code)</li> </ul>"},{"location":"tools/all.code_coverage_subprocess.how_to_guide.html#step_1_configure_coverage_for_parallel_execution","title":"Step 1: Configure Coverage for Parallel Execution","text":"<p>Update <code>.coveragerc</code> in project root:</p> <pre><code>[run]\nbranch = True\nparallel = True\nconcurrency = multiprocessing\nsigterm = True\n\n[paths]\nsource =\n        .\n        /app\n</code></pre>"},{"location":"tools/all.code_coverage_subprocess.how_to_guide.html#step_2_install_coverage_hooks","title":"Step 2: Install Coverage Hooks","text":"<pre><code>python -c \"import helpers.hcoverage as hcovera; hcovera.inject()\"\nexport COVERAGE_PROCESS_START=.coveragerc\n</code></pre>"},{"location":"tools/all.code_coverage_subprocess.how_to_guide.html#step_3_prepare_coverage_data_directory","title":"Step 3: Prepare Coverage Data Directory","text":"<pre><code>python3 -c \"import helpers.hcoverage as hcovera; hcovera.coverage_commands_subprocess()\"\n</code></pre>"},{"location":"tools/all.code_coverage_subprocess.how_to_guide.html#step_4_update_docker_containers_if_applicable","title":"Step 4: Update Docker Containers (If Applicable)","text":"<p>Containers built with <code>hdocker.build_container_image()</code> automatically include coverage support.</p> <p>For manual Docker setups, add to your Dockerfile:</p> <pre><code>RUN pip install --no-cache-dir coverage pytest pytest-cov\n\n# Create Coverage Data Directory with Proper Permissions.\nRUN mkdir -p /app/coverage_data &amp;&amp; chmod 777 /app/coverage_data\n\n# Setup Coverage Configuration.\nCOPY .coveragerc /app/coverage_data/.coveragerc\nENV COVERAGE_PROCESS_START=/app/coverage_data/.coveragerc\n\n# Create Coverage.Pth File for Automatic Startup.\n# This Ensures Coverage Tracking Starts Automatically When Python Runs.\nRUN python - &lt;&lt;PYCODE\nimport site, os\nsite_dir = site.getsitepackages()[0]\npth_file = os.path.join(site_dir, 'coverage.pth')\nwith open(pth_file, 'w') as f:\n        f.write('import coverage; coverage.process_startup()')\nPYCODE\n</code></pre>"},{"location":"tools/all.code_coverage_subprocess.how_to_guide.html#step_5_run_tests_with_coverage","title":"Step 5: Run Tests with Coverage","text":"<pre><code>coverage run --parallel-mode -m pytest your_test_file.py\n</code></pre>"},{"location":"tools/all.code_coverage_subprocess.how_to_guide.html#step_6_collect_and_merge_coverage_data","title":"Step 6: Collect and Merge Coverage Data","text":"<pre><code>python3 -c \"import helpers.hcoverage as hcovera; hcovera.coverage_combine()\"\n</code></pre>"},{"location":"tools/all.code_coverage_subprocess.how_to_guide.html#step_7_view_coverage_report","title":"Step 7: View Coverage Report","text":"<p>Generate text report:</p> <pre><code>coverage report\n</code></pre> <p>Generate HTML report:</p> <pre><code>coverage html\npython3 -m http.server --directory htmlcov 8000\n# Navigate to Http://Localhost:8000\n</code></pre>"},{"location":"tools/all.code_coverage_subprocess.reference.html","title":"All.code coverage subprocess.reference","text":""},{"location":"tools/all.code_coverage_subprocess.reference.html#coverage_subprocess_reference","title":"Coverage Subprocess Reference","text":""},{"location":"tools/all.code_coverage_subprocess.reference.html#invoke_task","title":"Invoke Task","text":"<pre><code>invoke run_coverage_subprocess [--target-dir=DIR] [--generate-html-report]\n</code></pre> <p>Parameters:</p> <ul> <li><code>target_dir</code>: Directory to measure coverage (default: \".\")</li> <li><code>generate_html_report</code>: Generate HTML coverage report (default: False)</li> </ul>"},{"location":"tools/all.code_coverage_subprocess.reference.html#configuration_options","title":"Configuration Options","text":"<p>Required in <code>.coveragerc</code>:</p> <pre><code>[run]\nparallel = True              # Enables separate coverage files\nconcurrency = multiprocessing # Handles concurrent processes\nsigterm = True               # Saves coverage data on termination\n\n[paths]\nsource =\n        .                        # Host path\n        /app                     # Container path\n</code></pre> <p>Environment variables:</p> <ul> <li><code>COVERAGE_PROCESS_START</code>: Points to <code>.coveragerc</code></li> <li><code>COVERAGE_FILE</code>: Specifies coverage data file location</li> </ul>"},{"location":"tools/all.code_coverage_subprocess.reference.html#function_reference","title":"Function Reference","text":"<p><code>hcoverage</code> module functions:</p> <ul> <li><code>inject()</code>: Installs coverage hooks in site-packages</li> <li><code>remove()</code>: Removes coverage hooks</li> <li><code>coverage_commands_subprocess()</code>: Prepares coverage data directory</li> <li><code>coverage_combine()</code>: Merges coverage data and generates reports</li> </ul>"},{"location":"tools/all.code_coverage_subprocess.reference.html#docker_integration","title":"Docker Integration","text":"<p>Containers built with <code>hdocker.build_container_image()</code> automatically include:</p> <ul> <li>Coverage tools installation</li> <li>Coverage data directory setup</li> <li>Hook installation</li> <li>Runtime environment variables</li> </ul> <p>Manual Docker setup requires:</p> <pre><code>RUN pip install --no-cache-dir coverage pytest pytest-cov\n\n# Create Coverage Data Directory with Proper Permissions.\nRUN mkdir -p /app/coverage_data &amp;&amp; chmod 777 /app/coverage_data\n\n# Setup Coverage Configuration.\nCOPY .coveragerc /app/coverage_data/.coveragerc\nENV COVERAGE_PROCESS_START=/app/coverage_data/.coveragerc\n\n# Create Coverage.Pth File for Automatic Startup.\n# This Ensures Coverage Tracking Starts Automatically When Python Runs.\nRUN python - &lt;&lt;PYCODE\nimport site, os\nsite_dir = site.getsitepackages()[0]\npth_file = os.path.join(site_dir, 'coverage.pth')\nwith open(pth_file, 'w') as f:\n        f.write('import coverage; coverage.process_startup()')\nPYCODE\n</code></pre>"},{"location":"tools/all.code_coverage_subprocess.reference.html#troubleshooting","title":"Troubleshooting","text":"<ul> <li>Missing Coverage Data: Check hooks with     <code>python -c \"import site; print(site.getsitepackages())\"</code>.</li> <li>Container Permissions: Ensure 777 permissions for coverage directory, 644 for     <code>.coveragerc</code>.</li> <li>Path Mapping Issues: Verify <code>[paths]</code> maps <code>/app</code> to <code>.</code> in <code>.coveragerc</code>.</li> </ul>"},{"location":"tools/all.code_review_tools.reference.html","title":"All.code review tools.reference","text":""},{"location":"tools/all.code_review_tools.reference.html#code_review_tools","title":"Code Review Tools","text":""},{"location":"tools/all.code_review_tools.reference.html#review_systems","title":"Review Systems","text":""},{"location":"tools/all.code_review_tools.reference.html#github_copilot_code_review","title":"Github Copilot Code Review","text":"<ul> <li> <p>Link:     https://docs.github.com/en/copilot/using-github-copilot/code-review/using-copilot-code-review</p> </li> <li> <p>Key Features:</p> <ul> <li>AI-generated review comments</li> <li>Suggestions for bug fixes and style improvements</li> <li>Context-aware feedback</li> </ul> </li> <li> <p>Usage / Integration</p> <ul> <li>Seamless integration within GitHub</li> <li>Works directly on PRs in the GitHub ecosystem</li> </ul> </li> <li> <p>Ease of Use</p> <ul> <li>Very easy for teams already on GitHub</li> <li>Minimal setup required</li> </ul> </li> </ul>"},{"location":"tools/all.code_review_tools.reference.html#graphitedev","title":"Graphite.dev","text":"<ul> <li> <p>Link:     https://graphite.dev/docs/code-review</p> </li> <li> <p>Key Features:</p> <ul> <li>Automated code review assistance</li> <li>Consistency and style checking</li> <li>Customizable rule sets</li> </ul> </li> <li> <p>Usage / Integration</p> <ul> <li>Integrates into CI/CD pipelines and possibly GitHub workflows</li> <li>Can be configured for team needs</li> </ul> </li> <li> <p>Ease of Use</p> <ul> <li>User-friendly dashboard</li> <li>Requires initial configuration to align with project-specific rules</li> </ul> </li> </ul>"},{"location":"tools/all.code_review_tools.reference.html#coderabbit","title":"CodeRabbit","text":"<ul> <li> <p>Link: https://docs.coderabbit.ai/</p> </li> <li> <p>Key Features:</p> <ul> <li>Advanced AI-driven code review</li> <li>Highly context-aware suggestions</li> <li>Focus on catching subtle issues and recommending optimizations</li> </ul> </li> <li> <p>Usage / Integration</p> <ul> <li>Early stage integrations with popular platforms (GitHub, Bitbucket, etc.)</li> <li>Designed for modern development workflows</li> </ul> </li> <li> <p>Ease of Use</p> <ul> <li>Modern UI and workflow</li> <li>May involve a learning curve as the product matures</li> </ul> </li> </ul>"},{"location":"tools/all.code_review_tools.reference.html#deepcode_now_integrated_with_snyk_code","title":"Deepcode (now integrated with Snyk Code)","text":"<ul> <li> <p>Link https://docs.snyk.io/</p> </li> <li> <p>Key Features:</p> <ul> <li>AI-powered static analysis</li> <li>Detects bugs, security issues, and anti-patterns</li> <li>Machine learning-based code analysis</li> </ul> </li> <li> <p>Usage / Integration</p> <ul> <li>Integrates with GitHub and other SCM platforms via Snyk Code</li> <li>Often used as part of a broader security/quality toolchain</li> </ul> </li> <li> <p>Ease of Use</p> <ul> <li>Integration may require initial setup within Snyk ecosystem</li> <li>Familiarity with Snyk platforms can help</li> </ul> </li> </ul>"},{"location":"tools/all.code_review_tools.reference.html#prices","title":"Prices","text":""},{"location":"tools/all.code_review_tools.reference.html#github_copilot_code_review_1","title":"Github Copilot Code Review","text":"<ul> <li> <p>Link:     https://docs.github.com/en/copilot/about-github-copilot/plans-for-github-copilot</p> </li> <li> <p>Cost per User:</p> <ul> <li>Pro: $10/month</li> <li>Pro+: $39/month</li> <li>Business: $19/month</li> <li>Enterprise: $39/month</li> </ul> </li> <li> <p>Cost for 10 Users:</p> <ul> <li>Pro: $100/month</li> <li>Pro+: $390/month</li> <li>Business: $190/month</li> <li>Enterprise: $390/month</li> </ul> </li> <li> <p>Cost for 20 Users:</p> <ul> <li>Pro: $200/month</li> <li>Pro+: $780/month</li> <li>Business: $380/month</li> <li>Enterprise: $780/month</li> </ul> </li> </ul>"},{"location":"tools/all.code_review_tools.reference.html#grapitedev","title":"Grapite.dev","text":"<ul> <li> <p>Link:     https://graphite.dev/docs/graphite-standard</p> </li> <li> <p>Cost per User:</p> <ul> <li>Annual Subscription: $25/month</li> <li>Monthly Subscription: $29/month</li> </ul> </li> <li> <p>Cost for 10 Users (Annual):</p> <ul> <li>Base (3 seats): $900/year</li> <li>Additional 7 seats: $2,100/year</li> <li>Total: \\(3,000/year (~\\)250/month)</li> </ul> </li> <li> <p>Cost for 20 Users (Annual):</p> <ul> <li>Base (3 seats): $900/year</li> <li>Additional 17 seats: $5,100/year</li> <li>Total: \\(6,000/year (~\\)500/month)</li> </ul> </li> <li> <p>Note: Graphite is free for personal repositories, teams with 10 or fewer     GitHub collaborators, open-source projects, and students/educators.</p> </li> </ul>"},{"location":"tools/all.code_review_tools.reference.html#coderabbit_1","title":"CodeRabbit","text":"<ul> <li> <p>Link: https://www.coderabbit.ai/pricing</p> </li> <li> <p>Cost per User:</p> <ul> <li>Lite: $12/month (billed annually) or $15/month</li> <li>Pro: $24/month (billed annually) or $30/month</li> </ul> </li> <li> <p>Cost for 10 Users:</p> <ul> <li>Lite (Annual): \\(1,440/year (~\\)120/month)</li> <li>Pro (Annual): \\(2,880/year (~\\)240/month)</li> </ul> </li> <li> <p>Cost for 20 Users:</p> <ul> <li>Lite (Annual): \\(2,880/year (~\\)240/month)</li> <li>Pro (Annual): \\(5,760/year (~\\)480/month)</li> </ul> </li> <li> <p>Note: CodeRabbit is free for open-source projects and offers a 14-day free     trial.</p> </li> </ul>"},{"location":"tools/all.code_review_tools.reference.html#takeaways","title":"Takeaways","text":""},{"location":"tools/all.code_review_tools.reference.html#core_needs","title":"Core Needs","text":"<ol> <li> <p>Automated Code Review vs. Code Generation         - GitHub Copilot is primarily an AI-assisted code generation tool             (though it also has a \"Code Review\" beta). Its strength lies in offering             real-time suggestions as you code.         - Graphite is focused on PR workflow optimization and automated checks,             helping streamline how pull requests are created, reviewed, and merged.         - Coderabbit is geared toward AI-based code review and analysis, aiming             to provide feedback on potential bugs, performance issues, and style             concerns.</p> </li> <li> <p>Integration with GitHub         - Copilot integrates directly within GitHub (especially if you're using             GitHub for everything).         - Graphite integrates well with GitHub but provides its own dashboard             and workflow enhancements. Coderabbit is newer but also targets GitHub             integration. You'll want to verify how mature their integration is and             whether it fits your team's workflows.</p> </li> <li> <p>Budget &amp; Licensing         - GitHub Copilot is priced per user per month. For 30\u201340 developers, the             cost scales linearly.         - Graphite and Coderabbit typically use a per-seat or tiered pricing             model as well.         - If you already have a GitHub Enterprise or Team plan, adding Copilot can             be straightforward. Graphite and Coderabbit would be additional monthly             expenses.</p> </li> </ol>"},{"location":"tools/all.code_review_tools.reference.html#strengths_and_weaknesses","title":"Strengths and Weaknesses","text":""},{"location":"tools/all.code_review_tools.reference.html#github_copilot","title":"Github Copilot","text":"<ul> <li> <p>Strengths</p> <ul> <li>Seamless integration if your team is already deeply invested in GitHub.</li> <li>Great for boosting productivity during coding (boilerplate, tests,     refactors).</li> <li>Provides a familiar in-IDE experience.</li> </ul> </li> <li> <p>Weaknesses</p> <ul> <li>The \"Copilot for Code Review\" feature is relatively new and may not offer     deep analysis compared to specialized tools.</li> <li>Can produce \"best guess\" suggestions that require human oversight.</li> </ul> </li> </ul>"},{"location":"tools/all.code_review_tools.reference.html#graphitedev_1","title":"Graphite.dev","text":"<ul> <li> <p>Strengths</p> <ul> <li>Focuses on improving the pull request workflow, making it faster and more     organized.</li> <li>Catches common style or lint issues early, reducing manual review overhead.</li> <li>Ideal for teams seeking to structure their PR process rigorously (e.g.,     stacked diffs, streamlined merges).</li> </ul> </li> <li> <p>Weaknesses</p> <ul> <li>Not as advanced in AI-based code analysis as some specialized code-review     tools.</li> <li>May require your team to adapt to a new PR workflow or dashboard.</li> </ul> </li> </ul>"},{"location":"tools/all.code_review_tools.reference.html#coderabbit_2","title":"CodeRabbit","text":"<ul> <li> <p>Strengths</p> <ul> <li>Billed as an AI-driven code review tool, aiming for deeper analysis of     logic, bugs, and potential improvements.</li> <li>If effective, it could reduce the time spent on finding edge cases or hidden     issues.</li> </ul> </li> <li> <p>Weaknesses</p> <ul> <li>A relatively new entrant; maturity and coverage (languages, frameworks) need     to be confirmed.</li> <li>Integration details might not be as polished or comprehensive yet.</li> </ul> </li> </ul>"},{"location":"tools/all.code_review_tools.reference.html#references","title":"References","text":"<ul> <li> <p>https://www.awesomecodereviews.com/tools/ai-code-review-tools</p> </li> <li> <p>https://bito.ai/blog/best-automated-ai-code-review-tools/</p> </li> <li> <p>https://www.codacy.com/</p> </li> <li> <p>https://www.sonarsource.com/</p> </li> <li> <p>https://usetrag.com/</p> </li> <li> <p>https://medium.com/@anyu6686/use-llm-for-code-review-70385c3f7457</p> </li> </ul>"},{"location":"tools/all.codebase_clean_up.how_to_guide.html","title":"All.codebase clean up.how to guide","text":""},{"location":"tools/all.codebase_clean_up.how_to_guide.html#codebase_clean_up","title":"Codebase Clean Up","text":""},{"location":"tools/all.codebase_clean_up.how_to_guide.html#codebase_clean-up_scripts","title":"Codebase clean-up scripts","text":""},{"location":"tools/all.codebase_clean_up.how_to_guide.html#problem","title":"Problem","text":"<ol> <li>Since we have multiple repos, we can't always easily replace code in one repo    (e.g., with PyCharm) and have all the other repos work properly</li> <li>Sometimes it is required to rename files and replace text in files at the    same time (e.g., when renaming an import)</li> <li> <p>While developing a change for the entire repo, we want to be able to \"reset\"    the work and apply the change from scratch</p> </li> <li> <p>E.g., during the review of the PR applying lots of text replaces:</p> <ul> <li>The code in master might be changing creating conflicts</li> <li>The reviewers might ask some changes</li> <li>This creates a lot of manual changes</li> </ul> </li> </ol>"},{"location":"tools/all.codebase_clean_up.how_to_guide.html#solution_script_approach","title":"Solution: script approach","text":"<ul> <li>Create a shell <code>sh</code> script that applies the correct changes to all the repos     using     <code>/dev_scripts_helpers/system_tools/replace_text.py</code></li> <li> <p>For more complex problems we can extend <code>replace_text.py</code> with custom     regex-based operations</p> </li> <li> <p>The script approach solves all the problems above</p> </li> <li> <p>We apply the script to all the repos</p> </li> <li>The script can rename text and files at the same time</li> <li>We can check out a clean master, run the script to apply the changes    automatically, regress and merge</li> </ul>"},{"location":"tools/all.codebase_clean_up.how_to_guide.html#using_the_script_approach","title":"Using the script approach","text":"<ul> <li> <p>We want to apply clean-up changes to the code base with a script</p> </li> <li> <p>Ideally we would like to apply all the changes automatically through the     script</p> <ul> <li>E.g., in SorrTask258 a     script that replaces <code>pytest.raises</code> with <code>self.assertRaises</code> everywhere in     the code</li> </ul> </li> <li> <p>We are ok to make the vast majority (like 95%) of the changes automatically,     and the rest manually</p> </li> <li> <p>We want to keep together in a single PR</p> <ul> <li>The script performing automatically the changes; and</li> <li>The manual changes from the outcome of the script</li> </ul> </li> <li> <p>We want to create a separate PR to communicate with the reviewers the output     of running the script</p> <ul> <li>The author/reviewers should run the script on all the repos, run the unit     tests, and merge (through a PR as usual)</li> </ul> </li> </ul>"},{"location":"tools/all.codebase_clean_up.how_to_guide.html#how_to_use_replace_textpy","title":"How to use <code>replace_text.py</code>","text":"<ul> <li> <p>See <code>-h</code> for updated list of options</p> </li> <li> <p>Replace an instance of text in the content of all the files with extensions:     <code>.py</code>, <code>.ipynb</code>, <code>.txt</code>, <code>.md</code></p> </li> <li><code>--old</code>: regular expression or string that should be replaced with <code>--new</code></li> <li><code>--new</code>: regular expression or string that should replace <code>--old</code></li> <li><code>--preview</code>: see script result without making actual changes</li> <li><code>--only_dirs</code>: provide space-separated list of directories to process only</li> <li><code>--only_files</code>: provide space-separated list of files to process only</li> <li><code>--exclude_files</code>: provide space-separated list of files to exclude from     replacements</li> <li><code>--exclude_dirs</code>: provide space-separated list of dir to exclude from     replacements</li> <li> <p><code>--ext</code>: process files with specified extensions</p> <ul> <li>Defaults are <code>py, ipynb, txt, sh</code></li> <li>Use <code>_all_</code> for all files</li> </ul> </li> <li> <p>The goal of the script is to replace an instance of text in the content of all     the files with extensions <code>.py</code>, <code>.ipynb</code>, <code>.txt</code>, <code>.md</code> and to do a <code>git mv</code>     for files based on certain criteria</p> </li> </ul>"},{"location":"tools/all.codebase_clean_up.how_to_guide.html#rename_a_file","title":"Rename a file","text":"<ul> <li>Preview the change     <pre><code>&gt; replace_text.py \\\n        --old research_backtest_utils \\\n        --new backtest_api \\\n        --preview\n</code></pre></li> <li>Then you can look at the changes to be performed with <code>vic</code> /     <code>vim -c \"cfile cfile\"</code></li> <li>If you are satisfied you can re-run the command with <code>--preview</code> to apply the     change</li> <li>Rename file     <pre><code>&gt; git mv ./dataflow/backtest/{research_backtest_utils.py,backtest_api.py}\n</code></pre></li> </ul>"},{"location":"tools/all.codebase_clean_up.how_to_guide.html#replace_an_import_with_a_new_one","title":"Replace an import with a new one","text":"<pre><code>&gt; replace_text.py \\\n        --old \"import core.fin\" \\\n        --new \"import core.finance\"\n</code></pre>"},{"location":"tools/all.codebase_clean_up.how_to_guide.html#replace_text_in_a_specific_directory","title":"Replace text in a specific directory","text":"<pre><code>&gt; replace_text.py \\\n        --old \"exec \" \\\n        --new \"execute \" \\\n        --preview \\\n        --dirs dev_scripts \\\n        --exts None\n</code></pre>"},{"location":"tools/all.codebase_clean_up.how_to_guide.html#revert_all_files_but_this_one","title":"Revert all files but this one","text":"<ul> <li>There is an option <code>--revert_all</code> to apply this before the script     <pre><code>&gt; gs -s | \\\n        grep -v dev_scripts_helpers/system_tools/replace_text.py | \\\n        grep -v \"\\?\" | \\\n        awk '{print $2}' | \\\n        xargs git checkout --\n</code></pre></li> </ul>"},{"location":"tools/all.codebase_clean_up.how_to_guide.html#custom_flows","title":"Custom flows","text":"<pre><code>&gt; replace_text.py --custom_flow _custom1\n</code></pre> <ul> <li>Custom flow for AmpTask14     <pre><code>&gt; replace_text.py --custom_flow _custom2 --revert_all\n</code></pre></li> </ul>"},{"location":"tools/all.codebase_clean_up.how_to_guide.html#usage_examples","title":"Usage examples","text":"<ul> <li> <p>See SorrIssue259 and the     related PR for reference</p> <ul> <li>We wanted to make <code>_to_multiline_cmd()</code> from     <code>/helpers/lib_tasks_utils.py</code> a public     function</li> <li>This would require to rename <code>_to_multiline_cmd()</code> to <code>to_multiline_cmd()</code>     with the script</li> <li>This     script     will make the replacement smoothly everywhere in the code except for the     dirs specified <code>--exclude_dirs</code> flag.</li> </ul> </li> <li> <p>See SorrIssue258 and the     related PR for reference</p> <ul> <li>We wanted to replace <code>pytest.raises</code> with <code>self.assertRaises</code></li> <li>This     script     will replace it everywhere in the code</li> <li>Note the use of <code>--ext</code> flag to specify the file extentions the script     should work on</li> </ul> </li> <li>Of course the changes need to be applied in one repo and then propagated to     all the other repos if the tests are successful</li> </ul>"},{"location":"tools/all.codebase_clean_up.how_to_guide.html#instructions_for_the_pr_author","title":"Instructions for the PR author","text":"<ul> <li>Create a local branch called <code>...TaskXYZ_..._script</code> containing:<ul> <li>The code that needs to be changed manually<ul> <li>E.g.: Replacing <code>pytest.raises</code> with <code>self.assertRaises</code></li> </ul> </li> <li>More contextual changes<ul> <li>E.g.: Adding unit tests to the new functions</li> </ul> </li> <li>The script for the replacement of the caller named after the GH issue<ul> <li>The script should:<ul> <li>Prepare the target Git client</li> <li>Merge this <code>script</code> branch with the manual changes</li> <li>Make the automated changes<ul> <li>E.g.: Rename a function or replace certain word in comments /     docstring</li> </ul> </li> </ul> </li> </ul> </li> <li>Notes in the files that need to be changed manually after the automatic     script</li> </ul> </li> <li>Run from scratch the script getting the regression to pass<ul> <li>Any time there is a change needed by hand, the change should be added to the     script branch</li> <li>The goal is to be able to run the script</li> </ul> </li> <li>File a PR of the <code>...TaskXYZ_..._script</code></li> <li>(Optional) Create a PR with the result of the script<ul> <li>The author can request a review on this PR, but still the goal is to     automate as much as possible</li> </ul> </li> <li>Finally, the PR author merges the PR with the results of the script</li> </ul>"},{"location":"tools/all.codebase_clean_up.how_to_guide.html#example","title":"Example","text":"<ul> <li>The name of script should be related to the task. E.g:     <code>SorrTask259_Make_to_multi_line_cmd_public.sh</code></li> <li>The script should have a system call to <code>replace_text.py</code> to execute the     required functionality as provided in the above examples</li> <li>Create a PR only with the script and the changes</li> </ul>"},{"location":"tools/all.codebase_clean_up.how_to_guide.html#instructions_for_the_subrepo_integrator","title":"Instructions for the subrepo integrator","text":"<ul> <li>Do a <code>git checkout</code> of the <code>...TaskXYZ_..._script</code></li> <li>Run the script</li> <li>Review carefully the changes to make sure we are not screwing things up</li> <li>Run the regressions</li> <li>Merge the resulting <code>...TaskXYZ...</code> PR</li> <li>Ensure that the <code>...TaskXYZ_..._script</code> is merged in <code>master</code></li> <li>Delete the <code>...TaskXYZ_..._script</code></li> </ul>"},{"location":"tools/all.codecov.how_to_guide.html","title":"All.codecov.how to guide","text":""},{"location":"tools/all.codecov.how_to_guide.html#codecov_integration_and_coverage_setup_documentation","title":"Codecov Integration and Coverage Setup Documentation","text":"<p>This documentation describes the setup and usage of Codecov integration for our repos. The purpose is to explain how Codecov coverage tracking is configured, the functionalities implemented, and how developers can interpret, interact with, and extend the coverage results.</p>"},{"location":"tools/all.codecov.how_to_guide.html#setting_up_codecov","title":"Setting Up Codecov","text":"<p>Codecov was integrated by adding necessary files and configuration steps:</p> <p>Files and Directories Added</p> <ul> <li>.coveragerc: Configures directories and files under coverage     collection</li> <li>/.github/gh_requirements.txt: Lists     dependencies necessary for the coverage workflow</li> <li>/.github/workflows/coverage_tests.yml:     Defines GitHub Actions workflow for automated coverage runs</li> </ul> <p>External setup</p> <p>Applies default coverage settings across all repos to ensure consistency in reporting and behavior. If needed, individual repos can include their own <code>.codecov.yml</code> at the root to override specific global settings.</p> <ul> <li>Global YAML: Configures     coverage collection of Codecov</li> </ul>"},{"location":"tools/all.codecov.how_to_guide.html#coverage_configuration","title":"Coverage Configuration","text":"<p>The <code>.coveragerc</code> file defines coverage measurement settings:</p> <ul> <li><code>Excluded Files</code>: These files are omitted from coverage reporting.     <pre><code>[report]\nomit =\n        */devops/compose/*\n        */helpers/test/outcomes/*/tmp.scratch/*\n</code></pre></li> </ul>"},{"location":"tools/all.codecov.how_to_guide.html#github_actions_workflow","title":"GitHub Actions Workflow","text":"<p>Coverage tests are automated via GitHub Actions - <code>.github/workflows/coverage_tests.yml</code>.</p>"},{"location":"tools/all.codecov.how_to_guide.html#workflow_schedule","title":"Workflow Schedule","text":"<ul> <li>Runs daily at midnight (UTC)</li> <li>Can be manually triggered (<code>workflow_dispatch</code>)</li> <li>Action fails if coverage drops by <code>1%</code> (including <code>fast</code>, <code>slow</code> and     <code>superslow</code> tests)</li> </ul>"},{"location":"tools/all.codecov.how_to_guide.html#workflow_jobs","title":"Workflow Jobs","text":"<ol> <li> <p>Fast Tests Coverage:</p> </li> <li> <p>Runs daily or on manual trigger</p> </li> <li> <p>Uploads report flagged as <code>fast</code></p> </li> <li> <p>Slow Tests Coverage:</p> </li> <li> <p>Runs daily or on manual trigger</p> </li> <li> <p>Uploads report flagged as <code>slow</code></p> </li> <li> <p>Superslow Tests Coverage:</p> </li> <li> <p>Runs weekly on Monday or on manual trigger.</p> </li> <li> <p>Uploads report flagged as <code>superslow</code>.</p> </li> <li> <p>Each job:</p> </li> <li> <p>Generates an <code>XML</code> coverage report (<code>Global YAML</code>)</p> </li> <li>Uploads reports to <code>Codecov</code> with respective flags (<code>fast</code>, <code>slow</code>,     <code>superslow</code>)</li> </ol>"},{"location":"tools/all.codecov.how_to_guide.html#codecov_configuration","title":"Codecov Configuration","text":"<ul> <li>Coverage flags and project-level checks are configured at Global yml -     https://app.codecov.io/account/gh/causify-ai/yaml/.</li> <li> <p>If required, you can add distinct repository configurations to the     <code>.codecov.yml</code> file at the root of your repository. - You can change the     threshold of coverage drops for a specific repo - You can add/ change patch     settings or flags for a specific repo</p> </li> <li> <p>Flag Management</p> </li> </ul> <p>The <code>carryforward</code> option allows Codecov to reuse the previous coverage data    if a report is not submitted for a given flag in the current CI run. This is    useful when certain test suites (e.g., slow or superslow) don't run in every    cycle but should still be reflected in the coverage summary.</p> <pre><code>flag_management:\nindividual_flags:\n  - name: fast\n    carryforward: true\n  - name: slow\n    carryforward: true\n  - name: superslow\n    carryforward: true\n</code></pre> <ol> <li>Comment Behavior</li> </ol> <p>Codecov can automatically post a summary comment on PRs. This comment can be    customized in layout, behavior, and verbosity.    - <code>layout: \"reach, diff, files\"</code> : Displays overall coverage, diff coverage,      and file-level detail    - <code>behavior: default</code> : Overwrites the previous comment instead of posting a      new one    - <code>require_changes: false</code> : Posts the comment even when coverage doesn't      change    - <code>show_critical_paths: false</code> : Disables per-line comments in the PR diff      view</p> <p><pre><code>comment:\n  layout: \"reach, diff, files\"\n  behavior: default\n  require_changes: false\n  show_critical_paths: false\n</code></pre>    - When PR comment is enabled:</p> <pre><code> &lt;img src=\"figs/coverage/image1.png\" alt=\"alt text\" width=\"1000\"/&gt;\n</code></pre> <ul> <li> <p>When per-line comments in PR files is enabled:</p> <p></p> </li> <li> <p>GitHub Check Annotations</p> </li> </ul> <p>Inline annotations in the GitHub <code>Files changed</code> view are disabled using the    <code>github_checks.annotations</code> flag. This ensures a cleaner PR experience    without coverage-based highlights on each line.</p> <pre><code> &lt;img src=\"figs/coverage/image7.png\" alt=\"alt text\" width=\"1000\"/&gt;\n</code></pre> <ol> <li>Coverage Status Check:</li> </ol> <p>This section configures the status checks that appear in GitHub pull    requests. It defines both patch-level and project-level coverage checks and    sets conditions for when they should run and how they should behave.    - <code>project.default</code>: Defines the overall coverage check behavior.    - <code>target</code>: auto automatically compares against the base branch of the PR.    - <code>threshold: 1%</code> means the check will fail if coverage drops by <code>1%</code> or      more.    - <code>flags</code> scopes the project-level check to specific test suites (<code>fast</code>,      <code>slow</code>, <code>superslow</code>).    - <code>branches</code> limits the check to PRs targeting the <code>master</code> branch.    - <code>patch: true</code>: Ensures Codecov always checks coverage on the changed lines      in a PR, regardless of the base branch or flag.</p> <pre><code>coverage:\n  status:\n    project:\n      default:\n        target: auto\n        threshold: 1%\n        flags:\n          - fast\n          - slow\n          - superslow\n        branches:\n          - master\n    patch: true\n</code></pre> <pre><code> &lt;img src=\"figs/coverage/image3.png\" alt=\"alt text\" width=\"1000\"/&gt;\n</code></pre>"},{"location":"tools/all.codecov.how_to_guide.html#viewing_coverage_reports","title":"Viewing Coverage Reports","text":"<p>Coverage results for the helpers repository are accessible via Codecov.</p> <ul> <li>Codecov UI link for helpers -     https://app.codecov.io/gh/causify-ai/helpers</li> <li>Master Build Dashboard Notebook:     http://172.30.2.44/build/buildmeister_dashboard/Master_buildmeister_dashboard.latest.html#Code-coverage-HTML-page</li> </ul>"},{"location":"tools/all.codecov.how_to_guide.html#running_coverage_locally","title":"Running Coverage Locally","text":"<p>Developers can manually run coverage tasks locally via Invoke commands and generate html report:</p> <ul> <li> <p>Fast Tests:</p> <pre><code>invoke run_coverage --suite fast --generate-html-report\n</code></pre> </li> <li> <p>Slow Tests:</p> <pre><code>invoke run_coverage --suite slow --generate-html-report\n</code></pre> </li> <li> <p>Superslow Tests:</p> <pre><code>invoke run_coverage --suite superslow --generate-html-report\n</code></pre> </li> <li> <p>Review HTML coverage report</p> <ul> <li>Run a local HTTP server to serve the HTML:     <pre><code>    cd htmlcov\n    python3 -m http.server 8000\n</code></pre></li> <li>If you're running this on a remote server, set up SSH port forwarding:     <pre><code>    ssh -i ~/.ssh/&lt;private_key&gt; -L 8000:localhost:8000 &lt;user_name&gt;@&lt;server_ip&gt;\n</code></pre></li> <li> <p>Then open your browser and go to:     http://localhost:8000</p> <p></p> </li> </ul> </li> </ul>"},{"location":"tools/all.codecov.how_to_guide.html#running_targeted_coverage_suites_for_a_single_pr_manual_triggering","title":"Running Targeted Coverage Suites for a Single PR (Manual Triggering)","text":"<p>The primary reason for doing this is to measure the coverage impact of the changes introduced in a specific pull request, including newly added or modified files. This helps determine whether the PR maintains, increases, or decreases test coverage in the areas it touches. This section explains how to trigger an isolated test suite (e.g., <code>fast</code>,<code>slow</code>,<code>superslow</code>) for a specific PR and ensure that Codecov coverage reflects the results correctly.</p>"},{"location":"tools/all.codecov.how_to_guide.html#logic_behind_the_workflow","title":"Logic Behind the Workflow","text":"<ul> <li>A GitHub Actions workflow can be triggered manually via the     <code>workflow_dispatch</code> event</li> <li>The input field <code>suite</code> (<code>fast</code>, <code>slow</code>, or <code>superslow</code>) determines which     test group runs</li> <li>To attribute the results to the PR, the test suite must run on a branch that     is part of the PR history (not <code>master</code> or a detached manual run)</li> <li>When the upload is done from a commit not associated with the PR, Codecov will     not link the results to the correct diff</li> </ul>"},{"location":"tools/all.codecov.how_to_guide.html#steps_to_trigger_manual_pr-specific_coverage","title":"Steps to Trigger Manual PR-Specific Coverage","text":"<p>This approach ensures that the Codecov flag is uploaded against your PR commit, so the coverage diff is accurate.</p> <ol> <li>Open the Actions tab of the repository</li> <li>Select the Test coverage workflow (or its current name)</li> <li>Select the branch name where the PR is open</li> <li>In the suite input box, enter the test you want to run:</li> <li>Fast</li> <li>Slow</li> <li>Superslow</li> <li> <p>Click Run workflow to start the job.</p> <p></p> </li> <li> <p>Monitor the run</p> </li> <li> <p>The workflow executes only on the selected test.</p> </li> <li> <p>On success, it uploads the coverage report to Codecov with the test flag.</p> </li> <li> <p>Verify the updated flag in Codecov</p> </li> <li> <p>Return to the pull-request page on GitHub.</p> </li> <li> <p>There should be a comment from the codecov bot with the PR coverage details</p> <p></p> </li> </ol>"},{"location":"tools/all.codecov.how_to_guide.html#system_behavior_when_the_test_coverage_workflow_fails_or_continues","title":"System Behavior: When the Test Coverage Workflow Fails or Continues","text":"<p>This section documents how the Test coverage workflow behaves under various failure conditions, specifically regarding the fast, slow, and superslow test suites.</p> <ol> <li>Dependency / Setup Steps</li> </ol> <p>Steps included:</p> <ul> <li>AWS credential configuration</li> <li>Docker login</li> <li>Cleanup</li> <li>Code checkout</li> <li>PYTHONPATH update</li> <li>Dependency installation</li> </ul> <p>Behavior:</p> <ul> <li>If any of these steps fail, the workflow fails immediately</li> <li>No test suites (fast, slow, superslow) will run</li> <li> <p>This is intentional to prevent test execution in a broken or incomplete     environment</p> </li> <li> <p>Fast / Slow Test Steps</p> </li> </ul> <p>Steps included:</p> <ul> <li><code>run_fast</code></li> <li><code>upload_fast</code></li> <li><code>run_slow</code></li> <li><code>upload_slow</code></li> </ul> <p>These steps use <code>continue-on-error: true</code>.</p> <p>Behavior:</p> <ul> <li>If any of these steps fail, the workflow continues without immediate failure</li> <li>The superslow test will still run if the workflow is triggered on Monday     (scheduled) or manually (workflow_dispatch)</li> <li> <p>However, the workflow may still fail at the end if fast/slow failures are     detected by the final failure check step</p> </li> <li> <p>Superslow Test Steps</p> </li> </ul> <p>Steps included:</p> <ul> <li><code>run_superslow</code></li> <li><code>upload_superslow</code></li> </ul> <p>These steps do not use <code>continue-on-error</code>.</p> <p>Behavior:</p> <ul> <li>These steps run only:<ul> <li>On scheduled workflows that fall on a Monday (DAY_OF_WEEK == 1)</li> <li>Or when the workflow is manually triggered</li> </ul> </li> <li>If either step fails, the workflow fails immediately</li> <li> <p>If both pass, the workflow continues to the final fast/slow check</p> </li> <li> <p>Final Failure Check (Fast/Slow Only)</p> </li> </ul> <p>Step included:</p> <ul> <li>Fail if fast/slow test or upload failed</li> </ul> <p>Behavior:</p> <ul> <li>This step runs at the very end of the workflow</li> <li>It checks whether any of the fast/slow test or upload steps failed</li> <li>If any of them failed, this step causes the entire job to fail using exit 1</li> <li>This ensures that silent failures in fast/slow coverage are surfaced, even if     superslow passes</li> </ul> Step Type Step Failed? Superslow Runs? Job Fails? Setup Step Yes No Yes Fast Test Yes Yes (Mon/dispatch only) Yes (after final check) Slow Test Yes Yes (Mon/dispatch only) Yes (after final check) Superslow Test Yes n/a Yes Final Fail Check Yes (if fast/slow failed) Already ran Yes"},{"location":"tools/all.codecov.how_to_guide.html#additional_functionalities_and_extensions","title":"Additional Functionalities and Extensions","text":"<p>Additional functionalities provided by Codecov that can be utilized or extended include:</p> <ul> <li><code>Pull Request Comments</code>: Automatically generate detailed coverage summaries or     line-by-line coverage comments directly in GitHub pull requests</li> <li> <p><code>Coverage Badges</code>: Integrate coverage badges in the repository <code>README</code> to     visibly show current coverage status</p> <p></p> </li> <li> <p><code>Report Customization</code>: Configure detailed reporting settings to specify what     information to display or omit in coverage summaries</p> </li> </ul>"},{"location":"tools/all.codecov.how_to_guide.html#coverage_behavior_and_best_practices","title":"Coverage Behavior and Best Practices","text":"<ul> <li>Coverage reports are uploaded regardless of test success to ensure coverage     tracking consistency</li> <li> <p>Coverage flags (<code>fast</code>, <code>slow</code>, <code>superslow</code>) allow separate visibility and     tracking</p> <ul> <li>Fast test coverage:</li> </ul> <p></p> </li> <li> <p>Regular review of coverage differences (visible in PR checks and Codecov UI)     is encouraged to maintain code quality</p> </li> </ul>"},{"location":"tools/all.codecov.how_to_guide.html#troubleshooting","title":"Troubleshooting","text":"<ul> <li>Check GitHub Actions logs for errors in coverage upload steps</li> <li>Ensure <code>CODECOV_TOKEN</code> is correctly set as a GitHub secret</li> <li>Validate workflow and coverage configuration files for correctness if issues     arise</li> </ul>"},{"location":"tools/all.evaluating_external_tools.how_to_guide.html","title":"All.evaluating external tools.how to guide","text":""},{"location":"tools/all.evaluating_external_tools.how_to_guide.html#tool_evaluation_guide","title":"Tool Evaluation Guide","text":"<p>This guide outlines how to consistently evaluate third-party tools (e.g., coverage reporting, code review, CI add-ons) across our repositories such as <code>cmamp</code>, <code>helpers</code>, <code>tutorials</code>, etc.</p>"},{"location":"tools/all.evaluating_external_tools.how_to_guide.html#1_define_comparison_attributes","title":"1. Define Comparison Attributes","text":"<p>Use the following attributes to evaluate and compare tools:</p> Attribute Description Tool Name Name of the tool Website Official website link Integration Method GitHub Action, CLI, manual, automatic pull, etc. Deployment Model SaaS only, Local only, or Both Open Source Yes / No Free for OSS Yes / No Pricing Cost per month, usage tiers, or credits Pricing Page Link to official pricing documentation Setup Effort Point to repo / Needs config / Requires signup or subscription Use Cases Coverage, code review, security, dependency management, etc. Reference Link Blog post, GitHub repo, YouTube demo, testimonial, etc. Pros Key strengths or features Cons Known limitations or pain points"},{"location":"tools/all.evaluating_external_tools.how_to_guide.html#2_track_in_a_shared_google_sheet","title":"2. Track in a Shared Google Sheet","text":"<ul> <li>Use a shared Google Sheet to create a comparison matrix with the attributes     above</li> <li>Each row represents one tool</li> <li>Columns can include notes, ratings, or checkboxes</li> <li>Assign owners for research if needed</li> </ul>"},{"location":"tools/all.evaluating_external_tools.how_to_guide.html#3_pick_top_5_tools_to_investigate_further","title":"3. Pick Top 5 Tools to Investigate Further","text":"<ul> <li>Based on research, select the top 5 tools that appear promising</li> <li>Prioritize tools with:<ul> <li>Minimal setup requirements</li> <li>Strong community or support</li> <li>Transparent pricing</li> </ul> </li> </ul>"},{"location":"tools/all.evaluating_external_tools.how_to_guide.html#4_try_23_tools_hands-on","title":"4. Try 2\u20133 Tools Hands-On","text":"<p>Choose 2\u20133 tools to test directly in one of the repositories.</p>"},{"location":"tools/all.evaluating_external_tools.how_to_guide.html#example_tool_categories","title":"Example Tool Categories","text":"<ul> <li> <p>Tools requiring minimal setup</p> <p>These tools can be tested with little to no configuration. You often just sign in with GitHub and point them to a repository. - Codecov \u2013 Add their GitHub App and upload a coverage file from CI. No     manual config needed for basic use. Works out of the box with popular test     runners like <code>pytest</code> (Python) and <code>jest</code> (JavaScript) - Coveralls \u2013 GitHub integration and CI upload. Just set the     <code>COVERALLS_REPO_TOKEN</code> secret and push coverage results - Code Climate \u2013 GitHub integration with default support for several     languages. Free for open source but may need a <code>.codeclimate.yml</code> file for     customization</p> </li> <li> <p>Tools requiring moderate setup</p> <p>These tools require sign-up, access configuration, or CLI installation. Setup is still manageable but not zero-effort. - SonarCloud \u2013 Requires GitHub login, project import, and token setup in     CI. Needs a <code>sonar-project.properties</code> file. Provides static analysis and     coverage reporting - DeepSource \u2013 GitHub login and permission to scan repos. Auto-detects     config, but may need a <code>.deepsource.toml</code> to fine-tune rules or exclusions</p> </li> <li> <p>Tools that may require subscription or approval</p> <p>These tools focus on enterprise or compliance use cases. Setup may require contacting sales, credit card details, or legal approval. - Snyk \u2013 Security scanning for dependencies. Free for public repos but     requires signup and CLI setup. Some features (e.g., PR gating, private repo     scanning) require a paid plan - FOSSA \u2013 License compliance scanning. Requires signup, and although an     open-source tier exists, full access may require approval or paid plans</p> </li> </ul>"},{"location":"tools/all.evaluating_external_tools.how_to_guide.html#5_review_and_demo","title":"5. Review and Demo","text":"<ul> <li>After testing, note impressions and any issues</li> <li>Schedule a 30-minute demo to share findings with the team</li> <li>Decide as a group whether to adopt, postpone, or reject each tool</li> </ul>"},{"location":"tools/all.evaluating_external_tools.how_to_guide.html#notes","title":"Notes","text":"<ul> <li>Not all tools can be judged fairly from documentation alone</li> <li>Actual usage is necessary to evaluate UX, speed, noise, and integration pain     points</li> </ul>"},{"location":"tools/all.explanation_template.html","title":"All.explanation template","text":"<p> <pre><code>&lt;title&gt;Explanation: &amp;lt;FileName&amp;gt;&lt;/title&gt;\n\n&lt;section name=\"IntroductionMotivation\"&gt;\n</code></pre>"},{"location":"tools/all.explanation_template.html#introduction_motivation","title":"Introduction / Motivation","text":"<pre><code>    &lt;description&gt;\n        &lt;bullet&gt;TODO: What is this about?&lt;/bullet&gt;\n        &lt;bullet&gt;TODO: What problem or limitation does it solve?&lt;/bullet&gt;\n        &lt;bullet&gt;TODO: Who needs to understand it?&lt;/bullet&gt;\n    &lt;/description&gt;\n\n    &lt;example&gt;\n        Traditional file conversion methods focused on quality rather than file size. This method aims to optimize file size while ensuring quality.\n    &lt;/example&gt;\n\n&lt;/section&gt;\n\n&lt;section name=\"CoreConcepts\"&gt;\n</code></pre>"},{"location":"tools/all.explanation_template.html#core_concepts","title":"Core Concepts","text":"<pre><code>    &lt;concepts&gt;\n        &lt;bullet&gt;&lt;b&gt;Concept 1:&lt;/b&gt; TODO: Brief explanation&lt;/bullet&gt;\n        &lt;bullet&gt;&lt;b&gt;Concept 2:&lt;/b&gt; TODO: How it relates to others&lt;/bullet&gt;\n        &lt;bullet&gt;&lt;b&gt;Concept 3:&lt;/b&gt; TODO: Dependencies or assumptions&lt;/bullet&gt;\n    &lt;/concepts&gt;\n    &lt;!-- Optional diagram or chart --&gt;\n    &lt;code_block language=\"text\"&gt;\n\n&lt;!--&gt; Insert diagram or logical model here --&gt;\n\n    &lt;/code_block&gt;\n\n&lt;/section&gt;\n\n&lt;section name=\"HowItWorks\"&gt;\n</code></pre>"},{"location":"tools/all.explanation_template.html#how_it_works","title":"How It Works","text":"<pre><code>    &lt;steps&gt;\n        &lt;bullet&gt;TODO: Step-by-step or component-based explanation&lt;/bullet&gt;\n        &lt;bullet&gt;TODO: Key data transformations or control flow&lt;/bullet&gt;\n    &lt;/steps&gt;\n    &lt;code_block language=\"text\"&gt;\n</code></pre> <p>[Component A] \u2192 transforms \u2192 [Component B] \u2192 outputs \u2192 [Result] </p> <pre><code>&lt;/section&gt;\n\n&lt;section name=\"DesignRationale\"&gt;\n</code></pre>"},{"location":"tools/all.explanation_template.html#design_rationale","title":"Design Rationale","text":"<pre><code>    &lt;rationale&gt;\n        &lt;bullet&gt;TODO: What goals guided its design?&lt;/bullet&gt;\n        &lt;bullet&gt;TODO: What constraints shaped its form? (e.g., performance, usability)&lt;/bullet&gt;\n        &lt;bullet&gt;TODO: What would go wrong with an alternate approach?&lt;/bullet&gt;\n    &lt;/rationale&gt;\n\n&lt;/section&gt;\n\n&lt;section name=\"TradeoffsAndAlternatives\"&gt;\n</code></pre>"},{"location":"tools/all.explanation_template.html#tradeoffs_and_alternatives","title":"Tradeoffs And Alternatives","text":""},{"location":"tools/all.explanation_template.html#current_approach","title":"Current Approach","text":"<pre><code>    &lt;comparison&gt;\n        &lt;current_approach&gt;\n            &lt;title&gt;Current Approach&lt;/title&gt;\n            &lt;advantages&gt;\n                &lt;bullet&gt;TODO: Advantage #1&lt;/bullet&gt;\n                &lt;bullet&gt;TODO: Advantage #2&lt;/bullet&gt;\n            &lt;/advantages&gt;\n            &lt;drawbacks&gt;\n                &lt;bullet&gt;TODO: Drawback #1&lt;/bullet&gt;\n                &lt;bullet&gt;TODO: Drawback #2&lt;/bullet&gt;\n            &lt;/drawbacks&gt;\n        &lt;/current_approach&gt;\n</code></pre>"},{"location":"tools/all.explanation_template.html#alternative_approach","title":"Alternative Approach","text":"<pre><code>        &lt;alternative_approach&gt;\n            &lt;title&gt;Alternative Approach&lt;/title&gt;\n            &lt;advantages&gt;\n                &lt;bullet&gt;TODO: Advantage #1&lt;/bullet&gt;\n                &lt;bullet&gt;TODO: Advantage #2&lt;/bullet&gt;\n            &lt;/advantages&gt;\n            &lt;drawbacks&gt;\n                &lt;bullet&gt;TODO: Drawback #1&lt;/bullet&gt;\n                &lt;bullet&gt;TODO: Drawback #2&lt;/bullet&gt;\n            &lt;/drawbacks&gt;\n        &lt;/alternative_approach&gt;\n    &lt;/comparison&gt;\n\n&lt;/section&gt;\n</code></pre>"},{"location":"tools/all.how_to_guide_template.html","title":"All.how to guide template","text":"<p> <pre><code>&lt;title&gt;How-To Guide: script.py&lt;/title&gt;\n\n&lt;section name=\"WhatItDoes\"&gt;\n</code></pre>"},{"location":"tools/all.how_to_guide_template.html#what_it_does","title":"What It Does","text":"<pre><code>    &lt;bullet&gt;TODO: Explain the purpose of this script or workflow&lt;/bullet&gt;\n    &lt;bullet&gt;TODO: Describe what outcome or goal this achieves&lt;/bullet&gt;\n\n    &lt;example&gt;\n        Automatically render images from fenced code blocks in Markdown using a custom Python script.\n    &lt;/example&gt;\n\n&lt;/section&gt;\n\n&lt;section name=\"AssumptionsRequirements\"&gt;\n</code></pre>"},{"location":"tools/all.how_to_guide_template.html#assumptions_requirements","title":"Assumptions / Requirements","text":"<pre><code>    &lt;bullet&gt;Docker installed and running&lt;/bullet&gt;\n    &lt;bullet&gt;Basic command-line familiarity&lt;/bullet&gt;\n    &lt;bullet&gt;TODO: List any additional dependencies or permissions&lt;/bullet&gt;\n\n&lt;/section&gt;\n\n&lt;section name=\"Instructions\"&gt;\n</code></pre>"},{"location":"tools/all.how_to_guide_template.html#instructions","title":"Instructions","text":"<pre><code>    &lt;step name=\"Step1\" title=\"Fetch Input\"&gt;\n</code></pre>"},{"location":"tools/all.how_to_guide_template.html#step_1_fetch_input","title":"Step 1: Fetch Input","text":"<pre><code>        &lt;description&gt;TODO: Describe the input file(s) and how to prepare or provide them.&lt;/description&gt;\n\n        &lt;code_block language=\"bash\"&gt;\n</code></pre>"},{"location":"tools/all.how_to_guide_template.html#example_download_markdown_input_file","title":"Example: Download Markdown input file","text":"<p>wget https://example.com/input.md -O input.md  </p> <pre><code>    &lt;step name=\"Step2\" title=\"Describe Action\"&gt;\n</code></pre>"},{"location":"tools/all.how_to_guide_template.html#step_2_describe_action","title":"Step 2: Describe Action","text":"<pre><code>        &lt;description&gt;TODO: Describe the main script command to execute the action.&lt;/description&gt;\n\n        &lt;code_block language=\"bash\"&gt;\n</code></pre> <p>python render_images.py -i input.md -o output.md --action render  </p> <pre><code>    &lt;step name=\"Step3\" title=\"Review Output\"&gt;\n</code></pre>"},{"location":"tools/all.how_to_guide_template.html#step_3_review_output","title":"Step 3: Review Output","text":"<pre><code>        &lt;description&gt;TODO: Explain how to verify the results of the script run.&lt;/description&gt;\n\n        &lt;code_block language=\"bash\"&gt;\n</code></pre>"},{"location":"tools/all.how_to_guide_template.html#preview_the_output_file","title":"Preview the output file","text":"<p>cat output.md | less  </p> <pre><code>&lt;/section&gt;\n\n&lt;section name=\"Examples\"&gt;\n</code></pre>"},{"location":"tools/all.how_to_guide_template.html#examples","title":"Examples","text":"<pre><code>    &lt;examples&gt;\n        &lt;example title=\"Basic Render\"&gt;\n            &lt;description&gt;Render all diagrams in a Markdown file to embedded images.&lt;/description&gt;\n            &lt;code_block language=\"bash\"&gt;\n</code></pre> <p>python render_images.py -i diagrams.md -o diagrams.output.md --action render  </p> <pre><code>        &lt;example title=\"Render + Open in Browser\"&gt;\n            &lt;description&gt;Render diagrams and open the rendered file in browser preview.&lt;/description&gt;\n            &lt;code_block language=\"bash\"&gt;\n</code></pre> <p>python render_images.py -i diagrams.md --action render --run_dockerized  </p> <pre><code>        &lt;example title=\"Dry Run for Debugging\"&gt;\n            &lt;description&gt;Check what will be processed without rendering the output.&lt;/description&gt;\n            &lt;code_block language=\"bash\"&gt;\n</code></pre> <p>python render_images.py -i diagrams.md -o /tmp/preview.md --dry_run  </p> <pre><code>&lt;/section&gt;\n\n&lt;section name=\"Troubleshooting\"&gt;\n</code></pre>"},{"location":"tools/all.how_to_guide_template.html#troubleshooting","title":"Troubleshooting","text":"<pre><code>    &lt;issue_block&gt;\n        &lt;issue&gt;TODO: Describe a common issue&lt;/issue&gt;\n        &lt;cause&gt;TODO: Likely cause&lt;/cause&gt;\n        &lt;solution&gt;TODO: Suggested fix or workaround&lt;/solution&gt;\n    &lt;/issue_block&gt;\n\n    &lt;issue_block&gt;\n        &lt;issue&gt;TODO: Another possible issue&lt;/issue&gt;\n        &lt;cause&gt;TODO: Likely cause&lt;/cause&gt;\n        &lt;solution&gt;TODO: How to resolve it&lt;/solution&gt;\n    &lt;/issue_block&gt;\n\n&lt;/section&gt;\n</code></pre>"},{"location":"tools/all.import_check.reference.html","title":"All.import check.reference","text":"<ul> <li>show_imports             * Basic usage             * Visualize dependencies at a directory level             * Visualize external dependencies             * Visualize level X dependencies             * Visualize cyclic dependencies             * Pydeps-dependent limitations          * NotModuleError          * Modules above the target directory             * Run the tool on our codebase -- pre-docker procedure</li> <li>detect_import_cycles             * Basic usage</li> </ul>"},{"location":"tools/all.import_check.reference.html#show_imports","title":"show_imports","text":"<p>A tool for visualizing dependencies among files and packages.</p>"},{"location":"tools/all.import_check.reference.html#basic_usage","title":"Basic usage","text":"<pre><code>&gt;./show_imports.py [flags] &lt;target_directory&gt;\n</code></pre> <p>The script will produce by default an output <code>.png</code> file named <code>&lt;target_directory&gt;_dependencies.png</code>, you can change the default output name or image format by specifying the <code>--out_filename</code> and <code>--out_format</code> options.</p> <p>In the following examples we will analyze an example input directory <code>example/input</code> that you can find in the <code>import_check/</code> dir. It is structured as follows:</p> <pre><code>example\n\u251c\u2500\u2500 input\n        \u251c\u2500\u2500 __init__.py\n        \u251c\u2500\u2500 subdir1\n        \u2502\u00a0\u00a0 \u251c\u2500\u2500 file1.py\n        \u2502\u00a0\u00a0 \u251c\u2500\u2500 file2.py\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 __init__.py\n        \u251c\u2500\u2500 subdir2\n        \u2502    \u251c\u2500\u2500 file1.py\n        \u2502    \u251c\u2500\u2500 file2.py\n        \u2502    \u251c\u2500\u2500 __init__.py\n        \u2502    \u2514\u2500\u2500 subdir3\n        \u2502        \u251c\u2500\u2500 file1.py\n        \u2502        \u251c\u2500\u2500 file2.py\n        \u2502        \u251c\u2500\u2500 file3.py\n        \u2502        \u2514\u2500\u2500 __init__.py\n        \u2514\u2500\u2500 subdir4\n                \u251c\u2500\u2500 file1.py\n                \u251c\u2500\u2500 file2.py\n                \u251c\u2500\u2500 file3.py\n                \u2514\u2500\u2500 __init__.py\n</code></pre> <p>Basic usage example:</p> <pre><code>&gt;./show_imports.py --out_filename example/output/basic.png example/input\n</code></pre> <p>Will produce the following output:</p> <p></p>"},{"location":"tools/all.import_check.reference.html#visualize_dependencies_at_a_directory_level","title":"Visualize dependencies at a directory level","text":"<p>To visualize dependencies at a directory level, specify <code>--dir</code> option.</p> <p>Example:</p> <pre><code>&gt;./show_imports.py --dir --out_filename example/output/directory_deps.png example/input\n</code></pre> <p>Output:</p> <p></p>"},{"location":"tools/all.import_check.reference.html#visualize_external_dependencies","title":"Visualize external dependencies","text":"<p>By default, external dependencies are not visualized. You can turn them on by specifying the <code>--ext</code> option.</p> <p>Example:</p> <pre><code>&gt;./show_imports.py --ext --out_filename example/output/external_deps.png example/input\n</code></pre> <p>Output:</p> <p></p>"},{"location":"tools/all.import_check.reference.html#visualize_level_x_dependencies","title":"Visualize level X dependencies","text":"<p>When you want to stop analyzing dependencies at a certain directory level, you can set the <code>--max_level</code> option.</p> <p>Example:</p> <pre><code>&gt;./show_imports.py --max_level 2 --out_filename example/output/max_level_deps.png example/input\n</code></pre> <p>Output:</p> <p></p>"},{"location":"tools/all.import_check.reference.html#visualize_cyclic_dependencies","title":"Visualize cyclic dependencies","text":"<p>When you want to visualize cyclic dependencies only, you can set the <code>--show_cycles</code> option.</p> <p>Example:</p> <pre><code>&gt;./show_imports.py --show_cycles --out_filename example/output/cyclic_deps.png example/input\n</code></pre> <p>Output:</p> <p></p>"},{"location":"tools/all.import_check.reference.html#pydeps-dependent_limitations","title":"Pydeps-dependent limitations","text":"<p><code>show_imports</code> is based on the <code>pydeps</code> tool for detecting dependencies among imports, therefore it shares some of the its limitations:</p> <ul> <li>The output contains only files which have at least one import, or are imported     in at least one other file</li> <li>Only files that can be found by using the Python import machinery will be     considered (e.g., if a module is missing or not installed, it will not be     included regardless of whether it is being imported)</li> <li>All the imports inside submodules should be absolute</li> <li>There are certain requirements related to the presence of modules in and     above the target directory, which are described in detail below<ul> <li>Here, a module is a directory that contains an <code>__init__.py</code> file</li> </ul> </li> </ul>"},{"location":"tools/all.import_check.reference.html#notmoduleerror","title":"NotModuleError","text":"<p>Suppose we run the <code>show_imports</code> script on a target directory <code>input_dir</code>. The script will check the <code>input_dir</code> and all of its subdirectories of any level. A <code>NotModuleError</code> will be raised if any of them</p> <ul> <li>Contain Python files (directly or in any of their subdirectories of any level)     and</li> <li>Are not modules</li> </ul> <p>Example of an acceptable structure for <code>input_dir</code> as a target directory:</p> <pre><code>input_dir\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 subdir1\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 file1.py\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 __init__.py\n\u2514\u2500\u2500 subdir2\n        \u2514\u2500\u2500 __init__.py\n</code></pre> <p>Examples of input directories for which <code>show_imports</code> will fail with a <code>NotModuleError</code>:</p> <ul> <li><code>input_dir/subdir1</code> contains Python files but is not a module</li> </ul> <pre><code>input_dir\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 subdir1\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file1.py\n\u2514\u2500\u2500 subdir2\n        \u2514\u2500\u2500 __init__.py\n</code></pre> <pre><code>__main__.NotModuleError: The following dirs have to be modules (add `__init__.py`): ['input_dir/subdir1']\n</code></pre> <ul> <li><code>input_dir</code> contains subdirectories with Python files (<code>input_dir/subdir1</code>)     but is not a module</li> </ul> <pre><code>input_dir\n\u251c\u2500\u2500 subdir1\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 file1.py\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 __init__.py\n\u2514\u2500\u2500 subdir2\n        \u2514\u2500\u2500 __init__.py\n</code></pre> <pre><code>__main__.NotModuleError: The following dirs have to be modules (add `__init__.py`): ['input_dir']\n</code></pre>"},{"location":"tools/all.import_check.reference.html#modules_above_the_target_directory","title":"Modules above the target directory","text":"<p>Suppose we run the <code>show_imports</code> script on a target directory <code>input_dir</code>. The dependencies will be retrieved and shown for the files</p> <ul> <li>Under <code>input_dir</code> (including the files in its subdirectories of any level)     and</li> <li>In the directories above <code>input_dir</code><ul> <li>If these directories are modules themselves and there is no non-module     directory between them and <code>input_dir</code></li> </ul> </li> </ul> <p>For example,</p> <ul> <li>All the directories in following structure are modules</li> <li>Therefore, if <code>import_check</code> or any of the subdirectories are passed as a     target directory (e.g. <code>example/input</code>, <code>example/input/subdir1</code>,     <code>example/input/subdir2/subdir3</code>, etc), all the dependencies in <code>import_check</code>     will be shown</li> </ul> <pre><code>import_check\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 show_imports.py\n\u251c\u2500\u2500 detect_import_cycles.py\n\u2514\u2500\u2500 example\n        \u251c\u2500\u2500 __init__.py\n        \u2514\u2500\u2500 input\n                \u251c\u2500\u2500 __init__.py\n                \u251c\u2500\u2500 subdir1\n                \u2502\u00a0\u00a0 \u251c\u2500\u2500 file1.py\n                \u2502\u00a0\u00a0 \u251c\u2500\u2500 file2.py\n                \u2502\u00a0\u00a0 \u2514\u2500\u2500 __init__.py\n                \u2514\u2500\u2500 subdir2\n             \u251c\u2500\u2500 file1.py\n             \u251c\u2500\u2500 file2.py\n             \u251c\u2500\u2500 __init__.py\n             \u2514\u2500\u2500 subdir3\n                 \u251c\u2500\u2500 file1.py\n                 \u251c\u2500\u2500 file2.py\n                 \u251c\u2500\u2500 file3.py\n                 \u2514\u2500\u2500 __init__.py\n</code></pre> <ul> <li>In the following structure <code>import_check/example</code> is not a module</li> <li>Therefore, if <code>import_check/example/input</code> or any of its subdirectories are     passed as a target directory, all the dependencies in     <code>import_check/example/input</code> will be shown, but not the dependencies of the     files above it</li> <li>If <code>import_check</code> or <code>import_check/example</code> are passed as a target directory,     a <code>NotModuleError</code> will be raised, see above</li> </ul> <pre><code>import_check\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 show_imports.py\n\u251c\u2500\u2500 detect_import_cycles.py\n\u2514\u2500\u2500 example\n        \u2514\u2500\u2500 input\n                \u251c\u2500\u2500 __init__.py\n                \u251c\u2500\u2500 subdir1\n                \u2502\u00a0\u00a0 \u251c\u2500\u2500 file1.py\n                \u2502\u00a0\u00a0 \u251c\u2500\u2500 file2.py\n                \u2502\u00a0\u00a0 \u2514\u2500\u2500 __init__.py\n                \u2514\u2500\u2500 subdir2\n             \u251c\u2500\u2500 file1.py\n             \u251c\u2500\u2500 file2.py\n             \u251c\u2500\u2500 __init__.py\n             \u2514\u2500\u2500 subdir3\n                 \u251c\u2500\u2500 file1.py\n                 \u251c\u2500\u2500 file2.py\n                 \u251c\u2500\u2500 file3.py\n                 \u2514\u2500\u2500 __init__.py\n</code></pre> <p>In practice, this means that if all the directories containing Python files in the repository are modules, the output of the <code>show_imports</code> script will always show the dependencies for the whole repository.</p> <p>If it is necessary to run <code>show_imports</code> only for a specific directory, it has to be located directly inside a non-module directory (like <code>import_check/example/input</code>, which is located in a non-module <code>import_check/example</code>).</p>"},{"location":"tools/all.import_check.reference.html#run_the_tool_on_our_codebase_--_pre-docker_procedure","title":"Run the tool on our codebase -- pre-docker procedure","text":"<ul> <li>Activate <code>helpers</code> environment:<ul> <li>From the <code>helpers</code> root:     <pre><code>poetry shell; export PYTHONPATH=$PYTHONPATH:$(pwd)\n</code></pre></li> </ul> </li> <li>Run the tool on the target repo. E.g., analyze for cyclic dependencies     <pre><code>&lt;path for the show_imports.py script&gt; --show_cycles \\\n                                                                            --out_format svg \\\n                                                                            --out_filename cyclic_dependencies.svg \\\n                                                                            &lt;absolute path for the target repo&gt;\n</code></pre></li> </ul>"},{"location":"tools/all.import_check.reference.html#detect_import_cycles","title":"detect_import_cycles","text":"<p>A tool for detecting circular dependencies among files and packages.</p>"},{"location":"tools/all.import_check.reference.html#basic_usage_1","title":"Basic usage","text":"<pre><code>&gt;./detect_import_cycles.py &lt;target_directory&gt;\n</code></pre> <p>The script will either exit with an error, logging the groups of files with circular dependencies, or will pass, logging that no cyclic imports have been detected.</p> <p>The script uses <code>show_imports.py</code> for the dependency retrieval and therefore inherits its limitations.</p> <p>For the <code>import_check/example/input</code> directory, the script will produce the following output, detecting two import cycles:</p> <pre><code>&gt;./detect_import_cycles.py example/input\n</code></pre> <pre><code>ERROR detect_import_cycles.py _main:73    Cyclic imports detected: (input.subdir2.subdir3.file1, input.subdir2.subdir3.file2)\nERROR detect_import_cycles.py _main:73    Cyclic imports detected: (input.subdir4.file1, input.subdir4.file2, input.subdir4.file3)\n</code></pre>"},{"location":"tools/all.imports_and_packages.how_to_guide.html","title":"All.imports and packages.how to guide","text":""},{"location":"tools/all.imports_and_packages.how_to_guide.html#imports_and_packages","title":"Imports And Packages","text":""},{"location":"tools/all.imports_and_packages.how_to_guide.html#imports_and_packages_1","title":"Imports and packages","text":"<ul> <li>TODO(gp): Consolidate here any other rule from other gdoc</li> </ul>"},{"location":"tools/all.imports_and_packages.how_to_guide.html#goals_of_packages","title":"Goals of packages","text":"<ul> <li> <p>The goal of creating packages is to:</p> <ul> <li>Simplify the import from clients</li> <li>Hide in which file the actual code is, so that we can reorganize the code     without having to change all the client code</li> <li>Organize the code in related units</li> <li>Make it simpler to avoid import loops by enforcing that there are no import     loops in any module and no import loops among modules</li> </ul> </li> <li> <p>E.g., referring to package from a different package looks like     <code>python import dataflow.core as dtfcore dtfcore.ArmaGenerator(...)</code></p> </li> <li>Importing the specific file:     <code>python import dataflow_amp.system.source_nodes as dtfsysonod dtfsysonod.ArmaGenerator(...)</code></li> </ul>"},{"location":"tools/all.imports_and_packages.how_to_guide.html#circular_dependency_aka_import_cycle_import_loop","title":"Circular dependency (aka import cycle, import loop)","text":"<ul> <li>The simplest case of circular import is a situation when in lib <code>A</code> we have     <code>import B</code>, and in lib B we have <code>import A</code></li> <li>The presence of circular imports can be checked with an invoke     <code>i lint_detect_cycles</code>. By default, it will run on the whole repo, which takes     a couple of minutes, but it will provide the most reliable and thorough check     for circular imports</li> </ul>"},{"location":"tools/all.imports_and_packages.how_to_guide.html#rules_for_imports","title":"Rules for imports","text":"<ul> <li>We follow rules to avoid import loops:<ul> <li>Code inside a package should import directly a file in the same package and     not use the package<ul> <li> <p>E.g., <code>datapull/common/data/client/data_frame_im_clients.py</code></p> <ul> <li> <p>Good</p> <p><code>python import datapull.common.data.client.abstract_im_clients as imvcdcaimcl</code>             - Bad <code>python import datapull.common.data.client as icdc</code>     - Code from a package should import other packages, instead of importing         directly the file     - We don't allow any import loop that can be detected statically (i.e., by         inspecting the code without executing it)         - This guarantees that there are no dynamic import loops, which are even             more difficult to detect and disruptive     - We allow only imports at the module level and not inside functions         - We don't accept using local imports to break import loops, unless it's             temporary to solve a more important problem     - We allow nested packages         - TODO(gp): Clarify the rules here     - We don't want to abuse packaging by creating too many of them         - Rationale:             - There is overhead in organizing and maintaining code in packages and we want to pay the overhead only if we get enough benefit from this     - We specify a short import in the <code>__init__.py</code> file for a package manually         because Linter cannot do it automatically yet         - We use the first letters to build a short import and try to keep it less             than 8 chars long, e.g., <code>datapull.talos.data.client</code> -&gt; <code>itdcl</code>         - We insert an import docstring in the <code>__init__.py</code> file manually and then             we use the specified short import everywhere in the codebase. E.g.,</p> </li> </ul> <p>```python Import as:</p> </li> </ul> </li> </ul> </li> </ul> <p>import datapull.talos.data.client as itdcl             ```</p>"},{"location":"tools/all.imports_and_packages.how_to_guide.html#how_to_import_code_from_unit_tests","title":"How to import code from unit tests","text":"<ul> <li> <p>To avoid churning client code when code is moved among files, we allow unit     tests to both:</p> <ol> <li>Import the package when testing code exported from the package</li> <li>E.g., in <code>market_data/test/market_data_test_case.py</code> you can import the    package even if it's included    <code>python import market_data as mdata ... mdata.AbstractMarketData ...</code></li> <li>Import the files directly with the code and not the package</li> <li>E.g.,    <code>python import market_data.abstract_market_data as mdabmada ... mdabmada.AbstractMarketData ...</code></li> </ol> </li> <li> <p>To justify, one can argue that unit tests are clients of the code and should     import packages like any other client</p> </li> <li> <p>To justify, one can interpret that unit tests are tied to specific files, so     they should be kept in sync with the low-level code and not with the public     interface. In fact, we already allow unit tests to call private functions,     acknowledging that unit tests are not regular clients</p> </li> <li> <p>Given that both explanations are valid, we allow both styles</p> </li> </ul>"},{"location":"tools/all.imports_and_packages.how_to_guide.html#common_unit_test_code","title":"Common unit test code","text":"<ul> <li>Unit tests should not import from each other<ul> <li>If there is common code, it should go in libraries inside or outside <code>test</code>     directories<ul> <li>E.g., we use <code>foobar_example.py</code> files containing builders for mocks and     examples of objects to be used by tests</li> <li>E.g., we use <code>test/foobar_test_case.py</code> or <code>test/foobar_utils.py</code></li> </ul> </li> <li>In other terms, test files are always leaves of the import graph</li> </ul> </li> </ul>"},{"location":"tools/all.imports_and_packages.how_to_guide.html#packagelib_hierarchy_and_cycle_prevention","title":"Package/lib hierarchy and cycle prevention","text":"<ul> <li>Static import cycles can be detected by the invoke <code>lint_detect_cycles</code></li> <li>To prevent import cycles, we want to enforce that certain packages don't     depend on other packages<ul> <li>E.g., <code>helpers</code> should not depend on any other package, besides external     libraries</li> <li><code>core</code> should only depend on <code>helpers</code></li> <li><code>dataflow</code> should only depend on <code>core</code> and <code>helpers</code></li> <li>These constraints can be expressed in terms of \"certain nodes of the import     graph are sources\" or \"certain edges in the import graph are forbidden\"</li> </ul> </li> <li>We also want to enforce that certain libs don't import others within a single     package. For example, in <code>helpers</code>, the following hierarchy should be     respected:<ol> <li><code>hwarnings</code>, <code>hserver</code>, <code>hlogging</code></li> <li><code>hdbg</code></li> <li><code>hintrospection</code>, <code>hprint</code></li> <li><code>henv</code>, <code>hsystem</code>, <code>hio</code>, <code>hversio</code> (this is the base layer to access env  vars and execute commands)</li> <li><code>hgit</code> (Git requires accessing env vars and system calls)</li> </ol> </li> <li>A library can only import libs that precede it or are on the same level in the     hierarchy above.<ul> <li>E.g., <code>henv</code> can import <code>hdbg</code>, <code>hprint</code>, and <code>hio</code>, but it cannot import     <code>hgit</code></li> <li>While importing a lib on the same level, make sure you are not creating an     import cycle</li> </ul> </li> <li>In addition, keep in mind the following rules to prevent import cycles:<ul> <li>Any import inside a function is just a temporary hack waiting to create     problems</li> <li>Any time we can break a file into smaller pieces, we should do that since     this helps control the dependencies</li> </ul> </li> </ul>"},{"location":"tools/all.imports_and_packages.how_to_guide.html#anatomy_of_a_package","title":"Anatomy of a package","text":"<ul> <li>TODO(gp): Let's use <code>dataflow</code> as a running example</li> <li>A package has a special <code>__init__.py</code> exporting public methods</li> </ul>"},{"location":"tools/all.integrate_repos.how_to_guide.html","title":"All.integrate repos.how to guide","text":""},{"location":"tools/all.integrate_repos.how_to_guide.html#integrate_repos","title":"Integrate Repos","text":""},{"location":"tools/all.integrate_repos.how_to_guide.html#how_to_integrate_repos","title":"How to integrate repos","text":""},{"location":"tools/all.integrate_repos.how_to_guide.html#concepts","title":"Concepts","text":"<ul> <li>We have two dirs storing two forks of the same repo<ul> <li>Files are touched (e.g., added, modified, deleted) in each forks</li> <li>The most problematic files are the files that are modified in both forks</li> <li>Files that are added or deleted in one fork, should be added / deleted also     in the other fork</li> </ul> </li> <li>Often we can integrate \"by directory\", i.e., finding entire directories that     were touched in one branch but not in the other<ul> <li>In this case we can simply copy the entire dir from one repo to the other</li> </ul> </li> <li> <p>Other times we need to integrate each file</p> </li> <li> <p>There are various interesting Git reference points:</p> <ol> <li>The branch point for each fork, at which the integration branch was started</li> <li>The last integration point for each fork, at which the repos are the same,  or at least aligned</li> </ol> </li> </ul>"},{"location":"tools/all.integrate_repos.how_to_guide.html#invariants_for_the_integration_workflows","title":"Invariants for the integration workflows","text":"<ul> <li>The user runs commands in an abs dir, e.g., <code>/Users/saggese/src/{amp1,cmamp1}</code></li> <li>The user refers in the command line to <code>dir_basename</code>, which is the basename     of the integration directories (e.g., <code>amp1</code>, <code>cmamp1</code>, <code>kaizenflow1</code>)<ul> <li>The <code>src_dir_basename</code> is the one where the command is issued</li> <li>The <code>dst_dir_basename</code> is assumed to be parallel to the <code>src_dir_basename</code></li> </ul> </li> <li>The dirs are then transformed in absolute dirs <code>abs_src_dir</code></li> </ul>"},{"location":"tools/all.integrate_repos.how_to_guide.html#integration_process","title":"Integration process","text":""},{"location":"tools/all.integrate_repos.how_to_guide.html#preparation","title":"Preparation","text":"<ul> <li> <p>Pull master</p> </li> <li> <p>Crete the integration branches</p> <pre><code>&gt; cd cmamp1\n&gt; git checkout master\n&gt; i integrate_create_branch --dir-basename cmamp1\n&gt; cd kaizenflow1\n&gt; git checkout master\n&gt; i integrate_create_branch --dir-basename kaizenflow1\n</code></pre> </li> <li> <p>In one line</p> <pre><code>cd $HOME/cmamp1 &amp;&amp; \\\n    git checkout master &amp;&amp; \\\n    i integrate_create_branch --dir-basename cmamp1 &amp;&amp; \\\n    cd $HOME/kaizenflow1 &amp;&amp; \\\n    git checkout master &amp;&amp; \\\n    i integrate_create_branch --dir-basename kaizenflow1\n</code></pre> </li> <li> <p>Remove white spaces from both source and destination repos:</p> <p><pre><code>&gt; dev_scripts/clean_up_text_files.sh\n&gt; git commit -am \"Remove white spaces\"; git push\n</code></pre> - One should still run the regressions out of paranoia since some golden     outcomes can be changed     <pre><code>&gt; i gh_create_pr --no-draft\n&gt; i gh_workflow_list\n</code></pre></p> </li> <li> <p>Remove empty files:</p> <p><pre><code>&gt; find . -type f -empty -print | grep -v .git | grep -v __init__ | grep -v \".log$\" | grep -v \".txt$\" | xargs git rm\n</code></pre> - TODO(gp): Add this step to <code>dev_scripts/clean_up_text_files.sh</code></p> </li> <li> <p>Align <code>lib_tasks.py</code>:</p> <pre><code>&gt; vimdiff ~/src/{cmamp1, kaizenflow1}/tasks.py; diff_to_vimdiff.py --dir1 ~/src/cmamp1 --dir2 ~/src/kaizenflow1 --subdir helpers\n</code></pre> </li> <li> <p>Lint both dirs:</p> <pre><code>&gt; cd amp1\n&gt; i lint --dir-name . --only-format\n&gt; cd cmamp1\n&gt; i lint --dir-name . --only-format\n</code></pre> <p>or at least the files touched by both repos:</p> <p><pre><code>&gt; i integrate_files --file-direction only_files_in_src\n&gt; cat tmp.integrate_find_files_touched_since_last_integration.cmamp1.txt tmp.integrate_find_files_touched_since_last_integration.amp1.txt | sort | uniq &gt;files.txt\n&gt; FILES=$(cat files.txt)\n&gt; i lint --only-format -f \"$FILES\"\n</code></pre> - This should be done as a single separated PR to be reviewed separately</p> </li> <li> <p>Align <code>lib_tasks.py</code>:     <pre><code>&gt; vimdiff ~/src/{amp1,cmamp1}/tasks.py; diff_to_vimdiff.py --dir1 ~/src/amp1 --dir2 ~/src/cmamp1 --subdir helpers\n</code></pre></p> </li> </ul>"},{"location":"tools/all.integrate_repos.how_to_guide.html#integration","title":"Integration","text":"<ul> <li> <p>Create the integration branches:</p> <pre><code>&gt; cd amp1\n&gt; i integrate_create_branch --dir-basename amp1\n&gt; i integrate_create_branch --dir-basename kaizenflow1\n&gt; cd cmamp1\n&gt; i integrate_create_branch --dir-basename cmamp1\n</code></pre> </li> <li> <p>Check what files were modified in each fork since the last integration:</p> <pre><code>&gt; i integrate_files --file-direction common_files\n&gt; i integrate_files --file-direction common_files --src-dir-basename cmamp1 --dst-dir-basename kaizenflow1\n\n&gt; i integrate_files --file-direction only_files_in_src\n&gt; i integrate_files --file-direction only_files_in_dst\n</code></pre> </li> <li> <p>Look for directory touched on only one branch:     <pre><code>&gt; i integrate_files --file-direction common_files --mode \"print_dirs\"\n&gt; i integrate_files --file-direction only_files_in_src --mode \"print_dirs\"\n&gt; i integrate_files --file-direction only_files_in_dst --mode \"print_dirs\"\n</code></pre></p> </li> <li> <p>If we find dirs that are touched in one branch but not in the other we can     copy / merge without running risks</p> <pre><code>&gt; i integrate_diff_dirs --subdir $SUBDIR -c\n</code></pre> </li> <li> <p>Check which change was made in each side since the last integration</p> <pre><code># Find the integration point:\n&gt; i integrate_files --file-direction common_files\n...\nlast_integration_hash='813c7e763'\n\n# Diff the changes in each side from the integration point:\n&gt; i git_branch_diff_with -t hash -h 813c7e763 -f ...\n&gt; git difftool 813c7e763 ...\n</code></pre> </li> <li> <p>Check which files are different between the dirs:</p> <pre><code>&gt; i integrate_diff_dirs\n</code></pre> </li> <li> <p>Diff dir by dir</p> <pre><code>&gt; i integrate_diff_dirs --subdir dataflow/system\n</code></pre> </li> <li> <p>Copy by dir</p> <pre><code>&gt; i integrate_diff_dirs --subdir market_data -c\n</code></pre> </li> <li> <p>Sync a dir to handle moved files</p> </li> <li>Assume that there is a dir where files were moved     <pre><code>&gt; invoke integrate_diff_dirs\n...\n... Only in .../cmamp1/.../alpha_numeric_data_snapshots: alpha\n... Only in .../amp1/.../alpha_numeric_data_snapshots: latest\n</code></pre></li> <li>You can accept one side with:     <pre><code>&gt; invoke integrate_rsync $(pwd)/marketing\n</code></pre></li> <li>This corresponds to:     <pre><code>&gt; rsync --delete -a -r {src_dir}/ {dst_dir}/\n</code></pre></li> </ul>"},{"location":"tools/all.integrate_repos.how_to_guide.html#double-check_the_integration","title":"Double-check the integration","text":"<ul> <li> <p>Check that the regressions are passing on GH</p> <pre><code>&gt; i gh_create_pr --no-draft\n</code></pre> </li> <li> <p>Check the files that were changed in both branches (i.e., the \"problematic     ones\") since the last integration and compare them to the base in each branch</p> <pre><code>&gt; cd amp1\n&gt; i integrate_diff_overlapping_files --src-dir-basename \"amp1\" --dst-dir-basename \"cmamp1\"\n&gt; cd cmamp1\n&gt; i integrate_diff_overlapping_files --src-dir-basename \"cmamp1\" --dst-dir-basename \"amp1\"\n</code></pre> </li> <li> <p>Read the changes to Python files:</p> <pre><code>&gt; cd amp1\n&gt; i git_branch_diff_with -t base --keep-extensions py\n&gt; cd cmamp1\n&gt; i git_branch_diff_with -t base --keep-extensions py\n</code></pre> </li> <li> <p>Quickly scan all the changes in the branch compared to the base:     <pre><code>&gt; cd amp1\n&gt; i git_branch_diff_with -t base\n&gt; cd cmamp1\n&gt; i git_branch_diff_with -t base\n</code></pre></p> </li> </ul>"},{"location":"tools/all.integrate_repos.how_to_guide.html#run_tests","title":"Run tests","text":"<ul> <li> <p>Check <code>amp</code> / <code>cmamp</code> using GH actions:</p> <pre><code>&gt; i gh_create_pr --no-draft\n&gt; i pytest_collect_only\n&gt; i gh_workflow_list\n</code></pre> </li> <li> <p>Check <code>lem</code> on dev1</p> <pre><code># Clean everything.\n&gt; git reset --hard; git clean -fd; git pull; (cd amp; git reset --hard; git clean -fd; git pull)\n\n&gt; i git_pull\n\n&gt; AM_BRANCH=AmpTask1786_Integrate_20220916\n&gt; (cd amp; gco $AM_BRANCH)\n\n&gt; i pytest_collect_only\n&gt; i pytest_buildmeister\n\n&gt; i git_branch_create -b $AM_BRANCH\n</code></pre> </li> <li> <p>Check <code>lime</code> on dev4</p> </li> <li> <p>Check <code>orange</code> on dev1</p> </li> </ul>"},{"location":"tools/all.invoke_bash_print_tree.how_to_guide.html","title":"All.invoke bash print tree.how to guide","text":""},{"location":"tools/all.invoke_bash_print_tree.how_to_guide.html#the_bash_print_tree_workflow","title":"The Bash Print Tree Workflow","text":""},{"location":"tools/all.invoke_bash_print_tree.how_to_guide.html#introduction","title":"Introduction","text":"<ul> <li>The <code>bash_print_tree</code> <code>invoke</code> workflow prints a directory tree and optionally     updates an existing Markdown file</li> <li>It is used for maintaining documentation of structured files preserving inline     comments</li> <li>The tree can be printed to standard output or embedded into a file between     markers like <code>&lt;!-- tree:start:{name} --&gt;</code> and <code>&lt;!-- tree:end --&gt;</code></li> </ul>"},{"location":"tools/all.invoke_bash_print_tree.how_to_guide.html#workflow_explanation","title":"Workflow Explanation","text":"<ul> <li>The task walks the specified directory up to a maximum depth</li> <li>By default, the tree includes all subdirectories and files (excluding Python     and test files), and outputs to the terminal only</li> <li>You can configure whether to:<ul> <li>Include or exclude Python files</li> <li>Include or exclude test files</li> <li>Show only directories</li> <li>Output to a file, while preserving existing inline comments</li> <li>Clean untracked files</li> </ul> </li> <li>If an output file is given and contains tree markers, the script:<ul> <li>Extracts inline comments from the existing tree</li> <li>Preserves these comments while updating the tree section</li> </ul> </li> </ul>"},{"location":"tools/all.invoke_bash_print_tree.how_to_guide.html#usage_instructions","title":"Usage Instructions","text":"<ul> <li> <p>Some examples of workflows are:</p> <pre><code># Print the current directory tree.\n&gt; i bash_print_tree\n\n# Limit depth to 2 and include test files.\n&gt; i bash_print_tree --path=\"devops\" --depth=2 --include-tests\n\n# Include only Python files.\n&gt; i bash_print_tree --include-python\n\n# Print only directory names.\n&gt; i bash_print_tree --only-dirs\n\n# Overwrite tree block in a Markdown file while preserving comments.\n&gt; i bash_print_tree --path=\"devops\" --output=\"README.md\"\n\n# Clean untracked files before generating the tree.\n&gt; i bash_print_tree --clean\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_bash_print_tree.how_to_guide.html#use_cases","title":"Use Cases","text":"<ul> <li>Documenting file structures in <code>README.md</code> or similar documentation</li> <li>Auditing the layout of codebases and shared folders</li> <li>Tracking structural changes over time via version control</li> </ul>"},{"location":"tools/all.invoke_bash_print_tree.how_to_guide.html#example","title":"Example","text":"<ul> <li>Consider the case where we want to document the DevOps code organization     located in the directory <code>devops</code></li> </ul>"},{"location":"tools/all.invoke_bash_print_tree.how_to_guide.html#step_1_create_a_new_file_with_tree_output","title":"Step 1: Create a new file with tree output","text":"<ul> <li> <p>Create the initial file with the structure of the tree</p> <pre><code>&gt; i bash_print_tree --path=\"devops\" --output=\"all.devops_docker.reference.md\"\n</code></pre> </li> <li> <p>The output file <code>all.devops_docker.reference.md</code> should look like this:</p> <pre><code>&lt;!-- tree:start:devops --&gt;\n\ndevops\n- compose\n    - tmp.docker-compose.yml\n- docker_build\n    - create_users.sh\n    - dev.Dockerfile\n    - dockerignore.dev\n    - dockerignore.prod\n    - etc_sudoers\n    - fstab\n    - install_cprofile.sh\n    - install_dind.sh\n    - install_os_packages.sh\n    - install_publishing_tools.sh\n    - install_python_packages.sh\n    - pip_list.txt\n    - poetry.lock\n    - poetry.toml\n    - prod.Dockerfile\n    - pyproject.python_data_stack.toml\n    - pyproject.toml\n    - update_os.sh\n    - utils.sh\n- docker_run\n    - bashrc\n    - docker_setenv.sh\n    - entrypoint.sh\n    - run_jupyter_server.sh\n- env\n    - default.env\n    &lt;!-- tree:end --&gt;\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_bash_print_tree.how_to_guide.html#step_2_add_comments_to_explain_important_files","title":"Step 2: Add comments to explain important files","text":"<ul> <li> <p>You edit the output file <code>all.devops_docker.reference.md</code> and more information     and comments to the files in the tree</p> <pre><code>## Introduction\n\nThis file documents the code organization and Docker-based DevOps structure.\n\n## Directory Structure\n\n&lt;!-- tree:start:devops --&gt;\n\ndevops\n- compose # Contains Docker compose files.\n    - tmp.docker-compose.yml\n- docker_build # Building Docker image.\n    - create_users.sh # Create container users.\n    - dev.Dockerfile\n    - dockerignore.dev\n    - dockerignore.prod\n    - etc_sudoers # Gives sudo permissions.\n    - fstab\n    - install_cprofile.sh\n    - install_dind.sh # Installs docker-in-docker.\n    - install_os_packages.sh\n    - install_publishing_tools.sh\n    - install_python_packages.sh\n    - pip_list.txt\n    - poetry.lock\n    - poetry.toml\n    - prod.Dockerfile\n    - pyproject.python_data_stack.toml\n    - pyproject.toml\n    - update_os.sh\n    - utils.sh\n- docker_run # Running Docker image.\n    - bashrc\n    - docker_setenv.sh\n    - entrypoint.sh\n    - run_jupyter_server.sh\n- env\n    - default.env\n    &lt;!-- tree:end --&gt;\n\n## Docker invoke flow\n\nThere exists `docker_bash` and `docker_jupyter`.\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_bash_print_tree.how_to_guide.html#step_3_add_more_files_and_subdirectories_to_devops","title":"Step 3: Add more files and subdirectories to <code>devops</code>","text":"<ul> <li> <p>Over time, additional files and subdirectories will be added to <code>devops</code></p> <pre><code># Create a new directory.\n&gt; mkdir -p devops/debug\n\n# Add a new file.\n&gt; touch devops/docker_build/install_tools.sh\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_bash_print_tree.how_to_guide.html#step_4_re-run_the_workflow_to_update_the_tree","title":"Step 4: Re-run the workflow to update the tree","text":"<ul> <li> <p>Update the documentation file with the updated structure of <code>devops</code></p> <pre><code>&gt; i bash_print_tree --path=\"devops\" --output=\"all.devops_docker.reference.md\"\n</code></pre> </li> <li> <p>The updated tree will reflect the new files while preserving comments:</p> <pre><code>## Introduction\n\nThis file documents the code organization and Docker-based DevOps structure.\n\n## Directory Structure\n\n&lt;!-- tree:start:devops --&gt;\n\ndevops\n- compose # Contains Docker compose files.\n    - tmp.docker-compose.yml\n- debug\n- docker_build # Building Docker image.\n    - create_users.sh # Create container users.\n    - dev.Dockerfile\n    - dockerignore.dev\n    - dockerignore.prod\n    - etc_sudoers # Gives sudo permissions.\n    - fstab\n    - install_cprofile.sh\n    - install_dind.sh # Installs docker-in-docker.\n    - install_os_packages.sh\n    - install_publishing_tools.sh\n    - install_python_packages.sh\n    - install_tools.sh\n    - pip_list.txt\n    - poetry.lock\n    - poetry.toml\n    - prod.Dockerfile\n    - pyproject.python_data_stack.toml\n    - pyproject.toml\n    - update_os.sh\n    - utils.sh\n- docker_run # Running Docker image.\n    - bashrc\n    - docker_setenv.sh\n    - entrypoint.sh\n    - run_jupyter_server.sh\n- env\n    - default.env\n    &lt;!-- tree:end --&gt;\n\n## Docker invoke flow\n\nThere exists `docker_bash` and `docker_jupyter`.\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_bash_print_tree.how_to_guide.html#known_limitations","title":"Known Limitations","text":"<ul> <li>Inline comment preservation only works if the tree is wrapped with markers     like <code>&lt;!-- tree:start:{name} --&gt;</code> and <code>&lt;!-- tree:end --&gt;</code></li> <li>The function does not support excluding arbitrary file patterns beyond test or     Python filters</li> </ul>"},{"location":"tools/all.invoke_bash_print_tree.how_to_guide.html#future_improvements","title":"Future Improvements","text":"<ul> <li>Add support for custom exclude or include glob patterns</li> <li>Support multiple tree blocks per file (e.g., for different directories)</li> <li>Improve standardization of how tree blocks are rendered in Markdown files by     wrapping the content between markers in a code block (e.g., using <code>```bash</code>)     so that only the tree, not the markers, is displayed in the final output</li> </ul>"},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html","title":"All.invoke git branch copy.how to guide","text":""},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html#the_git_branch_copy_workflow","title":"The Git Branch Copy Workflow","text":""},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html#introduction","title":"Introduction","text":"<ul> <li>The <code>git_branch_copy</code> <code>invoke</code> workflow creates a new Git branch derived from     the current branch and copies its content exactly</li> <li>It's primarily useful in scenarios where a large PR (Pull Request) needs to be     split into smaller, independently mergeable PRs to improve code review     efficiency and reduce integration complexity</li> <li>This approach allows to:<ul> <li>Develop a large feature in one-shot, but merge it in chunks</li> <li>Easily extract a sub-PR, since often \"removing\" code chunks is simpler than     \"adding\" code chunks one by one, e.g., by reverting an entire file</li> <li>Overlap developing and testing / reviewing</li> <li>Make it simple to extract a sub-PR and then merge it back into the feature     branch easily</li> </ul> </li> </ul>"},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html#workflow_explanation","title":"Workflow Explanation","text":"<ul> <li>The workflow executes the following operations:<ul> <li>Cleans up untracked files in the working directory</li> <li>Optionally merges the latest changes from <code>master</code> before creating the new     branch</li> <li>Creates and switches to a new branch<ul> <li>Automatically generates a suitable branch name if not explicitly provided</li> <li>Validates the new branch name according to established naming conventions,     e.g, <code>{Repo}Task{Number}_{Description}</code></li> </ul> </li> <li>Squash merge changes from the current branch into the new branch<ul> <li>Changes are staged, but uncommitted, to allow developers to selectively     stage, commit, and push specific parts.</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html#usage_instructions","title":"Usage Instructions","text":"<ul> <li> <p>Go to the target branch to merge</p> <pre><code>&gt; git checkout CmTask5874_Document_PR_flow\n</code></pre> </li> <li> <p>You can execute the workflow with one of these command:</p> <pre><code># Create new branch with an automatically generated name (e.g., `CmTask5874_Document_PR_flow_02`).\n&gt; i git_branch_copy\n\n# Create new branch with given name.\n&gt; i git_branch_copy --new-branch-name=\"CmTask5874_PR_flow_Images\"\n\n# Create a new branch without merging `master`.\n&gt; i git_branch_copy --skip-git-merge-master --new-branch-name=\"CmTask5874_PR_flow_Images\"\n\n# Create a new branch without checking for naming conventions.\n&gt; i git_branch_copy --new-branch-name=\"wrongname_123\" --no-check-branch-name\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html#example","title":"Example","text":"<ul> <li>Consider the case where we are working on a large feature branch     <code>CmTask5874_Document_PR_flow</code></li> <li> <p>For various reasons we might want to extract and merge just a few files, e.g.,</p> <ul> <li>The regression tests are not passing and we want to test and merge only a     subset of changes</li> <li>The branch contains unrelated changes (e.g., while implementing a feature,     we ended up fixing another issue)</li> <li>The PR is too complex to review in one shot and we want to break it down in     reviewable pieces</li> </ul> </li> <li> <p>Rather than merging the main PR, we create one or more children PRs, and merge     them into <code>master</code> one at a time</p> </li> </ul>"},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html#step_1_make_sure_your_branch_is_up_to_date","title":"Step 1: Make sure your branch is up to date","text":"<ul> <li> <p>Use this workflow to ensure your branch is up to date with <code>master</code></p> <pre><code># First switch to your feature branch.\n&gt; git checkout CmTask5874_Document_PR_flow\n\n# Make sure that the branch is up-to-date with master.\n&gt; i git_merge_master\n\n# Commit and push the changes that you have made to the branch.\n&gt; git commit -m \"Merge\"\n&gt; git push\n\n# Check the diff between your branch and master.\n&gt; i git_branch_diff_with -t base --only-print-files\n</code></pre> </li> <li> <p>The output looks like:</p> <pre><code>INFO: &gt; cmd='/data/sameepp/src/venv/amp.client_venv/bin/invoke git_branch_diff_with -t base --only-print-files'\n04:58:35 - INFO  lib_tasks_git.py _git_diff_with_branch:726\n###############################################################################\n# files=3\n###############################################################################\n04:58:35 - INFO  lib_tasks_git.py _git_diff_with_branch:727\n./figs/development/Fig1.png\n./figs/development/Fig2.png\ndocs/work_tools/all.development.how_to_guide.md\n04:58:35 - WARN  lib_tasks_git.py _git_diff_with_branch:732             Exiting as per user request with --only-print-files\n</code></pre> </li> <li> <p>As shown above, three files have been modified</p> </li> <li> <p>Suppose we only want to partially merge this PR, specifically, just the <code>.png</code>     files, while continuing development in the main feature branch</p> </li> </ul>"},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html#step_2_create_a_new_branch_from_your_feature_branch","title":"Step 2: Create a new branch from your feature branch","text":"<ul> <li> <p>Create a new branch (e.g., <code>CmTask5874_Document_PR_flow_02</code>) derived from our     feature branch <code>CmTask5874_Document_PR_flow</code></p> <pre><code># Create a derived branch from the feature branch.\n&gt; i git_branch_copy\nINFO: &gt; cmd='/data/sameepp/src/venv/amp.client_venv/bin/invoke git_branch_copy'\ngit clean -fd\ninvoke git_merge_master --ff-only\nFrom github.com:cryptokaizen/cmamp\ne59affd79..d6e6ed8e4  master     -&gt; master\nINFO: &gt; cmd='/data/sameepp/src/venv/amp.client_venv/bin/invoke git_merge_master --ff-only'\n## git_merge_master:\n## git_fetch_master:\ngit fetch origin master:master\ngit submodule foreach 'git fetch origin master:master'\ngit merge master --ff-only\nAlready up to date.\n07:04:46 - INFO  lib_tasks_git.py git_branch_copy:599                   new_branch_name='CmTask5874_Document_PR_flow_2'\ngit checkout master &amp;&amp; invoke git_branch_create -b 'CmTask5874_Document_PR_flow_2'\nSwitched to branch 'master'\nYour branch is up to date with 'origin/master'.\nINFO: &gt; cmd='/data/sameepp/src/venv/amp.client_venv/bin/invoke git_branch_create -b CmTask5874_Document_PR_flow_2'\n## git_branch_create:\n07:05:00 - INFO  lib_tasks_git.py git_branch_create:413                 branch_name='CmTask5874_Document_PR_flow_2'\ngit pull --autostash --rebase\nCurrent branch master is up to date.\nSwitched to a new branch 'CmTask5874_Document_PR_flow_2'\nremote:\nremote: Create a pull request for 'CmTask5874_Document_PR_flow_2' on GitHub by visiting:\nremote:      https://github.com/cryptokaizen/cmamp/pull/new/CmTask5874_Document_PR_flow_2\nremote:\nTo github.com:causify-ai/cmamp.git\n[new branch] CmTask5874_Document_PR_flow_2 -&gt;\nCmTask5874_Document_PR_flow_2 git checkout -b CmTask5874_Document_PR_flow_2\ngit push --set-upstream origin CmTask5874_Document_PR_flow_2 Branch\n'CmTask5874_Document_PR_flow_2' set up to track remote branch\n'CmTask5874_Document_PR_flow_2' from 'origin'. git merge --squash --ff\nCmTask5874_Document_PR_flow &amp;&amp; git reset HEAD Updating d6e6ed8e4..a264a6f30\nFast-forward Squash commit -- not updating HEAD\ndocs/work_tools/figs/development/Fig1.png | Bin 27415 -&gt; 0 bytes\ndocs/work_tools/figs/development/Fig2.png | Bin 35534 -&gt; 0 bytes 2 files\nchanged, 0 insertions(+), 0 deletions(-) delete mode 100644\ndocs/work_tools/figs/development/Fig1.png delete mode 100644\ndocs/work_tools/figs/development/Fig2.png Unstaged changes after reset: D\ndocs/work_tools/figs/development/Fig1.png D\ndocs/work_tools/figs/development/Fig2.png\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html#step_3_confirm_the_new_branch_is_created","title":"Step 3: Confirm the new branch is created","text":"<ul> <li> <p>After running the command, a new branch <code>CmTask5874_Document_PR_flow_2</code> is     created, containing all changes from the original feature branch</p> <pre><code>&gt; git status\nOn branch CmTask5874_Document_PR_flow_2\nYour branch is up to date with 'origin/CmTask5874_Document_PR_flow_2'.\n\nUntracked files:\n(use \"git add &lt;file&gt;...\" to include in what will be committed)\n        ./figs/development/Fig1.png\n        ./figs/development/Fig2.png\n        docs/work_tools/all.invoke_workflows.how_to_guide.md\n</code></pre> </li> <li> <p>You can now stage and commit only the files you want to merge (e.g., the     <code>.png</code> files), and proceed to create a PR to merge those changes into <code>master</code></p> <pre><code># Add, commit and push only the required files.\n&gt; git add ./figs/development/Fig1.png ./figs/development/Fig2.png\n&gt; git commit -m \"Checkpoint\"\n&gt; git push origin CmTask5874_Document_PR_flow_2\n</code></pre> </li> <li> <p>From this you can create a PR, test it, review it, and merge it</p> </li> <li> <p>Once the chunk is merged into <code>master</code>, you can go to the father branch and     merge <code>master</code></p> <pre><code>&gt; git checkout CmTask5874_Document_PR_flow\n&gt; i git_merge_master\n&gt; git commit -am \"Merge\"\n&gt; git push\n</code></pre> </li> <li> <p>Note that the merge it's typically very simple, since the incoming code is the     same one that is already in the branch</p> </li> </ul>"},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html#execution_flow_diagram","title":"Execution flow diagram","text":"<pre><code>%%{init: {'theme': 'base', 'gitGraph': {'mainBranchName': 'master'}}}%%\ngitGraph\n        commit id: \"Initial commit (master)\"\n        branch CmTask5874_Document_PR_flow\n        checkout CmTask5874_Document_PR_flow\n        commit id: \"Feature change 1\"\n        commit id: \"Feature change 2\"\n        checkout master\n        branch CmTask5874_Document_PR_flow_2\n        checkout CmTask5874_Document_PR_flow_2\n        merge CmTask5874_Document_PR_flow id: \"Squash feature changes\"\n        commit id: \"Commit .png files only\"\n        checkout master\n        merge CmTask5874_Document_PR_flow_2 id: \"Partial PR merged\"\n        checkout CmTask5874_Document_PR_flow\n        merge master id: \"Sync with master\"</code></pre>"},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html#alternative_manual_workflow","title":"Alternative Manual Workflow","text":"<ul> <li>You can also manually extract part of a PR using patch-based workflows or     squash merging.</li> </ul>"},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html#using_invoke_git_create_patch","title":"Using invoke <code>git_create_patch</code>","text":"<ul> <li> <p>If you're working with multiple Git clients or prefer working outside your     development tree:</p> <pre><code># In your feature branch:\n&gt; i git_patch_create --branch\n\n# Copy the patch file to a clean Git client or switch to `master`\n&gt; git checkout master\n\n# Apply the patch generated earlier\n&gt; git apply ~/patch.amp.8f9cda97.20210609_080439.patch\n\n# The patch should apply cleanly. If you get conflicts, your feature branch may not be up-to-date with `master`.\n\n# Clean up unwanted files before committing\n&gt; git diff\n&gt; git checkout master -- files/to/revert\n\n# Commit and push selected changes\n&gt; git commit -m \"Partial merge from feature branch\"\n&gt; git push\n\n# Create a PR to trigger GitHub tests\n&gt; i gh_create_pr --no-draft\n\n# Run regression tests\n&gt; i run_fast_tests\n\n# Merge PR into `master`\n\n# Return to your feature branch and merge updates from `master`\n&gt; git checkout CmTask5874_Document_PR_flow\n&gt; git pull\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html#known_limitations","title":"Known Limitations","text":"<ul> <li>Currently, the <code>use_patch</code> option for creating branches via patches is     unimplemented and reserved for future enhancements</li> <li>The workflow doesn't explicitly handle merge conflicts during the squash merge     step, manual resolution may be required</li> </ul>"},{"location":"tools/all.invoke_git_branch_copy.how_to_guide.html#future_improvements","title":"Future Improvements","text":"<ul> <li>Implement the <code>use_patch</code> option to support patch-based branch creation</li> <li>Introduce enhanced automation for conflict resolution and interactive conflict     handling during branch operations</li> <li>Provide options to handle specific file types or directories selectively     during branch creation</li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html","title":"All.invoke workflows.how to guide","text":""},{"location":"tools/all.invoke_workflows.how_to_guide.html#invoke_workflows","title":"Invoke Workflows","text":""},{"location":"tools/all.invoke_workflows.how_to_guide.html#introduction","title":"Introduction","text":"<ul> <li>We use <code>invoke</code> to implement workflows (aka \"tasks\") similar to Makefile     targets, but using Python</li> <li> <p>The official documentation for <code>invoke</code> is     here</p> </li> <li> <p>We use <code>invoke</code> to automate tasks and package workflows for:</p> <ul> <li>Docker: <code>docker_*</code></li> <li>Git: <code>git_*</code></li> <li>GitHub (relying on <code>gh</code> integration): <code>gh_*</code></li> <li>Running tests: <code>run_*</code></li> <li>Branch integration: <code>integrate_*</code></li> <li>Releasing tools and Docker images: <code>docker_*</code></li> <li>Lint: <code>lint_*</code></li> </ul> </li> <li> <p>Each set of commands starts with the name of the corresponding topic:</p> <ul> <li>E.g., <code>docker_*</code> for all the tasks related to Docker</li> </ul> </li> <li>The best approach to getting familiar with the tasks is to browse the list and     then check the output of the help</li> <li> <p><code>i</code> is the shortcut for the <code>invoke</code> command</p> <pre><code>&gt; invoke --help command\n&gt; i -h gh_issue_title\nUsage: inv[oke] [--core-opts] gh_issue_title [--options] [other tasks here ...]\n\nDocstring:\nPrint the title that corresponds to the given issue and repo_short_name.\nE.g., AmpTask1251_Update_GH_actions_for_amp.\n\n:param pbcopy: save the result into the system clipboard (only on macOS)\n\nOptions:\n-i STRING, --issue-id=STRING\n-p, --[no-]pbcopy\n-r STRING, --repo-short-name=STRING\n</code></pre> </li> <li> <p>We can guarantee you a 2x improvement in performance if you master the     workflows, but it takes some time and patience</p> </li> <li> <p><code>TAB</code> completion available for all the tasks, e.g.,</p> <p><pre><code>&gt; i gh_&lt;TAB&gt;\ngh_create_pr      gh_issue_title    gh_login          gh_workflow_list  gh_workflow_run\n</code></pre> - Tabbing after typing a dash (-) or double dash (--) will display valid     options/flags for the current context.</p> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#listing_all_the_tasks","title":"Listing All the Tasks","text":"<ul> <li> <p>New commands are always being added, but a list of valid tasks is below</p> <pre><code>&gt; invoke --list\nINFO: &gt; cmd='/Users/saggese/src/venv/amp.client_venv/bin/invoke --list'\nAvailable tasks:\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#getting_help_for_a_specific_workflow","title":"Getting Help for a Specific Workflow","text":"<ul> <li> <p>You can get a more detailed help with</p> <pre><code>&gt; invoke --help run_fast_tests\nUsage: inv[oke] [--core-opts] run_fast_tests [--options] [other tasks here ...]\n\nDocstring:\nRun fast tests.\n\n:param stage: select a specific stage for the Docker image\n:param pytest_opts: option for pytest\n:param pytest_mark: test list to select as `@pytest.mark.XYZ`\n:param dir_name: dir to start searching for tests\n:param skip_submodules: ignore all the dir inside a submodule\n:param coverage: enable coverage computation\n:param collect_only: do not run tests but show what will be executed\n\nOptions:\n-c, --coverage\n-d STRING, --dir-name=STRING\n-k, --skip-submodules\n-o, --collect-only\n-p STRING, --pytest-opts=STRING\n-s STRING, --stage=STRING\n-y STRING, --pytest-mark=STRING\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#implementation_details","title":"Implementation Details","text":"<ul> <li>By convention all invoke targets are in <code>*_lib_tasks.py</code>, e.g.,<ul> <li><code>helpers/lib_tasks.py</code> - tasks to be run in <code>cmamp</code></li> <li><code>optimizer/opt_lib_tasks.py</code> - tasks to be run in <code>cmamp/optimizer</code></li> </ul> </li> <li> <p>All invoke tasks are functions with the <code>@task</code> decorator, e.g.,</p> <p>```python from invoke import task</p> </li> </ul> <p>@task def invoke_task(...):     ...     ```</p> <ul> <li>To run a task we use <code>context.run(...)</code>, see     the official docs</li> <li>To be able to run a specified invoke task one should import it in <code>tasks.py</code><ul> <li>E.g., see <code>cmamp/tasks.py</code></li> </ul> </li> <li>A task can be run only in a dir where it is imported in a corresponding     <code>tasks.py</code>, e.g.,<ul> <li><code>invoke_task1</code> is imported in <code>cmamp/tasks.py</code> so it can be run only from     <code>cmamp</code></li> <li><code>invoke_task2</code> is imported in <code>cmamp/optimizer/tasks.py</code> so it can be run     only from <code>cmamp/optimizer</code><ul> <li>In other words one should do <code>cd cmamp/optimizer</code> before doing     <code>i invoke_task2 ...</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#task_categories","title":"Task Categories","text":"<p>The invoke tasks are organized into the following categories:</p> <ul> <li> <p>AWS/ECS Task Definitions</p> <ul> <li>Tasks for managing AWS ECS task definitions across different environments     (test, preprod, prod).<ul> <li>Creating task definitions for different environments</li> <li>Copying image URLs between task definitions</li> </ul> </li> </ul> </li> <li> <p>Bash Utilities</p> <ul> <li>Simple bash utility commands for printing paths and directory trees.</li> </ul> </li> <li> <p>Docker Tasks</p> <ul> <li>Comprehensive Docker workflow automation including:<ul> <li>Container Operations: Starting bash shells, running commands, Jupyter notebooks</li> <li>Image Building: Building local, dev, prod, and multi-arch images</li> <li>Image Management: Listing, pulling, pushing, and removing images</li> <li>Release Workflows: Complete release pipelines for dev and prod images</li> <li>Tagging: Managing image tags across registries</li> </ul> </li> </ul> </li> <li> <p>Find Utilities</p> <ul> <li>Code search and discovery tools:<ul> <li>Finding symbols, imports, and dependencies</li> <li>Locating test classes and decorators</li> <li>Finding <code>check_string()</code> output in tests</li> </ul> </li> </ul> </li> <li> <p>GitHub Integration</p> <ul> <li>GitHub operations via <code>gh</code> CLI integration:<ul> <li>Creating and managing pull requests</li> <li>Managing GitHub issues</li> <li>Running and monitoring GitHub Actions workflows</li> <li>Publishing dashboards to S3</li> </ul> </li> </ul> </li> <li> <p>Git Operations</p> <ul> <li>Git workflow automation:<ul> <li>Branch management (create, copy, rename, delete)</li> <li>Branch analysis (files changed, diffs, merge status)</li> <li>Merging and pulling changes</li> <li>Creating patches and backups</li> <li>Repository integration</li> </ul> </li> </ul> </li> <li> <p>Integration Workflows</p> <ul> <li> <p>Tools for integrating code between different repository directories:</p> <ul> <li>Creating integration branches</li> <li>Finding and comparing modified files</li> <li>Syncing directories with rsync</li> <li>Managing cross-repo integrations</li> </ul> </li> <li> <p>Linting and Code Quality</p> <ul> <li>Code quality and linting tools:<ul> <li>Running linters on modified files</li> <li>Checking Python file compilation</li> <li>Detecting cyclic imports</li> <li>Creating lint branches</li> <li>Syncing linting code</li> </ul> </li> </ul> </li> <li> <p>Pytest</p> <ul> <li>Test management utilities:<ul> <li>Managing golden outcome files</li> <li>Running regression tests (buildmeister)</li> <li>Cleaning pytest artifacts</li> <li>Comparing test logs</li> <li>Renaming tests and their outcomes</li> <li>Reproducing failed tests</li> </ul> </li> </ul> </li> <li> <p>Running Tests</p> <ul> <li>Test execution tasks for different test suites:<ul> <li>Fast tests (quick unit tests)</li> <li>Slow tests (integration tests)</li> <li>Superslow tests (end-to-end tests)</li> <li>Test coverage reporting</li> <li>QA tests</li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#common_workflows","title":"Common Workflows","text":""},{"location":"tools/all.invoke_workflows.how_to_guide.html#git_workflows","title":"Git Workflows","text":""},{"location":"tools/all.invoke_workflows.how_to_guide.html#merge_master_in_the_current_branch","title":"Merge Master in the Current Branch","text":"<pre><code>&gt; i git_merge_master\n</code></pre>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#github_workflows","title":"Github Workflows","text":"<ul> <li> <p>Get the official branch name corresponding to an Issue</p> <pre><code>&gt; i gh_issue_title -i 256\n## gh_issue_title: issue_id='256', repo_short_name='current'\n\n# Copied to system clipboard:\nAmpTask256_Part_task2236_jenkins_cleanup_split_scripts:\nhttps://github.com/alphamatic/amp/pull/256\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#create_a_pr","title":"Create a PR","text":"<p>TODO(gp): Describe</p>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#extract_a_pr_from_a_larger_one","title":"Extract a PR From a Larger One","text":"<ul> <li>For splitting large PRs, use the dedicated workflow `git_branch_copy'</li> <li>See detailed guide in     all.invoke_git_branch_copy.how_to_guide.md</li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#systematic_code_transformation","title":"Systematic Code Transformation","text":"<ul> <li>Can be done with the help of     <code>dev_scripts_helpers/system_tools/replace_text.py</code></li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#docker_workflows","title":"Docker Workflows","text":""},{"location":"tools/all.invoke_workflows.how_to_guide.html#generate_a_local_amp_docker_image","title":"Generate a Local <code>amp</code> Docker Image","text":"<ul> <li>This is a manual flow used to test and debug images before releasing them to     the team.</li> <li> <p>The flow is similar to the dev image, but by default tests are not run and the     image is not released.</p> <pre><code># Build the local image (and update Poetry dependencies, if needed).\n\n&gt; i docker_build_local_image --update-poetry\n...\ndocker image ls 665840871993.dkr.ecr.us-east-1.amazonaws.com/amp:local\n\nREPOSITORY TAG IMAGE ID CREATED SIZE\n665840871993.dkr.ecr.us-east-1.amazonaws.com/amp local 9b3f8f103a2c 1 second ago 1.72GB\n\n# Test the new \"local\" image\n&gt; i docker_bash --stage \"local\" python -c \"import async_solipsism\" python -c\n&gt; \"import async_solipsism; print(async_solipsism.**version**)\"\n\n# Run the tests with local image\n# Make sure the new image is used: e.g., add an import and trigger the tests.\n&gt; i run_fast_tests --stage \"local\" --pytest-opts core/dataflow/test/test_real_time.py\n&gt; i run_fast_slow_tests --stage \"local\"\n\n# Promote a local image to dev.\n&gt; i docker_tag_local_image_as_dev\n&gt; i docker_push_dev_image\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#update_the_dev_amp_docker_image","title":"Update the dev <code>amp</code> Docker image","text":"<ul> <li> <p>To implement the entire Docker QA process of a dev image</p> <pre><code># Clean all the Docker images locally, to make sure there is no hidden state.\n&gt; docker system prune --all\n\n# Update the needed packages.\n&gt; devops/docker_build/pyproject.toml\n\n# Visually inspect the updated packages.\n&gt; git diff devops/docker_build/poetry.lock\n\n# Run entire release process.\n&gt; i docker_release_dev_image\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#experiment_in_a_local_image","title":"Experiment in a local image","text":"<ul> <li> <p>To install packages in an image, do <code>i docker_bash</code></p> <pre><code># Switch to root and install package.\n&gt; sudo su -\n&gt; source /venv/bin/activate\n&gt; pip install &lt;package&gt;\n\n# Switch back to user.\n&gt; exit\n</code></pre> </li> <li> <p>You should test that the package is installed for your user, e.g.,     <pre><code>&gt; source /venv/bin/activate python -c \"import foobar; print(foobar);print(foobar.__version__)\"\n</code></pre></p> </li> <li>You can now use the package in this container. Note that if you exit the     container, the modified image is lost, so you need to install it again.</li> <li>You can save the modified image, tagging the new image as local, while the     container is still running.</li> <li>Copy your Container ID. You can find it<ul> <li>In the docker bash session, e.g., if the command line in the container     starts with <code>user_1011@da8f3bb8f53b:/app$</code>, your Container ID is     <code>da8f3bb8f53b</code></li> <li>By listing running containers, e.g., run <code>docker ps</code> outside the container</li> </ul> </li> <li>Commit image     <pre><code>&gt; docker commit &lt;Container ID&gt; &lt;IMAGE&gt;/cmamp:local-$USER\n</code></pre><ul> <li>E.g.     <code>docker commit da8f3bb8f53b 665840871993.dkr.ecr.us-east-1.amazonaws.com/cmamp:local-julias</code></li> </ul> </li> <li>If you are running inside a notebook using <code>i docker_jupyter</code> you can install     packages using a one liner <code>! sudo su -; source ...;</code></li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#github_actions_ci","title":"Github Actions (CI)","text":"<ul> <li>To run a single test in GH Action<ul> <li>Create a branch</li> <li>Change .github/workflows/fast_tests.yml     <pre><code>run: invoke run_fast_tests\n--pytest-opts=\"helpers/test/test_git.py::Test_git_modified_files1::test_get_modified_files_in_branch1\n-s --dbg\"\n</code></pre></li> </ul> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#pytest_workflows","title":"Pytest Workflows","text":"<ul> <li> <p>From     https://gist.github.com/kwmiebach/3fd49612ef7a52b5ce3a</p> </li> <li> <p>More details on running unit tests with <code>invoke</code> is     /docs/coding/all.run_unit_tests.how_to_guide.md</p> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#run_with_coverage","title":"Run with Coverage","text":"<pre><code>&gt; i run_fast_tests --pytest-opts=\"core/test/test_finance.py\" --coverage\n</code></pre>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#capture_output_of_a_pytest","title":"Capture Output of a Pytest","text":"<ul> <li> <p>Inside the <code>dev</code> container (i.e., docker bash)</p> <p><pre><code>docker&gt; pytest_log ...\n</code></pre> - This captures the output in a file <code>tmp.pytest_script.txt</code></p> </li> <li> <p>Get the failed tests (inside or outside the container)     <pre><code>[docker]&gt; i pytest_failed\ndataflow/model/test/test_run_notebooks.py::Test_run_master_research_backtest_analyzer::test_run_notebook1\ndataflow/system/test/test_real_time_runner.py::TestRealTimeDagRunner1::test_simulated_replayed_time1\ndataflow/model/test/test_dataframe_modeler.py::TestDataFrameModeler::test_dump_json1\n...\n</code></pre></p> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#run_only_one_test_based_on_its_name","title":"Run Only One Test Based on Its Name","text":"<ul> <li> <p>Outside the <code>dev</code> container</p> <pre><code>&gt; i find_test_class Test_obj_to_str1\nINFO: &gt; cmd='/Users/saggese/src/venv/amp.client_venv/bin/invoke find_test_class Test_obj_to_str1'\n## find_test_class: class_name abs_dir pbcopy\n10:18:42 - INFO  lib_tasks_find.py _find_test_files:44                  Searching from '.'\n\n# Copied to system clipboard:\n./helpers/test/test_hobject.py::Test_obj_to_str1\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#iterate_on_stacktrace_of_failing_test","title":"Iterate on Stacktrace of Failing Test","text":"<ul> <li>Inside docker bash     <pre><code>docker&gt; pytest ...\n</code></pre></li> <li> <p>The test fails: switch to using <code>pytest_log</code> to save the stacktrace to a file</p> <pre><code>&gt; pytest_log dataflow/model/test/test_tiled_flows.py::Test_evaluate_weighted_forecasts::test_combine_two_signals\n...\n=================================== FAILURES ===================================\n__________ Test_evaluate_weighted_forecasts.test_combine_two_signals ___________\nTraceback (most recent call last):\n    File \"/app/dataflow/model/test/test_tiled_flows.py\", line 78, in test_combine_two_signals\n        bar_metrics = dtfmotiflo.evaluate_weighted_forecasts(\n    File \"/app/dataflow/model/tiled_flows.py\", line 265, in evaluate_weighted_forecasts\n        weighted_sum = hpandas.compute_weighted_sum(\nTypeError: compute_weighted_sum() got an unexpected keyword argument 'index_mode'\n============================= slowest 3 durations ==============================\n2.18s call     dataflow/model/test/test_tiled_flows.py::Test_evaluate_weighted_forecasts::test_combine_two_signals\n0.01s setup    dataflow/model/test/test_tiled_flows.py::Test_evaluate_weighted_forecasts::test_combine_two_signals\n0.00s teardown dataflow/model/test/test_tiled_flows.py::Test_evaluate_weighted_forecasts::test_combine_two_signals\n</code></pre> </li> <li> <p>Then from outside <code>dev</code> container launch <code>vim</code> in quickfix mode</p> <pre><code>&gt; invoke traceback\n</code></pre> </li> <li> <p>The short form is <code>it</code></p> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#iterating_on_a_failing_regression_test","title":"Iterating on a Failing Regression Test","text":"<ul> <li> <p>The workflow is:</p> <pre><code># Run a lot of tests, e.g., the entire regression suite.\n&gt; pytest ...\n# Some tests fail.\n\n# Run the `pytest_repro` to summarize test failures and to generate commands to reproduce them.\n&gt; invoke pytest_repro\n</code></pre> </li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#detect_mismatches_with_golden_test_outcomes","title":"Detect Mismatches with Golden Test Outcomes","text":"<ul> <li> <p>The command is</p> <pre><code>&gt; i pytest_find_unused_goldens\n</code></pre> </li> <li> <p>The specific dir to check can be specified with the <code>dir_name</code> parameter.</p> </li> <li>The invoke detects and logs mismatches between the tests and the golden     outcome files.<ul> <li>When goldens are required by the tests but the corresponding files do not     exist<ul> <li>This usually happens if the tests are skipped or commented out.</li> <li>Sometimes it's a FP hit (e.g. the method doesn't actually call     <code>check_string</code> but instead has it in a string, or <code>check_string</code> is called     on a missing file on purpose to verify that an exception is raised).</li> </ul> </li> <li>When the existing golden files are not actually required by the     corresponding tests.<ul> <li>In most cases it means the files are outdated and can be deleted.</li> <li>Alternatively, it can be a FN hit: the test method A, which the golden     outcome corresponds to, doesn't call <code>check_string</code> directly, but the     test's class inherits from a different class, which in turn has a method B     that calls <code>check_string</code>, and this method B is called in the test method     A.</li> </ul> </li> </ul> </li> <li>For more details see     CmTask528.</li> </ul>"},{"location":"tools/all.invoke_workflows.how_to_guide.html#lint_workflows","title":"Lint Workflows","text":""},{"location":"tools/all.invoke_workflows.how_to_guide.html#lint_everything","title":"Lint Everything","text":"<pre><code>&gt; i lint --phases=\"amp_isort amp_class_method_order amp_normalize_import\namp_format_separating_line amp_black\" --files='$(find . -name \"\\*.py\")'\n</code></pre>"},{"location":"tools/all.llm_transform.how_to_guide.html","title":"All.llm transform.how to guide","text":""},{"location":"tools/all.llm_transform.how_to_guide.html#available_prompt_tags","title":"Available prompt tags:","text":"<p>code_1_unit_test code_apply_refactoring code_comment code_docstring code_propose_refactoring code_review code_review_and_improve code_type_hints code_unit_test md_rewrite md_summarize_short slide_colorize slide_colorize_points slide_improve</p>"},{"location":"tools/all.parquet.explanation.html","title":"All.parquet.explanation","text":""},{"location":"tools/all.parquet.explanation.html#pyarrow_parquet_management","title":"Pyarrow Parquet management","text":""},{"location":"tools/all.parquet.explanation.html#introduction","title":"Introduction","text":"<ul> <li> <p>What is Parquet?</p> <ul> <li>Parquet is a columnar storage file format that provides efficient data     compression and encoding schemes with enhanced performance to handle complex     data in bulk. It is designed to support complex data structures and is ideal     for big data processing.</li> </ul> </li> <li> <p>Core features of Parquet:</p> <ul> <li>Efficient storage and compression: Parquet uses efficient encoding and     compression techniques to store data in a columnar format, reducing the     storage space and improving the read performance</li> <li>Support for various compression algorithms: Parquet supports various     compression algorithms such as Snappy, Gzip, and LZO</li> <li>Support for complex data types: Parquet supports complex data types such as     nested fields, arrays, and maps, making it suitable for handling complex     data structures</li> <li>Efficient encoding and decoding schemes: Parquet provides efficient encoding     and decoding schemes for complex data types, improving the read and write     performance</li> </ul> </li> <li> <p>Pyarrow</p> <ul> <li>Pyarrow is a cross-language development platform for in-memory data that     provides efficient data interchange between Python and other languages. It     is designed to support complex data structures and is ideal for big data     processing.</li> <li>Pyarrow provides efficient data interchange between Python and other     languages, enabling seamless data exchange between different systems</li> <li>It supports various data types and complex data structures, making it     suitable for handling complex data processing tasks</li> </ul> </li> </ul>"},{"location":"tools/all.parquet.explanation.html#implementation_details","title":"Implementation details","text":"<p>The <code>helpers.hparquet</code> module provides a set of helper functions to manage Parquet files using the pyarrow library.</p>"},{"location":"tools/all.parquet.explanation.html#writing_parquet","title":"Writing Parquet","text":"<ul> <li> <p><code>to_parquet()</code></p> <ul> <li>Writes a Pandas DataFrame to a Parquet file</li> </ul> </li> <li> <p><code>to_partitioned_parquet()</code></p> <ul> <li>Writes a Pandas DataFrame to a partitioned Parquet files</li> </ul> </li> </ul>"},{"location":"tools/all.parquet.explanation.html#reading_parquet","title":"Reading Parquet","text":"<ul> <li><code>from_parquet()</code><ul> <li>Reads a Parquet file or partitional Parquet files into a Pandas DataFrame</li> </ul> </li> </ul>"},{"location":"tools/all.parquet.explanation.html#change_log","title":"Change log","text":""},{"location":"tools/all.parquet.explanation.html#2024-02-26_cmamp-1140","title":"2024-02-26: cmamp-1.14.0","text":"<ul> <li>Upgraded pyarrow to 14.0.2 -&gt; 15.0.0</li> <li>Update outomes in the tests due to the new version of pyarrow changed the size     of the some Parquet files</li> <li>Delete <code>partition_filename</code> from <code>to_partitioned_parquet()</code> function<ul> <li>Delete <code>partition_filename_cb</code> in the <code>pq.write_to_dataset()</code> call</li> </ul> </li> <li>Delete <code>partition_filename</code> arguments from the all calls of     <code>to_partitioned_parquet()</code> function</li> <li>In the <code>list_and_merge_pq_files()</code><ul> <li>In the <code>pq.ParquetDataset()</code> change <code>use_legacy_dataset=True</code> to     <code>partitioning=None</code></li> </ul> </li> <li>Introduce <code>purify_parquet_file_names()</code> in the <code>helpers/hunit_test.py</code></li> </ul>"},{"location":"tools/all.parquet.explanation.html#rationale","title":"Rationale","text":"<ul> <li>The upgrade to pyarrow 15.0.0 is necessary to keep the library up-to-date and     benefit from the latest features and improvements</li> <li>Due the <code>partition_filename_cb</code> is deprecated in the new version of pyarrow,     it is necessary to remove it from the <code>to_partitioned_parquet()</code> function<ul> <li>After discussion with the team, we decided to remove the     <code>partition_filename</code> from the <code>to_partitioned_parquet()</code> function</li> <li>The consequence of this change is that the Parquet files will be saved with     the default names like <code>&lt;guid&gt;-&lt;number&gt;.parquet</code> for example     <code>f3b3e3e33e3e3e3e3e3e3e3e3e3e3e3e-0.parquet</code></li> </ul> </li> <li>In the pyarrow 1.15.0 the <code>use_legacy_dataset</code> is deprecated and the     <code>partitioning</code> should be used instead<ul> <li>When we use the <code>partitioning=None</code> in <code>pq.ParquetDataset()</code> then we will     not use the partitioning and will not add the partitioned columns to the     dataset</li> <li>Some tests expect the Parquet files with the name <code>data.parquet</code>. The     <code>purify_parquet_file_names()</code> changes the names of the Parquet files to     <code>data.parquet</code> in the goldens</li> </ul> </li> </ul>"},{"location":"tools/all.parquet.explanation.html#2024-03-11_cmamptask7331_remove_ns_vs_us_hacks_related_to_pyarrow_1402","title":"2024-03-11: CmampTask7331 Remove <code>ns vs us</code> hacks related to Pyarrow 14.0.2","text":"<ul> <li>Remove time unit casting to <code>us</code> in the <code>to_parquet()</code></li> <li>Keep time unit casting to <code>ns</code> in the <code>from_parquet()</code></li> </ul>"},{"location":"tools/all.parquet.explanation.html#time_unit_conversion_when_writing_to_parquet","title":"Time unit conversion when writing to Parquet","text":"<ul> <li>Context: Before the upgrade to pyarrow 15.0.0, casting the time unit to     <code>us</code> was necessary to avoid the <code>pyarrow.lib.ArrowInvalid</code> exception.</li> <li>Problem: In pyarrow 15.0.0, this exception is no longer raised, and the     time unit is preserved correctly.</li> <li>Insight: Casting the time unit to <code>us</code> in the <code>to_parquet()</code> function is     no longer necessary and can be removed. At the same time, casting to <code>us</code> in     the <code>to_parquet()</code> function does not make sense since the time unit will be     converted back to <code>ns</code> in the <code>from_parquet()</code> function.</li> <li>Solution: Remove the casting of the time unit to <code>us</code> in the     <code>to_parquet()</code> function.</li> </ul>"},{"location":"tools/all.parquet.explanation.html#time_unit_conversion_when_reading_from_parquet","title":"Time unit conversion when reading from Parquet","text":"<ul> <li>Context: The pyarrow version prior to 15.0.0 did not correctly preserve     the time unit information when reading data back from Parquet files. That's     why casting the time unit to <code>ns</code> was necessary in the <code>from_parquet()</code>     function.</li> <li>Problem: Since the upgrade to pyarrow 15.0.0, casting the time unit to     <code>ns</code> is no longer necessary, as the new version of pyarrow correctly preserves     the time unit. See the Pyarrow issue for details:     https://github.com/apache/arrow/issues/33321 When reading Parquet files with a     time unit that is not in ['us', 'ns'], the <code>pyarrow.lib.ArrowInvalid</code>     exception could be raised. This could occur when Pyarrow attempts to cast the     time unit to a lower resolution. This behavior is tested in the     <code>test_parquet_files_with_mixed_time_units_2</code> test. In this case, the     alphabetical order of the files is important. The data from the first file     will be cast to the time unit of the rest of the files.</li> <li>Insight: The general approach is to preserve the time unit information     after reading data back from Parquet files. Currently, resolving this issue is     challenging because Parquet data is mixed with data from CSV files, which     convert the time unit to <code>ns</code> by default. Refer to CmampTask7331 for details.     https://github.com/cryptokaizen/cmamp/issues/7331</li> <li>Solution: Retain the casting of the time unit to <code>ns</code> in the     <code>from_parquet()</code> function.</li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html","title":"All.precommit.how to guide","text":""},{"location":"tools/all.precommit.how_to_guide.html#tools_for_code_quality","title":"Tools for code quality","text":""},{"location":"tools/all.precommit.how_to_guide.html#pre-commit","title":"<code>pre-commit</code>","text":"<ul> <li> <p>The documentation is https://pre-commit.com/</p> </li> <li> <p>The <code>.pre-commit-config.yaml</code> contains the configuration for <code>pre-commit</code></p> <pre><code>repos:\n    - repo: https://github.com/astral-sh/ruff-pre-commit\n        rev: v0.4.4\n        hooks:\n            - id: ruff\n    - repo: local\n        hooks:\n            - id: fixit-lint\n                name: fixit lint\n                entry: fixit lint\n                language: system\n                types: [python]\n            - id: pyrefly\n                name: pyrefly lint\n                entry: pyrefly lint\n                language: system\n                types: [python]\n</code></pre> </li> <li> <p>To install:     <pre><code>&gt; pre-commit install\n&gt; pip install pre-commit ruff fixit pyrefly\n</code></pre></p> <ul> <li>TODO(gp): Maybe we should install in the thin env?</li> </ul> </li> <li> <p>Run against all the files</p> <pre><code>&gt; pre-commit run --all-files\n</code></pre> </li> <li> <p>Run against a subset of files     <pre><code>&gt; pre-commit run --files $(find helpers_root -type f)\n</code></pre></p> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#ruff","title":"<code>ruff</code>","text":"<ul> <li> <p>Website: https://docs.astral.sh/ruff/</p> </li> <li> <p><code>ruff</code>:</p> <ul> <li>Is a fast Python linter and code formatter</li> <li>Supports over 700 linting rules from popular tools</li> <li>Is meant to be a single replacement for multiple tools (e.g., flake8,     pylint, isort, pyupgrade)</li> </ul> </li> <li> <p>Help     <pre><code>&gt; ruff -h\n...\nCommands:\n    check    Run Ruff on the given files or directories\n    rule     Explain a rule (or all rules)\n    config   List or describe the available configuration options\n    linter   List all supported upstream linters\n    clean    Clear any caches in the current directory and any subdirectories\n    format   Run the Ruff formatter on the given files or directories\n    server   Run the language server\n    analyze  Run analysis over Python source code\n    version  Display Ruff's version\n    help     Print this message or the help of the given subcommand(s)\n...\n</code></pre></p> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#config","title":"Config","text":"<ul> <li> <p>Often we want to exclude certain files in the repos, e.g., files under     <code>outcomes</code>:     <pre><code>&gt; ruff ... --exclude  '**/outcomes/**' --exclude '**/import_check/example/**'\n</code></pre></p> </li> <li> <p>By default we use the following options in <code>pyproject.toml</code></p> <pre><code>[tool.ruff]\nline-length = 81\ntarget-version = \"py311\"\nfix = true\nexclude = [\n    \"**/outcomes/**\",\n    \"**/import_check/example/**\"\n]\noutput-format = \"concise\"\n\n[tool.ruff.lint]\n# E731 Do not assign a `lambda` expression, use a `def`\nignore = [\"E731\"]\n</code></pre> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#ruff_format","title":"<code>ruff format</code>","text":"<ul> <li>Format only:     <pre><code>&gt; ruff format --line-length 80\n</code></pre></li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#ruff_linter","title":"<code>ruff linter</code>","text":"<ul> <li>List all supported upstream linters     <code>bash     &gt; ruff linter    AIR Airflow    ERA eradicate     FAST FastAPI    YTT flake8-2020    ANN flake8-annotations     ASYNC flake8-async     ...</code></li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#ruff_analyze","title":"<code>ruff analyze</code>","text":"<ul> <li>Can analyze the code base     <pre><code>&gt; ruff analyze graph -h\nGenerate a map of Python file dependencies or dependents\n\nUsage: ruff analyze graph [OPTIONS] [FILES]...\n\nArguments:\n    [FILES]...  List of files or directories to include [default: .]\n\nOptions:\n            --direction &lt;DIRECTION&gt;            The direction of the import map. By\n                                       default, generates a dependency map, i.e., a map from file to files that\n                                       it depends on. Use `--direction dependents` to generate a map from file\n                                       to files that depend on it [default: dependencies] [possible values:\n                                       dependencies, dependents]\n            --detect-string-imports            Attempt to detect imports from string literals\n            --preview                          Enable preview mode. Use `--no-preview` to disable\n    -h, --help                             Print help (see more with '--help')\n</code></pre></li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#linting","title":"Linting","text":""},{"location":"tools/all.precommit.how_to_guide.html#ruff_check","title":"<code>ruff check</code>","text":"<ul> <li> <p>Lint, auto-fix, and format code:</p> <pre><code>&gt; ruff check $DIR\nhelpers/notebooks/cache.ipynb:cell 11:1:7: F821 Undefined name `dict_`\nhelpers/notebooks/cache.ipynb:cell 12:3:7: F821 Undefined name `dict_`\n...\nFound 62 errors.\nNo fixes available (2 hidden fixes can be enabled with the `--unsafe-fixes` option).\n</code></pre> </li> <li> <p>Interesting options are:</p> <pre><code>        --fix                              Apply fixes to resolve lint violations\n        --unsafe-fixes                     Include fixes that may not retain the original intent of the code\n        --ignore-noqa                      Ignore any `# noqa` comments\n        --output-format &lt;OUTPUT_FORMAT&gt;    Output serialization format for violations\n-o, --output-file &lt;OUTPUT_FILE&gt;        Specify file to write the linter output to (default: stdout)\n        --statistics                       Show counts for every rule with at least one violation\n        --add-noqa                         Enable automatic additions of `noqa` directives to failing lines\n        --show-settings                    See the settings Ruff will use to lint a given Python file\n</code></pre> </li> <li> <p>Remove colors (useful for cfile)</p> <pre><code>&gt; ruff check . | less -R | cat | tee cfile\n&gt; vic\n</code></pre> </li> <li> <p>To select only a subset of errors     <pre><code># Skip the warnings\n&gt; ruff check . --select E,F\n</code></pre>     where:</p> <ul> <li>E: pycodestyle errors</li> <li>F: pyflakes errors</li> <li>W: warnings</li> <li>I: isort, etc.</li> </ul> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#ty","title":"<code>ty</code>","text":"<ul> <li>It's best to run <code>ty</code> inside the dev container to get the type hints of the     installed packages     <pre><code>docker&gt; sudo bash -c \"(source /venv/bin/activate; pip install --quiet ty)\"\ndocker&gt; ty check --output-format concise --color never --exclude '**/outcomes/**' --exclude '**/import_check/example/**' . 2&gt;&amp;1 | tee ty.log\n...\nerror[unresolved-attribute] linters/utils.py:101:22: Type `list[str]` has no attribute `replace`\nerror[unresolved-import] main_pytest.py:15:8: Cannot resolve imported module `junitparser`\nerror[unresolved-import] tasks.py:122:10: Cannot resolve imported module `oms.lib_tasks_binance`\n...\n\n# To format the output for a cfile:\ndocker&gt; cat ty.log | cut -d' ' -f2- | tee cfile\n</code></pre></li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#fixit","title":"<code>fixit</code>","text":"<ul> <li> <p>Website:     https://fixit.readthedocs.io/en/latest/index.html</p> </li> <li> <p><code>fixit</code></p> <ul> <li>Configurable linting framework with support for auto-fixes</li> <li>Custom \"local\" lint rules, and hierarchical configuration</li> <li>Built on LibCST.</li> </ul> </li> <li> <p>Fixit doesn't seem to support toml</p> </li> <li> <p>Run on <code>helpers</code> dir</p> <pre><code>&gt; fixit lint .\n</code></pre> </li> <li> <p>Fix automatically     <pre><code>&gt; fixit fix --automatic\n</code></pre></p> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#pyrefly","title":"<code>pyrefly</code>","text":"<ul> <li> <p>Website: https://pyrefly.org/</p> </li> <li> <p>Pyrefly is a high-performance static type checker for Python</p> <ul> <li>Type Checking: Analyzes Python code for type consistency before runtime</li> <li>Type Inference: Infers types for local variables and return values, even in     un-annotated code</li> <li>Configurable through <code>pyproject.toml</code><ul> <li>TODO: Is this true?</li> </ul> </li> </ul> <pre><code>&gt; pyrefly -h\n\nUsage: pyrefly [OPTIONS] &lt;COMMAND&gt;\n\nCommands:\n    check        Full type checking on a file or a project\n    dump-config  Dump info about pyrefly's configuration. Use by replacing\n             `check` with `dump-config` in your pyrefly invocation\n    init         Initialize a new pyrefly config in the given directory, or\n             migrate an existing mypy or pyright config to pyrefly\n    lsp          Start an LSP server\n\nOptions:\n    -j, --threads &lt;THREADS&gt;  Number of threads to use for parallelization.\n                         Setting the value to 1 implies sequential execution without any parallelism.\n                         Setting the value to 0 means to pick the number of threads automatically\n                         using default heuristics [default: 0]\n            --color &lt;COLOR&gt;      Controls whether colored output is used\n</code></pre> </li> <li> <p>It's best to run <code>pyrefly</code> inside the dev container to get the type hints of     the installed packages</p> <pre><code>docker&gt; sudo bash -c \"(source /venv/bin/activate; pip install --quiet pyrefly)\"\n</code></pre> <pre><code>docker&gt; pyrefly check --color=never --output-format=min-text --project-excludes '**/outcomes/**' --project-excludes '**/import_check/example/**' --project-excludes '**/mkdocs.venv/**'\n</code></pre> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#ssort","title":"<code>ssort</code>","text":"<ul> <li>Reorder in place     <pre><code>&gt; uvx ssort file\n</code></pre></li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#call_graph_and_dependencies","title":"Call graph and dependencies","text":""},{"location":"tools/all.precommit.how_to_guide.html#pycg_practical_call_graph_generator","title":"PyCG (Practical Call Graph Generator)","text":"<ul> <li>GitHub: https://github.com/vitsalis/PyCG <ul> <li>Read only (349 stars)</li> </ul> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#code2flow","title":"code2flow","text":"<ul> <li> <p>GitHub: https://github.com/scottrogowski/code2flow</p> </li> <li> <p>Install with:     <pre><code>&gt; sudo /bin/bash \\-c \"(source /venv/bin/activate; pip install code2flow)\"\n</code></pre></p> </li> <li> <p>Run with:     <pre><code>&gt; code2flow helpers/hmarkdown*.py\n&gt; open out.png\n</code></pre></p> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#pycallgraph2","title":"pycallgraph2","text":"<ul> <li> <p>GitHub: https://github.com/daneads/pycallgraph2</p> <ul> <li>236 stars</li> </ul> </li> <li> <p>Install with:     <pre><code>docker&gt; sudo /bin/bash \\-c \"(source /venv/bin/activate; pip install pycallgraph2)\"\n</code></pre></p> </li> <li> <p>Run with:     <pre><code>&gt; pycallgraph graphviz \\-- helpers/hmarkdown*.py\n</code></pre></p> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#py-call-graph","title":"py-call-graph","text":"<ul> <li>GitHub: https://github.com/lewiscowles1986/py-call-graph</li> <li>Doc:<ul> <li>https://pycallgraph.readthedocs.io/en/master/ </li> <li>https://pypi.org/project/python-call-graph/</li> </ul> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#pyan","title":"pyan","text":"<ul> <li>https://github.com/davidfraser/pyan </li> <li> <p>692 stars</p> </li> <li> <p>Install with:     <pre><code>&gt; sudo /bin/bash -c \"(source /venv/bin/activate; pip install pyan3==1.1.1)\"\n# Top of the tree is broken (https://github.com/Technologicat/pyan/issues/72)\n&gt; sudo /bin/bash -c \"(source /venv/bin/activate; pip install pyan3)\"\n</code></pre></p> </li> <li> <p>Run with:     <pre><code>&gt; pyan ./helpers/hmarkdown_filtering.py --dot --uses --no-defines &gt; callgraph.dot\n&gt; ./dev_scripts_helpers/documentation/dockerized_graphviz.py -i callgraph.dot -o c.png  \n&gt; open c.png\n</code></pre></p> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#snakeviz","title":"<code>SnakeViz</code>","text":"<ul> <li>Works on runtime profiling (not static), gives function timing &amp; hierarchy</li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#dependencies","title":"Dependencies","text":""},{"location":"tools/all.precommit.how_to_guide.html#pylint_pyreverse","title":"<code>pylint pyreverse</code>","text":"<ul> <li>GitHub: https://github.com/pylint-dev/pylint </li> <li>Doc:<ul> <li>https://pylint.readthedocs.io/en/latest/</li> <li>https://pylint.readthedocs.io/en/latest/additional_tools/pyreverse/index.html</li> </ul> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#pydeps","title":"<code>Pydeps</code>","text":"<ul> <li>GitHub: https://github.com/thebjorn/pydeps </li> <li> <p>Doc: https://pydeps.readthedocs.io/en/latest/</p> </li> <li> <p>Run with     <pre><code>&gt; pydeps helpers --noshow --show-dot -o import_graph.dot\n</code></pre></p> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#snakefood","title":"<code>snakefood</code>","text":"<ul> <li>GitHub: https://github.com/blais/snakefood</li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#measuring_complexity","title":"Measuring complexity","text":""},{"location":"tools/all.precommit.how_to_guide.html#radon","title":"<code>radon</code>","text":"<ul> <li>Static analysis for complexity, can complement class structure graphs</li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#xenon","title":"<code>xenon</code>","text":"<ul> <li>Enforces complexity thresholds based on Radon</li> <li>Built on Radon</li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#lizard","title":"<code>lizard</code>","text":"<ul> <li>Measures cyclomatic complexity for many languages</li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#finding_dead_code","title":"Finding dead code","text":""},{"location":"tools/all.precommit.how_to_guide.html#vulture","title":"Vulture","text":"<ul> <li>Finds dead (unused) code</li> <li>GitHub: https://github.com/jendrikseipp/vulture</li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#detecting_copy-paste","title":"Detecting copy-paste","text":""},{"location":"tools/all.precommit.how_to_guide.html#pylint_symilar","title":"<code>pylint symilar</code>","text":"<ul> <li>Docs: https://pylint.readthedocs.io/en/latest/additional_tools/symilar/index.html</li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#lizard_1","title":"<code>lizard</code>","text":"<ul> <li> <p>Install with:     <pre><code>&gt; pip install lizard\n</code></pre></p> </li> <li> <p>Run with:     <pre><code>&gt; lizard \\-Eduplicate helpers/test/test\\_hmarkdown\\_coloring.py helpers/test/test\\_hmarkdown.py\n\nDuplicate block:  \n\\--------------------------  \n./dev\\_scripts\\_helpers/llms/llm\\_prompts.py:1129 \\~ 1151  \n./dev\\_scripts\\_helpers/llms/llm\\_prompts.py:1151 \\~ 1177  \n./dev\\_scripts\\_helpers/llms/llm\\_prompts.py:1177 \\~ 1219  \n./dev\\_scripts\\_helpers/llms/llm\\_prompts.py:1219 \\~ 1256  \n./dev\\_scripts\\_helpers/llms/llm\\_prompts.py:1256 \\~ 1280  \n./dev\\_scripts\\_helpers/llms/llm\\_prompts.py:1280 \\~ 1312  \n./dev\\_scripts\\_helpers/llms/llm\\_prompts.py:1377 \\~ 1425\n</code></pre></p> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#jscpd","title":"<code>jscpd</code>","text":"<ul> <li> <p>Install with:     <pre><code>docker&gt; sudo npm install -g jscpd\n</code></pre></p> </li> <li> <p>Run with:     <pre><code>&gt; jscpd --languages python --reporters console,path/to/your/code\n&gt; jscpd --format=python --reporters console helpers\n</code></pre></p> </li> <li> <p>It doesn't seem to work</p> </li> </ul>"},{"location":"tools/all.precommit.how_to_guide.html#linter2","title":"Linter2","text":"<p>tmp=$(find ck_marketing/workflows/ -name \".py\" -o -name \".ipynb\" | \\grep -v ipynb_checkpoints | sort | tee tmp)</p> <p>tmp=$(git diff --name-only master... | \\grep py)</p> <p>pre-commit run --files $(cat tmp) helpers_root/linters2/normalize_import.py $(cat tmp) helpers_root/linters2/add_class_frames.py $(cat tmp)</p>"},{"location":"tools/all.precommit.how_to_guide.html#notebooks","title":"Notebooks","text":"<ul> <li>Make sure that all notebooks are paired</li> </ul> <p>jupytext --set-formats ipynb,py:percent /*.ipynb jupytext --sync /*.ipynb</p>"},{"location":"tools/all.profiling.how_to_guide.html","title":"All.profiling.how to guide","text":""},{"location":"tools/all.profiling.how_to_guide.html#profiling","title":"Profiling","text":""},{"location":"tools/all.profiling.how_to_guide.html#profiling_1","title":"Profiling","text":""},{"location":"tools/all.profiling.how_to_guide.html#profiling_end-to-end_a_command_line","title":"Profiling end-to-end a command line","text":"<ul> <li> <p>You can use the time-tested Linux <code>time</code> command to profile both time and     memory</p> <pre><code>&gt; /usr/bin/time -v COMMAND 2&gt;&amp;1 | tee time.log\n\nCommand being timed: \"...COMMAND...\"\nUser time (seconds): 187.70\nSystem time (seconds): 16.27\nPercent of CPU this job got: 96%\nElapsed (wall clock) time (h:mm:ss or m:ss): 3:31.38\nAverage shared text size (kbytes): 0\nAverage unshared data size (kbytes): 0\nAverage stack size (kbytes): 0\nAverage total size (kbytes): 0\nMaximum resident set size (kbytes): 13083892\nAverage resident set size (kbytes): 0\nMajor (requiring I/O) page faults: 0\nMinor (reclaiming a frame) page faults: 9911066\nVoluntary context switches: 235772\nInvoluntary context switches: 724\nSwaps: 0\nFile system inputs: 424\nFile system outputs: 274320\nSocket messages sent: 0\nSocket messages received: 0\nSignals delivered: 0\nPage size (bytes): 4096\nExit status: 0\n</code></pre> </li> <li> <p>Information about the spent time are:     <pre><code>User time (seconds): 187.70\nSystem time (seconds): 16.27\nPercent of CPU this job got: 96%\nElapsed (wall clock) time (h:mm:ss or m:ss): 3:31.38\n</code></pre></p> </li> <li> <p>The relevant part is the following line representing the amount of resident     memory (which is ~13GB) <code>Maximum resident set size (kbytes): 13083892</code></p> </li> </ul>"},{"location":"tools/all.profiling.how_to_guide.html#profiling_python_code_from_command_line","title":"Profiling Python code from command line","text":""},{"location":"tools/all.profiling.how_to_guide.html#cprofile","title":"cProfile","text":""},{"location":"tools/all.profiling.how_to_guide.html#install_in_a_docker_container","title":"Install in a Docker container","text":"<ul> <li>From <code>devops/docker_build/install_cprofile.sh</code> <pre><code>&gt; sudo apt-get install -y python3-dev\n&gt; sudo apt install -y libgraphviz-dev\n&gt; sudo apt-get install -y graphviz\n&gt; pip install gprof2dot\n</code></pre></li> </ul>"},{"location":"tools/all.profiling.how_to_guide.html#how_to_use_with_workflow","title":"How to use with workflow","text":"<ul> <li>There is a script that runs the flow <code>amp/dev_scripts/run_profiling.sh</code></li> </ul>"},{"location":"tools/all.profiling.how_to_guide.html#how_to_use_manually","title":"How to use manually","text":"<ul> <li>You need to run the code first with profiling enabled to collect the profiling     data in a binary file (often called <code>prof.bin</code>).     <pre><code># Profile a Python script.\n&gt; python -m cProfile -o prof.bin ${CMD}\n</code></pre></li> <li> <p>To profile a unit test you can run:</p> <pre><code># Profile a unit test.\n&gt; python -m cProfile -o profile edgar/forms8/test/test_edgar_utils.py\n&gt; python -m cProfile -o profile -m pytest edgar/forms8/test/test_edgar_utils.py::TestExtractTablesFromForms::test_table_extraction_example_2\n</code></pre> </li> <li> <p>Plotting the results</p> <pre><code>&gt; gprof2dot -f pstats profile | dot -Tpng -o output.png\n&gt; gprof2dot -n 10 -f pstats profile | dot -Tpng -o output.png\n&gt; gprof2dot -n 10 -f pstats profile -l\n\"*extract_tables_from_forms*\" | dot -Tpng -o output.png\n</code></pre> <p>How to read a graph: https://nesi.github.io/perf-training/python-scatter/profiling-cprofile</p> </li> <li> <p>Gprof2dot has lots of interesting options to tweak the output, e.g.,     <pre><code>&gt; gprof2dot -h\n...\n-n PERCENTAGE, --node-thres=PERCENTAGE\neliminate nodes below this threshold [default: 0.5]\n-e PERCENTAGE, --edge-thres=PERCENTAGE\neliminate edges below this threshold [default: 0.1]\n--node-label=MEASURE measurements to on show the node (can be specified\nmultiple times): self-time, self-time-percentage,\ntotal-time or total-time-percentage [default: total-\ntime-percentage, self-time-percentage]\n-z ROOT, --root=ROOT prune call graph to show only descendants of\nspecified\nroot function\n-l LEAF, --leaf=LEAF prune call graph to show only ancestors of\nspecified\nleaf function\n--depth=DEPTH prune call graph to show only descendants or ancestors\nuntil specified depth\n--skew=THEME_SKEW skew the colorization curve. Values &amp;lt; 1.0 give\nmore\nvariety to lower percentages. Values &gt; 1.0 give less\nvariety to lower percentages\n-p FILTER_PATHS, --path=FILTER_PATHS\nFilter all modules not in a specified path\n...\n</code></pre></p> </li> </ul>"},{"location":"tools/all.profiling.how_to_guide.html#process_profpy","title":"process_prof.py","text":"<ul> <li>You can use the script <code>dev_scripts/process_prof.py</code> to automate some tasks:<ul> <li>Top-level statistics</li> <li>Plotting the call-graph</li> <li>Custom statics</li> </ul> </li> </ul>"},{"location":"tools/all.profiling.how_to_guide.html#line_profiler","title":"line_profiler","text":"<ul> <li> <p>CProfile allows to break down the execution time into function calls, while     kernprof allows to profile a function line by line.</p> </li> <li> <p>GitHub: https://github.com/pyutils/line_profiler</p> </li> <li> <p>Install with:     <pre><code>&gt; pip install line_profiler\n</code></pre></p> </li> </ul>"},{"location":"tools/all.profiling.how_to_guide.html#how_to_use","title":"How to use","text":"<ul> <li> <p>Instrument the code to profile:</p> <p>```python import line_profiler profiler = line_profiler.LineProfiler()</p> </li> </ul>"},{"location":"tools/all.profiling.how_to_guide.html#print_the_results_at_the_end_of_the_run","title":"Print the results at the end of the run.","text":"<p>import atexit</p> <p>def exit_handler():         profiler.print_stats()</p> <p>atexit.register(exit_handler)</p> <p>@profiler def function():</p> <p>...     ```</p> <ul> <li>Through command line:     <pre><code>&gt; kernprof -o prof.lprof -l $cmd\n...\nWrote profile results to run_process_forecasts.py.lprof\n</code></pre></li> </ul>"},{"location":"tools/all.profiling.how_to_guide.html#pytest-profiling","title":"pytest-profiling","text":"<ul> <li> <p>Webpage: https://pypi.org/project/pytest-profiling</p> </li> <li> <p>Install it with     <pre><code>&gt; pip install pytest-profiling\n</code></pre></p> </li> </ul>"},{"location":"tools/all.profiling.how_to_guide.html#how_to_use_1","title":"How to use","text":"<pre><code> &gt; pytest --profile ./amp/core/dataflow_model/test/test_pnl_simulator.py::TestPnlSimulator2::test_perf1 -s\n</code></pre>"},{"location":"tools/all.profiling.how_to_guide.html#profiling_in_a_jupyter_notebook","title":"Profiling in a Jupyter notebook","text":"<ul> <li>You can find all of the examples below in action in the     <code>amp/core/notebooks/time_memory_profiling_example.ipynb</code> link.</li> </ul>"},{"location":"tools/all.profiling.how_to_guide.html#time_profilers","title":"Time profilers","text":"<ul> <li>In a notebook, execute cell with <code>%time</code> cell-magic:     <code>python %%time func()</code></li> </ul>"},{"location":"tools/all.profiling.how_to_guide.html#by_function","title":"By function","text":"<ul> <li> <p>We prefer cProfile for profiling and gprof2dot for visualization.</p> </li> <li> <p>The documentation does not state this, but <code>%prun</code> magic uses cProfile under     the hood, so we can use it in the notebook instead</p> <p>```python</p> </li> <li> <p>This will output something like this:     </p> </li> <li> <p>If you open the output image in the new tab, you can zoom in and look at the     graph in detail.</p> </li> <li> <p>Gprof2dot supports thresholds that make output more readable:</p> <p><code>python !gprof2dot -n 5 -e 5 -f pstats tmp.pstats | dot -Tpng -o output.png dspl.Image(filename=\"output.png\")</code></p> </li> <li> <p>This will filter the output into something like this:     </p> </li> </ul>"},{"location":"tools/all.profiling.how_to_guide.html#we_can_suppress_output_to_the_notebook_by_specifying_-q","title":"We can suppress output to the notebook by specifying \"-q\".","text":"<p>%%prun -D tmp.pstats func() !gprof2dot -f pstats tmp.pstats | dot -Tpng -o output.png dspl.Image(filename=\"output.png\") ```</p>"},{"location":"tools/all.profiling.how_to_guide.html#memory_profilers","title":"Memory profilers","text":"<ul> <li> <p>We prefer using memory-profiler.</p> </li> <li> <p>Peak memory</p> <pre><code>%%memit\nfunc()\n</code></pre> </li> <li> <p>Memory by line     <pre><code>%mprun -f func func()\n</code></pre></p> </li> </ul>"},{"location":"tools/all.pycharm.how_to_guide.html","title":"All.pycharm.how to guide","text":""},{"location":"tools/all.pycharm.how_to_guide.html#pycharm","title":"Pycharm","text":""},{"location":"tools/all.pycharm.how_to_guide.html#pycharm_1","title":"PyCharm","text":""},{"location":"tools/all.pycharm.how_to_guide.html#current_situation","title":"Current situation","text":"<p>There are multiple ways to develop on a remote server using PyCharm</p> <ol> <li> <p>VNC approach         - PyCharm runs locally on the server using a \"virtual screen\"         - Your laptop interacts with a VNC server to get the GUI locally         - Pros:             - Everything works             - You can run anything like you are local on the server, since you are in                 practice just using a virtual screen         - Cons:             - Without enough bandwidth it's slow and not snappy enough</p> </li> <li> <p>X11 approach         - Same as VNC, but instead of sending bitmaps through VNC, a \"compressed\"             version of the GUI is sent to the local computer directly         - Pros:             - Maybe faster than VNC             - PyCharm window is like a native window on your laptop         - Cons:             - X11 is old crap developed long time again and not really supported any                 more             - One needs to tunnel X11 traffic, set things up, and so on</p> </li> <li> <p>PyCharm Gateway         - New client-server architecture for PyCharm             - A \"headless\" PyCharm runs on the server             - A GUI client PyCharm runs on your laptop         - Pros             - It's as fast as possible, probably as fast as running locally         - Cons             - Need a PyCharm pro license (not a problem, we have money)             - It's not super polished: kind of beta, but it will get better and better</p> </li> <li> <p>PyCharm Remote Set-up             - Edit locally and then PyCharm moves the files back and forth         - Pros             - Only requires ssh         - Cons             - You can't run / debug remotely</p> </li> <li> <p>Approach 1) seems to require lots of memory and CPU and it's not really fast.</p> </li> <li> <p>Approach 2) works but it's a pain to set-up and slow.</p> </li> <li> <p>We want to try with 3)</p> <ul> <li>TODO(gp): @Juraj pls a short tutorial on how to install</li> <li>TODO(gp): @Juraj understand if it works, if it's fast, and if it requires     less memory</li> </ul> </li> </ol>"},{"location":"tools/all.pycharm.how_to_guide.html#how_to_run_our_cmamp_container_directly_from_pycharm","title":"How to run our cmamp container directly from PyCharm","text":"<ul> <li>PyCharm allows to run commands directly inside a container<ul> <li>See     https://www.jetbrains.com/help/pycharm/using-docker-as-a-remote-interpreter.html</li> </ul> </li> <li> <p>In fact when we do <code>i docker_bash</code> we launch a container and run bash inside     it, but PyCharm can do the same thing</p> </li> <li> <p>TODO(gp): @Juraj Let's both try this. There are some notes below about it</p> </li> </ul>"},{"location":"tools/all.pycharm.how_to_guide.html#how_to_review_a_pr_inside_pycharm","title":"How to review a PR inside Pycharm","text":"<ul> <li> <p>CTRL + SHIFT + A -&gt; View Pull Request</p> </li> <li> <p></p> </li> </ul>"},{"location":"tools/all.pycharm.how_to_guide.html#how_to_edit_remote_code","title":"How to edit remote code","text":"<ul> <li> <p>You need to use a certain local directory (e.g.,     /Users/saggese/src/commodity_research1) and a remote directory (e.g.,     /wd/saggese/src/commodity_research1)</p> </li> <li> <p>They need to be synced at the same git branch (e.g., master or     AmpTask1112_Audit_amp_Docker_system_03)</p> </li> <li> <p>Set-up Deployment</p> </li> </ul> <p></p> <p></p> <ul> <li>The deployment options are</li> </ul> <p></p> <ul> <li>You can see what file is changed in the file transfer window:</li> </ul> <p></p> <p>pycharm</p> <ul> <li>Develop on one node, sync, run on the server</li> <li> <p>Run local application with venv</p> </li> <li> <p>Database</p> </li> <li> <p>Run application inside Docker</p> </li> <li> <p>Run application remotely inside Docker</p> </li> </ul>"},{"location":"tools/all.pycharm.how_to_guide.html#general_ssh_config","title":"General ssh config","text":"<ul> <li> <p>File | Settings | Tools | SSH Configurations</p> <ul> <li></li> </ul> </li> <li> <p>Once setup, ssh config can be used for all tools in PyCharm.</p> <ul> <li>Remote Interpreter</li> <li>DataGrip</li> <li>Deployment</li> <li>Etc.</li> </ul> </li> </ul>"},{"location":"tools/all.pycharm.how_to_guide.html#db_connection_via_ssh","title":"DB connection via ssh","text":"<p>Note: PyCharm Professional DataGrip is used as an example. There are numerous open source alternatives such as Beaver. Config below should apply to them also.</p> <ul> <li> <p>To add a new data source in DataGrip, go to the database section in the lower     left corner.</p> <ul> <li></li> </ul> </li> <li> <p>Then pick your desired data source from the dropdown in the upper right     corner.</p> <ul> <li></li> </ul> </li> <li> <p>You will be presented with a dummy config that needs to be replaced with     proper data as shown below.</p> <ul> <li></li> </ul> </li> <li> <p>Before that is done, be sure that proper ssh info is added in SSH/SSL section.</p> <ul> <li></li> </ul> </li> </ul>"},{"location":"tools/all.pycharm.how_to_guide.html#deployment_with_remote_repository_through_sync","title":"Deployment with remote repository (through sync)","text":"<p>Note: Before setting up deployment, pull the cmamp repo on EC2 instance and use the same name as on your local machine (example: cmamp1). Always try to keep both repos in sync via git. For more subtle and simpler changes use File | Reload All From Disk . This will upload changes to the remote repo.</p> <ul> <li> <p>Tools | Deployment | Configuration</p> <ul> <li></li> <li></li> </ul> </li> <li> <p>Tools | Deployment | Options</p> <ul> <li><ul> <li>Uncheck \"Skip external changes\" and check \"Delete remote files\"</li> </ul> </li> </ul> </li> <li> <p>Tools | Deployment | Automatic Upload</p> <ul> <li>Check it</li> </ul> </li> <li> <p>Tools | Deployment | Browse Remote Host</p> <ul> <li></li> </ul> </li> </ul>"},{"location":"tools/all.pycharm.how_to_guide.html#pudb_-_remote_debugging_-_todo","title":"PUDB - remote debugging - ToDo","text":""},{"location":"tools/all.pycharm.how_to_guide.html#how_to_run_tests_inside_a_container","title":"How to run tests inside a container","text":"<ul> <li> <p>https://www.jetbrains.com/help/pycharm/using-docker-compose-as-a-remote-interpreter.html#docker-compose-remote</p> </li> <li> <p>Note that the \"start SSH session...\" action is available only in PyCharm     Professional Edition, while the terminal itself is available in both     Professional and Community editions.</p> </li> </ul>"},{"location":"tools/all.pycharm.how_to_guide.html#installing_pycharm_professional","title":"Installing PyCharm Professional","text":""},{"location":"tools/all.pycharm.how_to_guide.html#windows","title":"Windows","text":"<ol> <li>Download the installer using this    link</li> <li>Run the installer and follow the wizard steps.</li> <li>To run PyCharm, find it in the Windows Start menu or use the desktop    shortcut.</li> </ol>"},{"location":"tools/all.pycharm.how_to_guide.html#macos","title":"macOS","text":"<p>There are separate disk images for Intel and Apple Silicon processors.</p> <ol> <li> <p>Download the image, based on your processor using this    link</p> </li> <li> <p>Mount the image and drag the PyCharm app to the Applications folder.</p> </li> <li> <p>Run the PyCharm app from the Applications directory, Launchpad, or Spotlight.</p> </li> </ol>"},{"location":"tools/all.pycharm.how_to_guide.html#linux","title":"Linux","text":"<p>**Using tar archives **</p> <ol> <li> <p>Download the tar archive using this    link</p> </li> <li> <p>Unpack the pycharm-*.tar.gz file to a different folder, if your current    Download folder doesn't support file execution:    <pre><code>&gt; tar xzf pycharm-*.tar.gz -C &lt;new_archive_folder&gt;\n</code></pre></p> </li> <li> <p>The recommended installation location according to the filesystem hierarchy     standard (FHS) is <code>/opt</code>. To install PyCharm into this directory, enter the     following command:     <pre><code>&gt; sudo tar xzf pycharm-\\*.tar.gz -C /opt/\n</code></pre></p> </li> <li> <p>Switch to the bin subdirectory:    <pre><code>&gt; cd &lt;new archive folder&gt;/pycharm-\\*/bin\n# E.g.,\n&gt; cd /opt/pycharm-\\*/bin\n</code></pre></p> </li> <li> <p>Run pycharm.sh from the bin subdirectory    <pre><code>&gt; sh pycharm.sh\n</code></pre></p> </li> </ol> <p>Using snap packages</p> <ol> <li> <p>For Ubuntu 16.04 and later, you can use snap packages to install PyCharm.    <pre><code>&gt; sudo snap install pycharm-professional --classic\n# or\n&gt; sudo snap install pycharm-community --classic\n</code></pre></p> </li> <li> <p>Run in the Terminalu    <pre><code>&gt; pycharm-professional\n# or\n&gt; pycharm-community\n# or\n&gt; pycharm-educational\n</code></pre></p> </li> </ol>"},{"location":"tools/all.pycharm.how_to_guide.html#connecting_via_pycharm_gateway_ssh","title":"Connecting via PyCharm gateway (SSH)","text":"<p>The first thing you need to do is sign up for a free trial license or use it if it already have</p> <p>Then make sure you have a VPN connection to our VPC</p> <ol> <li>Click on Connect via SSH</li> <li>Into Username: write &lt;&gt; Example: richard <li>Into Host: write &lt;&gt; Example: 172.30.2.136 <li>Mark the Specify private key check box and locate the private key from the         zip which was sent in the onboarding process. Example: crypto.pub</li> <li>Leave Port: 22 as it is.</li> <li>Click on Check Connection and Continue.</li> <li>Select IDE version: PyCharm Py 213.6777.x</li> <li>Locate your directory. Example: /data/richard</li> <li>Click on Download and Start IDE.</li>"},{"location":"tools/all.pycharm.how_to_guide.html#connecting_via_vnc","title":"Connecting via VNC","text":"<ul> <li>Make sure you have a VPN connection.</li> </ul> <p>Installing VNC</p> <ul> <li>Install VNC using this link:<ul> <li>https://www.realvnc.com/en/connect/download/viewer/windows/</li> </ul> </li> </ul> <p>Sysadmin has sent you:</p> <ul> <li><code>os_password.txt</code></li> <li>Your username <code>$USER</code></li> <li>A key <code>crypto.pub</code> that looks like:     <pre><code>-----BEGIN OPENSSH PRIVATE KEY----- # gitleaks:allow\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAYEA0IQsLy1lL3bhPT+43sht2/m9tqZm8sEQrXMAVtfm4ji/LXMr7094 ...\nhakqVTlQ2sr0YTAAAAHnNhZ2dlc2VAZ3BtYWMuZmlvcy1yb3V0ZXIuaG9tZQECAwQ=\n-----END OPENSSH PRIVATE KEY-----\n</code></pre></li> </ul> <p>Let's say you are connected via VNC.</p> <ol> <li>Login into the OS.</li> <li>Run pycharm.sh using terminal (should be there)    <pre><code>&gt; bash /opt/pycharm-community-2021.2.3/bin/pycharm.sh\n</code></pre></li> </ol>"},{"location":"tools/all.pycharm.how_to_guide.html#configuration","title":"Configuration","text":""},{"location":"tools/all.pycharm.how_to_guide.html#reflow","title":"Reflow","text":"<ul> <li>Set the reflow to reindent<ul> <li></li> </ul> </li> </ul>"},{"location":"tools/all.pycharm.how_to_guide.html#some_recommended_plug-ins","title":"Some recommended plug-ins","text":"<ul> <li>Vim</li> <li>Grazie</li> <li>Wrap-to-column</li> <li>GitHub Copilot</li> </ul>"},{"location":"tools/all.reference_template.html","title":"All.reference template","text":"<p> <pre><code>&lt;title&gt;Reference Guide: &amp;lt;FileName&amp;gt;&lt;/title&gt;\n\n&lt;description&gt;\n    TODO: Write a short paragraph describing what the script does and its key use cases.\n&lt;/description&gt;\n\n&lt;section name=\"WhatItDoes\"&gt;\n</code></pre>"},{"location":"tools/all.reference_template.html#what_it_does","title":"What It Does","text":"<pre><code>    &lt;objective&gt;\n        &lt;bullet&gt;TODO: Explain core objective #1&lt;/bullet&gt;\n        &lt;bullet&gt;TODO: Explain core objective #2&lt;/bullet&gt;\n        &lt;bullet&gt;TODO: Explain core objective #3&lt;/bullet&gt;\n    &lt;/objective&gt;\n\n    &lt;sample_behavior&gt;\n        This script performs the following:\n        &lt;bullet&gt;Detects fenced code blocks (e.g., PlantUML, Mermaid, TikZ)&lt;/bullet&gt;\n        &lt;bullet&gt;Renders them using the appropriate tool&lt;/bullet&gt;\n        &lt;bullet&gt;Comments out the original code block&lt;/bullet&gt;\n        &lt;bullet&gt;Inserts an image reference like &lt;code&gt;![](image.png)&lt;/code&gt;&lt;/bullet&gt;\n    &lt;/sample_behavior&gt;\n\n&lt;/section&gt;\n\n&lt;section name=\"InputAndOutput\"&gt;\n</code></pre>"},{"location":"tools/all.reference_template.html#input_and_output","title":"Input And Output","text":"<pre><code>    &lt;inputs&gt;\n        TODO: List accepted input formats (e.g., .md, .tex)\n    &lt;/inputs&gt;\n    &lt;outputs&gt;\n        TODO: Describe the output file format and its expected content\n    &lt;/outputs&gt;\n\n&lt;/section&gt;\n\n&lt;section name=\"SupportedFileTypes\"&gt;\n</code></pre>"},{"location":"tools/all.reference_template.html#supported_file_types","title":"Supported File Types","text":"<pre><code>    &lt;sample_behavior&gt;\n    &lt;filetype name=\".md\"&gt;TODO: Markdown processing logic&lt;/filetype&gt;\n    &lt;filetype name=\".tex\"&gt;TODO: LaTeX file processing logic&lt;/filetype&gt;\n\n    &lt;use_cases&gt;\n        &lt;case description=\"Render Markdown to a new file\"&gt;\n            &lt;code_block language=\"bash\"&gt;\n</code></pre> <p>render_images.py -i ABC.md -o XYZ.md --action render --run_dockerized   render_images.py -i ABC.md --action render --run_dockerized   render_images.py -i ABC.md --action open --run_dockerized  </p> <pre><code>&lt;/section&gt;\n\n&lt;section name=\"FlagOptions\"&gt;\n</code></pre>"},{"location":"tools/all.reference_template.html#flag_options","title":"Flag Options","text":"<pre><code>    &lt;sample_behavior&gt;\n    &lt;code_block language=\"bash\"&gt;\n    &lt;flag name=\"-h, --help\"&gt;Show help message and exit&lt;/flag&gt;\n    &lt;flag name=\"-i, --in_file_name\"&gt;Input file path&lt;/flag&gt;\n    &lt;flag name=\"-o, --out_file_name\"&gt;Output file path&lt;/flag&gt;\n    &lt;flag name=\"--action {open,render}\"&gt;Action to execute&lt;/flag&gt;\n    &lt;flag name=\"--skip_action {open,render}\"&gt;Action to skip&lt;/flag&gt;\n    &lt;flag name=\"--all\"&gt;Run all available actions&lt;/flag&gt;\n    &lt;flag name=\"--dry_run\"&gt;Simulate run (update files but don't render images)&lt;/flag&gt;\n    &lt;flag name=\"--dockerized_force_rebuild\"&gt;Force Docker container rebuild&lt;/flag&gt;\n    &lt;flag name=\"--dockerized_use_sudo\"&gt;Use sudo inside Docker container&lt;/flag&gt;\n    &lt;flag name=\"-v {TRACE,DEBUG,INFO,WARNING,ERROR,CRITICAL}\"&gt;Set logging level&lt;/flag&gt;\n    &lt;/code_block&gt;\n    &lt;/sample_behavior&gt;\n\n&lt;/section&gt;\n\n&lt;section name=\"Examples\"&gt;\n</code></pre>"},{"location":"tools/all.reference_template.html#examples","title":"Examples","text":"<pre><code>    &lt;example title=\"Render to a new Markdown file\"&gt;\n        &lt;code_block language=\"bash\"&gt;\n</code></pre> <p>render_images.py -i lesson.md -o lesson.rendered.md --action render --run_dockerized   render_images.py -i lesson.md --action render --run_dockerized   render_images.py -i lesson.md --action open --run_dockerized   render_images.py -i lesson.md -o /tmp/out.md --dry_run  </p> <pre><code>&lt;/section&gt;\n\n&lt;section name=\"ErrorsAndFixes\"&gt;\n</code></pre>"},{"location":"tools/all.reference_template.html#errors_and_fixes","title":"Errors And Fixes","text":"<pre><code>    &lt;error&gt;\n        &lt;issue&gt;TODO: Describe a common error&lt;/issue&gt;\n        &lt;cause&gt;TODO: Likely cause&lt;/cause&gt;\n        &lt;solution&gt;TODO: Suggested fix or workaround&lt;/solution&gt;\n    &lt;/error&gt;\n\n&lt;/section&gt;\n\n&lt;section name=\"Dependencies\"&gt;\n</code></pre>"},{"location":"tools/all.reference_template.html#dependencies","title":"Dependencies","text":"<pre><code>&lt;dependency&gt;\n    &lt;bullet&gt;TODO: Docker (for --run_dockerized support)&lt;/bullet&gt;\n    &lt;bullet&gt;TODO: Graphviz, PlantUML, or other rendering tools depending on code block types&lt;/bullet&gt;\n    &lt;bullet&gt;TODO: Any other external CLI utilities used in subprocess calls&lt;/bullet&gt;\n&lt;/dependency&gt;\n</code></pre>"},{"location":"tools/all.selenium.how_to_guide.html","title":"All.selenium.how to guide","text":""},{"location":"tools/all.selenium.how_to_guide.html#selenium","title":"Selenium","text":""},{"location":"tools/all.selenium.how_to_guide.html#what_is_selenium","title":"What is Selenium","text":"<ul> <li> <p><code>Selenium</code> is an open-source automation tool primarily used for testing web     applications. It allows developers to programmatically control web browsers,     making it valuable for data crawling and web scraping when interacting with     dynamic, <code>JavaScript</code> driven websites. With Selenium, you can simulate user     actions like clicking buttons, filling forms, and navigating pages, which     makes it particularly effective for extracting data from websites that do not     provide a direct <code>API</code> or have content loaded dynamically via <code>JavaScript</code></p> </li> <li> <p>Key Features for Data Crawling:</p> <ul> <li><code>Browser Automation</code>: <code>Selenium</code> supports multiple browsers (e.g., <code>Chrome</code>,     <code>Firefox</code>, <code>Safari</code>), enabling you to simulate a real user's interaction     with the webpage</li> <li><code>JavaScript Handling:</code>Selenium<code>can interact with</code>JavaScript` based     elements, ensuring data loaded dynamically is accessible</li> <li><code>Customizable Waiting Strategies</code>: <code>Selenium</code> offers both explicit and     implicit waits, allowing scripts to wait for specific elements or     conditions, essential for dealing with varying page load times</li> </ul> </li> </ul>"},{"location":"tools/all.selenium.how_to_guide.html#installation","title":"Installation","text":"<ul> <li>The following installation is based on <code>Chrome browser</code> and <code>Linux OS</code> for a     local machine environment and not our dev servrer. It can be used for any     other OS and browsers</li> <li> <p>Check your google chrome verion</p> <ul> <li>Open Google Chrome, type <code>chrome://settings/help</code> and press Enter. You\u2019ll     see the Chrome version listed under \"Google Chrome\" (e.g.,     <code>Version 118.0.5993.89</code>)</li> </ul> </li> <li> <p>There are 2 ways to install chrome driver</p> <ul> <li>Using Web Browser<ul> <li>Check what <code>ChromeDriver</code> version in compatible with your chrome and     download at     ChromeDriver Download</li> </ul> </li> <li> <p>Using Terminal</p> <ul> <li>Check what <code>ChromeDriver</code> version in compatibility with chrome     ChromeDriver Link</li> </ul> <pre><code>&gt; wget https://chromedriver.storage.googleapis.com/&lt;version&gt;/chromedriver_linux64.zip\n</code></pre> <p>OR</p> <p><pre><code>&gt; curl -O https://chromedriver.storage.googleapis.com/&lt;version&gt;/chromedriver_linux64.zip\n</code></pre>     - Unzip the file</p> <p><pre><code>&gt; unzip chromedriver_linux64.zip\n</code></pre>     - Move the file to given path and extract from here when needed</p> <pre><code>&gt; mv chromedriver /&lt;path to driver&gt;/\n</code></pre> </li> </ul> </li> <li> <p>Install the following modules</p> <ul> <li> <p>Within terminal</p> <pre><code>&gt; pip install selenium\n&gt; pip install webdriver-manager\n</code></pre> </li> </ul> </li> </ul>"},{"location":"tools/all.selenium.how_to_guide.html#code_tutorial","title":"Code Tutorial","text":"<ol> <li> <p>Go to the notebook:    Selenium tutorial</p> </li> <li> <p>High-Level Overview</p> </li> </ol> <p>The uploaded notebook uses <code>Selenium WebDriver</code> to automate browser actions    for web scraping and testing two websites:    - Website 1: Test site -      Automates the process of logging in and out, ensuring the login      functionality works as expected    - Website 2:      Adidas shoes site -      Focuses on extracting show data from multiple pages within a specific      section of the site (Basketball)</p> <ol> <li>Key functionalities include:</li> <li>Setting up <code>ChromeDriver</code> with custom options for compatibility in      restricted environments</li> <li>Interacting with web elements like <code>buttons</code>, <code>input fields</code>, and      <code>pagination</code> controls</li> <li>Extracting and potentially saving scraped data using <code>pandas</code></li> <li> <p>Employing explicit waits (<code>WebDriverWait</code>) to handle dynamic content      loading effectively</p> </li> <li> <p>How to Find Elements Using <code>Selenium</code></p> </li> </ol> <p><code>Selenium</code> provides several ways to locate elements on a webpage. Below is an    explanation of each method, an example, and placeholders for images you can    insert:    - By <code>ID</code>:      - Description: Locates an element by its unique <code>id</code> attribute      - Example:        <pre><code>from selenium.webdriver.common.by import By\n\n# Example: Find the login field element by its ID.\nlogin_field = driver.find_element(By.ID, \"username\")\nlogin_field.send_keys(\"xyz\")\n</code></pre></p> <pre><code>   &lt;img src=\"figs/selenium/image1.png\"&gt;\n</code></pre> <ul> <li> <p>By <code>Name</code>:</p> <ul> <li>Description: Finds an element using its <code>Name</code> attribute.</li> <li>Example:    <code># Example: Find the password field by its name attribute.    password_field = driver.find_element(By.NAME, \"password\")    password_field.send_keys(\"xyz\")</code></li> </ul> <p>    - By <code>Class Name</code>  - Description: Locates elements by their <code>class</code> attribute  - Example:    <pre><code># Example: Find a show name by its class name.\nshoe = driver.find_element(By.CLASS_NAME, \"product-card-description_name__xHvJ2\")\n</code></pre></p> <p>    - By <code>Tag Name</code>:  - Description: Targets elements based on their <code>HTML</code> tag (e.g., <code>div</code>,    <code>button</code>)  - Example:    <pre><code># Example: Find shoe type by tag and print their text\ntype = driver.find_elements(By.TAG_NAME, \"p\")\nprint(type.text)\n</code></pre></p> <p>    - By <code>CSS Selector</code>:  - Description: Leverages <code>CSS selectors</code> for flexible element    identification.  - Consider the following <code>html</code>:    <pre><code>&lt;div class=\"product\" id=\"item-1\"&gt;\n  &lt;h2 class=\"product-title\"&gt;Running Shoes&lt;/h2&gt;\n  &lt;p class=\"product-price\"&gt;$50&lt;/p&gt;\n  &lt;button class=\"add-to-cart\"&gt;Add to Cart&lt;/button&gt;\n&lt;/div&gt;\n</code></pre>  - Key CSS Selectors with Examples    - Select by <code>Class</code>:      <pre><code>button = driver.find_element(By.CSS_SELECTOR, \".add-to-cart\")\nbutton.click()\n</code></pre>    - Select by <code>ID</code>:      <pre><code>product = driver.find_element(By.CSS_SELECTOR, \"#item-1\")\nprint(product.text)\n</code></pre>    - Select by <code>Parent-Child</code>:      <pre><code>price = driver.find_element(By.CSS_SELECTOR, \"#item-1 &gt; p\")\nprint(price.text)\n</code></pre>    - Select by <code>Descendant</code>:      <pre><code>button = driver.find_element(By.CSS_SELECTOR, \".product button\")\nbutton.click()\n</code></pre>    - Select by <code>Attribute</code>:      <pre><code>title = driver.find_element(By.CSS_SELECTOR, \"[class='product-title']\")\nprint(title.text)\n</code></pre>    - By <code>XPath</code>:  - Description: Uses <code>XML path</code> expressions to locate elements.  - Example:    <pre><code># Example: Find a shoe block using an XPath query\nshow_block = driver.find_element(By.XPATH, \"/html/body/div[1]/div[2]/main/section[3]/article[2]/div\")\n</code></pre></p> <p></p> </li> <li> <p>The above tutorial describes how to set up <code>Selenium</code>, find elements on a    webpage, and automate tasks like clicking, sending data and scraping data.    With different locator methods like <code>ID</code>, <code>Name</code>, and <code>XPath</code>, you can handle    most web pages. Just tweak the code to fit your target site, and you\u2019re good    to go!</p> </li> </ul>"},{"location":"tools/all.ssh.how_to_guide.html","title":"All.ssh.how to guide","text":""},{"location":"tools/all.ssh.how_to_guide.html#ssh","title":"Ssh","text":""},{"location":"tools/all.ssh.how_to_guide.html#what_is_ssh","title":"What is SSH?","text":"<p>From the Wikipedia</p> <p>Secure Shell (SSH) is a cryptographic network protocol for operating network services securely over an unsecured network.[1] Typical applications include remote command-line, login, and remote command execution, but any network service can be secured with SSH.</p> <p>More details here</p>"},{"location":"tools/all.ssh.how_to_guide.html#how_we_use_ssh_in_our_company","title":"How we use ssh in our company?","text":"<ul> <li>We use it to connect to any of our servers.</li> <li>Sometimes we use <code>scp</code> to copy files between hosts via <code>ssh</code>.<ul> <li>Don't know what is <code>scp</code>? read     here</li> </ul> </li> </ul>"},{"location":"tools/all.ssh.how_to_guide.html#public_key_for_authorization","title":"Public key for authorization?","text":"<ul> <li>We use <code>public key</code> authorization. This is the common way of secure     authorization for SSH connection.</li> <li>GitHub also can authorize you with <code>public key</code>, if you setup it in your GH     account. This is mean that you don't have to type your <code>login</code> and <code>password</code>     when you interact with GitHub via <code>git</code> e.g. <code>git clone</code>, <code>git pull</code>, etc.</li> </ul> <p>More details about <code>public key</code> here</p>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html","title":"All.sync gh projects.how to guide","text":""},{"location":"tools/all.sync_gh_projects.how_to_guide.html#github_project_sync_tool","title":"GitHub Project Sync Tool","text":"<p>This guide explains how the <code>sync_gh_projects.py</code> tool works, what it's designed to do, and the known limitations due to GitHub's Projects (Beta) API constraints. This tool has many limitations currently due to restricted GraphQL API support for ProjectV2, especially around views, layout, and ordering.</p>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#purpose","title":"Purpose","text":"<p>This tool synchronizes the <code>structure</code> of a GitHub Project from a source template project to a target destination project. It helps teams quickly align project configuration without manually replicating fields.</p>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#what_it_actually_syncs","title":"What It Actually Syncs","text":"<ul> <li><code>Fields</code>: These are the global columns in your project (e.g., Status,     Assignees, Labels). When created via the API, they are automatically visible     in all views. There is no API support to add fields specifically to one view     or to hide them from others</li> <li><code>Views</code>: These are saved layouts (e.g., \"Backlog\", \"Current sprint\"). However,     the API currently does not support creating views, so this script only     compares view names and logs a warning if any are missing in the destination</li> </ul>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#features","title":"Features:","text":"<ul> <li>Adds <code>missing global fields</code> from the template into the destination project</li> <li>Logs a warning about any <code>missing views</code> in the destination project</li> <li>Supports a <code>dry-run mode</code> (<code>--dry-run</code>) to preview intended changes without     modifying anything</li> <li>Supports a <code>verbose mode</code> (<code>--verbose</code>) to display detailed command logs</li> </ul>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#how_it_works","title":"How It Works","text":""},{"location":"tools/all.sync_gh_projects.how_to_guide.html#step-by-step","title":"Step-by-Step:","text":"<ol> <li>Lists all Projects V2 for the specified GitHub <code>--owner</code> using    <code>gh project list</code></li> <li>Locates the source (<code>--src-template</code>) and destination (<code>--dst-project</code>) by    title</li> <li>Queries each project's structure using GraphQL to fetch:</li> <li>Global <code>fields</code></li> <li> <p>Global <code>views</code> (names only)</p> </li> <li> <p>Compares structures:</p> </li> <li>If a field is in the source but not in the destination, it is added using      <code>addProjectV2Field</code>.</li> <li>If a view is in the source but not in the destination, it is not      created but logged with a warning.</li> </ol>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#limitations","title":"Limitations","text":"Capability Supported Notes Create missing global fields Yes Done via GraphQL <code>addProjectV2Field</code> mutation Detect and warn about missing views Yes Logs missing view names, but cannot recreate them Delete extra fields/views No Not implemented (non-destructive by design) Reorder fields or views No API does not expose position or ordering mutations View-specific field visibility No GraphQL only exposes global field presence View filters, sort orders, layout No Not accessible via GitHub's GraphQL API"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#current_state_technical_insights","title":"Current State &amp; Technical Insights","text":"<ul> <li><code>All fields in GitHub Projects are global</code> - They are shared across views.     While you can hide fields per view in the UI, this cannot be accessed or     modified via the API.</li> <li><code>There is no GraphQL mutation to create or configure views</code>     (<code>addProjectV2View</code> does not exist) - Hence, the tool only checks for view     names and alerts when missing.</li> <li><code>The script avoids destructive behavior</code> - It does not delete fields or views     that appear extra in the destination project.</li> <li><code>Newly added fields will be visible across all views</code> unless manually hidden     in the UI.</li> <li><code>You must still manually create views or configure filters, grouping, and sorting</code>,     as none of that is available through GitHub's API.</li> </ul>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#recommended_usage","title":"Recommended Usage","text":""},{"location":"tools/all.sync_gh_projects.how_to_guide.html#1_to_preview_what_changes_would_be_made","title":"1. To preview what changes would be made:","text":"<pre><code>sync_gh_projects.py \\\n    --owner causify-ai \\\n    --src-template \"[TEMPLATE] Causify Project\" \\\n    --dst-project \"Buildmeister\" \\\n    --dry-run --verbose\n</code></pre> <p>This will output:</p> <ul> <li>Fields in both source and destination</li> <li>Views in both source and destination</li> <li>Fields that would be created</li> <li>Views that are missing but cannot be added via script</li> </ul>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#2_to_apply_changes","title":"2. To apply changes:","text":"<pre><code>sync_gh_projects.py \\\n    --owner causify-ai \\\n    --src-template \"[TEMPLATE] Causify Project\" \\\n    --dst-project \"Buildmeister\"\n</code></pre> <p>This will:</p> <ul> <li>Add any missing fields that are present in the source template and absent in     the destination.</li> <li>Warn about any views missing in the destination.</li> <li>Not reorder, delete, or modify any existing structure.</li> </ul>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#example_scenario","title":"Example Scenario","text":""},{"location":"tools/all.sync_gh_projects.how_to_guide.html#source_project_template_causify_project","title":"Source Project <code>[TEMPLATE] Causify Project</code>","text":"<p><code>Fields</code>:</p> <ul> <li>Title, Assignees, Status, Labels, Milestone, Repository, Estimate</li> </ul> <p><code>Views</code>:</p> <ul> <li>Backlog, Current sprint, All issues</li> </ul>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#destination_project_buildmeister","title":"Destination Project <code>Buildmeister</code>","text":"<p><code>Fields</code>:</p> <ul> <li>Title, Assignees, Status, Labels, Milestone</li> </ul> <p><code>Views</code>:</p> <ul> <li>Backlog, Current sprint</li> </ul>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#what_the_script_will_do","title":"What the Script Will Do:","text":"<ul> <li>It will <code>add</code> the missing fields: <code>Repository</code>, <code>Estimate</code></li> <li>It will <code>log a warning</code> that the view <code>All issues</code> is missing</li> <li>It will <code>not</code> remove or alter any other structure</li> </ul>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#example_output_from_script","title":"Example output from script","text":"<ul> <li> <p>The source project is <code>[TEMPLATE] Causify Project</code> and dst project is     <code>Test_Shaunak</code></p> <ul> <li>The dst project does not contain <code>All issues</code> view which is a req according     to the template</li> <li>The dst project also does not have <code>Assignees</code> field in <code>Backlog</code> view</li> <li>The fields are calculated globally as git does not allow to see fileds for a     certain view yet</li> </ul> </li> <li> <p>The output is displayed below:     <pre><code>15:11:14 - INFO  sync_gh_projects.py main:304                           Syncing '[TEMPLATE] Causify Project' \u2794 'Test_Shaunak'\n15:11:14 - INFO  sync_gh_projects.py _get_structure:180                 Project #92 ([TEMPLATE] Causify Project) structure:\n15:11:14 - INFO  sync_gh_projects.py _get_structure:181                 Fields: ['Title', 'Assignees', 'Status', 'Labels', 'Linked pull requests', 'Milestone', 'Repository', 'Reviewers', 'Parent issue', 'Sub-issues progress', 'Estimate', 'Sprint']\n15:11:14 - INFO  sync_gh_projects.py _get_structure:182                 Views: ['All issues', 'Current sprint', 'Next sprint', 'Backlog', 'Team capacity ']\n15:11:14 - WARN  sync_gh_projects.py _get_structure:183                 This script cannot detect per-view visibility, filters, grouping or ordering, since GitHubs GraphQL API does not expose them.\n15:11:14 - INFO  sync_gh_projects.py _get_structure:180                 Project #95 (Test_Shaunak) structure:\n15:11:14 - INFO  sync_gh_projects.py _get_structure:181                 Fields: ['Title', 'Assignees', 'Status', 'Labels', 'Linked pull requests', 'Milestone', 'Repository', 'Reviewers', 'Parent issue', 'Sub-issues progress', 'Estimate', 'Sprint']\n15:11:14 - INFO  sync_gh_projects.py _get_structure:182                 Views: ['Current sprint', 'Next sprint', 'Backlog', 'Team capacity ']\n15:11:14 - WARN  sync_gh_projects.py _get_structure:183                 This script cannot detect per-view visibility, filters, grouping or ordering, since GitHubs GraphQL API does not expose them.\n15:11:14 - WARN  sync_gh_projects.py _sync_structure:245                View 'All issues' is missing in destination. GitHub API does not currently support view creation. Please add manually.\n15:11:14 - INFO  sync_gh_projects.py _sync_structure:250                Structure sync complete.\n</code></pre></p> <ul> <li>The script displayes the missing fields or views in the dst project when     compared to the source. <code>Github</code> has not introduced a way to automate view     creation yet.</li> </ul> </li> </ul>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#final_notes","title":"Final Notes","text":"<p>This tool is ideal for aligning the structure of GitHub Projects across teams or environments where a base template is used. It helps reduce manual setup effort and avoids configuration drift.</p> <p>Because GitHub's ProjectV2 API is still limited, this tool takes a conservative approach:</p> <ul> <li>It only creates fields</li> <li>It does not delete or modify</li> <li>It only checks for view presence by name</li> </ul>"},{"location":"tools/all.sync_gh_projects.how_to_guide.html#when_github_adds_support_for","title":"When GitHub adds support for:","text":"<ul> <li>View creation</li> <li>View filters and layout configuration</li> <li>Field ordering</li> </ul> <p>...this tool can be extended to do more complete synchronization.</p>"},{"location":"tools/all.tutorial_template.html","title":"All.tutorial template","text":"<p> <pre><code>&lt;title&gt;Tutorial Guide: script.py&lt;/title&gt;\n\n&lt;section name=\"Introduction\"&gt;\n</code></pre>"},{"location":"tools/all.tutorial_template.html#introduction","title":"Introduction","text":"<pre><code>    Provide a brief description of the task and what the script does.\n\n    &lt;bullet&gt;TODO: Define the task at a high level&lt;/bullet&gt;\n    &lt;bullet&gt;TODO: Identify the key motivation or use case&lt;/bullet&gt;\n\n&lt;/section&gt;\n\n&lt;section name=\"WhatYoullBuild\"&gt;\n</code></pre>"},{"location":"tools/all.tutorial_template.html#what_youll_build","title":"What You'll Build","text":"<pre><code>    Describe what the script produces or automates.\n    &lt;sample_behavior&gt;\n    &lt;bullet&gt;A Markdown file with diagram code blocks&lt;/bullet&gt;\n    &lt;bullet&gt;A script that processes and renders those diagrams&lt;/bullet&gt;\n    &lt;bullet&gt;A new output file with embedded images&lt;/bullet&gt;\n    &lt;/sample_behavior&gt;\n\n&lt;/section&gt;\n\n&lt;section name=\"BeforeYouBegin\"&gt;\n</code></pre>"},{"location":"tools/all.tutorial_template.html#before_you_begin","title":"Before You Begin","text":"<pre><code>    Describe all prerequisites or setup conditions required.\n\n    &lt;bullet&gt;Docker installed and running&lt;/bullet&gt;\n    &lt;bullet&gt;Linter up and running&lt;/bullet&gt;\n    &lt;bullet&gt;TODO: Any required environment variables or permissions&lt;/bullet&gt;\n\n&lt;/section&gt;\n\n&lt;section name=\"UsingTheScript\"&gt;\n</code></pre>"},{"location":"tools/all.tutorial_template.html#using_the_script","title":"Using the Script","text":"<pre><code>    Describe how to execute the script with examples.\n\n    &lt;sample_behavior&gt;\n    &lt;code_block language=\"bash\"&gt;\n</code></pre> <p>python render_images.py -i input.md -o output.md </p> <pre><code>    &lt;bullet&gt;TODO: Explain the different flags&lt;/bullet&gt;\n    &lt;bullet&gt;TODO: Mention optional flags or parameters&lt;/bullet&gt;\n    &lt;/sample_behavior&gt;\n\n&lt;/section&gt;\n\n&lt;section name=\"Output\"&gt;\n</code></pre>"},{"location":"tools/all.tutorial_template.html#output","title":"Output","text":"<pre><code>    Explain what output is expected and how to validate it.\n\n    &lt;bullet&gt;TODO: Describe where the output file is saved&lt;/bullet&gt;\n    &lt;bullet&gt;TODO: Mention format of embedded images or changes in the file&lt;/bullet&gt;\n\n&lt;/section&gt;\n</code></pre>"},{"location":"tools/all.veracrypt.how_to_guide.html","title":"All.veracrypt.how to guide","text":""},{"location":"tools/all.veracrypt.how_to_guide.html#how_to_use_veracrypt","title":"How to use VeraCrypt","text":""},{"location":"tools/all.veracrypt.how_to_guide.html#using_gui","title":"Using GUI","text":"<ol> <li> <p>Connect to VPN</p> </li> <li> <p>Connect to one of dev server via VNC that you want to have or already         have encrypted folder</p> </li> <li> <p>In CLI, type veracrypt or via application menu open veracrypt</p> </li> </ol>"},{"location":"tools/all.veracrypt.how_to_guide.html#creating_a_veracrypt_volume","title":"Creating a VeraCrypt Volume","text":"<ol> <li>Open up the VeraCrypt application and select \"Create Volume\".</li> <li> <p>Select \"Create an encrypted file container\" and click \"Next\".</p> </li> <li> <p>Then choose if you want hidden or standard volume</p> </li> <li> <p>Create a name and select a location to save the VeraCrypt volume that you    will be creating and select \"Next.\"</p> </li> <li>It is helpful if you create a volume name that ends with <code>.vc</code>. This will      associate the volume with the VeraCrypt application.</li> </ol> <p></p> <ol> <li>VeraCrypt provides some options for encryption. Select the desired         encryption algorithms and select \"Next\". VeraCrypt uses the AES algorithm by         default and is recommended for selection.         - In most cases a 500mb size volume is suitable. However this depends on the             user's need and should be adjusted accordingly.</li> </ol> <p></p> <ol> <li>Create the size of the volume that you would like to create. Click \"Next\".</li> <li>Set the volume to have appropriate size.</li> </ol> <p></p> <ol> <li>Create a password for your encrypted volume. Click \"Next\".</li> <li>The longer the password the better it is. It is important to not lose your      password. A lost password will make the data unrecoverable.</li> </ol> <p></p> <ol> <li>Select the file system and click \"Next\". The default is suitable in most    cases. Then you should move your mouse to get randomness in Pool but feel    free to click \"Format\".</li> <li>You do not need to move your cursor that much as this server is behind VPN.</li> </ol> <p> </p> <ol> <li>Your volume has been created. Click \"Exit\" or X button in top right corner.</li> </ol> <p></p>"},{"location":"tools/all.veracrypt.how_to_guide.html#mounting_a_veracrypt_volume","title":"Mounting a VeraCrypt Volume","text":"<ol> <li>Select the VeraCrypt volume that you would like to mount. Select the letter    drive location you would like to use. Click \"Mount\".</li> </ol> <ol> <li>Enter your password for the VeraCrypt volume. Click \"OK\".</li> </ol> <ol> <li>The drive is now unencrypted and ready for use at the Mount Directory    (<code>/media/veracrypt&lt;slotnumber&gt;</code>). Save files and documents as you would    normally do with a mounted drive.</li> </ol>"},{"location":"tools/all.veracrypt.how_to_guide.html#unmounting_a_veracrypt_volume","title":"Unmounting a VeraCrypt Volume","text":"<ul> <li>You can Encrypt files by Dismounting Volume, Select Slot and press Dismount</li> </ul>"},{"location":"tools/all.veracrypt.how_to_guide.html#using_cli","title":"Using CLI","text":""},{"location":"tools/all.veracrypt.how_to_guide.html#creating_a_veracrypt_volume_with_interactive_mode","title":"Creating a VeraCrypt volume with interactive mode","text":"<ul> <li> <p>If you need help use <code>veracrypt -h</code> there is everything you need</p> </li> <li> <p>If it asks this: (Enter your user password or administrator password:) use     your os_password or type sudo before the command.</p> </li> <li> <p>Be careful in not deleting the file that VeraCrypt uses to store the data     (e.g., <code>/data/saggese/.src_vc_DO_NOT_OVERWRITE</code>)</p> </li> <li> <p>Go to the server in your home and create a Veracrypt dir under your <code>$HOME</code>.     Since the directory typically stores code, we assume that it's in parallel to     <code>$HOME</code> like <code>/data/saggese/src_vc_encrypted</code></p> </li> </ul> <pre><code>&gt; sudo veracrypt -t -c\nVolume type:\n1) Normal\n2) Hidden\nSelect [1]: 1\n\nEnter volume path: /data/$USER/.src_vc_DO_NOT_OVERWRITE\n\n# An orange client is around 350M, so you can create 2GB worth of encrypted dir\n\nEnter volume size (sizeK/size[M]/sizeG): 2G\n\nEncryption Algorithm:\n1) AES\n2) Serpent\n3) Twofish\n4) Camellia\n5) Kuznyechik\n6) AES(Twofish)\n7) AES(Twofish(Serpent))\n8) Camellia(Kuznyechik)\n9) Camellia(Serpent)\n10) Kuznyechik(AES)\n11) Kuznyechik(Serpent(Camellia))\n12) Kuznyechik(Twofish)\n13) Serpent(AES)\n14) Serpent(Twofish(AES))\n15) Twofish(Serpent)\nSelect [1]: 1\n\nHash algorithm:\n1) SHA-512\n2) Whirlpool\n3) SHA-256\n4) Streebog\nSelect [1]: 1\n\nFilesystem:\n1) None\n2) FAT\n3) Linux Ext2\n4) Linux Ext3\n5) Linux Ext4\n6) NTFS\n7) exFAT\n8) Btrfs\nSelect [2]: 5\n\n# Avoid using \"FAT\" as it does not support symbolic links, meaning that\n# files such as `invoke.yaml`, `conftest.py` (hence `i docker_bash`,\n# `i run_fast_tests`) won't work, because in `lemonade` they are symbolic\n# links to the corresponding files in `amp`. Use Linux Ext4 (!)\n\nEnter password: Password123\nWARNING: Short passwords are easy to crack using brute force techniques!\n\nWe recommend choosing a password consisting of 20 or more characters.\nAre you sure you want to use a short password? (y=Yes/n=No) [No]: y\n\nRe-enter password: Password123\n\nEnter PIM: 1\n\nEnter keyfile path [none]: none\n\n# It interprets \"none\" as a literal path, instead just press Enter to proceed\n\nPlease type at least 320 randomly chosen characters and then press\nEnter: aksjdhqhhaskfjjhcb,anbowquehjkashdbncakh...\n\nDone: 100.000% Speed: 123 MiB/s Left: 0 s\n\nThe VeraCrypt volume has been successfully created.\n</code></pre>"},{"location":"tools/all.veracrypt.how_to_guide.html#create_a_veracrypt_volume_with_non-interactive_mode","title":"Create a VeraCrypt volume with non-interactive mode","text":"<pre><code>&gt; sudo veracrypt -t -c --volume-type=normal\n/data/$USER/.src_vc_DO_NOT_OVERWRITE \\\n--size=2G --encryption=aes --hash=sha-512 \\\n--filesystem=ext4 --pim=1 \\\n-k \"\" --random-source=/dev/urandom\n</code></pre> <ul> <li>You need to use the same PIM (personal iterations multipliers) that you used     to create the volume</li> </ul>"},{"location":"tools/all.veracrypt.how_to_guide.html#mounting_a_veracrypt_volume_1","title":"Mounting a VeraCrypt Volume","text":"<ul> <li> <p>It seems that this operation can be performed only by a \"sudoer\", refer to     https://github.com/veracrypt/VeraCrypt/issues/496.     Check with the infra team if there are any problems.</p> </li> <li> <p>To mount without user prompts:</p> </li> </ul> <pre><code>&gt; sudo veracrypt /data/$USER/.src_vc_DO_NOT_OVERWRITE\n/data/$USER/src_vc --pim=1 --protect-hidden=no -k \"\"\n</code></pre> <ul> <li>To mount an encrypted dir (e.g., <code>/data/richard/vc</code>):</li> </ul> <pre><code># Create the mount point if it doesn't exist\n&gt; mkdir /data/$USER/src_vc\n&gt; sudo veracrypt /data/$USER/.src_vc_DO_NOT_OVERWRITE\n/data/$USER/src_vc\nEnter password for /data/$USER/Desktop/vc: Password123\nEnter PIM for /data/$USER/Desktop/test.vc: 1\nEnter keyfile [none]: none (i.e. press Enter without typing anything)\nProtect hidden volume (if any)? (y=Yes/n=No) [No]: No\n\n# Change ownership of the `src_vc` folder. When using Linux Ext4 filesystem,\n# it creates a `lost+found` folder inside `src_vc` owned by `root` and then\n# the entire `src_vc` is owned by `root`. Meaning that you cannot create a\n# dir (e.g., `lemonade1` to clone the repo to) inside `src_vc` as long as\n# it is owned by `root`. Perhaps, you may need to ask the infra team to run\n# the cmd for you.\n&gt; sudo chown -R $USER:$USER /data/$USER/src_vc\n</code></pre> <ul> <li>To check what dirs are mounted by Veracrypt:</li> </ul> <pre><code>&gt; veracrypt -l\n1: /data/richard/Desktop/test.vc /dev/mapper/veracrypt1\n/data/richard/Desktop/private\n</code></pre>"},{"location":"tools/all.veracrypt.how_to_guide.html#unmounting_a_veracrypt_volume_1","title":"Unmounting a VeraCrypt Volume","text":"<ul> <li>Dismount a volume:</li> </ul> <pre><code>&gt; sudo veracrypt -d /data/$USER/src_vc\n</code></pre> <ul> <li>Umount all mounted volumes:</li> </ul> <pre><code>&gt; sudo veracrypt -d\n</code></pre>"},{"location":"tools/all.veracrypt.how_to_guide.html#how_to_use_a_git_client_under_an_encrypted_volume","title":"How to use a Git client under an encrypted volume","text":"<p>TODO(gp): Move somewhere else</p>"},{"location":"tools/all.veracrypt.how_to_guide.html#mount","title":"Mount","text":"<pre><code>&gt; sudo veracrypt -l\n1: /data/saggese/.src_vc_DO_NOT_OVERWRITE /dev/mapper/veracrypt1\n/data/saggese/src_vc\n\n&gt; sudo veracrypt -d /data/$USER/src_vc\n\n&gt; sudo veracrypt /data/$USER/.src_vc_DO_NOT_OVERWRITE\n/data/$USER/src_vc --pim=1 --protect-hidden=no -k \"\"\n\n# Create dir if it was not created already.\n&gt; mkdir ~/src_vc/lemonade1\n\n&gt; cd ~/src_vc/lemonade1/\n</code></pre>"},{"location":"tools/all.veracrypt.how_to_guide.html#one_time_set-up","title":"One time set-up","text":"<pre><code># Clone the code\n&gt; GIT_SSH_COMMAND=\"ssh -i ~/.ssh/id_rsa.gpsaggese.github\" git clone\n--recursive git@github.com:causify-ai/lemonade.git lemonade1\n\n# Init amp sub-module\n&gt; cd amp\n&gt; git submodule init\n&gt; git submodule update\n</code></pre> <ul> <li> <p>No need to build a thin environment. We need to re-use the helpers venv which     is located under <code>src</code>. For example:     <code>venv_dir=/data/grisha/src/venv/client_venv.helpers</code></p> </li> <li> <p>Assumption: the helpers virtual environment was already built under <code>src</code> when     setting up a different repo.</p> </li> </ul>"},{"location":"tools/all.veracrypt.how_to_guide.html#create_the_tmux_env","title":"Create the tmux env","text":"<pre><code># Create a soft link. The cmd creates a file `~/go_lemonade.py` which creates a tmux session.\n&gt; dev_scripts_lemonade/thin_client/tmux.py --create_global_link\n\n# Export encrypted dir path before creating a tmux session.\n&gt; export AM_SRC_DIR=\"/data/$USER/src_vc\"\n\n# Create the tmux session\n&gt; ~/go_lemonade.py --index 1\n\n# Verify that all tmux windows run without issues\n\n# Test Docker\n&gt; i docker_bash\n\n# Run tests\n&gt; i run_fast_tests\n</code></pre>"},{"location":"tools/all.visual_studio_code.how_to_guide.html","title":"All.visual studio code.how to guide","text":""},{"location":"tools/all.visual_studio_code.how_to_guide.html#visual_studio_code","title":"Visual Studio Code","text":""},{"location":"tools/all.visual_studio_code.how_to_guide.html#installation_of_vscode","title":"Installation of VSCode","text":""},{"location":"tools/all.visual_studio_code.how_to_guide.html#windows_linux_mac","title":"Windows, Linux, Mac","text":"<ul> <li>Download the installer using this link:     Download Visual Studio Code - Mac, Linux, Windows.</li> <li>Run the installer and follow the wizard steps.</li> <li>To run VSCode, find it in the Start menu or use the desktop shortcut.</li> <li>In the left navigation bar search for extensions ( or use <code>Ctrl+Shift+X</code> ) and     search for \"ms-vscode-remote.remote-ssh\" and then click on the install button.     </li> </ul>"},{"location":"tools/all.visual_studio_code.how_to_guide.html#connect_to_dev_server","title":"Connect to dev server","text":"<ul> <li>Connect to the VPN</li> <li>In bottom left corner click on this green button:     </li> <li>Then you will see these options on top of the screen, click on \"Open SSH     Configuration File\u2026\" and then click on the <code>user\\.ssh\\config</code> or     <code>user/.ssh/config</code>.     </li> <li>The config should look like this:     <ul> <li><code>HostName</code>: dev1 (or dev2) server IP.</li> <li><code>User</code>: your linux user name on the dev server.</li> <li><code>IdentityFile</code>: private key that you use to <code>SSH</code> to the dev server.</li> </ul> </li> <li>Save and close the config file and press the green button again, then for     connection click on \"Connect to Host...\". You should see the IP address of the     server, so just click on it and it will connect you in a new window.</li> <li>Open a preferred repo directory.<ul> <li>Click on the \"Source control\" button on the left:     </li> <li>Choose \"Open Folder\":     </li> <li>Choose the desired repo directory from the drop-down menu, e.g., <code>cmamp1</code>:     </li> </ul> </li> </ul>"},{"location":"tools/all.visual_studio_code.how_to_guide.html#how_to_run_a_vscode_debugger_within_a_remote_container","title":"How to run a VSCode debugger within a remote container","text":"<p>The goal is to successfully run a Visual Studio Code (VSCode) debugger on code that runs within a docker container located on a remote server.</p>"},{"location":"tools/all.visual_studio_code.how_to_guide.html#prerequisites","title":"Prerequisites","text":"<ul> <li> <p>Mac OS or Linux-based OS</p> </li> <li> <p>Visual Studio Code installed on the local machine you are working from</p> </li> <li> <p>VSCode extensions installed:</p> <ul> <li>Python     (Installed on the remote machine)<ul> <li>VSCode installs some files inside <code>.vscode-*</code> directories on the remote     host to ensure full functionality of the extensions</li> </ul> </li> <li>Remote SSH</li> <li>Remote Explorer</li> <li>Remote Development     (Installed on the remote machine)</li> <li>Dev Containers</li> </ul> </li> <li> <p>Ability to access the remote server where the container will be located using     SSH</p> </li> <li> <p>Kaizen dev environment set-up on the remote machine to allow running <code>invoke</code>     targets</p> </li> <li> <p>A running Kaizen dev docker container created on the remote machine using     <code>invoke docker_bash</code></p> </li> </ul>"},{"location":"tools/all.visual_studio_code.how_to_guide.html#tips","title":"Tips","text":"<ul> <li>To open the command palette in VSCode use a keyboard shortcut <code>Cmd + Shift + P</code></li> </ul>"},{"location":"tools/all.visual_studio_code.how_to_guide.html#steps","title":"Steps","text":"<ol> <li> <p>Open the command palette and search for <code>Remote-SSH: Connect to host</code> action</p> </li> <li> <p>Click <code>+ Add new SSH Host</code>. The prompt will ask you to provide a full         command to log in to the server, e.g. \"ssh ubuntu@10.11.12.13\"</p> <pre><code>1.  Note: if you use `~/.ssh/config` to specify frequently used hosts,\n        VSCode will automatically fetch the list for you, this way you simply\n        choose the name of the host and the connection is established\n        automatically\n</code></pre> </li> <li> <p>Make sure you have a container running using <code>invoke docker_bash</code> on the         remote machine</p> </li> <li> <p>VSCode will establish a remote connection to the server and open a new         window. Make sure that is your active window.</p> </li> <li> <p>Open the command palette and search for         <code>Dev Containers: Attach To Running Container</code>. A list of all running         containers on your server will appear, choose your container.</p> </li> <li> <p>Choose the debugging panel from the sidebar and click on <code>Run and Debug</code></p> </li> </ol> <p></p> <ol> <li>Click \"Add Configuration\" an editor for \"launch.json\" should open</li> </ol> <p></p> <ol> <li> <p>Paste the following JSON into the file and save it. <pre><code>{\n        // Use IntelliSense to learn about possible attributes.\n        // Hover to view descriptions of existing attributes.\n        // For more information, visit:\n        https://go.microsoft.com/fwlink/?linkid=830387\n        \"version\": \"0.2.0\",\n        \"configurations\": [\n        {\n                \"name\": \"Python: Current File\",\n                \"type\": \"python\",\n                \"request\": \"launch\",\n                \"program\": \"${file}\",\n                \"console\": \"integratedTerminal\",\n                \"justMyCode\": true,\n                \"python\":\"/venv/bin/python\",\n                \"env\": {\n                        \"PATH\":\n                        \"/app/amp/documentation/scripts:/app/amp/dev_scripts/testing:/app/amp/dev_scripts/notebooks:/app/amp/dev_scripts/install:/app/amp/dev_scripts/infra:/app/amp/dev_scripts/git:/app/amp/dev_scripts/aws:/app/amp/dev_scripts:/app/amp:/app/dev_script_p1:/app:.:/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\n                        \"PYTHONPATH\":\"/app/amp:/app:\"\n                }\n        }\n        ]\n}\n</code></pre></p> </li> <li> <p>Now you can open any Python file within the environment. You can for example         set a breakpoint, hit the green \"play\" button and the debugger will run the         currently opened file</p> </li> </ol> <p></p> <ol> <li>To run a script with a specific set of command line arguments, append         <code>\"args\"</code> key to the launch.json file (the location should be         <code>.vscode/launch.json</code>). The value is a list of command line arguments and         values. Example below: <pre><code>\"args\": [\n        \"--file\",\n        \"/app/datapull/ccxt/notebooks/Master_universe.ipynb\",\n        \"--action\",\n        \"convert\"\n]\n</code></pre></li> </ol>"},{"location":"tools/all.visual_studio_code.how_to_guide.html#how_to_access_the_jupyter_server_running_on_the_remote_server_through_your_local_machine","title":"How to access the Jupyter server running on the remote server through your local machine","text":"<ol> <li>Run the Jupyter server <pre><code>&gt; i docker_jupyter\n</code></pre></li> </ol> <pre><code>###&gt; devops/docker_run/run_jupyter_server.sh\n&gt; cmd=jupyter notebook --ip=* --port=10421 --allow-root --NotebookApp.token=''\n...\n</code></pre> <ol> <li>In VSCode, add port forwarding from port <code>10421</code> on the server to the same    port on your local machine. You can then access the Jupyter notebook running    on the remote machine through <code>http://localhost:10421</code> on your local machine.</li> </ol>"},{"location":"tools/all.visual_studio_code.how_to_guide.html#connecting_via_vnc","title":"Connecting via VNC","text":"<ul> <li>Make sure you have a VPN connection.</li> </ul>"},{"location":"tools/all.visual_studio_code.how_to_guide.html#installing_vnc","title":"Installing VNC","text":"<ul> <li>Install VNC using this link: https://www.realvnc.com/en/connect/download/viewer/windows/</li> <li> <p>Sysadmin has sent you:</p> <ul> <li><code>os_password.txt</code></li> <li>Your username <code>$USER</code></li> <li>A key <code>crypto.pub</code> that looks like:     <pre><code>-----BEGIN OPENSSH PRIVATE KEY----- # gitleaks:allow\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAYEA0IQsLy1lL3bhPT+43sht2/m9tqZm8sEQrXMAVtfm4ji/LXMr7094\n\u2026\nhakqVTlQ2sr0YTAAAAHnNhZ2dlc2VAZ3BtYWMuZmlvcy1yb3V0ZXIuaG9tZQECAwQ=\n-----END OPENSSH PRIVATE KEY-----\n</code></pre></li> </ul> </li> <li> <p>Let's say you are connected via VNC.</p> <ul> <li>Login into the OS.</li> <li>Run <code>pycharm.sh</code> using terminal (should be there):     <pre><code>&gt; bash /opt/pycharm-community-2021.2.3/bin/pycharm.sh\n</code></pre></li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html","title":"All.conda environment obsolete.how to guide","text":""},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#conda_environment_obsolete","title":"Conda Environment (Obsolete)","text":"<p>THIS IS OBSOLETE AFTER DOCKER DEV CONTAINER</p>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#conda_flow","title":"Conda flow","text":""},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#optional_install_anaconda","title":"(optional) Install anaconda","text":"<ul> <li>For the AWS machine there is already a central conda, so there is no need for     users to install</li> <li>For a laptop you need to install it yourself<ul> <li>You need anaconda3</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#configure_anaconda","title":"Configure anaconda","text":"<ul> <li>Configure anaconda for your shell using:     <pre><code>&gt; conda init bash\n</code></pre></li> <li>Anaconda3 adds a snippet of code in your <code>.bashrc</code></li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#create_conda_environment","title":"Create conda environment","text":"<ul> <li>This is needed to install all the packages that are required for development:     <pre><code>&gt; cd $DST_DIR\n&gt; ./dev_scripts/create_conda.develop.sh\n</code></pre></li> <li> <p>This script takes 5 mins to run</p> </li> <li> <p>You need to create an environment for every server you use (e.g., for the AWS     server <code>research</code>, for your laptop)</p> </li> <li>You can reuse the same environment for multiple Git clients</li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#check_conda_environment","title":"Check conda environment","text":"<ul> <li>Check that your conda environment exists:     <pre><code>&gt; conda info --envs\n# conda environments:\n#\nbase                     /anaconda3\ndevelop            *  /home/&lt;USER&gt;/.conda/envs/develop\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#configure_conda_environment","title":"Configure conda environment","text":"<ul> <li> <p>Every time you open a shell you need to activate the development environment     run:</p> <pre><code>&gt; source dev_scripts/setenv_....sh\n</code></pre> </li> <li> <p>This script:</p> <ul> <li>Activates the conda environment</li> <li>Sets environment variables</li> <li>Makes sure things are working properly</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#delete_recreate_environment","title":"Delete / recreate environment","text":""},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#overwrite_a_conda_environment_with_create_condapy","title":"Overwrite a conda environment with <code>create_conda.py</code>","text":"<ul> <li>You can use the option <code>--delete_env_if_exists</code> to overwrite a conda env,     creating it from scratch</li> <li> <p>This is the typical approach</p> </li> <li> <p>There are some pre-packaged command lines to create the standard environments,     e.g., <code>./dev_scripts/create_conda.develop.sh</code></p> </li> <li> <p>The <code>create_conda.py</code> help as some useful examples of command lines, see the     help:     <pre><code>&gt; create_conda.py -h\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#manually_delete_a_conda_environment","title":"Manually delete a conda environment","text":"<ul> <li>You can delete a conda environment by simply deleting the corresponding     directory</li> <li>The conda command tries to be smart removing the packages and leaving the dir,     but IMO it doesn't always work</li> <li>You look at the environments with:     <pre><code>&gt; conda info --envs\n# conda environments:\n#\n...\ndevelop               *  /Users/&lt;USER&gt;/.conda/envs/develop\n...\n</code></pre></li> <li>Then you can delete with:     <pre><code>&gt; rm -rf /Users/&lt;USER&gt;/.conda/envs/develop\n</code></pre></li> <li>It's a good idea to move it so you can resume it if something goes wrong:     <pre><code>&gt; mv /Users/&lt;USER&gt;/.conda/envs/develop &gt; /Users/&lt;USER&gt;/.conda/envs/develop.OLD\n</code></pre><ul> <li>Note that <code>develop.OLD</code> might not work anymore since all the links are     broken by the move</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#to_delete_the_entire_conda_installation_advanced_users","title":"To delete the entire conda installation (advanced users)","text":"<ul> <li>This is a dangerous operation, since it deletes the executable <code>conda</code><ul> <li>You want to do this only when your environment is screwed up: a more expert     team member can help you diagnose it</li> </ul> </li> <li>If you want to delete your conda installation, find the base env     <pre><code>&gt; conda info --envs\nbase                     /anaconda3\n...\n</code></pre></li> <li>Run <code>rm -rf /anaconda3</code></li> <li>A good idea is to move it so you can resume the state</li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#update_anaconda","title":"Update anaconda","text":"<ul> <li> <p>To update anaconda (i.e., the framework that manages conda packages and     <code>conda</code> executable)</p> <pre><code>&gt; conda activate base\n# Remove index cache, lock files, tarballs, unused cache packages, and source\n# cache.\n&gt; conda clean --all\n&gt; conda update conda\n&gt; conda update anaconda\n&gt; conda -V\nconda 4.7.12\n</code></pre> </li> <li> <p>You can try to activate one environment     <pre><code>&gt; conda activate amp_develop\n&gt; which python\n/Users/saggese/.conda/envs/amp_develop/bin/python\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#configure_user_credentials","title":"Configure user credentials","text":"<ul> <li> <p>For now this topic is obsolete. All development with AWS is running on a     server side (or locally) in a docker container. Here you can find the     documentation     the link</p> </li> <li> <p>Update the user credential files in <code>amp/helpers/user_credentials.py</code></p> <ul> <li>Commit this so all your clients are configured</li> </ul> </li> <li>Typically you can just copy-paste a portion of the configuration of another     user</li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#be_patient","title":"Be patient","text":"<ul> <li> <p>The <code>create_conda.py</code> flow is designed to make our projects portable across:</p> <ul> <li>Platforms (e.g., macOS, Linux)</li> <li>Different installation of OSes (e.g., GP's laptop vs Paul's laptop) with all     the peculiar ways we install and manage servers and laptops</li> <li>Different versions of conda</li> <li>Different versions of python 3.x</li> <li>Different versions of python packages</li> </ul> </li> <li> <p>There is no easy way to make sure that <code>create_conda.py</code> works for everybody</p> <ul> <li>We can only make sure that Jenkins builds the environment correctly in its     set-up by following the process described above</li> <li>Try to follow the steps one by one, using a clean shell, cutting and pasting     commands</li> <li>If you hit a problem, be patient, ping GP / Paul, and we will extend the     script to handle the quirks of your set-up</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#conda_bloat","title":"Conda bloat","text":"<ul> <li> <p>\"Conda bloat\" refers to the situation when there are more packages in the     conda recipe than what strictly needed to allow us to make progress.</p> </li> <li> <p>The effects of conda bloat are:</p> <ul> <li>Longer time for <code>conda</code> to solve the dependencies, download the packages,     and update the environment</li> <li>Additional dependencies forcing <code>conda</code> to install older packages that can     create subtle issues in our environment (we want our code always to be     forward compatible, but we can't afford our code to be back compatible)</li> <li>People starting pinning down packages to get deterministic library behaviors</li> <li>In the worst case, not being able to install the environment at all due to     conflicting <code>conda</code> requirements</li> </ul> </li> <li> <p>On the one side, we want to minimize \"conda bloat\".</p> </li> <li>On the other side, we want to be able to experiment with packages.</li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#minimize_conda_bloat","title":"Minimize conda bloat","text":"<ul> <li>To minimize conda bloat, our process consists of adding a package to the conda     recipe when a new package is actually needed by code and to run unit tests<ul> <li>Having code using the library and running unit tests for that code should     happen together</li> <li>The rule is \"Important code should be tested, and if code is not important     it should not be in the repo at all\"</li> <li>Thus a corollary is that all code in the repo should be tested</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#conda_environment_lifecycle","title":"Conda environment lifecycle","text":""},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#experimental_conda_environment","title":"Experimental conda environment","text":"<ul> <li> <p>On the other side we want to be free to experiment with a package that can     save us tons of development time.</p> </li> <li> <p>The proposed approach is:</p> <ul> <li>Install the package in whatever way you want on top of your standard conda     environment (<code>conda</code>, <code>pip</code>, whatever)</li> <li>Be aware that some packages are not easy to add to our production system     (e.g. packages written by students trying to graduate, non-coding savvy PhDs     and professors)</li> <li>Create a new local experimental conda environment with:     <code>create_conda.py --env_name develop.nlp</code></li> <li>If you want to reproduce your environment or share it (e.g., among the NLP     team) you can branch <code>dev_scripts/install/requirements/develop.yaml</code> and     modify it, then you can create an environment programmatically with:     <code>create_conda.py --env_name develop.nlp --req_file dev_scripts/install/requirements/develop.nlp.yaml</code></li> </ul> </li> <li> <p>We can make this process more automated by generalizing the scripts we already     have.</p> </li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#releasing_a_new_conda_environment","title":"Releasing a new conda environment","text":"<ul> <li> <p>Once the new package is added to the official conda environment, we should:</p> <ul> <li>Test the new conda environment locally, by creating a fresh environment and     running all the tests</li> <li>Compare the list of packages installed before / after the change:     <code>git diff amp/dev_scripts/install/conda_envs/amp_develop.saggese.Darwin.gpmac.lan.txt</code><ul> <li>E.g., Check whether installed pandas went from 0.25 to 0.14.1</li> </ul> </li> <li>Use the <code>dev</code> build to make sure Jenkins is happy with it, especially when     we develop on a different OS than Linux</li> <li>Send an email to the team asking them to recreate the environment</li> </ul> </li> <li> <p>Typically GP takes care of getting all this fun stuff to work, but you are     welcome to try locally to minimize surprises.</p> </li> </ul>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#conda_maintenance_only_for_admins","title":"Conda maintenance (only for admins)","text":""},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#updating_conda_itself","title":"Updating conda itself","text":"<ul> <li>To update conda itself you can run:</li> </ul> <pre><code>&gt; conda activate base\n\n&gt; conda --version\n3.7.1\n\n&gt; conda update anaconda\n\n&gt; conda --version\n3.8.0\n</code></pre>"},{"location":"tools/dev_system/all.conda_environment_obsolete.how_to_guide.html#cleaning_conda_packages","title":"Cleaning conda packages","text":"<ul> <li>One can clean up the entire cache of packages with:</li> </ul> <pre><code>&gt; conda clean --yes --all\n</code></pre> <ul> <li>This operation:<ul> <li>Affects the conda system for all the users</li> <li>Is just about deleting cached artifacts so it should not have destructive     effects</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html","title":"All.create a runnable dir.how to guide","text":""},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#how_to_create_a_runnable_dir","title":"How to Create a Runnable Dir","text":""},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#definition","title":"Definition","text":"<ul> <li>A runnable dir is a directory containing code and a <code>devops</code> dir so that it     can build its own container storing all the dependencies to run and be tested</li> <li>A runnable dir can be<ul> <li>A super-repo (e.g. <code>//cmamp</code>, <code>//quant_dashboard</code>)<ul> <li>Follow     all.create_a_super_repo_with_helpers.how_to_guide.md     to create a runnable dir that is a super repo</li> </ul> </li> <li>A sub directory under a super-repo (e.g. <code>//cmamp/ck.infra</code>)</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#a_runnable_dir_as_sub_directory_under_a_super-repo","title":"A Runnable Dir as Sub Directory Under a Super-Repo","text":"<pre><code>&gt; export CSFY_RUNNABLE_DIR=\"ck.infra\"\n&gt; export CSFY_RUNNABLE_DIR_SUFFIX=\"cmamp_infra\"\n</code></pre>"},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#1_turn_the_repo_into_a_super-repo_with_helpers","title":"1) Turn the Repo Into a Super-Repo with Helpers","text":"<ul> <li>Follow     all.create_a_super_repo_with_helpers.how_to_guide.md     to turn the repo into a super-repo with helpers</li> <li>For example, for <code>//cmamp</code>, the resulting root directory should have a     structure like:     <pre><code>&gt; ls -1\n...\ndev_scripts_cmamp\n...\nhelpers_root\n...\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#2_copy_and_customize_files_in_the_top_dir","title":"2) Copy and Customize Files in the Top Dir","text":"<ul> <li>Some files need to be copied from <code>helpers</code> to the runnable dir to configure     various tools (e.g., dev container workflow, <code>pytest</code>, <code>invoke</code>)     <pre><code>&gt; (cd helpers_root; git pull)\n&gt; echo $CSFY_RUNNABLE_DIR\n&gt; mkdir $CSFY_RUNNABLE_DIR\n&gt; cp helpers_root/{changelog.txt,conftest.py,pytest.ini,invoke.yaml,repo_config.yaml,tasks.py} $CSFY_RUNNABLE_DIR\n</code></pre><ul> <li><code>changelog.txt</code>: this is copied from the repo that builds the used container     or started from scratch for a new container     <pre><code>&gt; vim $CSFY_RUNNABLE_DIR/changelog.txt\n# cmamp-infra-1.0.0\n- 2024-10-16\n- First release\n</code></pre></li> <li><code>conftest.py</code>: needed to configure <code>pytest</code></li> <li><code>pytest.ini</code>: needed to configure <code>pytest</code> preferences</li> <li><code>invoke.yaml</code>: needed configure <code>invoke</code></li> <li><code>runnable_dir</code>: needed to be created as it is used for automated discovery     of runnable dirs for <code>pytest</code> runs     <pre><code>&gt; touch $CSFY_RUNNABLE_DIR/runnable_dir\n</code></pre></li> <li><code>repo_config.yaml</code>: store information about this specific repo (e.g., name,     used container)<ul> <li>This needs to be modified <pre><code>&gt; vim $CSFY_RUNNABLE_DIR/repo_config.yaml\nrepo_info:\n    repo_name: cmamp\n...\ndocker_info:\n    docker_image_name: cmamp-infra\n...\nrunnable_dir_info:\n    use_helpers_as_nested_module: True\n    ...\n    dir_suffix: cmamp_infra\n</code></pre></li> </ul> </li> <li><code>tasks.py</code>: the <code>invoke</code> tasks available in this container<ul> <li>This can be modified if needed</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#3_copy_and_customize_files_in_devops","title":"3) Copy and Customize Files in <code>devops</code>","text":"<ul> <li>Copy the <code>devops</code> from <code>//helpers</code> as a template dir     <pre><code>&gt; (cd helpers_root; git pull)\n&gt; cp -r helpers_root/devops $CSFY_RUNNABLE_DIR\n</code></pre></li> <li>Follow the instructions in     <code>/docs/tools/dev_system/all.devops_docker.reference.md</code>     and     <code>/docs/tools/dev_system/all.devops_docker.how_to_guide.md</code>     to customize the files in order to build the Docker container<ul> <li>Typically, we might want to customize the following<ul> <li><code>$CSFY_RUNNABLE_DIR/devops/docker_build/dev.Dockerfile</code>: if we need to use     a base image with different Linux distro or version</li> <li><code>$CSFY_RUNNABLE_DIR/devops/docker_build/install_os_packages.sh</code>: if we     need to add or remove OS packages using the declarative approach<ul> <li>See     <code>/docs/tools/dev_system/all.devops_docker.reference.md#declarative-os-package-installation</code>     for details on the declarative OS package installation system</li> </ul> </li> <li><code>$CSFY_RUNNABLE_DIR/devops/docker_build/pyproject.toml</code>: if we need to add     or remove Python dependencies</li> </ul> </li> </ul> </li> <li>Always trim     <code>/devops/docker_build/pyproject.toml</code>     to only include the dependancies requred by the runnable dir</li> </ul>"},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#4_copy_and_customize_files_in_thin_client","title":"4) Copy and Customize Files in Thin_Client","text":"<ul> <li> <p>Create the <code>dev_scripts_{runnable_dir_suffix}</code> dir based off the template from     <code>helpers</code></p> <pre><code># Use a suffix based on the repo name and runnable dir name, e.g., `cmamp_infra`.\n&gt; SRC_DIR=\"./helpers_root/dev_scripts_helpers/thin_client\"; echo $SRC_DIR\n&gt; DST_DIR=\"${CSFY_RUNNABLE_DIR}/dev_scripts_${CSFY_RUNNABLE_DIR_SUFFIX}/thin_client\"; echo $DST_DIR\n&gt; mkdir -p $DST_DIR\n&gt; cp \"$SRC_DIR/setenv.sh\" $DST_DIR\n</code></pre> </li> <li> <p>The resulting <code>dev_script</code> should look like:</p> <pre><code>&gt; ls -1 $DST_DIR\nsetenv.sh\n</code></pre> </li> <li> <p>Replace file with symbolic links</p> <pre><code>&gt; echo $SRC_DIR\n./helpers_root/dev_scripts_helpers/thin_client\n&gt; echo $DST_DIR\n./ck.infra/dev_scripts_cmamp_infra/thin_client\n&gt; ./helpers_root/helpers/create_links.py --src_dir $SRC_DIR --dst_dir $DST_DIR --replace_links --use_relative_paths\n</code></pre> </li> </ul>"},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#5_replace_files_with_symbolic_links","title":"5) Replace Files with Symbolic Links","text":"<ul> <li> <p>Some common files can be replaced with symbolic links</p> <pre><code># Runnable dir is \"ck.infra\" in this case.\n&gt; ./helpers_root/helpers/create_links.py --src_dir ./helpers_root --dst_dir $CSFY_RUNNABLE_DIR --replace_links --use_relative_paths\n</code></pre> </li> <li> <p>Refer to     Managing common files     for explanation</p> </li> <li>Refer to     Managing symbolic links between directories     for how to use the commands</li> </ul>"},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#6_commit_changes","title":"6) Commit Changes","text":"<ul> <li>Commit changes     <pre><code>&gt; git add $CSFY_RUNNABLE_DIR\n&gt; git commit -m \"Add runnable dir\"\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#7_build_a_container_for_a_runnable_dir","title":"7) Build a Container for a Runnable Dir","text":"<ul> <li> <p>Run the single-arch flow to test the flow</p> <pre><code>&gt; cd $CSFY_RUNNABLE_DIR\n&gt; source dev_scripts_${CSFY_RUNNABLE_DIR_SUFFIX}/thin_client/setenv.sh\n&gt; i docker_build_local_image --version 1.0.0 --container-dir-name $CSFY_RUNNABLE_DIR\n&gt; i docker_tag_local_image_as_dev --version 1.0.0\n&gt; i docker_bash --skip-pull --version 1.0.0\n</code></pre> </li> <li> <p>Run the multi-arch flow     <pre><code>&gt; cd $CSFY_RUNNABLE_DIR\n&gt; source dev_scripts_${CSFY_RUNNABLE_DIR_SUFFIX}/thin_client/setenv.sh\n&gt; i docker_build_local_image --version 1.0.0 --container-dir-name $CSFY_RUNNABLE_DIR --multi-arch \"linux/amd64,linux/arm64\"\n&gt; i docker_tag_local_image_as_dev --version 1.0.0\n&gt; i docker_bash --skip-pull --version 1.0.0\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#8_test_the_code","title":"8) Test the Code","text":"<ul> <li> <p>Run tests from the runnable dir (e.g. <code>cmamp/ck.infra</code>)</p> <pre><code># If the version of the locally built image is 1.0.0.\n&gt; cd $CSFY_RUNNABLE_DIR\n&gt; i run_fast_tests --version 1.0.0 --skip-pull\n&gt; i run_slow_tests --version 1.0.0 --skip-pull\n</code></pre> </li> <li> <p>Run tests from the root dir (e.g. <code>cmamp</code>)     <pre><code>&gt; main_pytest.py run_fast_tests --dir ck.infra\n&gt; main_pytest.py run_slow_tests --dir ck.infra\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#9_add_the_dependency_lock_files_to_the_commit","title":"9) Add the Dependency Lock Files to the Commit","text":"<pre><code>&gt; cd $CSFY_RUNNABLE_DIR\n&gt; git add devops/docker_build/poetry.lock\n&gt; git add devops/docker_build/pip_list.txt\n&gt; git commit -m \"Update dependencies\"\n</code></pre>"},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#10_release_the_docker_image","title":"10) Release the Docker Image","text":"<ul> <li> <p>Refer to the following docs for more info on image releases</p> <ul> <li>docs/tools/dev_system/all.devops_docker.how_to_guide.md#release-a-docker-image</li> </ul> </li> <li> <p>To create new registory to store the image, please contact Infra team.</p> </li> <li> <p>Release to ECR</p> <ul> <li>This is required for running the container from the dev/prod servers</li> </ul> <p><pre><code>&gt; i docker_push_dev_image --version &lt;version&gt;\n</code></pre> - Or run the following command to build, test, and release the image</p> <pre><code>&gt; i docker_release_dev_image --version &lt;version&gt; --container-dir-name $CSFY_RUNNABLE_DIR\n</code></pre> </li> <li> <p>Release to GHCR</p> <ul> <li>This is required for running the container from GH Actions CI/CD pipelines</li> <li>TODO(heanh): Can we create an invoke target for this? <pre><code>&gt; docker login ghcr.io -u &lt;username&gt; -p &lt;personal_access_token&gt;\n&gt; docker tag 623860924167.dkr.ecr.eu-north-1.amazonaws.com/&lt;image_name&gt;:dev ghcr.io/causify-ai/&lt;image_name&gt;:dev\n&gt; docker push ghcr.io/causify-ai/&lt;image_name&gt;:dev\n</code></pre></li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.create_a_runnable_dir.how_to_guide.html#11_update_and_release_a_new_version_of_the_image","title":"11) Update and Release a New Version of the Image","text":"<p>We release a new version of the Docker image whenever we need to update its dependencies</p> <ol> <li> <p>Modify changelog</p> </li> <li> <p>Specify what was changed</p> </li> <li>Pick the release version according to semantic versioning convention</li> <li>For example for version 1.2.3:<ul> <li>1 is major, 2 is minor, 3 is patch</li> </ul> </li> </ol> <pre><code>&gt; cd $CSFY_RUNNABLE_DIR\n&gt; source dev_scripts_${CSFY_RUNNABLE_DIR_SUFFIX}/thin_client/setenv.sh\n&gt; vim changelog.txt\n\n# Cmamp-Infra-1.2.0\n- 2025-05-18\n- Add support for Kubernetes Kustomize\n- Upgrade `kubectl` to v1.31.0\n- Add `yq` command line tool\n</code></pre> <ol> <li> <p>Modify dependencies list</p> </li> <li> <p>Modify <code>$CSFY_RUNNABLE_DIR/devops/docker_build/os_packages/os_packages.txt</code> to     add or remove OS packages using the declarative approach</p> <ul> <li>See     <code>/docs/tools/dev_system/all.devops_docker.reference.md#declarative-os-package-installation</code>     for details on the declarative OS package installation system</li> </ul> </li> <li> <p>Modify <code>$CSFY_RUNNABLE_DIR/devops/docker_build/pyproject.toml</code> to add or     remove Python packages</p> </li> <li> <p>Build the image locally</p> </li> </ol> <pre><code># Build the Image.\n&gt; i docker_build_local_image --version 1.2.0 --container-dir-name $CSFY_RUNNABLE_DIR\n\n# Tag the Image as Dev.\n&gt; i docker_tag_local_image_as_dev --version 1.2.0\n</code></pre> <ol> <li>Add the dependency lock files to the commit</li> </ol> <pre><code>&gt; cd $CSFY_RUNNABLE_DIR\n&gt; git add devops/docker_build/poetry.lock\n&gt; git add devops/docker_build/pip_list.txt\n&gt; git commit -m \"Update dependencies\"\n</code></pre> <ol> <li>Make sure we can run the container</li> </ol> <pre><code>&gt; i docker_bash --skip-pull --stage local --version 1.2.0\n&gt; i docker_jupyter --skip-pull --stage local --version 1.2.0\n</code></pre> <ol> <li>Make sure all tests pass</li> </ol> <pre><code># Run Tests.\n&gt; i run_fast_tests --stage local --version 1.2.0\n&gt; i run_slow_tests --stage local --version 1.2.0\n</code></pre> <ol> <li>Release the images to remote registries</li> </ol>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html","title":"All.create a super repo with helpers.how to guide","text":""},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#how_to_create_a_super-repo_with_helpers","title":"How to Create a Super-Repo with <code>Helpers</code>","text":""},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#create_a_new_super_repo_in_the_desired_organization","title":"Create a New (Super) Repo in the Desired Organization","text":"<ul> <li>Create a repo within the     <code>causify-ai</code> organization</li> <li>Follow the     official guide<ul> <li>TODO(Grisha): consider using repository     templates</li> </ul> </li> <li>Recommended options:<ul> <li>Owner: <code>causify-ai</code></li> <li>Repository-name: provide a valid short name, e.g., <code>algo_trading</code></li> <li>Visibility: by default choose <code>Private</code></li> <li>Add a README file</li> <li><code>.gitignore template: None</code></li> <li>License: <code>General Public License v3.0</code></li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#add_helpers_sub-repo","title":"Add Helpers Sub-Repo","text":"<ul> <li> <p>Below there is an example for the <code>//helpers</code> repo, but it works for any repo     (e.g., <code>//orange</code>) including any other repo (e.g., <code>//cmamp</code>)</p> </li> <li> <p>Clone the super-repo locally</p> <pre><code>&gt; git clone --recursive git@github.com:causify-ai/{repo_name}.git ~/src/{repo_name}{index}\n</code></pre> </li> <li> <p>Checkout to a new branch</p> <pre><code>&gt; git checkout -b repo_init\n</code></pre> </li> <li> <p>Add a submodule</p> <pre><code>&gt; cd ~/src/repo_name1\n# In general form.\n# &gt; git submodule add {submodule_url} {submodule_path}\n# Example for `cmamp`.\n&gt; git submodule add git@github.com:causify-ai/helpers.git helpers_root\n</code></pre> </li> <li> <p>The command will create a <code>.gitmodules</code> file that we need to check-in:</p> <pre><code>[submodule \"helpers_root\"]\npath = helpers_root\nurl = git@github.com:causify-ai/helpers.git\n</code></pre> </li> <li> <p>Init the submodule and commit the <code>.gitmodules</code> file</p> <pre><code>&gt; git submodule init\n&gt; git submodule update\n</code></pre> </li> <li> <p>Commit and push the changes     <pre><code>&gt; git add .gitmodules helpers_root\n&gt; git commit -am \"Add helpers subrepo\" &amp;&amp; git push\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#copy_and_customize_files_in_the_top_dir","title":"Copy and Customize Files in the Top Dir","text":"<ul> <li> <p>Conceptually you need to copy and customize the files in:</p> <ol> <li><code>thin_client</code> (one can reuse the thin client across repos)</li> <li>The top dir (to run <code>pytest</code>, ...)</li> <li><code>devops</code> (to build the dev and prod containers)</li> <li><code>.github/workflows</code> (to run the GitHub regressions)</li> </ol> </li> <li> <p>After copying the files you can search for the string <code>xyz</code> to customize</p> </li> <li> <p>If there is a problem with phases 3) and 4) due to the thin environment not     being completely configured, you can keep moving and then re-run the command     later</p> </li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#copy_files_from_existing_repo","title":"Copy Files From Existing Repo","text":"<ul> <li> <p>Copy the files from a working repo (e.g., <code>//cmamp</code>)</p> <pre><code>&gt; export SRC_DIR=$HOME/src/cmamp1\n&gt; ls $SRC_DIR\n\n&gt; cp $SRC_DIR/{pytest.ini,repo_config.yaml,tasks.py} .\n&gt; vi pytest.ini repo_config.yaml tasks.py\n</code></pre> </li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#script_approach","title":"Script Approach","text":"<ul> <li>Customize the script     <code>/dev_scripts_helpers/thin_client/sync_super_repo.sh</code> <pre><code>DST_PREFIX=\"umd_msml610\"\n</code></pre></li> <li>Run the script which allows to <code>vimdiff</code> / <code>cp</code> files across a super-repo and     its <code>//helpers</code> dir</li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#manual_approach","title":"Manual Approach","text":"<ul> <li> <p>Some files need to be copied from <code>//helpers</code> to the root of the super-repo to     configure various tools (e.g., dev container workflow, <code>pytest</code>, <code>invoke</code>)</p> <ul> <li><code>pytest.ini</code>: configure <code>pytest</code> preferences</li> <li><code>repo_config.yaml</code>: stores information about this specific repo (e.g., name,     used container, runnable dir config)<ul> <li>This needs to be modified <pre><code>repo_info:\n    repo_name: cmamp\n...\ndocker_info:\n    docker_image_name: cmamp\n...\nrunnable_dir_info:\n    use_helpers_as_nested_module: 1\n    ...\n    dir_suffix: cmamp\n</code></pre></li> </ul> </li> <li><code>tasks.py</code>: the <code>invoke</code> tasks available in this container<ul> <li>This can be modified if needed</li> </ul> </li> </ul> </li> <li> <p>You can copy all these files from <code>//helpers</code> <pre><code>&gt; cp helpers_root/{pytest.ini,repo_config.yaml,tasks.py} .\n&gt; vim pytest.ini repo_config.yaml tasks.py\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#copy_and_customize_files_in_thin_client","title":"Copy and Customize Files in <code>Thin_Client</code>","text":""},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#copy_files_from_existing_repo_1","title":"Copy Files From Existing Repo","text":"<ul> <li> <p>Copy the files from a working repo (e.g., <code>//cmamp</code>)</p> <pre><code>&gt; export SRC_DIR=$HOME/src/cmamp1\n&gt; ls $SRC_DIR\n\n&gt; cp $SRC_DIR/{pytest.ini,repo_config.yaml,tasks.py} .\n&gt; vi pytest.ini repo_config.yaml tasks.py\n</code></pre> </li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#script_approach_1","title":"Script Approach","text":"<ul> <li>Customize the script     <code>/dev_scripts_helpers/thin_client/sync_super_repo.sh</code> <pre><code>DST_PREFIX=\"umd_msml610\"\n</code></pre></li> <li>Run the script which allows to <code>vimdiff</code> / <code>cp</code> files across a super-repo and     its <code>//helpers</code> dir</li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#manual_approach_1","title":"Manual Approach","text":"<ul> <li> <p>Create the <code>dev_scripts_{dir_name}</code> dir based off the template from <code>helpers</code></p> <pre><code># Use a suffix based on the repo name, e.g., `tutorials`, `sports_analytics`.\n&gt; SRC_DIR=\"./helpers_root/dev_scripts_helpers/thin_client\"; ls $SRC_DIR\n&gt; DST_SUFFIX=\"xyz\"\n&gt; DST_DIR=\"dev_scripts_${DST_SUFFIX}/thin_client\"; echo $DST_DIR\n&gt; mkdir -p $DST_DIR\n&gt; cp -r $SRC_DIR/{build.py,requirements.txt,setenv.sh,tmux.py} $DST_DIR\n</code></pre> </li> <li> <p>The resulting <code>dev_scripts_{dir_name}</code> should look like:</p> <pre><code>&gt; ls -1 $DST_DIR\nbuild.py\nrequirements.txt\nsetenv.sh\ntmux.py\n</code></pre> </li> <li> <p>If we don't need to create a new thin env, then you can delete the files     <code>dev_scripts_{dir_name}/thin_client/build.py</code> and <code>requirements.txt</code></p> </li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#build_and_test_the_thin_environment","title":"Build and Test the Thin Environment","text":""},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#build_the_thin_environment","title":"Build the Thin Environment","text":"<ul> <li>Build the thin environment:     <pre><code>&gt; $DST_DIR/build.py\n... ==&gt; `brew cleanup` has not been run in the last 30 days, running now...\n... Disable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP.\n... Hide these hints with HOMEBREW_NO_ENV_HINTS (see `man brew`).\n14:37:37 - INFO  build.py _main:94                  # gh version=gh version 2.58.0 (2024-10-01)\nhttps://github.com/cli/cli/releases/tag/v2.58.0\n14:37:37 - INFO  build.py _main:100                 /Users/saggese/src/quant_dashboard1/dev_scripts_quant_dashboard/thin_client/build.py successful\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#test_the_thin_environment","title":"Test the Thin Environment","text":"<ul> <li>Follow     the on-boarding guide</li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#create_the_tmux_links","title":"Create the Tmux Links","text":"<ul> <li>Follow     the on-boarding guide</li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#copy_and_customize_files_in_devops","title":"Copy and Customize Files in <code>Devops</code>","text":"<ul> <li>Copy the <code>devops</code> template dir     <pre><code>&gt; (cd helpers_root; git pull)\n&gt; cp -r helpers_root/devops devops\n</code></pre></li> <li> <p>If we don't need to build a container and just we can reuse, then we can     delete the corresponding <code>build</code> directory</p> <pre><code>&gt; rm -rf devops/docker_build\n</code></pre> </li> <li> <p>Follow the instructions in     <code>/docs/tools/dev_system/all.devops_docker.reference.md</code>     and     <code>/docs/tools/dev_system/all.devops_docker.how_to_guide.md</code></p> </li> <li> <p>To customize OS package dependencies:</p> <ul> <li>The Docker build system uses a declarative approach for OS package     installation</li> <li>Edit     <code>/devops/docker_build/os_packages/os_packages.txt</code>     to control which packages will be installed during the container build<ul> <li>Disable a package: add <code>#</code> at the beginning of the line</li> <li>Enable a package: remove the <code>#</code> from the beginning of the line</li> </ul> </li> <li>See     <code>/docs/tools/dev_system/all.devops_docker.reference.md#declarative-os-package-installation</code>     for details on the declarative OS package installation system, including     important notes about dependencies between <code>helpers</code> modules and OS packages</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#create_symbolic_links","title":"Create Symbolic Links","text":""},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#create_standard_configuration_file_links","title":"Create Standard Configuration File Links","text":"<ul> <li> <p>Use <code>create_all_helpers_links.py</code> to automatically create symbolic links for     standard configuration files from <code>helpers_root</code> to the repository root</p> <pre><code># Create all missing links\n&gt; helpers_root/dev_scripts_helpers/thin_client/create_all_helpers_links.py\n\n# Force recreate all links (even if they exist)\n&gt; helpers_root/dev_scripts_helpers/thin_client/create_all_helpers_links.py --force\n\n# Preview what would be done without making changes\n&gt; helpers_root/dev_scripts_helpers/thin_client/create_all_helpers_links.py --dry_run\n</code></pre> </li> <li> <p>This script creates symbolic links for the following standard files:</p> <ul> <li><code>.claude/</code> - Claude Code configuration</li> <li><code>.coveragerc</code> - Test coverage configuration</li> <li><code>.gitignore</code> - Git ignore patterns</li> <li><code>.gitleaksignore</code> - Gitleaks scan exclusions</li> <li><code>.isort.cfg</code> - Import sorting configuration</li> <li><code>.pre-commit-config.yaml</code> - Pre-commit hooks</li> <li><code>CLAUDE.md</code> - Claude Code project context</li> <li><code>conftest.py</code> - Pytest configuration</li> <li><code>linters2/</code> - Linting scripts</li> <li><code>pyproject.toml</code> - Python project configuration</li> <li><code>pytest.ini</code> - Pytest settings</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#create_custom_symbolic_links","title":"Create Custom Symbolic Links","text":"<ul> <li> <p>Check the difference between the super-repo and <code>helpers</code></p> <pre><code>&gt; helpers_root/dev_scripts_helpers/thin_client/sync_super_repo.sh\n</code></pre> </li> <li> <p>Replace file with symbolic links:</p> <pre><code>&gt; echo $SRC_DIR\n./helpers_root/dev_scripts_helpers/thin_client\n&gt; echo $DST_DIR\n./dev_scripts_xyz/thin_client\n&gt; ./helpers_root/helpers/create_links.py --src_dir $SRC_DIR --dst_dir $DST_DIR --replace_links --use_relative_paths\n</code></pre> </li> <li> <p>Refer to     Managing common files     for explanation</p> </li> <li>Refer to     Managing symbolic links between directories     for how to use the commands</li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#5_build_container_and_running_tests","title":"5) Build Container and Running Tests","text":""},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#build_a_container_for_a_super-repo","title":"Build a Container for a Super-Repo","text":"<ul> <li> <p>Run the single-arch flow:</p> <pre><code>&gt; i docker_build_local_image --version 1.0.0 &amp;&amp; i docker_tag_local_image_as_dev --version 1.0.0\n&gt; i docker_bash --skip-pull\n&gt; i docker_jupyter\n</code></pre> </li> <li> <p>Run the multi-arch flow:</p> <pre><code>&gt; i docker_build_local_image --version 1.0.0 --multi-arch \"linux/amd64,linux/arm64\"\n&gt; i docker_tag_local_image_as_dev --version 1.0.0\n</code></pre> </li> <li> <p>If you wish to push the dev image to a remote registry, contact the infra team     to add new registry with default settings</p> <ul> <li>Make sure the registry name matches the repo name for consistency</li> <li>By default we add new containers to Stockholm region (<code>eu-north-1</code>)</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#check_if_the_regressions_are_passing","title":"Check If the Regressions Are Passing","text":"<ul> <li> <p>Follow     the on-boarding doc     to confirm that everything is set up properly</p> </li> <li> <p>File a PR with the new files and merge the PR into <code>master</code></p> </li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#configure_regressions_via_github_actions","title":"Configure Regressions Via Github Actions","text":""},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#set_repository_secretsvariables","title":"Set Repository Secrets/Variables","text":"<ul> <li> <p>Some secrets/variables are shared in an organization wide storage</p> <ul> <li>E.g. for Causify at     https://github.com/organizations/causify-ai/settings/secrets/actions</li> <li>These values are shared across all repos in the organization so we don't     need to create them on a per-repo basis<ul> <li>The access method is the same as for per-repo variables - via actions     context <code>${{ secrets.MY_TOKEN }}</code> or <code>`${{ vars.MY_TOKEN }}</code></li> </ul> </li> <li>Once a <code>secret</code> is set it's read-only for everybody. To preview all of the     raw values that are currently used, visit     1password &gt; Shared vault &gt; Causify org GH actions secrets</li> </ul> </li> <li> <p>Before adding a new secret/variables for a repo, consider the following:</p> <ul> <li>If it's already present in the global storage for an organization, no action     is required</li> <li>If it's not, check if the newly added value is not needed in all of the     repos, if so, add it to the global storage to facilitate reusability<ul> <li>If you lack permissions for this operation, contact your TL</li> </ul> </li> </ul> </li> <li> <p>Should a repo need some additional secret values/variables, follow the     procedure below</p> </li> <li> <p>Login to 1password    https://causify.1password.com/home</p> </li> <li>Ask your TL if you don't have access to 1password</li> <li>Navigate to the <code>Shared Vault</code></li> <li>Search for <code>Github actions secrets JSON</code> secret</li> <li>Copy the JSON from 1password to a temporary local file <code>vars.json</code></li> <li>Run the script to set the secrets/variables    <pre><code>&gt; cd ~/src/&lt;REPO_NAME&gt;\n&gt; ./helpers_root/dev_scripts_helpers/github/set_secrets_and_variables.py \\\n             --file `vars.json' \\\n             --repo '&lt;ORG_NAME&gt;/&lt;REPO_NAME&gt;'\n</code></pre></li> <li> <p>Make sure not to commit the raw <code>vars.json</code> file or the    <code>/dev_scripts_helpers/github/set_secrets_and_variables.py.log</code>    file</p> </li> <li> <p>Delete those files locally</p> </li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#create_github_actions_workflow_files","title":"Create Github Actions Workflow Files","text":"<ol> <li>Create a directory <code>./github/workflows</code> in the super-repo</li> <li>Copy an example flow from helpers</li> <li>E.g. `helpers_root/.github/workflows/fast_tests.yml</li> <li>Modify it based on your needs<ul> <li>Find and replace mentions of <code>helpers</code> with the name of super repo for    consistency</li> <li>Replace <code>invoke run_fast_tests</code> with your desired action</li> </ul> </li> </ol>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#configure_gitleaks_scan","title":"Configure Gitleaks Scan","text":"<ul> <li> <p>Copy the configuration and workflow files</p> <pre><code>&gt; cp ./helpers_root/.github/gitleaks-rules.toml ./.github\n&gt; cp ./helpers_root/.github/workflows/gitleaks.yml ./.github/workflows\n</code></pre> </li> <li> <p>Replace files with symbolic links</p> <pre><code>&gt; ./helpers_root/helpers/create_links.py --src_dir ./helpers_root/.github --dst_dir ./.github --replace_links --use_relative_paths\n</code></pre> </li> <li> <p>Note:</p> <ul> <li>Only the <code>gitleaks-rules.toml</code> file should be replaced with symbolic links</li> <li>The <code>gitleaks.yml</code> file should be copied as is because GitHub Actions does     not resolve symbolic links when parsing workflows in the <code>.github/workflows</code>     directory (See #CmampTask11429)</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.create_a_super_repo_with_helpers.how_to_guide.html#configure_github_repo","title":"Configure Github Repo","text":"<ul> <li> <p>Disclaimer: the following set-up requires paid GitHub version (Pro / Team     / Enterprise)</p> </li> <li> <p>Set-up branch protection rule for master</p> <ul> <li>Navigate to <code>https://github.com/&lt;your org&gt;/&lt;&lt;your-repo&gt;&gt;/settings/branches</code></li> <li>Click \"Add rule\"<ul> <li>Specify branch name pattern <code>master</code></li> <li>Check the following options:<ul> <li><code>Require a pull request before merging</code> (do not check the sub-options)</li> <li><code>Require status checks to pass before merging</code><ul> <li>Check the <code>Require branches to be up to date before merging</code>     sub-option</li> <li>In the <code>Status checks that are required</code> table specify the workflows     you want to pass before merging each PR<ul> <li>Depends on which workflows were set-up in the step above</li> <li>Usually its <code>run_fast_tests</code> and <code>run_slow_tests</code></li> </ul> </li> </ul> </li> <li><code>Require conversation resolution before merging</code></li> </ul> </li> <li>Click \"Save changes\" button</li> </ul> </li> </ul> </li> <li> <p>You need to sync the repo using the sync script</p> </li> </ul>"},{"location":"tools/dev_system/all.dealing_with_missing_dependencies.how_to_guide.html","title":"All.dealing with missing dependencies.how to guide","text":""},{"location":"tools/dev_system/all.dealing_with_missing_dependencies.how_to_guide.html#dealing_with_missing_dependencies_in_docker_images","title":"Dealing with missing dependencies in Docker images","text":"<ul> <li>Sometimes our scripts need to use dependencies that are not available in our     primary Docker image</li> <li>If the package is necessary for the entire project and not just for a specific     script, we can request to have it installed in the Docker image and release a     new version of the image</li> <li> <p>However, sometimes the packages are only needed for a specific script or part     of a project. Thus, we don't want to install them in the Docker image as it     would bloat the image</p> </li> <li> <p>Due to missing dependencies, the build process will fail when tests are     discovered or when the module is imported and used in another module</p> </li> <li>The following are some common workarounds to deal with the missing     dependencies without breaking the build</li> </ul>"},{"location":"tools/dev_system/all.dealing_with_missing_dependencies.how_to_guide.html#quick_hacks","title":"Quick hacks","text":"<ul> <li> <p>In test files,</p> <ul> <li>We can use <code>pytest.importorskip</code> to skip the tests if the package is not     available     <code>python pytest.importorskip(\"somepackage\")</code></li> </ul> </li> <li> <p>In non-test files,</p> <ul> <li>We do not need to do anything besides avoiding importing the module</li> <li>If the file is discovered by <code>pytest</code> and the image doesn't have the package     installed, it will be skipped with the <code>pytest.importorskip</code> in the test     file</li> </ul> </li> <li> <p>Why not installing the package on the fly within the script?</p> <ul> <li>While it is possible, it is NOT a good practice</li> <li>This approach is NOT great because every time somebody imports that module     (even pytest during test discovery), the package gets installed<ul> <li>Bad <code>python subprocess.call([\"sudo\", \"/venv/bin/pip\", \"install\", \"somepackage\"])</code></li> </ul> </li> <li>An exception is in Jupyter Notebooks, where it's acceptable to install     packages on the fly for prototyping, experimenting, or running analyses</li> <li>However, we should \"comment out\" those lines afterwards, since Jupyter     Notebooks are often converted to Python scripts (through jupytext), and we     don't want these installation commands running automatically</li> <li>Example (in a Jupyter Notebook cell)     <pre><code>!sudo sudo /venv/bin/pip install --quiet somepackage)\"\n</code></pre></li> </ul> </li> <li> <p>If we want to implement different variations of the code depending on whether     the package is available or not, we can use the following approaches     <code>python _HAS_MOTO = henv.has_module(\"moto\") if _HAS_MOTO:     import moto     # Implementation that uses moto. else:     # Implementation that doesn't use moto.</code></p> </li> </ul>"},{"location":"tools/dev_system/all.dealing_with_missing_dependencies.how_to_guide.html#delay_the_evaluation","title":"Delay the evaluation","text":"<ul> <li> <p>Sometimes it's sufficient to delay when a module is imported to prevent errors     during script loading or testing</p> </li> <li> <p>Move the <code>import</code> statement inside the function or class definition so that     the module is only required when that part of the code is executed</p> <p><code>python def my_function(): import somepackage</code></p> <p><code>python class MyClass: import somepackage ...</code></p> </li> </ul>"},{"location":"tools/dev_system/all.dealing_with_missing_dependencies.how_to_guide.html#type_annotations","title":"Type annotations","text":"<ul> <li> <p>If the missing dependency is only needed for type annotations, we can postpone     the evaluation of the annotations to avoid errors during module loading or     pytest discovery</p> </li> <li> <p>One option is to use string literals for type hints</p> <p><code>python def my_function(param: \"SomeClass\") -&gt; \"SomeClass\":     ...</code></p> </li> <li> <p>Another option is to use the <code>__future__</code> module to enable postponed     evaluation of type annotations     <code>python from __future__ import annotations</code></p> </li> </ul>"},{"location":"tools/dev_system/all.dealing_with_missing_dependencies.how_to_guide.html#long_term_solution","title":"Long term solution","text":"<ul> <li>While quick hacks are useful temporary workarounds, they are not a long term     solution</li> </ul>"},{"location":"tools/dev_system/all.dealing_with_missing_dependencies.how_to_guide.html#add_the_dependency_to_the_docker_image","title":"Add the dependency to the Docker image","text":"<ul> <li>Obviously, if the package is needed for the entire project, we should add it     to the Docker image and release a new version of the image</li> </ul>"},{"location":"tools/dev_system/all.dealing_with_missing_dependencies.how_to_guide.html#create_dockerized_executable","title":"Create \"dockerized\" executable","text":"<ul> <li>We can create a \"dockerized\" executable that can be run in a Docker container     with all the dependencies pre-installed</li> <li>A \"dockerized\" executable is easier to set up compared to a runnable directory</li> <li>It is suitable for utility scripts that have a single and well defined purpose     and do not have a large number of dependencies</li> <li>The image is built on the fly</li> <li>Some examples of dockerized executables:<ul> <li><code>dockerized_prettier</code></li> <li><code>dockerized_mermaid</code></li> <li><code>dockerized_extract_notebook_images</code></li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.dealing_with_missing_dependencies.how_to_guide.html#create_runnable_directory","title":"Create \"runnable\" directory","text":"<ul> <li>We can create a \"runnable\" directory that contains all the code and a <code>devops</code>     directory so it can build its own container with all the dependencies needed     to run and be tested</li> <li>A \"runnable\" dir is more complex to set up than the previous approach</li> <li>It is good for larger projects or parts of a project with many interacting     components that have many dependencies</li> <li>The image can be built and stored in the container registry</li> <li>Some examples of runnable directories:<ul> <li><code>infra</code></li> <li><code>optimizer</code></li> <li><code>sports_analytics</code></li> <li><code>tutorial_langchain</code></li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html","title":"All.devops docker.how to guide","text":""},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#high_level_philosophy","title":"High level philosophy","text":"<ul> <li>We use Docker extensively and assume you are familiar with Docker concepts and     workflows</li> <li>A short tutorial about Docker is     /docs/tools/docker/all.docker.tutorial.md</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#separate_docker_containers","title":"Separate Docker containers","text":"<ul> <li> <p>We always want to separate things that don't need to run together in different     containers along repos or \"independently runnable / deployable directories\"</p> <ul> <li>E.g., <code>dev / prod cmamp</code>, <code>optimizer</code>, <code>im</code>, <code>oms</code></li> </ul> </li> <li> <p>The rationale is that when we put too many dependencies in a single container,     we start having huge containers that are difficult to deploy and are unstable     in terms of building even when using tools like <code>poetry</code>.</p> </li> <li>Each dir that can be \"deployed\" and run should have a <code>devops</code> dir to build /     QA / release containers with all the needed dependencies</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#pre-built_vs_build-on-the-fly_containers","title":"Pre-built vs build-on-the-fly containers","text":"<ol> <li> <p>Certain containers that need to be widely available to the team and deployed    go through the release process and are stored in ECR (AWS and DockerHub)</p> </li> <li> <p>Other containers that are lightweight and used only by one person can be    built on the fly using <code>docker compose</code> / <code>docker build</code>.</p> </li> <li> <p>E.g., the <code>infra</code> container, containers to run a simple tools</p> </li> <li> <p>Sometimes we install a dependency on the fly from inside the code, when it's    needed only rarely and it doesn't justify being added to the Docker container</p> </li> <li>E.g., when we need to profile Python code, we install the package directly      in the container</li> </ol>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#thin_client","title":"Thin client","text":"<ul> <li>To bootstrap the system we use a \"thin client\" which installs in a virtual env     the minimum set of packages to run (e.g., installs <code>invoke</code>, <code>docker</code>, etc).</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#amp_cmamp_container","title":"amp / cmamp container","text":"<ul> <li>The <code>dev</code> version is used to develop</li> <li> <p>The <code>prod</code> version is used for deployment as shortcut to creating a smaller     container with only the strictly needed dependencies</p> </li> <li> <p>In order to avoid shipping the monster <code>cmamp</code> dev / prod container, we want     to start building smaller containers with only the dependencies that specific     prod scripts need</p> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#stages","title":"Stages","text":"<ul> <li>A \"stage\" is a step (e.g., local, dev, prod) in our release workflow of Docker     images, code, or infrastructure.</li> <li>To run a Docker container in a certain stage use the <code>stage</code> parameter<ul> <li>E.g. <code>i docker_bash --stage=\"local\"</code> creates a bash session inside the local     Docker <code>amp</code> container</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#local","title":"Local","text":"<ul> <li>A <code>local</code> image is used to develop and test an update to the Docker container<ul> <li>E.g. after updating a package, installing a new package, etc.</li> </ul> </li> <li>Local images can only be accessed locally by a developer, i.e. the team     members can not / should not use local images</li> <li>In practice <code>local</code> images are like <code>dev</code> images but private to users and     servers</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#dev","title":"Dev","text":"<ul> <li>A <code>dev</code> image is used by team members to develop our system<ul> <li>E.g., add new functionalities to the <code>cmamp</code> or <code>helpers</code> codebase</li> </ul> </li> <li>The source code is mounted through a bind mount in Docker so that one can     change the code and execute it in Docker, without rebuilding the container</li> <li>A local image is tested, blessed, and released as <code>dev</code> so that users and CI     can pull it and use it knowing that it's sane</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#prod","title":"Prod","text":"<ul> <li>A <code>prod</code> image is used to run a system by final users<ul> <li>E.g., Linter inside <code>helpers</code>, some prod system inside Airflow</li> </ul> </li> <li>It is self-contained (i.e., it has no dependencies) since it contains     everything required to run a system<ul> <li>E.g., OS, Python packages code, code</li> </ul> </li> <li>A <code>prod</code> image is typically created from the <code>dev</code> image by copying the     released code inside the <code>prod</code> image</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#registries","title":"Registries","text":"<ul> <li> <p>We use several Docker image registries</p> <ul> <li>AWS ECR: images are used on the dev and prod servers</li> <li>GHCR (GitHub Container Repo): images are used by the CI systems</li> <li>DockerHub: images are used by developers on the public facing repo</li> </ul> </li> <li> <p>In practice we mirror the Docker images to make sure they are close to where     they need to be used and they minimize downloading costs</p> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#invoke_targets","title":"invoke targets","text":""},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#single-arch_flow","title":"Single-arch flow","text":"<ul> <li><code>docker_build_local_image</code>: build a \"local\" image, i.e., a release candidate     for the \"dev\" image</li> <li><code>docker_tag_local_image_as_dev</code>: promote \"local\" image to \"dev\" without     pushing it to the remote</li> <li><code>docker_push_dev_image</code>: push image to an image registry</li> <li><code>docker_release_dev_image</code>: build, test the \"dev\" image and then release it to     ECR</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#multi-arch_flow","title":"Multi-arch flow","text":"<ul> <li><code>docker_tag_push_multi_build_local_image_as_dev</code>: build a \"local\" multi-arch     image and tag it as \"dev\"</li> <li><code>docker_release_multi_build_dev_image</code>: same as <code>docker_release_dev_image</code> but     for multi-arch image</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#prod_flow","title":"Prod flow","text":"<ul> <li><code>docker_build_prod_image</code>: build a \"prod\" image from a dev image</li> <li><code>docker_push_prod_image</code>: push the \"prod\" image to ECR</li> <li><code>docker_push_prod_candidate_image</code>: push the \"prod\" candidate image to ECR</li> <li><code>docker_build_multi_arch_prod_image</code>: build a multi arch. versioned \"prod\"     image from a \"dev\" image</li> <li><code>docker_tag_push_multi_arch_prod_image</code>: mark the multi-arch versioned \"prod\"     image as \"prod\" and push them to the target registry</li> <li><code>docker_release_prod_image</code>: build, test, and release the \"prod\" image to ECR</li> <li><code>docker_release_multi_arch_prod_image</code>: build, test, and release to Docker     registries the multi-arch prod image</li> <li><code>docker_release_all</code>: release both the \"dev\" and \"prod\" image to ECR</li> <li><code>docker_rollback_dev_image</code>: rollback the version of the \"dev\" image</li> <li><code>docker_rollback_prod_image</code>: rollback the version of the \"prod\" image</li> <li><code>docker_create_candidate_image</code>: create a new \"prod\" candidate image</li> <li><code>docker_update_prod_task_definition</code>: update image in \"prod\" task definition     to the desired version</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#how_to_test_a_package_in_a_docker_container","title":"How to test a package in a Docker container","text":""},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#install_a_package_in_a_container","title":"Install a package in a container","text":"<ul> <li>You can install a Python package with the following command in Docker     <pre><code>docker&gt; sudo /bin/bash -c \"(source /venv/bin/activate; pip install yfinance)\"\ndocker&gt; python -c \"import finance\"\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#hacky_approach_to_patch_up_a_container","title":"Hacky approach to patch up a container","text":"<ul> <li> <p>To patch up a container you can use the following instructions</p> <pre><code># After changing the container, create a new version of the container.\n&gt; docker commit d2916dd5f122 \\\n        623860924167.dkr.ecr.eu-north-1.amazonaws.com/cmamp:dev_ccxtpr\n\n# Push the updated container to the repo.\n&gt; docker push 623860924167.dkr.ecr.eu-north-1.amazonaws.com/cmamp:dev_ccxtpro\n\n# Now you can pull the container on different machines.\n&gt; docker pull 623860924167.dkr.ecr.eu-north-1.amazonaws.com/cmamp:dev_ccxtpro\n\n# To use `docker_bash` you might need to retag it to match what the system expects\n&gt; docker tag 623860924167.dkr.ecr.eu-north-1.amazonaws.com/cmamp:dev_ccxtpro\n</code></pre> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#release_a_docker_image","title":"Release a Docker image","text":"<ul> <li>All the <code>invoke</code> tasks to run the release flow are in     <code>/helpers/lib_tasks.py</code></li> <li>Depending on the type of changes sometimes one needs to rebuild only the     <code>prod</code> image, other times one needs to rebuild also the <code>dev</code> image</li> <li> <p>E.g.,</p> <ul> <li>If you change Docker build-related things (e.g., add a Python package), you     need to rebuild the <code>dev</code> image and then the <code>prod</code> image from the <code>dev</code>     image</li> <li>If you change the code for a production system, you need to create a new     <code>prod</code> image</li> </ul> </li> <li> <p>We try to use the same build/release flow, conventions, and code for all the     containers (e.g., <code>amp</code>, <code>cmamp</code>, <code>helpers</code>, <code>opt</code>)</p> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#overview_of_how_to_release_an_image","title":"Overview of how to release an image","text":"<ul> <li> <p>The release flow consists of the following phases</p> <ul> <li>Make changes to the image<ul> <li>E.g., add Python package through <code>poetry</code>, add an OS package, ...</li> </ul> </li> <li>Update the changelog</li> <li>Build a local image<ul> <li>Run specific tests (e.g., make sure that the new packages are installed)</li> <li>Run unit tests</li> <li>Run QA tests</li> </ul> </li> <li>Tag local image as dev image</li> <li>Push dev image to ECR, DockerHub, GHCR</li> </ul> </li> <li> <p>If there is also an associated prod image</p> <ul> <li>Build prod image from dev image<ul> <li>Run unit tests</li> <li>Run QA tests</li> </ul> </li> <li>Push prod image to ECR, DockerHub, GHCR</li> </ul> </li> <li> <p>The release flow is implemented in the <code>invoke</code> tasks:</p> <ul> <li>E.g., <code>docker_release_dev_image</code>, <code>docker_release_prod_image</code>, etc.</li> <li>These tasks are quite complex and perform many operations</li> <li>Currently, we don't run them directly \u2014 instead, we execute the individual     steps from the <code>invoke</code> tasks</li> <li>Once the release process is more stable, we plan to run them directly</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#how_to_add_a_python_package_to_dev_image","title":"How to add a Python package to dev image","text":"<ul> <li> <p>To add a new Python package to a Docker image you need to update <code>poetry</code>     files and release a new image:</p> <ul> <li>Add a new package to     <code>/devops/docker_build/pyproject.toml</code>     file to the <code>[tool.poetry.dependencies]</code> section</li> <li>E.g., to add <code>pytest-timeout</code> do:     <pre><code>[tool.poetry.dependencies]\n...\npytest-timeout = \"*\"\n...\n</code></pre></li> <li>In general we use the latest version of a package <code>*</code> whenever possible<ul> <li>If the latest package has some problems with our codebase, we freeze the     version of the problematic packages to a known-good version to get the     tests back to green until the problem is solved. We switch back to the     latest version once the problem is fixed</li> <li>If you need to put a constraint on the package version, follow the     official docs,     and explain in a comment why this is needed making reference to GitHub     issues</li> </ul> </li> </ul> </li> <li> <p>To verify that package is installed correctly:</p> <ul> <li>Build a local image<ul> <li>There are two options:<ul> <li>Update <code>poetry</code> and upgrade all packages to the latest versions     <pre><code>&gt; i docker_build_local_image --version {version} --poetry-mode=\"update\"\n</code></pre></li> <li>Install packages from the current <code>poetry.lock</code> file without upgrading     the packages     <pre><code>&gt; i docker_build_local_image --version &lt;VERSION&gt; --poetry-mode=\"no_update\"\n</code></pre></li> </ul> </li> </ul> </li> <li>Run a docker container based on the local image     <pre><code>&gt; i docker_bash --stage local --version &lt;VERSION&gt;\n</code></pre></li> <li>Verify what package was installed with <code>pip show {package name}</code>, e.g.,     <pre><code>&gt; pip show pytest-rerunfailures\nName: pytest-rerunfailures\nVersion: 10.2\nSummary: pytest plugin to re-run tests to eliminate flaky failures\n...\nLocation: /venv/lib/python3.8/site-packages\nRequires: pytest, setuptools\nRequired-by:\n</code></pre></li> <li>Run regressions for the local image, i.e.     <pre><code>&gt; i run_fast_tests --stage local --version &lt;VERSION&gt;\n&gt; i run_slow_tests --stage local --version &lt;VERSION&gt;\n</code></pre></li> </ul> </li> <li> <p>Update the changelog describing the new version</p> </li> <li>Send a PR with the updated <code>poetry</code> files and any other change needed to make     the tests pass</li> <li>Release the new image following the     Release a Docker image     section, use <code>--update-poetry</code> flag to resolve the dependencies</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#how_to_find_unused_packages","title":"How to find unused packages","text":"<ul> <li> <p>While installing Python packages we need to make sure that we do not install     packages that are not used</p> </li> <li> <p>You can use the import-based approach using     <code>pipreqs</code></p> <ul> <li>Under the hood it uses the regex below and <code>os.walk</code> for selected dir:     <code>python REGEXP = [     re.compile(r'^import (.+)$'),     re.compile(r'^from ((?!\\.+).*?) import (?:.*)$') ]</code></li> </ul> </li> <li> <p><code>pipreqs</code> has some limitations</p> <ul> <li>Not all packages that we use are necessarily imported, e.g. <code>awscli</code>,     <code>jupyter</code>, <code>pytest-cov</code>, etc. so <code>pipreqs</code> won't find these packages</li> <li>The import name is not always equal to the package actual name, see the     mapping here</li> </ul> </li> <li> <p>Run a bash session inside a Docker container</p> </li> <li>Install <code>pipreqs</code> with <code>sudo pip install pipreqs</code><ul> <li>We install it temporary within a Docker bash session in order to introduce     another dependency</li> <li>You need to re-install <code>pipreqs</code> every time you create a new Docker bash     session</li> </ul> </li> <li>To run for a root dir do:     <pre><code>docker&gt; pipreqs . --savepath ./tmp.requirements.txt\n</code></pre></li> <li>The command above will generate <code>./tmp.requirements.txt</code> with the list of the     imported packages, e.g.,     <pre><code>amp==1.1.4\nasync_solipsism==0.3\nbeautifulsoup4==4.11.1\nbotocore==1.24.37\ncvxopt==1.3.0\ncvxpy==1.2.0\ndill==0.3.4\nenvirons==9.5.0\n...\n</code></pre></li> <li>You can grep for a package name to see where it is used, e.g.,     <pre><code>&gt; jackpy \"dill\"\nhelpers/hpickle.py:108:       import dill\n...\n</code></pre></li> <li>See the official docs for the advanced     usage</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#how_to_build_a_local_image","title":"How to build a local image","text":"<ul> <li>The <code>local</code> image is built using     <code>/devops/docker_build/dev.Dockerfile</code></li> <li> <p>This Dockerfile runs various scripts to install:</p> <ul> <li>OS</li> <li>Python</li> <li><code>venv</code> + Python packages</li> <li>Jupyter extensions</li> <li>Application-specific packages (e.g., for Linter)</li> </ul> </li> <li> <p>To build a local image run:</p> <pre><code>&gt; i docker_build_local_image --version 1.0.0\n\n# Build from scratch and not incrementally.\n&gt; i docker_build_local_image --version 1.0.0 --no-cache\n\n# Update poetry package list.\n&gt; i docker_build_local_image --version 1.0.0 --poetry-mode=\"update\"\n\n# See more options:\n&gt; i docker_build_local_image -h\n</code></pre> </li> <li> <p>Once an image is built, it is tagged as <code>local-${user}-${version}</code>, e.g.,     <code>local-saggese-1.0.0</code> <pre><code>Successfully tagged 665840871993.dkr.ecr.us-east-1.amazonaws.com/amp:local-gsaggese-1.0.9\n\n&gt; docker image ls 665840871993.dkr.ecr.us-east-1.amazonaws.com/amp:local-gsaggese-1.0.9\nREPOSITORY                                         TAG                    IMAGE ID            CREATED                  SIZE\n665840871993.dkr.ecr.us-east-1.amazonaws.com/amp   local-gsaggese-1.0.9   cf16e3e3d1c7        Less than a second ago   2.75GB\n</code></pre></p> </li> <li> <p>A local image is a candidate for becoming a <code>dev</code> image.     <pre><code>&gt; i run_fast_tests --stage local --version 1.0.0\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#testing_the_local_image","title":"Testing the local image","text":"<ul> <li> <p>Compare the version of the packages in the different images</p> <pre><code>&gt; i docker_bash\ndocker&gt; pip list | tee pip_packages.dev.txt\n\n&gt; i docker_bash --stage local --version 1.0.9\ndocker&gt; pip list | tee pip_packages.local.txt\n</code></pre> </li> <li> <p>Or in one command:     <pre><code>&gt; i docker_cmd --cmd \"pip list | tee pip_packages.dev.txt\"; i docker_cmd --stage=local --version=1.0.9 --cmd \"pip list | tee pip_packages.local.txt\"\n&gt; vimdiff pip_packages.dev.txt pip_packages.local.txt\n</code></pre></p> </li> <li> <p>You can move the local image on different servers for testing by pushing it on     ECR:     <pre><code>&gt; i docker_login\n&gt; i docker push 665840871993.dkr.ecr.us-east-1.amazonaws.com/amp:local-gsaggese-1.1.0\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#pass_the_local_image_to_another_user_for_testing","title":"Pass the local image to another user for testing","text":"<ul> <li>Push the local image built by a user to ECR registry</li> <li> <p>For e.g., if the image is built by user <code>gsaggese</code> <pre><code>&gt; i docker_login\n&gt; i docker push 665840871993.dkr.ecr.us-east-1.amazonaws.com/amp:local-gsaggese-1.1.0\n</code></pre></p> </li> <li> <p>From user session who wants to test: pull the local image from ECR     <pre><code>&gt; i docker pull 665840871993.dkr.ecr.us-east-1.amazonaws.com/amp:local-gsaggese-1.1.0\n</code></pre></p> </li> <li> <p>Tag the local image from user <code>gsaggese</code>, who built the image, as     <code>local-currentuser-1.1.0</code> for user <code>currentuser</code> who wants to test it     <pre><code>&gt; i docker tag 665840871993.dkr.ecr.us-east-1.amazonaws.com/amp:local-gsaggese-1.1.0 665840871993.dkr.ecr.us-east-1.amazonaws.com/amp:local-currentuser-1.1.0\n</code></pre></p> </li> <li> <p>Run any kind of test using the local image. For e.g., to run fast tests     <pre><code>&gt; i run_fast_tests --stage local --version 1.1.0\n</code></pre></p> </li> <li> <p>Check something inside the container     <pre><code>&gt; i docker_bash --stage local --version 1.1.0\ndocker &gt; pip freeze | grep pandas\n</code></pre></p> </li> <li>After testing and making sure the regressions are green, make sure to tag the     image built by the initial user as <code>dev</code> and not the one tagged for the     <code>current-user</code></li> <li>This will make sure image is tagged for both <code>arm</code> and <code>x86</code> architecture on     the remote registries</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#tag_local_image_as_dev","title":"Tag <code>local</code> image as <code>dev</code>","text":"<ul> <li>A docker tag is just a way of referring to an image, in the same way Git tags     refer to a particular commit in your history</li> <li>Basically, tagging is creating a reference from one image (e.g.,     <code>local-saggese-1.0.0</code>) to another (<code>dev</code>)</li> <li>Once the <code>local</code> (e.g., <code>local-saggese-1.0.0</code>) image is tagged as <code>dev</code>, your     <code>dev</code> image becomes equal to <code>local-saggese-1.0.0</code></li> <li><code>dev</code> image is also tagged with <code>dev-${version}</code>, e.g., <code>dev-1.0.0</code> to     preserve history and allow for quick rollback</li> <li>Locally in Git repository a git tag <code>${repo_name}-${version}</code>, e.g.     <code>cmamp-1.0.0</code> is created in order to properly control sync between code and     container</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#push_image","title":"Push image","text":"<ul> <li>Pushing <code>dev</code> or <code>prod</code> image means sending them to our docker registries</li> <li>Once an image is pushed, it can be used by the team members by running     <code>i docker_pull</code></li> <li>Local git tag <code>${repo_name}-${version}</code>, e.g. <code>cmamp-1.0.0</code>, is pushed at this     stage to the remote repository to allow others to properly control sync     between code and container.</li> <li>To be able to push an image to the ECR one should have permissions to do so</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#end-to-end_flow_for_dev_image","title":"End-to-end flow for <code>dev</code> image","text":"<ul> <li> <p>Conceptually the flow consists of the following phases:</p> <ol> <li>Build a local image of docker</li> <li><code>i docker_build_local_image --version 1.0.0</code></li> <li>Run fast tests to verify that nothing is broken</li> <li><code>i run_fast_tests --stage local --version 1.0.0</code></li> <li>Run specific end-to-end tests by</li> <li>Tag <code>local</code> image as <code>dev</code></li> <li><code>i docker_tag_local_image_as_dev --version 1.0.0</code></li> <li>Push <code>dev</code> image to the docker registry</li> <li><code>i docker_push_dev_image --version 1.0.0</code></li> <li>The mentioned flow is executed by <code>Build dev image</code> GH action and that is a     preferred way to do an image release</li> </ol> </li> <li> <p>For specific cases that can not be done via GH action see commands below:</p> <pre><code># To run the official flow end-to-end:\n&gt; i docker_release_dev_image --version 1.0.0\n\n# To see the options:\n&gt; i docker_release_dev_image -h\n\n# Run from scratch and not incrementally:\n&gt; i docker_release_dev_image --version 1.0.0 --no-cache\n\n# Force an update to poetry to pick up new packages\n&gt; i docker_release_dev_image --version 1.0.0 --update-poetry\n\n# Skip running the QA tests\n&gt; i docker_release_dev_image --version 1.0.0 --no-qa-tests\n\n# Skip running the tests\n&gt; i docker_release_dev_image --version 1.0.0 --skip-tests\n\n# Skip end-to-end tests\n&gt; i docker_release_dev_image --version 1.0.0 --no-run-end-to-end-tests\n</code></pre> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#multi-architecture_build","title":"Multi-architecture build","text":"<ul> <li> <p>We allow to build multi-architecture Docker image using     <code>docker_build_local_image</code></p> <p><pre><code>&gt; i docker_build_local_image --version &lt;VERSION&gt; --multi-arch &lt;PLATFORM NAME&gt;\n</code></pre> - To build for specific platforms specify the platform name:     - For <code>x86</code>: <code>linux/amd64</code>     - For <code>arm</code>: <code>linux/arm64</code> - To build for both <code>arm</code> and <code>x86</code> architectures:     <pre><code>&gt; i docker_build_local_image --version &lt;VERSION&gt; --multi-arch linux/amd64,linux/arm64\n</code></pre></p> </li> <li> <p>Multi-arch images are built using <code>docker buildx</code> which does not generate any     local image by default</p> </li> <li>Images are pushed to the remote registry and pulled for testing and usage</li> <li>To tag the local image as dev and push it to the target registry: e.g.,     <code>aws_ecr.ck</code> or <code>dockerhub.causify</code> , use     <pre><code>&gt; i docker_tag_push_multi_build_local_image_as_dev --version &lt;VERSION&gt; --target-registry &lt;TARGET&gt;\n</code></pre></li> <li>Once the image has been successfully pushed to both ECR and DockerHub     registries, the subsequent step involves pushing the <code>dev</code> image to GHCR     registry. However, this action currently requires manual execution due to     restricted access<ul> <li>Access to the <code>causify-ai</code> packages is limited. To gain access, kindly reach     out to GP, Samarth or Vlad</li> <li>To proceed, perform a Docker login using your GitHub username and PAT     (Personal Access Token):     <pre><code>&gt; docker login ghcr.io -u &lt;username&gt;\n</code></pre></li> <li>Tag the <code>dev</code> image to the GHCR namespace:     <pre><code>&gt; docker tag 623860924167.dkr.ecr.eu-north-1.amazonaws.com/cmamp:dev ghcr.io/causify-ai/cmamp:dev\n</code></pre></li> <li>Push the tagged image to the GHCR registry:     <pre><code>&gt; docker push ghcr.io/causify-ai/cmamp:dev\n</code></pre></li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#release_a_multi-architecture_dev_image","title":"Release a multi-architecture dev image","text":""},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#overview","title":"Overview","text":"<ul> <li>Update the <code>changelog.txt</code> file with a description of the new version</li> <li>Build \"local\" image remotely in the CK AWS ECR registry and pull once it is     built</li> <li>Run the <code>cmamp</code> regressions using a local image</li> <li>Run QA tests using a local image</li> <li>Tag the image as dev image and push it to the target Docker registries</li> <li>Tag the new <code>dev</code> image to GHCR namespace and push it to GHCR registry</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#pre-release_check-list","title":"Pre-release check-list","text":"<p>Prerequisites:</p> <ul> <li>The new image is built locally</li> </ul> <p>Check-list:</p> <ul> <li> <p>Make sure that the regressions are passing when being run using the local     image because we run the regressions as part of the official release flow,     i.e. via <code>docker_release_multi_build_dev_image()</code>.</p> <ul> <li><code>cmamp</code><ul> <li>[ ] Update the <code>changelog.txt</code> file</li> <li>[ ] Fast tests</li> <li>[ ] Slow tests</li> <li>[ ] Super-slow test</li> <li>[ ] QA tests</li> </ul> </li> </ul> </li> <li> <p>Running regressions in the <code>orange</code> repository is not a part of the official     image release flow so run them separately.</p> <ul> <li><code>orange</code><ul> <li>[ ] Update the <code>changelog.txt</code> file</li> <li>[ ] Fast tests</li> <li>[ ] Slow tests</li> <li>[ ] Super-slow test</li> </ul> </li> </ul> </li> <li> <p>Example:     <pre><code>&gt; i run_fast_tests --version 1.10.0 --stage local\n</code></pre>     where <code>1.10.0</code> is the new version of the image with stage as local.</p> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#command_to_run_the_release_flow","title":"Command to run the release flow","text":"<ul> <li> <p>To run the release flow</p> <pre><code>&gt; i docker_release_multi_build_dev_image \\\n        --version &lt;VERSION&gt; \\\n        --target-registries &lt;TARGET_REGISTRIES&gt;\n</code></pre> <p>where - TARGET_REGISTRIES: list of target registries to push the image to. E.g.,     - <code>aws_ecr.ck</code>: private CK AWS Docker registry     - <code>dockerhub.causify</code>: public Dockerhub registry - All the other options are the same as for the <code>docker_release_dev_image</code>     end-to-end flow.</p> </li> <li> <p>E.g.,     <pre><code>&gt; i docker_release_multi_build_dev_image \\\n        --version 1.6.1 \\\n        --target-registries aws_ecr.ck,dockerhub.causify\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#post-release_check-list","title":"Post-release check-list","text":"<ul> <li>[ ] Make an integration with the <code>kaizenflow</code> repository in order to copy all             the changes from the <code>cmamp</code> repository</li> <li>[ ] Tag the new <code>dev</code> image to GHCR namespace and push it to GHCR registry</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#build_prod_image","title":"Build prod image","text":"<ul> <li> <p>The main differences between <code>dev</code> image and <code>prod</code> image are:</p> <ul> <li>The source code is accessed through a bind mount for <code>dev</code> image (so that it     can be easily modified) and copied inside the image for a <code>prod</code> image     (since we want to package the code in the container)</li> <li>Requirements to be installed are different:<ul> <li><code>dev</code> image requires packages to develop and run the code</li> <li><code>prod</code> image requires packages only to run the code</li> </ul> </li> </ul> </li> <li> <p>The recipe to build a <code>prod</code> image is in     <code>/devops/docker_build/prod.Dockerfile</code>.</p> </li> <li> <p>To build the <code>prod</code> image run:</p> <pre><code>&gt; i docker_build_prod_image --version 1.0.0\n\n# Check the options.\n&gt; i docker_build_prod_image -h\n\n# To build from scratch.\n&gt; i docker_build_prod_image --version 1.0.0 --no-cache\n</code></pre> </li> <li> <p>To run a command inside the prod image     <pre><code>&gt; docker run --rm -t --user $(id -u):$(id -g) --workdir=/app\n665840871993.dkr.ecr.us-east-1.amazonaws.com/cmamp:prod-1.0.3 \"ls -l /app\"\n</code></pre></p> </li> <li>Example of a complex command:     <pre><code>&gt; docker run --rm -t --workdir=/app 665840871993.dkr.ecr.us-east-1.amazonaws.com/cmamp:prod-1.0.3 \"python /app/datapull/ccxt/data/extract/download_realtime.py --to_datetime '20211204-194432' --from_datetime '20211204-193932' --dst_dir 'test/ccxt_test' --data_type 'ohlcv' --api_keys 'API_keys.json' --universe 'v03'\"\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#qa_for_prod_image","title":"QA for prod image","text":"<ul> <li>In dev_scripts repo test:     <pre><code>&gt; i lint --files \"linters/amp_black.py\"\n</code></pre></li> <li>In amp repo make sure:     <pre><code>&gt; i lint -f \"helpers/dbg.py\"\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#end-to-end_flow_for_prod_image","title":"End-to-end flow for <code>prod</code> image","text":"<ol> <li>Build docker <code>prod</code> image    <pre><code>&gt; i docker_build_prod_image --version 1.0.0\n</code></pre></li> <li>Run all the tests to verify that nothing is broken    <pre><code>&gt; i run_fast_tests --version 1.0.0 --stage prod\n&gt; i run_slow_tests --version 1.0.0 --stage prod\n&gt; i run_superslow_tests --version 1.0.0 --stage prod\n&gt; i run_qa_tests --version 1.0.0 --stage prod\n</code></pre></li> <li> <p>Push <code>prod</code> image to the docker registry    <pre><code>&gt; i docker_push_prod_image --version 1.0.0\n</code></pre></p> </li> <li> <p>To run the flow end-to-end do:</p> <pre><code>&gt; i docker_release_prod_image --version 1.0.0\n</code></pre> </li> <li> <p>The same options are available as for <code>i docker_release_dev_image</code> and you can     check them with <code>i docker_release_prod_image -h</code></p> </li> </ol>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#release_a_multi-architecture_prod_image","title":"Release a multi-architecture prod image","text":""},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#overview_1","title":"Overview","text":"<ul> <li>Build <code>prod</code> versioned image remotely in the CK AWS ECR registry and pull once     it is built</li> <li>Run the <code>cmamp</code> regressions using a versioned <code>prod</code> image</li> <li>Tag the versioned <code>prod</code> image as <code>prod</code> image and push it to the Docker     registries</li> <li>Tag the new <code>prod</code> image to GHCR namespace and push it to GHCR registry</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#flow_for_both_dev_and_prod_images","title":"Flow for both dev and prod images","text":"<ul> <li>To run both flows end-to-end do:<ul> <li><code>i docker_release_all</code></li> </ul> </li> <li>Alternatively, one can run the release stages step-by-step</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#release_flow","title":"Release flow","text":""},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#cmamp","title":"cmamp","text":"<ul> <li>File a GitHub Issue for the release<ul> <li>E.g., \"Add package foobar to cmamp image\"</li> </ul> </li> <li>Create the corresponding branch     <pre><code>&gt; i git_create_branch -i ${issue_number}\n</code></pre></li> <li>Change the code as needed</li> <li>Update the changelog, e.g., <code>//cmamp/changelog.txt</code><ul> <li>Specify what was changed</li> <li>Pick the release version according to     semantic versioning convention<ul> <li>For example for version <code>1.2.3</code>:<ul> <li>1 is major, 2 is minor, 3 is patch</li> </ul> </li> <li>We keep major and minor versions for <code>dev</code> and <code>prod</code> image in sync, while     <code>prod</code> gets patches<ul> <li>E.g., go from <code>prod-1.1.0</code> to <code>prod-1.1.1</code> for a small bug fix</li> </ul> </li> <li>In this manner, it cannot happen we have <code>dev-1.1.0</code> and <code>prod-1.2.0</code> at     any point in time, but <code>dev-1.1.0</code> and <code>prod-1.1.2</code> are perfectly fine</li> </ul> </li> </ul> </li> <li> <p>Test the change using the local release flow</p> <pre><code>&gt; i docker_build_local_image -v ${version}\n...\n\n&gt; i run_fast_slow_tests -s local -v ${version}\n</code></pre> </li> <li> <p>Make sure that the goal of the Issue is achieved</p> <ul> <li>E.g., a new package is visible, the package version has been updated</li> </ul> </li> <li>Do a PR with the change including the updated <code>changelog.txt</code>, the poetry     files (e.g.,     <code>/devops/docker_build/poetry.toml</code>,     <code>/devops/docker_build/poetry.lock</code></li> <li> <p>Run the release flow manually (or rely on GH Action build workflow to create     the new image)</p> <pre><code># Release dev image\n&gt; i docker_release_dev_image --version $version\n\n# Pick up the new image from image repo\n&gt; i docker_pull\n</code></pre> </li> <li> <p>Tag and push the latest <code>dev</code> to GHCR registry manually</p> <ul> <li>Perform a Docker login using your GitHub username and PAT (Personal Access     Token):     <pre><code>&gt; docker login ghcr.io -u &lt;username&gt;\n</code></pre></li> <li>Tag the <code>dev</code> image to the GHCR namespace:     <pre><code>&gt; docker tag 623860924167.dkr.ecr.eu-north-1.amazonaws.com/cmamp:dev ghcr.io/causify-ai/cmamp:dev\n</code></pre></li> <li>Push the tagged image to the GHCR registry:     <pre><code>&gt; docker push ghcr.io/causify-ai/cmamp:dev\n</code></pre></li> </ul> </li> <li> <p>Send a message on the <code>all@</code> chat telling people that a new version of the     <code>XYZ</code> container has been released</p> </li> <li>Users need to do a <code>i docker_pull</code> to get the new container</li> <li>Users that don't update should see a message telling them that the code and     container are not in sync any more, e.g.,:     <pre><code>-----------------------------------------------------------------------------\nThis code is not in sync with the container:\ncode_version='1.0.3' != container_version='amp-1.0.3'\n-----------------------------------------------------------------------------\nYou need to:\n- merge origin/master into your branch with `invoke git_merge_master`\n- pull the latest container with `invoke docker_pull`\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.devops_docker.how_to_guide.html#qa_flow","title":"QA flow","text":"<ul> <li>The goal is to test that the container as a whole works</li> <li> <p>We want to run the container as a user would do</p> </li> <li> <p>Usually we run tests inside a container to verify that the code is correct</p> </li> <li>To test the container itself right now we test outside (in the thin client)     <pre><code>&gt; pytest -m qa test --image_stage dev\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.devops_docker.reference.html","title":"All.devops docker.reference","text":""},{"location":"tools/dev_system/all.devops_docker.reference.html#code_organization","title":"Code Organization","text":"<ul> <li>A repo or directory is \"runnable\" if it can build a Docker container and run     its code inside the container<ul> <li>E.g., <code>//helpers</code>, <code>//amp</code>, <code>//orange</code>, <code>optimizer</code></li> </ul> </li> <li> <p>Each directory that is runnable contains the files:</p> <ul> <li><code>changelog.txt</code>: store the changelog</li> <li><code>devops</code>: dir with all the Docker files needed to build and run a container</li> </ul> </li> <li> <p>There are several types of <code>devops</code> dirs</p> <ul> <li>A <code>devops</code> where a container is built, run, and released<ul> <li>E.g., <code>//amp</code>, <code>//helpers</code>, <code>//optimizer</code>, <code>//sports_analytics</code>,     <code>//tutorials</code>, <code>//demo</code></li> </ul> </li> <li>A <code>devops</code> where a container from a different dir is run<ul> <li>E.g., <code>//orange</code> reuses <code>cmamp</code> container</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.reference.html#devops_to_build_run_release_a_container","title":"Devops to Build, Run, Release a Container","text":"<ul> <li> <p>An example of the <code>devops</code> structure is:     <pre><code>&gt; cd //amp\n&gt; tree.sh -p devops\ndevops/\n|-- compose/\n|   `-- __init__.py\n|-- debug/\n|   `-- repo_compare.sh*\n|-- docker_build/\n|   |-- create_users.sh*\n|   |-- dev.Dockerfile\n|   |-- etc_sudoers\n|   |-- fstab\n|   |-- install_cprofile.sh\n|   |-- install_dind.sh*\n|   |-- install_jupyter_extensions.sh*\n|   |-- install_os_packages.sh*\n|   |-- install_python_packages.sh*\n|   |-- poetry.lock\n|   |-- poetry.toml\n|   |-- prod.Dockerfile\n|   `-- pyproject.toml\n|-- docker_run/\n|   |-- aws_credentials.sh\n|   |-- bashrc\n|   |-- entrypoint.sh*\n|   |-- run_jupyter_server.sh*\n|   |-- setenv.sh\n|   `-- test_setup.sh*\n|-- env/\n|   `-- default.env\n|-- notebooks/\n...\n|-- test/\n...\n`-- __init__.py\n</code></pre></p> </li> <li> <p>The organization of a <code>devops</code> dir is:</p> <ul> <li><code>compose</code>: Docker compose files</li> <li><code>docker_build</code>: everything related to building a Docker image</li> <li><code>docker_run</code>: everything related to running a Docker image</li> <li><code>env</code>: Docker env files</li> </ul> </li> <li> <p>Optional dirs are:</p> <ul> <li><code>debug</code>: scripts to debug and maintain the dir</li> <li><code>notebooks</code>: notebooks used to analyze, monitor Docker container<ul> <li>E.g., <code>Master_buildmeister_dashboard.ipynb</code></li> </ul> </li> <li><code>test</code>: everything needed to test a Docker image</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.reference.html#detailed_description_of_files","title":"Detailed Description of Files","text":"<ul> <li> <p>In <code>devops/compose/</code></p> <ul> <li><code>devops/compose/docker-compose.yml</code>: file generated by the <code>invoke</code> system     based on templates, to run a Docker compose</li> </ul> </li> <li> <p>In <code>devops/docker_build/</code></p> <ul> <li><code>create_users.sh</code>: create the needed users inside the container</li> <li><code>dev.Dockerfile</code>: Dockerfile to build the dev version of the container</li> <li><code>etc_sudoers</code>: give sudo permission to all users inside the container</li> <li><code>fstab</code>: mount S3 and other dir in the container<ul> <li>TODO(gp): Not sure if it's needed anymore</li> </ul> </li> <li><code>install_cprofile.sh</code>: install the packages needed to profile Python code     inside the repo</li> <li><code>install_dind.sh</code>: install docker-in-docker<ul> <li>This workflow has been superseded by Docker sibling approach</li> </ul> </li> <li><code>install_jupyter_extensions.sh</code>: install Jupyter</li> <li><code>install_os_packages.sh</code>: install the OS packages using the declarative     approach</li> <li><code>os_packages/</code>: directory containing individual OS package install scripts     and configuration</li> <li><code>install_python_packages.sh</code>: install the Python packages with <code>poetry</code> and     <code>pip</code></li> <li><code>poetry.lock</code>: file generated by <code>poetry</code> after the list of packages has     been generated<ul> <li>This tracks what packages were installed by <code>poetry</code></li> </ul> </li> <li><code>poetry.toml</code>: configuration file for <code>poetry</code></li> <li><code>prod.Dockerfile</code>: Dockerfile to build the prod version of the container</li> <li><code>pyproject.toml</code>: list of package specification for <code>poetry</code></li> </ul> </li> <li> <p>In <code>devops/docker_run/</code></p> <ul> <li><code>aws_credentials.sh</code>: loads the AWS credentials in the corresponding env     vars<ul> <li>TODO(gp): This seems useless</li> </ul> </li> <li><code>bashrc</code>: basic configuration for bash shells inside a container</li> <li><code>entrypoint.sh</code>: configures the container on startup<ul> <li>E.g., run <code>setenv.sh</code>, start dind, setup Git to run inside the container</li> </ul> </li> <li><code>run_jupyter_server.sh</code>: start Jupyter notebook</li> <li><code>setenv.sh</code>: configure the virtual environment inside the container<ul> <li>E.g., update <code>$PATH</code> and <code>$PYTHONPATH</code></li> <li>This is equivalent to <code>setenv.sh</code> for the thin environment</li> </ul> </li> <li><code>test_setup.sh</code>: check that the major systems are configured properly<ul> <li>E.g., <code>AWS</code>, <code>gspread</code>, ...</li> <li>TODO(gp): Probably obsolete</li> </ul> </li> </ul> </li> <li> <p>In <code>env/</code></p> <ul> <li><code>default.env</code>: set some variables and their defaults<ul> <li>TODO(gp): This seems useless</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.reference.html#declarative_os_package_installation","title":"Declarative OS Package Installation","text":"<ul> <li>The OS package installation system uses a declarative approach where packages     are defined in configuration files rather than hardcoded in scripts</li> <li>This approach provides better modularity, maintainability, and allows easy     customization of which packages to install</li> </ul>"},{"location":"tools/dev_system/all.devops_docker.reference.html#structure","title":"Structure","text":"<ul> <li> <p><code>/devops/docker_build/install_os_packages.sh</code>:     main script that orchestrates the installation process</p> <ul> <li>Reads the list of packages to install from <code>os_packages/os_packages.txt</code></li> <li>Executes individual install scripts located in the <code>os_packages/</code> directory</li> <li>Each install script is responsible for installing a specific set of OS     packages (e.g., AWS CLI, GitHub CLI, GraphViz)</li> </ul> </li> <li> <p><code>devops/docker_build/os_packages/</code>: directory containing individual OS package     install scripts and configuration</p> <ul> <li>Install scripts follow the naming convention <code>install_os_&lt;package_name&gt;.sh</code></li> <li><code>os_packages.txt</code>: declarative list of install scripts to execute, one     script per line<ul> <li>Lines starting with <code>#</code> are treated as comments</li> <li>Empty lines are ignored</li> </ul> </li> <li>Available install scripts:<ul> <li><code>install_os_aws_cli.sh</code>: install AWS CLI V2 for multiple architectures</li> <li><code>install_os_github_cli.sh</code>: install GitHub CLI and configure repository</li> <li><code>install_os_graphviz.sh</code>: install GraphViz and related packages for     diagram generation</li> <li><code>install_os_publishing_tools.sh</code>: install publishing tools like PlantUML</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.reference.html#how_to_disable_or_enable_os_packages","title":"How to Disable or Enable OS Packages","text":"<ul> <li> <p>Edit     <code>/devops/docker_build/os_packages/os_packages.txt</code>     to control which packages are installed:</p> <ul> <li>Disable a package: add <code>#</code> at the beginning of the line</li> <li>Enable a package: remove the <code>#</code> from the beginning of the line <pre><code>install_os_publishing_tools.sh\n# install_os_aws_cli.sh          &lt;- disabled\ninstall_os_github_cli.sh\ninstall_os_graphviz.sh\n</code></pre></li> </ul> </li> <li> <p>Important: While it is technically possible to build the Docker image     without any OS packages listed in <code>os_packages.txt</code> (by commenting out all     entries), be aware that certain <code>helpers</code> modules depend on specific OS     packages to function correctly. Disabling required packages may cause runtime     errors when those modules attempt to execute system-level operations. For     example:</p> <ul> <li><code>hs3.py</code> functions like <code>copy_file_to_s3()</code> and     <code>copy_data_from_s3_to_local_dir()</code> use AWS CLI commands (<code>aws s3 cp</code>,     <code>aws s3 sync</code>) which require the <code>awscli</code> package (installed via     <code>install_os_aws_cli.sh</code>)</li> <li><code>lib_tasks_gh.py</code> functions like <code>gh_create_pr()</code>, <code>gh_workflow_list()</code>, and     <code>gh_issue_title()</code> use GitHub CLI commands (<code>gh pr create</code>,     <code>gh workflow list</code>, <code>gh issue view</code>) which require the <code>gh</code> package     (installed via <code>install_os_github_cli.sh</code>)</li> </ul> <p>Always verify that the functionality you need will work with your selected package configuration.</p> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.reference.html#how_to_add_a_new_os_package_install_script","title":"How to Add a New OS Package Install Script","text":"<ul> <li> <p>Create a new install script following the naming convention:</p> <ul> <li>File name: <code>devops/docker_build/os_packages/install_os_&lt;package_name&gt;.sh</code></li> <li>Make the script executable: <code>chmod +x install_os_&lt;package_name&gt;.sh</code></li> <li>The script should handle package installation and any necessary     configuration</li> </ul> </li> <li> <p>Add the script to the package list:</p> <ul> <li>Edit     <code>/devops/docker_build/os_packages/os_packages.txt</code></li> <li>Add a new line with the script name:     <pre><code>install_os_publishing_tools.sh\ninstall_os_aws_cli.sh\ninstall_os_github_cli.sh\ninstall_os_graphviz.sh\ninstall_os_&lt;package_name&gt;.sh\n</code></pre></li> </ul> </li> <li> <p>Example script structure:</p> <pre><code>#!/usr/bin/env bash\n#\n# Install &lt;package_name&gt;.\n#\napt-get install $APT_GET_OPTS &lt;package_dependencies&gt;\n# Add installation commands here\necho \"&lt;PACKAGE_NAME&gt; VERSION=\"$(&lt;package_name&gt; --version)\n</code></pre> </li> <li> <p>The <code>APT_GET_OPTS</code> environment variable is available and contains standard     apt-get options (<code>-y --no-install-recommends</code>)</p> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.reference.html#devops_to_run_an_already_existing_container","title":"Devops to Run an Already Existing Container","text":"<ul> <li>To reuse a Docker container from a different dir / repo, <code>devops</code> doesn't need     the <code>docker_build</code> dir     <pre><code>&gt; tree.sh -p devops\ndevops/\n|-- debug/\n|   `-- repo_compare.sh*\n|-- docker_build/\n|   `-- prod.Dockerfile -&gt; ../../amp/devops/docker_build/prod.Dockerfile\n|-- docker_run/\n|   |-- aws_credentials.sh\n...\n`-- env/\n        `-- default.env\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.devops_docker.reference.html#docker_invoke_flow","title":"Docker Invoke Flow","text":""},{"location":"tools/dev_system/all.devops_docker.reference.html#docker_bash","title":"<code>docker_bash</code>","text":"<ul> <li> <p>When <code>invoke docker_bash</code> is called, it generates a Docker compose command     line like:     <pre><code>&gt; IMAGE=623860924167.dkr.ecr.eu-north-1.amazonaws.com/sports_analytics:dev \\\n        docker compose \\\n            --file /Users/saggese/src/sports_analytics1/devops/compose/docker-compose.yml \\\n            --env-file devops/env/default.env \\\n            run \\\n            --rm \\\n            --name saggese.sports_analytics.app.sports_analytics1.20240817_113504 \\\n            --user $(id -u):$(id -g) \\\n            app \\\n            bash\n</code></pre></p> </li> <li> <p>The Docker compose file is generated programmatically based on the command     line options     <pre><code>version: '3'\n\nservices:\n    base_app:\n        cap_add:\n            - SYS_ADMIN\n        environment:\n            - AM_AWS_ACCESS_KEY_ID=$AM_AWS_ACCESS_KEY_ID\n            ...\n            - AM_ENABLE_DIND=0\n            - AM_FORCE_TEST_FAIL=$AM_FORCE_TEST_FAIL\n            - AM_HOST_NAME=gpmac.local\n            - AM_HOST_OS_NAME=Darwin\n            - AM_HOST_USER_NAME=saggese\n            - AM_HOST_VERSION=22.3.0\n            - AM_REPO_CONFIG_CHECK=True\n            # Use inferred path for `repo_config.py`.\n            - AM_REPO_CONFIG_PATH=\n            - AM_TELEGRAM_TOKEN=$AM_TELEGRAM_TOKEN\n            ...\n            - CK_TELEGRAM_TOKEN=$CK_TELEGRAM_TOKEN\n            # TODO(Vlad): consider removing, locally we use our personal tokens from files and\n            # inside GitHub actions we use the `GH_TOKEN` environment variable.\n            - GH_ACTION_ACCESS_TOKEN=$GH_ACTION_ACCESS_TOKEN\n            # Inside GitHub Actions we use `GH_TOKEN` environment variable,\n            # see https://cli.github.com/manual/gh_auth_login.\n            - GH_TOKEN=$GH_ACTION_ACCESS_TOKEN\n            # This env var is used by GH Action to signal that we are inside the CI.\n            - CI=$CI\n        image: ${IMAGE}\n\n        restart: \"no\"\n        volumes:\n            # TODO(gp): We should pass the value of $HOME from dev.Dockerfile to here.\n            # E.g., we might define $HOME in the env file.\n            - ~/.aws:/home/.aws\n            - ~/.config/gspread_pandas/:/home/.config/gspread_pandas/\n            - ~/.config/gh:/home/.config/gh\n\n            # Use sibling-container approach.\n            - /var/run/docker.sock:/var/run/docker.sock\n\n    # Mount `amp` when it is used as supermodule.\n    app:\n        extends:\n            base_app\n        volumes:\n            - ../../:/app\n\n    linter:\n        extends:\n            base_app\n        volumes:\n            - /Users/saggese/src/sports_analytics1:/src\n            - ../../:/app\n        working_dir: /src\n        environment:\n            - MYPYPATH\n\n    jupyter_server:\n        command: devops/docker_run/run_jupyter_server.sh\n        environment:\n            - PORT=${PORT}\n        extends:\n            app\n        network_mode: ${NETWORK_MODE:-bridge}\n        ports:\n            # TODO(gp): Rename `AM_PORT`.\n            - \"${PORT}:${PORT}\"\n\n    jupyter_server_test:\n        command: jupyter notebook -h 2&gt;&amp;1 &gt;/dev/null\n        environment:\n            - PORT=${PORT}\n        extends:\n            app\n        network_mode: ${NETWORK_MODE:-bridge}\n        ports:\n            - \"${PORT}:${PORT}\"\n\nnetworks:\n    default:\n        name: main_network\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker.reference.html#docker_jupyter","title":"<code>docker_jupyter</code>","text":"<ul> <li>This invokes a different service</li> <li>To disable vim go to Settings -&gt; Enable Vim Mode</li> <li>We use the percent format for Jupytext</li> </ul>"},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html","title":"All.devops docker auto release.explanation","text":""},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html#automated_docker_release_system_architecture","title":"Automated Docker Release System Architecture","text":""},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html#summary","title":"Summary","text":"<ul> <li>This document explains the architecture and design decisions for the automated     Docker dev image release system</li> <li>The system automatically builds, tests, and releases Docker images on a     periodic schedule</li> <li>It consists of three phases:<ul> <li>Phase 1: Automated build and test</li> <li>Phase 2: Manual review - Team member reviews and merges the PR</li> <li>Phase 3: Automated release to registries</li> </ul> </li> <li>The system uses GitHub Actions, invoke tasks, and GitHub CLI helpers to     orchestrate the entire workflow</li> </ul>"},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html#architecture_overview","title":"Architecture Overview","text":""},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html#core_components","title":"Core Components","text":"<ul> <li> <p>Invoke Task (<code>docker_build_test_dev_image</code>): Core automation logic</p> <ul> <li>Bumps version (minor by default)</li> <li>Creates GitHub issue and branch</li> <li>Builds local Docker image</li> <li>Runs test suites (currently commented out)</li> <li>Updates changelog</li> <li>Commits and pushes changes</li> <li>Creates PR (ready for review, with reviewer)</li> <li>Tags and pushes <code>dev-{version}</code> to GHCR</li> </ul> </li> <li> <p>GitHub Actions Workflow     (<code>.github/workflows/dev_image_build_and_test.yml</code>): Orchestrates the entire     automated build and test process</p> <ul> <li>Triggered weekly by cron schedule or manually</li> <li>Calls <code>invoke docker_build_test_dev_image --reviewers &lt;team members&gt;</code></li> </ul> </li> <li> <p>GitHub CLI Helpers: New team management functions</p> <ul> <li><code>gh_get_org_team_names()</code>: Fetch organization teams</li> <li><code>gh_get_team_member_names()</code>: Fetch team members</li> <li>Enhanced <code>gh_create_pr()</code>: Support for reviewer parameter</li> </ul> </li> <li> <p>Version Management (<code>bump_version()</code> in     <code>/helpers/hversion.py)</code>): New semantic versioning     function</p> <ul> <li>Bumps version numbers (major/minor/patch)</li> <li>Default: minor bump (e.g., 2.2.0 \u2192 2.3.0)</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html#system_diagram","title":"System Diagram","text":"<pre><code>graph TB\n        subgraph \"Trigger\"\n                A[Cron Schedule]\n                B[Manual Dispatch]\n        end\n\n        subgraph \"GitHub Actions\"\n                D[Workflow Runner]\n                D --&gt; E[Setup Environment]\n                E --&gt; F[Checkout Code]\n                F --&gt; G[Docker Login]\n                G --&gt; H[Run Invoke Task]\n        end\n\n        subgraph \"Phase 1: Build, Test &amp; PR Creation\"\n                H --&gt; I[Bump Version]\n                I --&gt; J[Create Issue]\n                J --&gt; K[Create Branch]\n                K --&gt; L[Build Image]\n                L --&gt; M[Run Tests]\n                M --&gt; N[Update Changelog]\n                N --&gt; O[Commit Changes]\n                O --&gt; P[Push Branch]\n                P --&gt; Q[Create PR &amp; Request Review]\n                Q --&gt; R[Push to GHCR]\n        end\n\n        subgraph \"Phase 2: Manual Review\"\n                R --&gt; S[Team Review]\n                S --&gt; T[Merge PR]\n        end\n\n        subgraph \"Phase 3: Automated Release\"\n                T --&gt; U[Detect Merge + Label]\n                U --&gt; V[Pull Image from GHCR]\n                V --&gt; W[Re-tag for ECR &amp; GHCR]\n                W --&gt; X[Push to Registries]\n        end\n\n        A --&gt; D\n        B --&gt; D</code></pre>"},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html#phase_1_automated_build_and_test_implemented","title":"Phase 1: Automated Build and Test (Implemented)","text":"<p>Triggered weekly by schedule, the workflow bumps the version, creates a GitHub issue and branch, builds a Docker image, runs tests (currently commented out), updates the changelog, commits and pushes changes, creates a PR with reviewer assigned, and pushes the versioned image (<code>dev-{version}</code>) to GHCR for verification before production release.</p>"},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html#components","title":"Components","text":"<ol> <li>GitHub Actions Workflow    (<code>.github/workflows/dev_image_build_and_test.yml</code>) - Weekly scheduled    workflow (Monday at 6 AM UTC) with manual trigger and assignee support</li> <li>Invoke Target (<code>docker_build_test_dev_image()</code> in    <code>/helpers/lib_tasks_docker_release.py)</code>) -    Orchestrates the complete build, test, and release pipeline</li> <li>GitHub CLI Helpers (<code>helpers/lib_tasks_gh.py</code>) - New team management    functions (<code>gh_get_org_team_names()</code>, <code>gh_get_team_member_names()</code>) and    enhanced <code>gh_create_pr()</code> with reviewer support</li> <li>Version Management (<code>bump_version()</code> in    <code>/helpers/hversion.py)</code>) - Semantic version bumping    (minor by default: 2.2.0 \u2192 2.3.0)</li> </ol>"},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html#phase_2_manual_review","title":"Phase 2: Manual Review","text":"<p>This is the critical human gate between automated build and automated release. After Phase 1 completes, the assigned team members review the PR, validate the changes (changelog, version, poetry.lock), optionally test the image from GHCR, and merge to master. The PR is automatically created as \"Ready for review\" with reviewers assigned. Quality gates: all status checks pass, properly formatted changelog, no merge conflicts, valid sequential version number.</p>"},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html#phase_3_automated_release","title":"Phase 3: Automated Release","text":"<p>When the PR from Phase 1 is merged, an automated workflow (<code>.github/workflows/dev_image_release.yml</code>) detects the merge event with the \"Automated release\" label, pulls the verified image from GHCR, re-tags it for production registries (AWS ECR, etc.), and pushes to all target registries.</p>"},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html#team-based_assignment","title":"Team-Based Assignment","text":"<p>Configuration:</p> <ul> <li>Add to <code>repo_config.yaml</code>:     <pre><code>release_team: \"dev_system\" # GitHub team slug\n</code></pre></li> </ul> <p>Implementation plan:</p> <ul> <li>Fetch team members using <code>gh_get_team_member_names()</code></li> <li>Request PR review from team (not individual)</li> <li>Format: <code>--reviewer team:org/team-slug</code></li> </ul> <p>Benefits:</p> <ul> <li>Distributes responsibility across team</li> <li>Any team member can review and merge</li> <li>Reduces single point of failure</li> </ul>"},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html#pr_labeling","title":"PR Labeling","text":"<p>Label name: <code>Automated release</code></p> <p>Purpose:</p> <ul> <li>Identifies PRs created by automated workflow</li> <li>Used as trigger for release workflow</li> <li>Enables filtering and automation</li> </ul> <p>Implementation:</p> <pre><code># In Gh_Create_Pr():\nif is_automated_release:\n        cmd += ' --label \"Automated release\"'\n</code></pre>"},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html#invoke_target_docker_tag_push_dev_image","title":"Invoke Target <code>docker_tag_push_dev_image()</code>","text":"<p>Gets the version from changelog (or uses provided version), pulls the versioned dev image from a base registry (GHCR by default, or custom via <code>--base-image</code>), re-tags it for target registries (GHCR and AWS ECR), pushes to all configured registries, and verifies the images. Supports dry-run mode for testing.</p>"},{"location":"tools/dev_system/all.devops_docker_auto_release.explanation.html#release_workflow_githubworkflowsdev_image_releaseyml","title":"Release Workflow (<code>.github/workflows/dev_image_release.yml</code>)","text":"<p>Trigger:</p> <ul> <li>Event: <code>pull_request</code></li> <li>Types: <code>[closed]</code></li> <li>Condition: <code>if: github.event.pull_request.merged == true</code></li> <li>Label filter: Check for <code>Automated release</code> label</li> <li>Also supports manual <code>workflow_dispatch</code></li> </ul> <p>Steps:</p> <ul> <li>Execute <code>invoke docker_tag_push_dev_image --dry-run</code></li> </ul>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html","title":"All.docker optimizer container.how to guide","text":""},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#optimizer_container","title":"Optimizer container","text":""},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#rationale","title":"Rationale","text":"<ul> <li>The high-level goal is to move towards containerized Python scripts running in     smaller containers instead of keep adding packages to <code>amp</code> / <code>cmamp</code>, which     makes the <code>amp</code> / <code>cmamp</code> container bloated and risky to build</li> <li>Along this design philosophy similar to microservices, we want to have a     Docker container, called <code>opt</code> with a Python script that uses some packages     that are not compatible with <code>amp</code> (specifically cvxopt, cvxpy)</li> <li>This is similar to what we do for the <code>helpers</code>, which is like a     containerized Python script for the Linter</li> </ul>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#build_and_run_a_local_version_of_opt","title":"Build and run a local version of <code>opt</code>","text":"<ul> <li>You can build the container locally with:     <pre><code>&gt; cd optimizer\n&gt; i opt_docker_build_local_image --version 0.1.0\n</code></pre></li> <li>This process takes around 5 mins and then you should have the container     <pre><code>docker image ls 665840871993.dkr.ecr.us-east-1.amazonaws.com/opt:local-saggese-0.1.0\nREPOSITORY                                         TAG                   IMAGE ID       CREATED         SIZE\n665840871993.dkr.ecr.us-east-1.amazonaws.com/opt   local-saggese-0.1.0   bb7d60d6a7d0   7 seconds ago   1.23GB\n</code></pre></li> <li>Run the container as:     <pre><code>&gt; i opt_docker_bash --stage local --version 0.1.0\n</code></pre></li> <li>To run a Jupyter notebook in the <code>opt</code> container:</li> </ul>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#internals","title":"Internals","text":""},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#one_container_per_git_repo","title":"One container per Git repo","text":"<ul> <li> <p>A simple approach is to have each deployable unit (i.e., container)     corresponding to a Git repo</p> <ul> <li>The consequence would be:<ul> <li>A multiplication of repos</li> <li>No implicit sharing of code across different containers</li> <li>Some mechanism to share code (e.g., <code>helpers</code>) across repos (e.g., using     bind mount)</li> <li>Not playing nice with Git subrepo mechanism since Docker needs to see the     entire repo</li> </ul> </li> </ul> </li> <li> <p>So the code would be organized in 4 repos:     <pre><code>- lemonade / lime\n        - helpers\n        - optimizer\n        - oms\n        - models in amp\n</code></pre></p> <ul> <li>Where the dependency between containers are<ul> <li>Lemonade -&gt; amp</li> <li>Amp -&gt; optimizer, helpers</li> <li>Optimizer -&gt; helpers, core</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#multiple_containers_per_git_repo","title":"Multiple containers per Git repo","text":"<ul> <li>Another approach is to have <code>optimizer</code> as a directory inside <code>amp</code><ul> <li>This keeps <code>amp</code> and <code>optimizer</code> in a single repo</li> <li>To build / run optimizer code in its container one needs to <code>cd</code> in the dir</li> <li>The problem then becomes how to share <code>helpers</code></li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#mounting_only_optimizer_dir_inside_docker","title":"Mounting only <code>optimizer</code> dir inside Docker","text":"<ul> <li>From <code>devops/compose/docker-compose.yml</code> <pre><code>42 volumes:\n43  # Move one dir up to include the entire git repo (see AmpTask1017).\n44  - ../../:/app\n45 # Move one dir down to include the entire git repo (see AmpTask1017).\n46 working_dir: /app\n</code></pre></li> <li>From <code>devops/docker_build/dev.Dockerfile</code></li> <li>ENTRYPOINT [\"devops/docker_run/entrypoint.sh\"]</li> <li>The problem is that Git repo doesn't work anymore     <pre><code>git --version: git version 2.30.2\nfatal: not a git repository (or any parent up to mount point /)\nStopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).\n</code></pre></li> <li> <p>A work around is to inject .git in /git of the container and then point git to     that     <pre><code>environment:\n...\n- GIT_DIR=/git\n\nvolumes:\n    # Move one dir up to include the entire git repo (see AmpTask1017).\n    - ../../:/app\n    - ../../../../.git:/git\n    - ../../../../amp/helpers:/app/helpers\n</code></pre></p> </li> <li> <p>Git works but it gets confused with the paths     <pre><code>        modified: .dockerignore\n        deleted: .github/gh_requirements.txt\n        deleted: .github/workflows/build_image.yml.DISABLED\n        deleted: .github/workflows/fast_tests.yml\n        deleted: .github/workflows/linter.yml.DISABLED\n        deleted: .github/workflows/slow_tests.yml\n        deleted: .github/workflows/superslow_tests.yml.DISABLED\n        deleted: .gitignore\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#mounting_the_supermodule_eg_lime_lemonade_amp_inside_docker","title":"Mounting the supermodule (e.g., lime, lemonade, amp) inside Docker","text":"<ul> <li>From <code>devops/compose/docker-compose.yml</code> <pre><code>42 volumes:\n43  # Move one dir up to include the entire git repo (see AmpTask1017).\n44  - ../../../:/app\n45 # Move one dir down to include the entire git repo (see AmpTask1017).\n46 working_dir: /app/amp\n</code></pre></li> <li>From <code>devops/docker_build/dev.Dockerfile</code></li> <li>ENTRYPOINT [\"optimizer/devops/docker_run/entrypoint.sh\"]</li> <li>This approach mounts 4 dirs up from devops/compose/docker-compose.yml, i.e.,     //lime</li> <li>The problem with this approach is that now repo_config.py is incorrect</li> <li><code>i opt_docker_build_local_image --version 0.4.0</code> <pre><code>32 - ../../../helpers:/app/amp/optimizer/helpers\n33\n34 # Shared cache. This is specific of lime.\n35 - /local/home/share/cache:/cache\n36\n37 # Mount `amp` when it is used as submodule. In this case we need to\n38 # mount the super project in the container (to make git work with the\n39 # supermodule) and then change dir to `amp`.\n40 app:\n41  extends:\n42    base_app\n43 volumes:\n44  # Move one dir up to include the entire git repo (see AmpTask1017).\n45  - ../../../../:/app\n46 # Move one dir down to include the entire git repo (see AmpTask1017).\n47 working_dir: /app/amp/optimizer\n48 #entrypoint: /bin/bash -c \"ls helpers\"\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#invariants","title":"Invariants","text":"<ul> <li>A deployable dir is a dir under a Git repo<ul> <li>It corresponds to a software component (code + library = Docker container)</li> <li>Anything that has a devops dir is \"deployable\"</li> </ul> </li> <li>Each Docker container is run from its corresponding dir, e.g.,<ul> <li>Amp container from the amp dir</li> <li>Amp container from the lemonade dir (this is just a shortcut since lemonade     has the same deps right now as amp)</li> </ul> </li> <li>Always mount the outermost Git repo under <code>/app</code></li> <li>Set the Docker working dir as the current dir</li> <li>Each deployable dir specifies all the needed information in <code>repo_config.py</code>     (which is the one in the current dir)<ul> <li>What container to run</li> <li>What functionality is supported on different servers (e.g., privileged way)</li> </ul> </li> <li>The <code>changelog.txt</code> file is in the deployable dir (e.g.,     optimizer/changelog.txt)</li> <li>Each</li> </ul> <p>One run the invoke commands from optimizer dir</p> <p>When the Docker container starts the current dir is optimizer</p> <p>helpers, core is mounted in the same dir</p> <p>You can't see code outside optimizer</p> <p>TODO(gp): running in amp under lemonade should use the local repo_config</p>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#release_and_ecr_flow","title":"Release and ECR flow","text":"<p>TODO(gp): Implement this</p>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#unit_testing_code_inside_opt_container","title":"Unit testing code inside <code>opt</code> container","text":"<ul> <li>Since we want to segregate the package dependencies in different containers,     tests that have a dependency from cvxopt /cvxpy can't be run inside the <code>amp</code>     container but need to be run inside <code>opt</code>.</li> <li>We want to:<ol> <li>(as always) write and run unit tests for the optimizer code in isolation,  i.e., test the code in the directory <code>optimizer</code> by itself</li> <li>Run all the tests for the entire repo (relying on both containers <code>amp</code> and  <code>optimizer</code> with a single command invocation)</li> <li>Be able to run tests belonging to only one of the containers to shorten the  debugging cycle</li> </ol> </li> <li>To achieve this we need to solve the 3 problems below.</li> </ul>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#avoid_compiling_code_depending_from_cvxopt_when_running_amp","title":"Avoid compiling code depending from cvxopt when running amp","text":"<ul> <li> <p>We can't parse code (e.g., in <code>pytest</code>) that includes packages that are not     present in a container</p> <ul> <li>E.g., <code>pytest</code> running in <code>amp</code> should not parse code in <code>//amp/optimizer</code>     since it contains imports that will fail</li> </ul> </li> <li> <p>Solution 1</p> <ul> <li>We use the pytest mechanism <code>cvx = pytest.importorskip(\"cvxpy\")</code> which is     conceptually equivalent to:     <pre><code>try:\n    import cvxopt\n    has_cvxopt = True\nexcept ImportError:\n    has_cvxopt = False\n\nif has_cvxopt:\n                def utils1():\n             cvxopt\u2026\n</code></pre></li> </ul> </li> <li> <p>Solution 2</p> <ul> <li>Test in eachfile for the existence of the needed packages and enclose the     code in an <code>if _has_package</code><ul> <li>Pros:<ul> <li>We can skip code based dynamically on a <code>try ... except ImportModule</code> to     check what packages are present</li> </ul> </li> <li>Cons:<ul> <li>Repeat the same piece of <code>try ... except</code> in many places<ul> <li>Solution: we can factor it out in a function</li> </ul> </li> <li>We need to enclose the code in a <code>if ...</code> that screws up the indentation     and makes the code weird</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>Solution 3</p> <ul> <li>Exclude certain directories (e.g., <code>//amp/optimizer</code>) from <code>pytest</code><ul> <li>Pros:<ul> <li>We don't have to spread the <code>try ... except</code> and <code>if \\_has_package</code> in     the code</li> </ul> </li> <li>Cons:<ul> <li>The directory is relative to the top directory<ul> <li>Solution: we can use a regex to specify the dir without the full path</li> </ul> </li> <li>Which directories are included and excluded depends on where <code>pytest</code> is     run<ul> <li>E.g., running <code>pytest</code> in an <code>amp</code> container we need to skip the     <code>optimizer</code> dir, while <code>pytest</code> in an <code>optimizer</code> container should     skip everything but the <code>optimizer</code> dir</li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> <li> <p>Solution 4</p> <ul> <li>Exclude certain directories or files based on which container we are running     in<ul> <li>Cons:<ul> <li>We need to have a way to determine in which container we are running<ul> <li>Solution: we can use the env vars we use for versioning <pre><code>&gt; echo $AM_CONTAINER_VERSION\namp-1.0.3-\n</code></pre></li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> <li>Given the pros and cons, we decided to follow Solution 1 and Solution 3</li> </ul>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#run_optimizer_tests_in_a_stand-alone_opt_container","title":"Run optimizer tests in a stand-alone <code>opt</code> container","text":"<ul> <li>To run the optimizer tests, you can create an <code>opt</code> container and then run     <code>pytest</code> <pre><code>&gt; cd optimizer\n&gt; i opt_docker_bash\ndocker&gt; pytest .\n</code></pre></li> <li>We wrap this in an invoke target like <code>i opt_run_fast_tests</code></li> </ul> <p>Alternative solution</p> <ul> <li>We can use dind to run the <code>opt</code> container inside a <code>cmamp</code> one<ul> <li>Cons:<ul> <li>Dind complicates the system</li> <li>Dind is not supported everywhere (one needs privileged containers)</li> <li>Dind is slower since there are 2 levels of (relatively fast)     virtualization</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#run_optimizer_tests_as_part_of_running_unit_tests_for_cmamp","title":"Run optimizer tests as part of running unit tests for <code>cmamp</code>","text":"<ul> <li>We use the same mechanism as <code>run_fast_slow_superslow_tests</code> to pull together     different test lists</li> </ul>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#call_a_dockerized_executable_from_a_container","title":"Call a Dockerized executable from a container","text":"<ul> <li>From     https://github.com/cryptokaizen/cmamp/issues/1357</li> <li> <p>We need to call something from <code>amp</code> to <code>opt</code> Docker</p> </li> <li> <p>Solution 1</p> <ul> <li>Inside the code we build the command line     <code>cmd = 'docker run -it ... '; system(cmd)</code><ul> <li>Cons:<ul> <li>There is code replicated between here and the invoke task (e.g., the     info about the container, ...)</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>Solution 2</p> <ul> <li>Call the Dockerized executable using the <code>docker_cmd</code> invoke target     <pre><code>cmd = \"invoke opt_docker_cmd -cmd '...'\"\nsystem(cmd)\n</code></pre><ul> <li>Pros:<ul> <li>All the Docker commands go through the same interface inside invoke</li> </ul> </li> <li>Cons<ul> <li>Bash interpolation in the command</li> <li>Another level of indirection: do a system call to call <code>invoke</code>,     <code>invoke</code> calls docker, docker does the work</li> <li><code>invoke</code> needs to be installed inside the calling container</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>Solution 3</p> <ul> <li>Call opt_lib_tasks.py <code>opt_docker_cmd(cmd, ...)</code><ul> <li>Pros<ul> <li>Avoid doing a call to invoke</li> <li>Can deal with bash interpolation in Python</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>We should always use Solution 3, although in the code sometimes we use     Solution 1 and 2 (but we should replace in favor of Solution 3).</p> </li> </ul>"},{"location":"tools/dev_system/all.docker_optimizer_container.how_to_guide.html#_1","title":"All.docker optimizer container.how to guide","text":"<ul> <li>The interface to the Dockerized optimizer is in <code>run_optimizer</code> in     <code>//amp/oms/call_optimizer.py</code></li> <li>To run the examples     <pre><code>&gt; cd //lime\n&gt; i docker_bash\n&gt; pytest ./amp/oms/test/test_call_optimizer.py::Test_run_dockerized_optimizer1\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.python_package_upgrade_and_troubleshooting.how_to_guide.html","title":"All.python package upgrade and troubleshooting.how to guide","text":""},{"location":"tools/dev_system/all.python_package_upgrade_and_troubleshooting.how_to_guide.html#python_package_upgrade_troubleshooting","title":"Python package upgrade &amp; troubleshooting","text":""},{"location":"tools/dev_system/all.python_package_upgrade_and_troubleshooting.how_to_guide.html#description","title":"Description","text":"<ul> <li>Upgrading Python or its packages is a complex process requiring significant     attention and time</li> <li>This document aims to provide a step-by-step guide for upgrading Python or its     packages</li> <li>Several steps are outlined to be followed to avoid any potential issues</li> <li>The primary objective is to streamline the upgrade process, ensuring it     unfolds seamlessly while mitigating any potential issues that might arise     along the way</li> </ul>"},{"location":"tools/dev_system/all.python_package_upgrade_and_troubleshooting.how_to_guide.html#building_the_local_image","title":"Building the local image","text":"<ul> <li>Upgrade the packages versions in the     /devops/docker_build/pyproject.toml</li> <li>After the upgrade, the first step is to build the local image</li> <li>The build command is described in the     /docs/work_tools/all.docker.how_to_guide.md#multi-architecture-build</li> </ul>"},{"location":"tools/dev_system/all.python_package_upgrade_and_troubleshooting.how_to_guide.html#run_the_tests","title":"Run the tests","text":"<ul> <li>Create a new task-specific gdoc, e.g., CmTask7256_Upgrade_Pandas.docx</li> <li>Run all the tests from the orange repo against the new dev image<ul> <li>Fast</li> <li>Slow</li> <li>Superslow</li> <li>QA</li> <li>Example: <code>i run_fast_tests --stage local --version {new version}</code></li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.python_package_upgrade_and_troubleshooting.how_to_guide.html#document_errors","title":"Document Errors","text":"<ul> <li>Collect all the failures in the GDOC:<ul> <li>Test name</li> <li>Traceback</li> </ul> </li> <li>Group errors by type, e.g.,     <pre><code># Error type 1\n## Test name 1\ntraceback\n## Test name 2\ntraceback\n# Error type 2\n## Test name 1\ntraceback\n## Test name 2\ntraceback\n# Error type N ...\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.python_package_upgrade_and_troubleshooting.how_to_guide.html#identify_forward-compatible_fixes","title":"Identify forward-compatible fixes","text":"<p>Forward-compatible fix is a fix that works on both versions of a Python package, i.e. on the current one and the target one.</p> <ul> <li>Identify forward-compatible changes</li> <li>Move them to a separate GDOC section to isolate from the other changes</li> <li>For each forward-compatible fix file a separate GH issue and a separate PR to     master</li> </ul>"},{"location":"tools/dev_system/all.python_package_upgrade_and_troubleshooting.how_to_guide.html#handle_non-forward_compatible_fixes","title":"Handle non-forward compatible fixes","text":"<ul> <li>File an issue for the error</li> <li>Describe the solution in the GDOC</li> <li>Apply changes to the main PR</li> <li>Run the tests for this error type and make sure they do not fail</li> <li>Repeat this process for all the types of errors</li> <li>Once resolved, run all the regressions locally on the new local image from the     orange repo and make sure the regressions are green</li> </ul>"},{"location":"tools/dev_system/all.python_package_upgrade_and_troubleshooting.how_to_guide.html#image_release","title":"Image Release","text":"<ul> <li>Run release command described in the     /docs/work_tools/all.docker.how_to_guide.md#command-to-run-the-release-flow</li> <li>Follow the post-release check-list in the     /docs/work_tools/all.docker.how_to_guide.md#post-release-check-list</li> </ul>"},{"location":"tools/dev_system/all.python_package_upgrade_and_troubleshooting.how_to_guide.html#merge_base_pr","title":"Merge Base PR","text":"<ul> <li>Run the regressions from GitHub on the main PR</li> <li>Check that the GitHub Actions is picking up new image and all regressions     (fast, slow, superslow) are green on <code>cmamp</code>, <code>orange</code> and <code>kaizenflow</code></li> <li>Merge the main PR on all the repos (<code>cmamp</code>, <code>orange</code>, <code>kaizenflow</code>)</li> </ul>"},{"location":"tools/dev_system/all.replace_common_files_with_script_links.html","title":"All.replace common files with script links","text":""},{"location":"tools/dev_system/all.replace_common_files_with_script_links.html#summary","title":"Summary","text":"<ul> <li>This document describes two scripts, <code>create_links.py</code> and     <code>stage_linked_file.py</code> used to manage symbolic links between a     source directory and a destination directory</li> <li>These tools simplify workflows where you want to create read-only symbolic     links for files, stage modifications, and later restore the links</li> <li>For automated linking of standard configuration files from <code>helpers_root</code> to     the repository root, see     <code>create_all_helpers_links.py</code>     which is documented in     Managing common files</li> </ul>"},{"location":"tools/dev_system/all.replace_common_files_with_script_links.html#managing_symbolic_links_between_directories","title":"Managing Symbolic Links Between Directories","text":""},{"location":"tools/dev_system/all.replace_common_files_with_script_links.html#why_do_we_need_this_approach","title":"Why Do We Need This Approach?","text":"<ul> <li>In our codebases, it is common to have duplicate files or files that are     identical between two directories</li> <li> <p>Maintaining these files manually can lead to inefficiencies and errors:</p> <ul> <li>Synchronization: If changes are made in one location, they may not reflect     in the other, leading to inconsistencies</li> <li>Accidental Modifications: Directly modifying files that should remain     synchronized can result in unintended discrepancies</li> </ul> </li> <li> <p>With our approach:</p> <ul> <li>We avoid file duplication by creating links that point to the original files</li> <li>Links in the destination directory remain read-only, reducing the risk of     accidental changes</li> <li>If modifications are needed, the \"staging process\" ensures you can work     safely on copies without altering the original source files</li> <li>After the code has been developed, one can then convert copies of files, back     to links</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.replace_common_files_with_script_links.html#workflow_and_commands","title":"Workflow and Commands","text":"<ul> <li>Below is the step-by-step workflow for using these scripts</li> </ul>"},{"location":"tools/dev_system/all.replace_common_files_with_script_links.html#step_1_replace_files_with_symbolic_links","title":"Step 1: Replace Files with Symbolic Links","text":"<ul> <li> <p>Use <code>create_links.py</code> to replace files in <code>dst_dir</code> with read-only symbolic     links to the corresponding files in <code>src_dir</code></p> </li> <li> <p>Command:     <pre><code>&gt; create_links.py --src_dir /path/to/src --dst_dir /path/to/dst --replace_links\n</code></pre></p> </li> <li> <p>What it does:</p> <ul> <li>Scans all files in <code>src_dir</code> and checks for files with the same name and     content in <code>dst_dir</code></li> <li>For each match, the file in <code>dst_dir</code> is replaced with a symbolic link     pointing to the file in <code>src_dir</code></li> <li>Sets the symbolic link to <code>read-only</code> (permission 444) to prevent accidental     modifications</li> </ul> </li> <li> <p>Why it is important:</p> <ul> <li>This ensures that all common files are linked to a single source,     eliminating duplication and keeping the directories in sync</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.replace_common_files_with_script_links.html#step_2_stage_files_for_modification","title":"Step 2: Stage Files for Modification","text":"<ul> <li> <p>If you want to edit the files in <code>dst_dir</code> (which are currently symbolic     links), use <code>stage_linked_file.py</code> to stage them. Staging replaces the     symbolic links with writable copies of the original files</p> </li> <li> <p>Command:     <pre><code>&gt; stage_linked_file.py --dst_dir /path/to/dst\n</code></pre></p> </li> <li> <p>What it does:</p> <ul> <li>Finds all the symbolic links in <code>dst_dir</code></li> <li>Replaces each symbolic link with a writable copy of the file it points     to</li> <li>Sets file permissions to <code>644</code> (writable)</li> </ul> </li> <li> <p>Why it is important:</p> <ul> <li>It allows safe modifications to the files without directly editing the     original source files in <code>src_dir</code>. This ensures a clean and reversible     workflow</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.replace_common_files_with_script_links.html#step_3_restore_symbolic_links_after_modifications","title":"Step 3: Restore Symbolic Links After Modifications","text":"<ul> <li> <p>Once you've finished modifying the files, you can restore the symbolic links     by running <code>create_links.py</code> again with the <code>--replace_links</code> flag</p> </li> <li> <p>Command:     <pre><code>&gt; create_links.py --src_dir /path/to/src --dst_dir /path/to/dst --replace_links\n</code></pre></p> </li> <li> <p>What it does:</p> <ul> <li>Compares the modified files in <code>dst_dir</code> to those in <code>src_dir</code></li> <li>Replaces the matching files with symbolic links, resetting them to     <code>read-only</code></li> </ul> </li> <li> <p>Why it is important:</p> <ul> <li>This step cleans up your workspace and restores the optimized     <code>symbolic link</code> structure, ensuring minimal disk usage and consistent file     management</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.replace_common_files_with_script_links.html#workflow_summary","title":"Workflow Summary","text":"<ul> <li> <p>Set up <code>symbolic links</code>:     <pre><code>&gt; create_links.py --src_dir /path/to/src --dst_dir /path/to/dst --replace_links\n</code></pre></p> </li> <li> <p>Stage <code>symbolic links</code> for modification:     <pre><code>&gt; stage_linked_file.py --dst_dir /path/to/dst\n</code></pre></p> </li> <li> <p>Modify files as required</p> </li> <li> <p>After modifications, restore the <code>symbolic links</code>:     <pre><code>&gt; create_links.py --src_dir /path/to/src --dst_dir /path/to/dst --replace_links\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.replace_common_files_with_script_links.html#example_directory_structure","title":"Example Directory Structure","text":"<ul> <li> <p>Before running <code>create_links.py</code>:     <pre><code>src_dir/\n        file1.txt\n        subdir/\n                file2.txt\n\ndst_dir/\n        file1.txt  (identical content)\n        subdir/\n                file2.txt  (identical content)\n</code></pre></p> </li> <li> <p>After running <code>create_links.py</code>:     <pre><code>dst_dir/\n        file1.txt -&gt; src_dir/file1.txt  (symlink, read-only)\n        subdir/\n                file2.txt -&gt; src_dir/subdir/file2.txt  (symlink, read-only)\n</code></pre></p> </li> <li> <p>After running <code>stage_linked_file.py</code>:     <pre><code>dst_dir/\n        file1.txt  (writable copy of src_dir/file1.txt)\n        subdir/\n                file2.txt  (writable copy of src_dir/subdir/file2.txt)\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html","title":"All.runnable repo.reference","text":""},{"location":"tools/dev_system/all.runnable_repo.reference.html#summary","title":"Summary","text":"<ul> <li>This document describes the design principles around our approach to create     Git repos that contain code that can be:<ul> <li>Composed through different Git sub-repo</li> <li>Tested, built, run, and released (on a per-directory basis or not)</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#design_goals","title":"Design goals","text":"<ul> <li> <p>The development toolchain should support the following functionalities</p> </li> <li> <p>Standardize ways of building, testing, retrieving, and deploying containers</p> </li> <li>Bootstrap the development system using a \"thin environment\", which has the     minimum number of dependencies to allow development and deployment in exactly     the same way in different setups (e.g., server, personal laptop, CI/CD)</li> <li>Support composing code using a GitHub sub-repo approach</li> <li>Manage dependencies in a way that is uniform across platforms and OSes, using     Docker containers</li> <li>Separate the need to:<ul> <li>Build and deploy containers (by devops)</li> <li>Use containers to develop and test (by developers)</li> </ul> </li> <li>Ensure alignment between development environment, deployment, and CI/CD     systems (e.g., GitHub Actions)</li> <li>Carefully manage and control dependencies using Python managers (such as     <code>poetry</code>) and virtual environments</li> <li>Run end-to-end tests using <code>pytest</code> by automatically discover tests based on     dependencies and test lists, supporting the dependencies needed by different     directories</li> <li>Support automatically different stages for container development<ul> <li>E.g., <code>test</code> / <code>local</code>, <code>dev</code>, <code>prod</code></li> </ul> </li> <li>A system of makefile-like tools based on Python <code>invoke</code> package to create     complex workflows (e.g., for testing, building</li> <li>Make it easy to add the development tool chain to a \"new project\" by simply     adding a Git sub-repo to the main project and importing all the above     functionalities</li> <li>Have a simple way to maintain common files across different repos in sync     through links and automatically diff-ing files</li> <li>Code and containers can be versioned and kept in sync automatically since a     certain version of the code can require a certain version of the container to     run properly<ul> <li>Code is versioned through Git</li> <li>Each container has a <code>changelog.txt</code> that contains the current version and     the history</li> </ul> </li> <li>Built-in support for multi-architecture builds (e.g, for Intel <code>x86</code> and Arm)     across different OSes supporting containers (e.g., Linux, MacOS, Windows     Subsystem for Linux WSL)</li> <li>Support for both local and remote development using IDEs (e.g., PyCharm,     VSCode)</li> <li>Native support for both children-containers (i.e., Docker-in-Docker) and     sibling containers</li> <li>Support for developing, testing, and deploying multi-container applications</li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#our_previous_solution_to_the_development","title":"Our previous solution to the development","text":"<ul> <li> <p>Our previous approach was to create a single repo with different directories     containing different \"applications\" all running in a single Docker container     (aka <code>cmamp</code> or <code>dev</code> container)</p> </li> <li> <p>The main issues with this approach is that:</p> <ul> <li>The repo is enormous and monolithic</li> <li>There is not an easy way to have permission control over which parts of a     repo developers have access to</li> </ul> </li> <li> <p>These problems got progressively worse since we want to have all the dev chain     we are used to (thin environment, <code>invoke</code>, pytest, Docker), but since the dev     chain was bolted on <code>cmamp</code>, we kept adding to <code>cmamp</code> instead of creating     another repo</p> </li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#current_solution","title":"Current solution","text":"<ul> <li>The current solution follows the approach described below</li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#helper_sub-repo","title":"Helper sub-repo","text":"<ul> <li><code>//helpers</code> is the sub-repo that contains utilities shared by all the repos     and the development toolchain (e.g., thin environment, Docker, <code>setenv</code>,     <code>invoke</code> workflows)</li> <li> <p>Git repos can include <code>//helpers</code> and other ones as sub-repos</p> <pre><code>graph TD\n    runnable_repo[runnable repo 1]\n    runnable_repo_2[runnable repo 2]\n    runnable_repo_3[runnable repo 3]\n\n    runnable_repo --&gt; helpers_sub_repo_1[helpers sub-repo]\n    runnable_repo --&gt; others[...]\n\n    runnable_repo_2 --&gt; helpers_sub_repo_2[helpers sub-repo]\n    runnable_repo_2 --&gt; others_2[...]\n\n    runnable_repo_3 --&gt; helpers_sub_repo_3[helpers sub-repo]\n    runnable_repo_3 --&gt; others_3[...]\n\n    helper_repo[helper repo]\n    helpers_sub_repo_1 -.-&gt; helper_repo\n    helpers_sub_repo_2 -.-&gt; helper_repo\n    helpers_sub_repo_3 -.-&gt; helper_repo\n\n    style helpers_sub_repo_1 fill:transparent, stroke-dasharray: 5 5\n    style helpers_sub_repo_2 fill:transparent, stroke-dasharray: 5 5\n    style helpers_sub_repo_3 fill:transparent, stroke-dasharray: 5 5</code></pre> </li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#runnable_dir","title":"Runnable dir","text":"<ul> <li>A dir is runnable when it contains its own <code>devops</code> dir to have its own     container and dependencies to develop, run, and test<ul> <li>E.g., <code>//cmamp/optimizer</code>, <code>//cmamp/infra</code></li> </ul> </li> <li> <p>The code in a runnable directory or in the main repo requires a container that     is built using the code in the corresponding <code>devops</code> dir</p> <pre><code>graph TD\n    runnable_repo[\"runnable dir&lt;br&gt;(runnable repo)\"]\n    runnable_repo --&gt; helpers_sub_repo[helpers sub-repo]\n    runnable_repo --&gt; devops[devops]\n    runnable_repo --&gt; runnable_dir[runnable dir]\n    runnable_repo --&gt; others[...]\n\n    runnable_dir  --&gt; runnable_dir_devops[devops]\n\n    style helpers_sub_repo fill:transparent, stroke-dasharray: 5 5</code></pre> </li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#runnable_repo","title":"Runnable repo","text":"<ul> <li>A runnable repo is a repo that contains a single runnable dir at the top</li> <li> <p>A repo can contain multiple runnable dirs in a hierarchical fashion</p> <pre><code>graph TD\n    runnable_repo[runnable repo]\n    runnable_repo --&gt; helpers_sub_repo[helpers sub-repo]\n    runnable_repo --&gt; devops[devops]\n    runnable_repo --&gt; runnable_dir_1[runnable dir 1]\n    runnable_repo --&gt; runnable_dir_2[runnable dir 2]\n    runnable_repo --&gt; runnable_dir_n[runnable dir n]\n    runnable_repo --&gt; others[...]\n\n    runnable_dir_1 --&gt; runnable_dir_1_devops[devops]\n    runnable_dir_2 --&gt; runnable_dir_2_devops[devops]\n    runnable_dir_n --&gt; runnable_dir_3_devops[devops]\n\n    style helpers_sub_repo fill:transparent, stroke-dasharray: 5 5</code></pre> </li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#thin_environment","title":"Thin environment","text":"<ul> <li>Each runnable dir requires a <code>dev_scripts</code> that contains code to build the     corresponding thin environment</li> <li>A thin environment can be shared across multiple repos and runnable     directories since typically the dependencies needed to start the development     containers are minimal and common</li> </ul> <pre><code>graph TD\n    thin_env[thin environment]\n\n    subgraph repo_1[\"runnable repo 1\"]\n        runnable_repo_1[runnable repo 1]\n        runnable_repo_1 --&gt; dev_scripts_repo1[dev_scripts_repo1]\n        runnable_repo_1 --&gt; others[...]\n        runnable_repo_1 --&gt; repo_1_runnable_dir\n        subgraph repo_1_runnable_dir[\"runnable dir\"]\n            repo_1_runnable_dirs[...]\n        end\n    end\n\n    subgraph repo_2[\"runnable repo 2\"]\n        runnable_repo_2[runnable repo 2]\n        runnable_repo_2 --&gt; dev_scripts_repo2[dev_scripts_repo2]\n        runnable_repo_2 --&gt; others_2[...]\n        runnable_repo_2 --&gt; repo_2_runnable_dir\n        subgraph repo_2_runnable_dir[\"runnable dir\"]\n            repo_2_runnable_dirs[...]\n        end\n    end\n\n    repo_1 -.-&gt; thin_env\n    repo_1_runnable_dir -.-&gt; thin_env\n    repo_2 -.-&gt; thin_env\n    repo_2_runnable_dir -.-&gt; thin_env</code></pre>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#setenv","title":"setenv","text":"<ul> <li>A <code>setenv</code> script is used to configure a shell outside and inside a Docker     container</li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#devops","title":"devops","text":"<ul> <li>A <code>devops</code> dir contains all the code needed to build and run a container for     both development, testing, and deployment</li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#managing_common_files","title":"Managing common files","text":"<ul> <li>When creating runnable repos or dirs, many files are copied from the template     files in <code>//helpers</code></li> <li>Some of these files are customized; however, many remain unchanged</li> <li>When changes are made to the files in <code>//helpers</code>, the corresponding files in     their respective runnable repos or dirs need to be identified and replaced     with the new copies</li> <li>This manual copying and comparison approach requires a lot of effort and     becomes increasingly difficult to maintain as the number of runnable repos and     dirs grows</li> <li> <p>There is no way to \"source control\" shared files because the files themselves     are used to create the repos</p> </li> <li> <p>The solution is to apply a symlink approach for all common files</p> </li> <li>All the template files are initially copied and customized based on the     requirements</li> <li>After customization, those that remain unchanged are deleted and replaced with     symbolic links to the corresponding template files in <code>//helpers</code></li> <li>If any changes are made in <code>//helpers</code>, those changes are automatically     propagated to all the linked files</li> <li>The symlinked files should not be directly editable. If a symlinked file needs     to be customized, it should first be staged for modification by replacing the     symlink with a copy of the file</li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#automated_linking_for_standard_configuration_files","title":"Automated linking for standard configuration files","text":"<ul> <li>For thin client repositories using <code>helpers_root</code> as a submodule, the script     <code>create_all_helpers_links.py</code>     automates the creation of symbolic links for standard configuration files</li> <li> <p>This script maintains a predefined list of common configuration files that     should be linked from <code>helpers_root</code> to the repository root:</p> <ul> <li><code>.claude/</code> - Claude Code configuration</li> <li><code>.coveragerc</code> - Test coverage configuration</li> <li><code>.gitignore</code> - Git ignore patterns</li> <li><code>.gitleaksignore</code> - Gitleaks scan exclusions</li> <li><code>.isort.cfg</code> - Import sorting configuration</li> <li><code>.pre-commit-config.yaml</code> - Pre-commit hooks</li> <li><code>CLAUDE.md</code> - Claude Code project context</li> <li><code>conftest.py</code> - Pytest configuration</li> <li><code>linters2/</code> - Linting scripts</li> <li><code>pyproject.toml</code> - Python project configuration</li> <li><code>pytest.ini</code> - Pytest settings</li> </ul> </li> <li> <p>The script provides three modes of operation:</p> <ul> <li>Default: Create only missing links (skips existing files)</li> <li><code>--force</code>: Recreate all links even if they already exist</li> <li><code>--dry_run</code>: Preview what would be done without making changes</li> </ul> </li> <li> <p>Example usage:     <pre><code># Create missing links\n&gt; helpers_root/dev_scripts_helpers/thin_client/create_all_helpers_links.py\n\n# Force recreate all links\n&gt; helpers_root/dev_scripts_helpers/thin_client/create_all_helpers_links.py --force\n\n# Preview changes\n&gt; helpers_root/dev_scripts_helpers/thin_client/create_all_helpers_links.py --dry_run\n</code></pre></p> </li> <li> <p>For more complex scenarios requiring custom source and destination directories,     use <code>create_links.py</code> as described in     Managing symbolic links between directories</p> </li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#managing_repo_configurations","title":"Managing repo configurations","text":"<ul> <li>Centralizing configurations eliminates duplication, reduces maintenance     overhead, and ensures consistency across different components of the system</li> <li>When configuration parameters need to be modified, changes only need to be     made in one location rather than across multiple files</li> <li> <p>YAML file format is preferred for its better support for nested structures and     complex data types</p> </li> <li> <p>All repo configurations are stored in a central <code>repo_config.yaml</code> file</p> </li> <li>The configurations are used by both Python and shell scripts</li> <li>The configurations may contain repo identifiers, docker container information,     runnable repo or runnable directory configs, thin environments used....etc</li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#building_a_docker_container","title":"Building a Docker container","text":"<ul> <li>Code and tests need to be run inside a corresponding Docker container</li> <li>There is a shared toolchain to build, test, release, and deploy each Docker     container:<ul> <li>The containers have all the dependencies to run the code</li> <li>Each container is multi-architecture in order to be run on different     processor architectures (e.g., x86-64, arm64)</li> </ul> </li> <li>The same container is used to run the code in all set-ups (e.g., on a personal     laptop, on a server, in the CI)</li> <li>It is possible to have different dependencies for the dev and prod container<ul> <li>E.g., dependencies to run the unit tests are not needed in a prod container</li> </ul> </li> <li>The toolchain to build containers is managed through <code>invoke</code> targets<ul> <li>It supports versioning</li> </ul> </li> <li>The Python dependencies are managed through <code>poetry</code></li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#building_dev_container","title":"Building <code>dev</code> container","text":"<ul> <li>The <code>dev</code> container mounts the source code as a bind-mount directory so that     developers can use external tools to edit the code (e.g., vim, PyCharm,     VSCode)</li> <li>The <code>dev</code> container mounts the outermost repo so runnable dirs that are sub     directories can see and use <code>//helpers</code> submodule</li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#buiding_prod_container","title":"Buiding <code>prod</code> container","text":"<ul> <li>The <code>prod</code> container copies the code inside so that it contains OS     dependencies, Python packages, and code, without any external dependency</li> <li>The entire repo (not just the current runnable dir) is copied because<ul> <li>We should respect the structure of the repo</li> <li>We want to ensure setup in the <code>prod</code> image mirrors that of the <code>dev</code> image</li> <li>We are guaranteed that all the dependencies are verified</li> <li>It is difficult to understand what exactly is needed from the repo for a     runnable dir to work (e.g., we know we need <code>helpers</code>, but what else?)</li> </ul> </li> <li>The entire code can be encrypted for confidentiality reason</li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#running_a_docker_container","title":"Running a Docker container","text":"<ul> <li>Handy wrappers through the <code>invoke</code> toolchain are available to perform common     operations, e.g.,<ul> <li><code>invoke docker_bash</code> to start a shell inside a container</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#module_imports","title":"Module imports","text":"<ul> <li> <p>Runnable dirs (which are subdirs of a runnable repo) should still import from     the root of their parent repo</p> <ul> <li>The imports should respect the structure of the repo</li> <li>A runnable dir can be run independently from the rest of the code</li> <li>However, it should be able to import from other dirs in the same repo as     well</li> <li>For example,<ul> <li>In a set up where <code>//cmamp</code> is a runnable repo and <code>//cmamp/optimizer</code> is     a runnable dir</li> <li>All the imports in <code>//cmamp/optimizer</code> should start from <code>//cmamp</code> rather     than <code>//cmamp/optimizer</code></li> </ul> </li> </ul> </li> <li> <p>Only runnable dirs (which are runnable repos and can be submodules of other     repos), such as <code>//helpers</code>, should use relative imports</p> <ul> <li>For example,<ul> <li>In a setup where <code>//helpers</code> is a submodule of <code>//cmamp</code> (i.e.,     <code>//cmamp/helpers_root</code>)</li> <li>All imports in <code>//helpers</code> can start from <code>//helpers</code> rather than     <code>//cmamp</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#pytest","title":"pytest","text":"<ul> <li>To run all the tests in a repo, <code>pytest</code> needs to run inside a dev container</li> <li>For top-level repo, the needed container is the top-level container</li> <li> <p>For a runnable dir, the needed container is the one built in that specific     directory</p> <pre><code>graph LR\n    start((start))\n    start --&gt; container\n    subgraph container[container]\n        direction LR\n        pytest((pytest))\n        pytest --&gt; dir_1[dir 1]\n        dir_1 --&gt; dir_1a[dir 1a]\n        dir_1a --&gt; dir_1a_others[...]\n        dir_1 --&gt; dir_1b[dir 1b]\n        dir_1 --&gt; dir_1_others[...]\n        pytest --&gt; dir_2[dir 2]\n        pytest --&gt; dir_others[...]\n    end</code></pre> </li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#recursive_pytest","title":"Recursive pytest","text":"<ul> <li> <p>When we want to run all the tests in a repo containing multiple runnable dirs,     we need to iterate over the runnable dirs and run the corresponding tests in     the corresponding container, e.g.,</p> <pre><code>for container in containers:\n (cd container; i run_fast_tests)\n</code></pre> <pre><code>graph LR\n        start((start))\n        start --&gt; container_1\n        start --&gt; container_2\n        start --&gt; container_3\n        start --&gt; container_n\n        subgraph container_1[container 1]\n                direction LR\n                pytest_1((pytest)) --&gt; runnable_dir1[runnable dir 1]\n        end\n        subgraph container_2[container 2]\n                direction LR\n                pytest_2((pytest)) --&gt; runnable_dir2[runnable dir 2]\n        end\n        subgraph container_3[container 3]\n                direction LR\n                pytest_3((pytest)) --&gt; runnable_dir3[runnable dir 3]\n        end\n        subgraph container_n[container n]\n                direction LR\n                pytest_n((pytest)) --&gt; runnable_dir_n[runnable dir n]\n        end</code></pre> </li> <li> <p>This function is performed automatically by the script <code>main_pytest.py</code> <pre><code>&gt; main_pytest.py --dir infra\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#support_for_docker-in-docker_and_sibling-containers","title":"Support for docker-in-docker and sibling-containers","text":"<pre><code>graph TD\n        host[Host]\n        docker_engine[docker engine]\n        subgraph sibling_container[\"sibling containers\"]\n                container_1[container 1]\n                container_2[container 2]\n        end\n        subgraph children_container[\"children containers\"]\n                container_1a[container 1a]\n                container_1b[container 1b]\n        end\n        host --&gt; docker_engine\n        docker_engine --&gt; container_1\n        docker_engine --&gt; container_2\n        container_1 --&gt; container_1a\n        container_1 --&gt; container_1b</code></pre>"},{"location":"tools/dev_system/all.runnable_repo.reference.html#maintaining_code_across_different_sub-repos","title":"Maintaining code across different sub-repos","text":"<ul> <li>TODO(gp): Explain</li> </ul>"},{"location":"tools/dev_system/all.synchronize_gh_issue_labels.how_to_guide.html","title":"All.synchronize gh issue labels.how to guide","text":""},{"location":"tools/dev_system/all.synchronize_gh_issue_labels.how_to_guide.html#synchronize_gh_issue_labels","title":"Synchronize GH issue labels","text":""},{"location":"tools/dev_system/all.synchronize_gh_issue_labels.how_to_guide.html#overview","title":"Overview","text":"<ul> <li> <p>GitHub labels help categorize and prioritize issues in a repository. You can     find more information in the     <code>all.use_github.how_to_guide.md</code></p> </li> <li> <p>The     <code>/dev_scripts_helpers/github/sync_gh_issue_labels.py</code>     script synchronizes GitHub issue labels between a repository and a label     inventory manifest file</p> </li> <li> <p>The script includes options to back up existing labels before synchronization     to prevent data loss</p> </li> <li> <p>The labels are stored in the     <code>/dev_scripts_helpers/github/labels/gh_issues_labels.yml</code>     file, which acts as a manifest for synchronization. You can create your own     label file or use the default ones provided in the repository but you need to     use only YAML file</p> </li> </ul>"},{"location":"tools/dev_system/all.synchronize_gh_issue_labels.how_to_guide.html#prerequisites","title":"Prerequisites","text":""},{"location":"tools/dev_system/all.synchronize_gh_issue_labels.how_to_guide.html#label_file","title":"Label file","text":"<ul> <li> <p>A GitHub label includes the following attributes:</p> <ul> <li><code>name</code>: The label's name</li> <li><code>color</code>: The label's color in hex format (e.g., <code>#FF0000</code> for red)</li> <li><code>description</code>: A short description of the label</li> </ul> </li> <li> <p>The <code>dev_scripts_helpers/labels/gh_issues_labels.yml</code> file contains various     label types, as shown below:</p> </li> </ul> <pre><code># Priority Labels.\n- name: P0\n    description: High priority - needs immediate attention\n    color: \"#ff0000\"\n# Issue Types.\n- name: Blocking\n    description: This issue needs to be worked on immediately\n    color: \"#e11d21\"\n# Pull Request Guidelines.\n- name: PR for authors\n    description: The PR needs changes\n    color: \"#eb35f3\"\n# Issue Status.\n- name: Paused\n    description: An issue was started and then stopped\n    color: \"#cccccc\"\n# Contribution Types.\n- name: Good first issue\n    description: Simple tasks for newcomers\n    color: \"#7057ff\"\n</code></pre>"},{"location":"tools/dev_system/all.synchronize_gh_issue_labels.how_to_guide.html#permissions_and_access","title":"Permissions and access","text":"<ul> <li> <p>The script uses the <code>PyGithub</code> library to interact with the GitHub API. Ensure     you have it installed in your Python environment</p> </li> <li> <p>Ensure that your local Python environment contains a token with write access     to the repository for the script to function. To check whether you have the     token in the local environment, run the following command:</p> </li> </ul> <pre><code>&gt; echo $GITHUB_TOKEN\n</code></pre> <ul> <li>The script requires write access to the repository you want to update labels</li> </ul>"},{"location":"tools/dev_system/all.synchronize_gh_issue_labels.how_to_guide.html#how_to_synchronize_issue_labels","title":"How to synchronize issue labels","text":""},{"location":"tools/dev_system/all.synchronize_gh_issue_labels.how_to_guide.html#using_github","title":"Using GitHub","text":"<ul> <li> <p>Open the <code>Issues</code> section in the GitHub repository you want to update labels     in </p> </li> <li> <p>Click on <code>Labels</code> on the right side of the page to view all the labels in the     repository </p> </li> <li> <p>To edit or delete a label, click on the label and make the necessary changes</p> </li> <li> <p>To create a new label, click on <code>New Label</code>, enter its name, description, and     color, and click <code>Create Label</code> </p> </li> </ul>"},{"location":"tools/dev_system/all.synchronize_gh_issue_labels.how_to_guide.html#running_the_script_manually","title":"Running the script manually","text":"<ul> <li> <p>When you want to create, update, or delete a label, update the     <code>dev_scripts_helpers/labels/gh_issues_labels.yml</code> file accordingly. If working     with a different file, ensure to specify the correct path in the script</p> </li> <li> <p>Run the script to synchronize the labels in the GitHub repository using the     following command:</p> </li> </ul> <pre><code>&gt; ./dev_scripts_helpers/github/sync_gh_issue_labels.py \\\n        --input_file ./dev_scripts_helpers/github/labels/gh_issues_labels.yml \\\n        --owner causify-ai \\\n        --repo helpers \\\n        --token_env_var GITHUB_TOKEN \\\n        --backup \\\n        --dry_run\n12:26:27 - INFO  hdbg.py init_logger:1013                               Saving log to file '/home/peeyush/src/helpers1/dev_scripts_helpers/github/sync_gh_issue_labels.py.log'\n12:26:27 - INFO  hdbg.py init_logger:1018                               &gt; cmd='./dev_scripts_helpers/github/sync_gh_issue_labels.py --input_file ./dev_scripts_helpers/github/labels/gh_issues_labels.yml --owner causify-ai --repo helpers --token_env_var GITHUB_TOKEN --backup --dry_run'\n12:26:28 - INFO  sync_gh_issue_labels.py _main:205                      Labels backed up to /home/peeyush/src/helpers1/tmp.labels.causify-ai.helpers.yaml\nAre you sure you want to synchronize labels? [y/n] y\n12:26:32 - INFO  sync_gh_issue_labels.py _main:263                      Label 'P0' not changed\n12:26:32 - INFO  sync_gh_issue_labels.py _main:263                      Label 'P1' not changed\n...\n12:26:32 - INFO  sync_gh_issue_labels.py _main:263                      Label 'Readings' not changed\n12:26:32 - INFO  sync_gh_issue_labels.py _main:241                      Label 'Testing' will be created without --dry_run\n12:26:32 - INFO  sync_gh_issue_labels.py _main:263                      Label 'PR for authors' not changed\n...\n12:26:32 - INFO  sync_gh_issue_labels.py _main:263                      Label 'Bounty' not changed\n12:26:32 - INFO  sync_gh_issue_labels.py _main:264                      Label synchronization completed!\n</code></pre> <ul> <li>For more information on the script's arguments, run the following command:</li> </ul> <pre><code>&gt; ./dev_scripts_helpers/github/sync_gh_issue_labels.py --help\n</code></pre>"},{"location":"tools/dev_system/all.synchronize_gh_issue_labels.how_to_guide.html#using_invoke","title":"Using Invoke","text":"<p>TODO(*): Update this section once the invoke target is implemented</p> <ul> <li>You can run the script using the <code>invoke</code> command where <code>$FILENAME</code> is the     name of the YAML file containing the labels:</li> </ul> <pre><code>&gt; i sync_gh_issue_labels \\\n        --input_file $FILENAME \\\n        --owner causify-ai \\\n        --repo sports_analytics \\\n        --token_env_var GITHUB_TOKEN  \\\n        --backup\n</code></pre>"},{"location":"tools/dev_system/all.synchronize_gh_settings.how_to_guide.html","title":"All.synchronize gh settings.how to guide","text":""},{"location":"tools/dev_system/all.synchronize_gh_settings.how_to_guide.html#synchronize_github_repository_settings","title":"Synchronize GitHub repository settings","text":"<ul> <li>TODO(sandeep): Update the script path references once the dockerized     executable is implemented</li> </ul>"},{"location":"tools/dev_system/all.synchronize_gh_settings.how_to_guide.html#overview","title":"Overview","text":"<ul> <li> <p>The     <code>dockerized_sync_gh_repo_settings.py</code>     script helps to export and synchronize GitHub repository settings and branch     protection rules through a settings manifest file</p> </li> <li> <p>The script supports two operations:</p> <ul> <li><code>export</code>: write current repository settings to a YAML file</li> <li><code>sync</code>: apply the settings defined in a YAML file to a repository</li> </ul> </li> <li> <p>The script uses <code>PyGithub</code> library to interact with the GitHub API</p> </li> <li> <p>The script is a dockerized executable (i.e., runs in a Docker container to     ensure that all the dependencies are verified, e.g., <code>PyGitHub</code>)</p> </li> <li> <p>Every time you run sync the script saves a backup of the current settings so     you can roll back if needed</p> <ul> <li>The settings are backed up in the current working directory</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.synchronize_gh_settings.how_to_guide.html#prerequisites","title":"Prerequisites","text":""},{"location":"tools/dev_system/all.synchronize_gh_settings.how_to_guide.html#github_token","title":"GitHub token","text":"<ul> <li>You need a GitHub token with appropriate repository management permissions</li> <li>Store the token in an environment variable and verify it:     <pre><code>&gt; echo $GITHUB_TOKEN\n</code></pre></li> </ul>"},{"location":"tools/dev_system/all.synchronize_gh_settings.how_to_guide.html#settings_manifest_file_structure","title":"Settings manifest file structure","text":"<ul> <li> <p>In each repo there are two parts of a configuration we need to set</p> </li> <li> <p>The \"repository settings\" section controls basic repository configuration:</p> <pre><code>repository_settings:\n    name: \"repo-name\"\n    description: \"Repository description\"\n    homepage: \"https://example.com\"\n    private: true\n    archived: false\n    has_issues: true\n    has_projects: true\n    has_wiki: true\n    allow_squash_merge: true\n    allow_merge_commit: true\n    allow_rebase_merge: true\n    delete_branch_on_merge: true\n    enable_automated_security_fixes: true\n    enable_vulnerability_alerts: true\n    topics:\n        - topic1\n        - topic2\n</code></pre> </li> <li> <p>The \"branch protection\" section defines rules for protected branches:</p> <pre><code>branch_protection:\n    main:\n        enforce_admins: true\n        allow_force_pushes: false\n        allow_deletions: false\n        required_status_checks:\n            strict: true\n            contexts:\n                - \"run tests\"\n        required_pull_request_reviews:\n            dismiss_stale_reviews: true\n            require_code_owner_reviews: true\n            required_approving_review_count: 2\n            dismissal_restrictions:\n                users:\n                    - \"user1\"\n                teams:\n                    - \"team1\"\n        restrictions:\n            users:\n                - \"maintainer1\"\n                - \"maintainer2\"\n            teams:\n                - \"developers\"\n                - \"admins\"\n</code></pre> </li> <li> <p>You can use two reference files to help configure your repository:</p> <ol> <li><code>Common repository settings</code></li> <li>Find the file at    /dev_scripts_helpers/github/settings/common_repo_settings.yaml</li> <li>This file contains standard settings that we use across multiple    repositories</li> <li> <p>Start with this file when you want to maintain consistency with other    repositories</p> </li> <li> <p><code>Template settings</code></p> </li> <li>Find the file at    /dev_scripts_helpers/github/settings/template_repo_settings.yaml</li> <li>This template shows all available configuration options with example    values</li> <li>Use this file when you need to create a new settings file from scratch</li> <li>You can remove any settings parameters you don't need; the script will    handle missing entries</li> </ol> </li> </ul>"},{"location":"tools/dev_system/all.synchronize_gh_settings.how_to_guide.html#how_to_synchronize_repository_settings","title":"How to synchronize repository settings","text":"<ul> <li> <p>View more information about the script's arguments:</p> <pre><code>&gt; dockerized_sync_gh_repo_settings.py --help\n</code></pre> <pre><code>&gt; dockerized_sync_gh_repo_settings.py export --help\n</code></pre> <pre><code>&gt; dockerized_sync_gh_repo_settings.py sync --help\n</code></pre> </li> <li> <p>Export repository settings to a YAML file:</p> <pre><code>&gt; dockerized_sync_gh_repo_settings.py export \\\n        --output_file settings.yaml \\\n        --owner your-org \\\n        --repo your-repo \\\n        --token_env_var GITHUB_TOKEN\n</code></pre> </li> <li> <p>Synchronize settings from a YAML file to a repository:</p> <pre><code>&gt; dockerized_sync_gh_repo_settings.py sync \\\n        --input_file settings.yaml \\\n        --owner your-org \\\n        --repo your-repo \\\n        --token_env_var GITHUB_TOKEN\n</code></pre> </li> <li> <p>Preview changes without applying them by adding <code>--dry_run</code> flag:</p> <pre><code>&gt; dockerized_sync_gh_repo_settings.py sync \\\n        --input_file settings.yaml \\\n        --owner your-org \\\n        --repo your-repo \\\n        --token_env_var GITHUB_TOKEN \\\n        --dry_run\n</code></pre> </li> </ul>"},{"location":"tools/dev_system/all.synchronize_gh_settings.how_to_guide.html#troubleshooting","title":"Troubleshooting","text":"<ol> <li>For permission errors:</li> <li>Verify your GitHub token has sufficient permissions</li> <li> <p>Check your repository admin access</p> </li> <li> <p>If settings are not applied:</p> </li> <li>Run with <code>--dry_run</code> to preview changes</li> <li>Verify the manifest file structure</li> <li>Check all required fields are present</li> </ol>"},{"location":"tools/dev_system/all.transition_to_cmamp2.how_to_guide.html","title":"All.transition to cmamp2.how to guide","text":""},{"location":"tools/dev_system/all.transition_to_cmamp2.how_to_guide.html#how_to_switch_to_cmamp-v20","title":"How to switch to cmamp-v2.0","text":"<ul> <li> <p><code>cmamp-2.0</code> brings major changes to our dev and deployment flow</p> </li> <li> <p>Changelog</p> <ul> <li>Made repos composable by using git subrepos instead of the mono-repo     approach used until now<ul> <li>E.g., <code>//helpers</code> is now a subrepo and not a normal dir</li> <li>In this way we can separate multiple applications in different composable     repos</li> </ul> </li> <li>Improved Docker flow where repos and dirs can run in different containers</li> <li>Improved Docker container building flow<ul> <li>Switched to Python 3.12</li> <li>Brought all the packages to the newest version, including pandas, numpy,     etc.</li> </ul> </li> <li>Improved thin client flow and tmux flow<ul> <li>It has been almost completely re-written in Python from Bash</li> </ul> </li> <li>Improved documentation</li> </ul> </li> <li> <p>(The whole thing is so fancy, we are writing a paper on our approach).</p> </li> <li> <p>Despite the fact that we tested the flows for more than one month across     different builds (Linux, Mac, GH), there will be certainly be problems for you     or the build systems, since this is a big change</p> </li> <li>You will find more or fewer issues if your flow is different than the official     one. Be patient, ask for help (kindly), and we will get all your problems     fixed.</li> </ul>"},{"location":"tools/dev_system/all.transition_to_cmamp2.how_to_guide.html#patching_up_an_existing_client_on_dev1_or_dev2","title":"Patching up an existing client on dev1 or dev2","text":"<ul> <li> <p>You need to patch up your Git client or start from scratch</p> <pre><code>&gt; cd /data/saggese/src/cmamp1\n\n&gt; git checkout master\n# ... It's going to pull a lot of stuff ...\n\n# Our old friendly dirs are empty.\n&gt; ls helpers/ config/\nls: config/: No such file or directory\nls: helpers/: No such file or directory\n\n# And there is a new friend, but it's still empty.\n&gt; ls helpers_root/\n\n&gt; git submodule init\nSubmodule 'helpers_root' (git@github.com:causify-ai/helpers.git) registered for path 'helpers_root'\n\n&gt; git submodule update\nCloning into '/data/saggese/src/cmamp1/helpers_root'...\nWarning: Permanently added 'github.com' (ED25519) to the list of known hosts.\nSubmodule path 'helpers_root': checked out '4534c7c3e0157aebc72d7fdc61a297e69cd23cc8'\n\n# Now `helpers_root` is populated\n&gt; ls helpers_root/\nLICENSE             __init__.py         config_root         dev_scripts_helpers docs                invoke.yaml         pytest.ini          tasks.py\nREADME.md           changelog.txt       conftest.py         devops              helpers             mypy.ini            repo_config.py\n</code></pre> </li> </ul>"},{"location":"tools/dev_system/all.transition_to_cmamp2.how_to_guide.html#clone_git_client_from_scratch","title":"Clone Git client from scratch","text":"<ul> <li> <p>If patching up your Git client doesn't work you can take a more destructive     road and create a new repo</p> </li> <li> <p>Push all your local branches remotely, since the Git clients might have issues</p> </li> <li> <p>I suggest to rename your Git client to <code>.old</code>, e.g.,     <pre><code>&gt; mv /data/saggese/cmamp1 /data/saggese/cmamp1.old\n</code></pre></p> </li> <li> <p>Then clone the Git from scratch     <pre><code>&gt; git clone --recursive ...\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.transition_to_cmamp2.how_to_guide.html#fix_all_env_vars","title":"Fix all env vars","text":"<ul> <li> <p>Your old bash and tmux sessions need to be patched up and then restarted</p> </li> <li> <p>To patch up the env vars you can run in every bash:     <pre><code>&gt; cd /.../cmamp1\n&gt; ./dev_scripts_cmamp/thin_client/setenv.sh\n</code></pre></p> </li> <li> <p>If you are using <code>tmux</code> (and you should) you need to restart the dev env     completely</p> </li> </ul>"},{"location":"tools/dev_system/all.transition_to_cmamp2.how_to_guide.html#restart_tmux_system","title":"Restart tmux system","text":"<ul> <li> <p>E.g., for a client <code>/data/saggese/src/cmamp1</code></p> </li> <li> <p>Create a new centralized script to control the different copies of the repos     <pre><code>&gt; /data/saggese/src/cmamp1/dev_scripts_cmamp/thin_client/tmux.py --create_global_link\n##&gt; /data/saggese/src/cmamp1/dev_scripts_cmamp/thin_client/tmux.py\n16:07:44 - INFO  hdbg.py init_logger:1010                               Saving log to file '{'/data/saggese/src/cmamp1/helpers_root/dev_scripts_helpers/thin_client/thin_client_utils.py.log'}'\n16:07:44 - INFO  hdbg.py init_logger:1015                               &gt; cmd='/data/saggese/src/cmamp1/dev_scripts_cmamp/thin_client/tmux.py --create_global_link'\n16:07:44 - INFO  thin_client_utils.py create_tmux_session:199           Creating the global link\n################################################################################\nln -sf /data/saggese/src/cmamp1/dev_scripts_cmamp/thin_client/tmux.py ~/go_cmamp.py\n################################################################################\n16:07:44 - INFO  thin_client_utils.py create_tmux_session:203           Link created: exiting\n</code></pre></p> </li> <li> <p>Start a new session for the client 1 of <code>cmamp</code> <pre><code>&gt; /data/saggese/src/cmamp1/dev_scripts_cmamp/thin_client/tmux.py --index1\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.transition_to_cmamp2.how_to_guide.html#check_that_the_new_docker_container_works","title":"Check that the new Docker container works","text":"<ul> <li> <p>Pull the new container</p> <pre><code>&gt; i docker_pull\n# This should pull a new image from the repo and should take a bit of time\n</code></pre> </li> <li> <p>Test the new container     <pre><code>&gt; i docker_bash\n16:14:49 - INFO  hdbg.py init_logger:1015                               &gt; cmd='/data/saggese/src/venv/client_venv.helpers/bin/invoke docker_bash'\n## docker_bash:\n16:14:49 - INFO  lib_tasks_docker.py docker_pull:246                    Pulling the latest version of Docker\n## docker_pull:\n## docker_login:\n## _docker_login_ecr:\n16:14:49 - INFO  lib_tasks_docker.py _docker_login_ecr:350              Logging in to the target registry\n    ... WARNING! Using --password via the CLI is insecure. Use --password-stdin.\n    ... Login Succeeded\n16:14:53 - INFO  lib_tasks_docker.py _docker_pull:233                   image='623860924167.dkr.ecr.eu-north-1.amazonaws.com/cmamp:dev'\ndocker pull 623860924167.dkr.ecr.eu-north-1.amazonaws.com/cmamp:dev\ndev: Pulling from cmamp\nDigest: sha256:68a1c9dfe5ec8a22f2e86ed13642422c5ca7abd886deb40637314805aa35af9c\nStatus: Image is up to date for 623860924167.dkr.ecr.eu-north-1.amazonaws.com/cmamp:dev\n623860924167.dkr.ecr.eu-north-1.amazonaws.com/cmamp:dev\n\nWhat's Next?\n    View a summary of image vulnerabilities and recommendations \u2192 docker scout quickview 623860924167.dkr.ecr.eu-north-1.amazonaws.com/cmamp:dev\nIMAGE=623860924167.dkr.ecr.eu-north-1.amazonaws.com/cmamp:dev \\\n                docker compose \\\n                --file /data/saggese/src/cmamp1/devops/compose/docker-compose.yml \\\n                --env-file devops/env/default.env \\\n                run \\\n                --rm \\\n                --name saggese.cmamp.app.cmamp1.20241110_111449 \\\n                --user $(id -u):$(id -g) \\\n                app \\\n                bash\nWARN[0000] The \"CSFY_FORCE_TEST_FAIL\" variable is not set. Defaulting to a blank string.\nWARN[0000] The \"CSFY_AWS_ACCESS_KEY_ID\" variable is not set. Defaulting to a blank string.\nWARN[0000] The \"CSFY_AWS_DEFAULT_REGION\" variable is not set. Defaulting to a blank string.\nWARN[0000] The \"CSFY_AWS_SECRET_ACCESS_KEY\" variable is not set. Defaulting to a blank string.\nWARN[0000] The \"CSFY_TELEGRAM_TOKEN\" variable is not set. Defaulting to a blank string.\nWARN[0000] /data/saggese/src/cmamp1/devops/compose/docker-compose.yml: `version` is obsolete\nWARN[0000] Found orphan containers ([compose-im_postgres3923-1 compose-im_postgres5173-1]) for this project. If you removed or renamed this service in your compose file, you can run this command with the --remove-orphans flag to clean it up.\nUSE_HELPERS_AS_NESTED_MODULE=1\n##&gt; devops/docker_run/entrypoint.sh\nUID=501\nGID=20\nGIT_ROOT_DIR=/app\n&gt; source /app/helpers_root/dev_scripts_helpers/thin_client/thin_client_utils.sh ...\nAM_CONTAINER_VERSION='2.0.0'\nUSE_HELPERS_AS_NESTED_MODULE=1\n##&gt; devops/docker_run/docker_setenv.sh\nGIT_ROOT_DIR=/app\n&gt; source /app/helpers_root/dev_scripts_helpers/thin_client/thin_client_utils.sh ...\n# Activate environment ...\n# Activate environment ... done\n# Set PATH\nPATH=.:./dataflow:./reconciliation:./oms:./ck_web_apps:./dataflow_amp:./devops:./core:./test:./.pytest_cache:./optimizer:./papers:./market_data:./research_amp:./ck.infra:./project_template:./ck.marketing:./docs:./ck.alembic:./helpers_root:./dev_scripts:./dev_scripts_cmamp:./.github:./datapull:./sorrentum_sandbox:./im:./mkdocs:./.git:./pnl_web_app:./ck_marketing:./defi:./data_schema:./.idea:/app:/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n# Set PYTHONPATH\nPYTHONPATH=/app:\n# Configure env\ngit --version: git version 2.43.0\n/app\nPATH=.:./dataflow:./reconciliation:./oms:./ck_web_apps:./dataflow_amp:./devops:./core:./test:./.pytest_cache:./optimizer:./papers:./market_data:./research_amp:./ck.infra:./project_template:./ck.marketing:./docs:./ck.alembic:./helpers_root:./dev_scripts:./dev_scripts_cmamp:./.github:./datapull:./sorrentum_sandbox:./im:./mkdocs:./.git:./pnl_web_app:./ck_marketing:./defi:./data_schema:./.idea:/app:/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nPYTHONPATH=/app/helpers_root:/app:\nentrypoint.sh: 'bash'\n</code></pre></p> </li> <li> <p>Note that starting a container should be much faster than what it used to</p> </li> <li> <p>Run <code>pytest</code> <pre><code>docker&gt; pytest\n</code></pre></p> </li> </ul>"},{"location":"tools/dev_system/all.transition_to_repo_config_yml.how_to_guide.html","title":"All.transition to repo config yml.how to guide","text":""},{"location":"tools/dev_system/all.transition_to_repo_config_yml.how_to_guide.html#how_to_switch_from_repo_configpy_to_repo_configyml","title":"How to switch from <code>repo_config.py</code> to <code>repo_config.yml</code>","text":"<ul> <li> <p>Design choice is discussed in     Managing repo configurations</p> </li> <li> <p>Changelog</p> <ul> <li>The <code>repo_config.py</code> is removed in favor of <code>repo_config.yml</code></li> <li>The <code>henv.execute_repo_config_code(\"func\")</code> layer here is also completely     removed in favor of direct access to the config either through the interface     from <code>hserver</code> (for server related config) or <code>repo_config_utils</code> (for repo     related config)</li> <li>Some config variables are also moved between <code>repo_config</code> and <code>hserver</code> for     better organization and reflection of their purposes</li> <li>The <code>IS_SUPER_REPO</code> variable is renamed to <code>USE_HELPERS_AS_NESTED_MODULE</code>     for better clarity</li> <li>Files with identical content are replaced with symbolic links to their     counterparts in the //helpers</li> </ul> </li> </ul>"},{"location":"tools/dev_system/all.transition_to_repo_config_yml.how_to_guide.html#patching_up_an_existing_repo","title":"Patching up an existing repo","text":"<ul> <li> <p>Copy the new <code>repo_config.yml</code> template from //helpers</p> <pre><code>cp ./helpers_root/repo_config.yaml .\n# Modify the values to match the setting in the current `repo_config.py`\n</code></pre> </li> <li> <p>Remove the old <code>repo_config.py</code> file</p> <pre><code>&gt; rm repo_config.py\n</code></pre> </li> <li> <p>Copy the updated <code>setenv.sh</code> script from //helpers</p> <pre><code>cp ./helpers_root/dev_scripts_helpers/thin_client/setenv.sh ./dev_scripts_cmamp/thin_client/setenv.sh\n</code></pre> </li> <li> <p>Replace <code>setenv.sh</code> file with symoblic link reference to the file in //helpers</p> <ul> <li>Except for when amp is the first level submodule (instead of //helpers). See     CmampTask11623<ul> <li>TODO (heanh): Generalize amp path resolution in setenv.sh when amp is the     first level submodule (CmampTask11623)</li> </ul> </li> </ul> <pre><code>python3 ./helpers_root/helpers/create_links.py --src_dir ./helpers_root/dev_scripts_helpers/thin_client --dst_dir ./dev_scripts_cmamp/thin_client --replace_links --use_relative_paths\n</code></pre> </li> <li> <p>Replace all references of <code>henv.execute_repo_config_code</code> and <code>rconf</code> to their     corresponding functions in either <code>hrecouti.get_repo_config()</code> or <code>hserver</code></p> <ul> <li>For example,<ul> <li><code>rconf.get_docker_base_image_name()</code> -&gt;     <code>hrecouti.get_repo_config().get_docker_base_image_name()</code></li> <li><code>henv.execute_repo_config_code(\"get_html_bucket_path()\")</code> -&gt;     <code>hrecouti.get_repo_config().get_html_bucket_path()</code></li> <li><code>henv.execute_repo_config_code(\"is_CK_S3_available()\")</code> -&gt;     <code>hserver.is_CK_S3_available()</code></li> </ul> </li> <li>While the following script helps automate the replacement, it's worth to     double check that all the references are correctly replaced.     <pre><code>&gt; ./helpers_root/dev_scripts_helpers/cleanup_scripts/HelpersTask88_Improve_repo_config.sh\n</code></pre></li> <li>Import statements in the modified files will need to be added or updated as     well</li> </ul> </li> <li> <p>Rename <code>IS_SUPER_REPO</code> to <code>USE_HELPERS_AS_NESTED_MODULE</code></p> <ul> <li>While the following script helps automate the replacement, it's worth to     double check that all the references are correctly replaced.     <pre><code>&gt; ./helpers_root/dev_scripts_helpers/cleanup_scripts/HelpersTask135_Rename_IS_SUPER_REPO_var.sh\n</code></pre></li> </ul> </li> <li> <p>Replace identical files with symbolic links to their counterparts in //helpers     <pre><code>python3 ./helpers_root/helpers/create_links.py --src_dir ./helpers_root/ --dst_dir . --replace_links --use_relative_paths\n</code></pre></p> </li> </ul>"},{"location":"tools/docker/all.develop_in_helpers.how_to_guide.html","title":"All.develop in helpers.how to guide","text":""},{"location":"tools/docker/all.develop_in_helpers.how_to_guide.html#using_the_helpers_docker_image","title":"Using the <code>helpers</code> Docker image","text":"<ul> <li>We use Docker to encapsulate dependencies and maintain a reproducible     environment</li> </ul>"},{"location":"tools/docker/all.develop_in_helpers.how_to_guide.html#set_up_and_activate_the_thin_environment","title":"Set up and activate the thin environment","text":"<ul> <li> <p>Build the thin environment to bootstrap the development system (e.g., for     using invoke). Run once for all clients; re-running is only needed when the     dependencies are changed.</p> <pre><code>&gt; ./dev_scripts_helpers/thin_client/build.py\n</code></pre> </li> <li> <p>To activate the thin environment, run</p> <pre><code>&gt; source dev_scripts_helpers/thin_client/setenv.sh\n</code></pre> <p>or start a tmux session, which will activate it automatically:</p> <pre><code>&gt; dev_scripts_helpers/thin_client/tmux.py --index 1\n</code></pre> </li> </ul>"},{"location":"tools/docker/all.develop_in_helpers.how_to_guide.html#releasing_docker_image","title":"Releasing Docker image","text":"<ul> <li>This flow is used only by the maintainers of the Docker container</li> </ul>"},{"location":"tools/docker/all.develop_in_helpers.how_to_guide.html#pull_docker_images_from_ecr","title":"Pull docker images from ECR","text":"<ul> <li> <p>Pull images from ECR for development purposes:</p> <pre><code>&gt; i docker_pull -s dev\n</code></pre> </li> <li> <p>For production purposes:</p> <pre><code>&gt; i docker_pull -s prod\n</code></pre> </li> </ul>"},{"location":"tools/docker/all.develop_in_helpers.how_to_guide.html#build_and_release_a_new_image_only_for_maintainers","title":"Build and release a new image (only for maintainers)","text":"<ul> <li> <p>To build a local image (e.g. for testing the changes locally), run</p> <pre><code>&gt; i docker_build_local_image --version ${version}\n</code></pre> </li> <li> <p>To bash into the local image, run</p> <pre><code>&gt; i docker_bash --stage local --version ${version}\n</code></pre> </li> <li> <p>To run different kinds of tests on a local image, run</p> <pre><code>&gt; i run_fast_tests --stage local --version ${version}\n&gt; i run_slow_tests --stage local --version ${version}\n&gt; i run_superslow_tests --stage local --version ${version}\n</code></pre> </li> <li> <p>To tag the local image as dev, run</p> <pre><code>&gt; i docker_tag_local_image_as_dev --version ${version}\n</code></pre> </li> <li> <p>To push the dev image to ECR, run</p> <pre><code>&gt; i docker_push_dev_image --version ${version}\n</code></pre> </li> <li> <p>To promote the image to prod, run     <pre><code>&gt; i docker_build_prod_image --version ${version}\n&gt; i docker_push_prod_image --version ${version}\n</code></pre></p> </li> </ul>"},{"location":"tools/docker/all.develop_in_helpers.how_to_guide.html#let_people_know","title":"Let people know","text":"<ul> <li> <p>Update the changelog: <code>changelog.txt</code></p> <ul> <li>The changelog should be updated only after the image is released; otherwise     the sanity checks will assert that the release's version is not higher than     the latest version recorded in the changelog.</li> <li>Specify what has changed</li> <li>Pick the release version accordingly - NB! The release version should     consist of 3 digits, e.g. \"1.1.0\" instead of \"1.1\" - We use     semantic versioning convention - For example, adding     a package to the image would mean bumping up version 1.0.0 to 1.0.1</li> </ul> </li> <li> <p>Do a PR with the change including the updated <code>changelog.txt</code></p> </li> <li>Send a message on Slack letting people (especially developers) know that a new     version of the container has been released</li> </ul>"},{"location":"tools/docker/all.develop_in_helpers.how_to_guide.html#poetry","title":"Poetry","text":"<ul> <li>This repo uses poetry for package management</li> <li>Use <code>poetry</code> to<ul> <li>Help resolve dependencies</li> <li>Hard-code all package versions (in <code>poetry.lock</code>) to get reproducible builds</li> <li>Avoid the need for manually updating requirements files</li> <li>Allow an easy distinction between prod &amp; dev dependencies</li> </ul> </li> </ul>"},{"location":"tools/docker/all.develop_in_helpers.how_to_guide.html#poetry_usage_examples","title":"Poetry usage examples","text":"<ul> <li> <p>To create a new virtual env (or reactivate it after it's created):</p> <pre><code>&gt; poetry shell\n</code></pre> </li> <li> <p>To install the requirements locally:</p> <pre><code>&gt; poetry install\n</code></pre> </li> <li> <p>To add a new production dependency or upgrade the dependency:</p> <ul> <li>Edit the <code>devops/docker_build/pyproject.toml</code> with the updated version of     the package or the addition of a new dependency</li> <li> <p>Build a new local image</p> <p><pre><code>&gt; i docker_build_local_image --version ${version}\n</code></pre> - By default, it runs with <code>--poetry-mode=\"update\"</code>, which updates <code>poetry</code>     and upgrades all packages to the latest versions - Alternatively, run with the flag <code>--poetry-mode=\"no_update\"</code> in order to     install packages from the current <code>poetry.lock</code> file without upgrading.     This is useful when the goal is to remove / add / update only a single     package without updating everything     - Bash into the container to check the version of the package</p> <p><pre><code>&gt; i docker_bash --stage local --version ${version}\ndocker &gt; pip freeze | grep &lt;package name&gt;\n</code></pre>     - Run the regressions on the new image and do the release only after the regressions are green</p> <pre><code>&gt; i run_fast_tests --stage local --version ${version}\n&gt; i run_slow_tests --stage local --version ${version}\n&gt; i run_superslow_tests --stage local --version ${version}\n</code></pre> </li> </ul> </li> <li> <p>To update the Python version inside the container:</p> <ul> <li>Update the Python version inside <code>devops/docker_build/pyproject.toml</code></li> <li>If the version mismatch occurs, follow this hacky approach:<ul> <li>Login into the current image</li> <li>Install the specific Python version in it</li> <li>Update poetry inside the container, so that the <code>pyproject.toml</code> and     <code>poetry.lock</code> files are in sync with the latest Python version</li> <li>Build a local image with <code>i docker_build_local_image --version ${version}</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/docker/all.dind_and_sibling_containers.how_to_guide.html","title":"All.dind and sibling containers.how to guide","text":""},{"location":"tools/docker/all.dind_and_sibling_containers.how_to_guide.html#docker-in-docker_dind","title":"Docker-in-docker (dind)","text":"<ul> <li>It is possible to install a Docker engine inside a Docker container so that     one can run Docker container (e.g., OMS or IM) inside an isolated <code>amp</code>     container.</li> <li>The problems with this approach are:<ul> <li>Dind requires to run the external container in privileged mode, which might     not be possible due to security concerns</li> <li>The Docker / build cache is not shared across parent and children     containers, so one needs to pull / build an image every time the outermost     container is restarted</li> </ul> </li> <li>An alternative approach is the \"sibling container\" approach</li> </ul>"},{"location":"tools/docker/all.dind_and_sibling_containers.how_to_guide.html#sibling_container_approach","title":"Sibling container approach","text":"<ul> <li>Refs:<ul> <li>Can I run Docker-in-Docker without using the --privileged flag - Stack Overflow</li> <li>https://jpetazzo.github.io/2015/09/03/do-not-use-docker-in-docker-for-ci/</li> </ul> </li> <li>Often what's really needed is the ability to build / run a container from     another container (e.g., CI or unit test). This can be achieved by mounting     the Docker socket <code>/var/run/docker.sock</code> to the container, so that a container     can talk to Docker Engine.</li> <li>This approach allows reuse of the build cache across the sibling containers.</li> <li>The downside is less isolation from the external container, e.g., spawned     containers can be left hanging or can collide.</li> <li>E.g.,     <pre><code># Run `docker ps` in a container, showing the containers running in the main\ncontainer\n&gt; docker run -ti --rm \\\n            -v /var/run/docker.sock:/var/run/docker.sock \\\n            dindtest \\\n            docker ps\n\n# Start a sibling hello world container:\n&gt; docker run -it --rm \\\n            -v /var/run/docker.sock:/var/run/docker.sock \\\n            dindtest \\\n            docker run -ti --rm hello-world\n</code></pre></li> </ul>"},{"location":"tools/docker/all.dind_and_sibling_containers.how_to_guide.html#connecting_to_postgres_instance_using_sibling_containers","title":"Connecting to Postgres instance using sibling containers","text":"<ul> <li>We can start the Docker container with Postgres as a service from outside the     container.     <pre><code>&gt; (cd oms;  i oms_docker_up -s local)\nINFO: &gt; cmd='/local/home/gsaggese/src/venv/amp.client_venv/bin/invoke oms_docker_up -s local'\nreport_memory_usage=False report_cpu_usage=False\ndocker-compose \\\n--file /local/home/gsaggese/src/sasm-lime4/amp/oms/devops/compose/docker-compose.yml \\\n--env-file /local/home/gsaggese/src/sasm-lime4/amp/oms/devops/env/local.oms_db_config.env \\\nup \\\noms_postgres\nCreating compose_oms_postgres_1 ... done\nAttaching to compose_oms_postgres_1\noms_postgres_1  |\noms_postgres_1  | PostgreSQL Database directory appears to contain a database; Skipping initialization\noms_postgres_1  |\noms_postgres_1  | 2022-05-19 22:57:15.659 UTC [1] LOG:  starting PostgreSQL 13.5 (Debian 13.5-1.pgdg110+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 10.2.1-6) 10.2.1 20210110, 64-bit\noms_postgres_1  | 2022-05-19 22:57:15.659 UTC [1] LOG:  listening on IPv4 address \"0.0.0.0\", port 5432\noms_postgres_1  | 2022-05-19 22:57:15.659 UTC [1] LOG:  listening on IPv6 address \"::\", port 5432\noms_postgres_1  | 2022-05-19 22:57:15.663 UTC [1] LOG:  listening on Unix socket \"/var/run/postgresql/.s.PGSQL.5432\"\noms_postgres_1  | 2022-05-19 22:57:15.670 UTC [25] LOG:  database system was shut down at 2022-05-19 22:56:50 UTC\noms_postgres_1  | 2022-05-19 22:57:15.674 UTC [1] LOG:  database system is ready to accept connections\n</code></pre></li> <li>Note that Postgres needs to be</li> <li>Start a container able to</li> <li>From inside a container I launch postgres through the /var/...     <pre><code>&gt; docker ps | grep postgres\nCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES\n83bba0818c74 postgres:13 \"docker-entrypoint.s...\" 6 minutes ago Up 6 minutes\n0.0.0.0:5432-&gt;5432/tcp compose-oms_postgres-1\n</code></pre></li> <li>Test connection to the DB from outside the container     <pre><code>&gt; psql --host=cf-spm-dev4 --port=5432 --user aljsdalsd -d oms_postgres_db_local\nPassword for user aljsdalsd:\npsql (9.5.25, server 13.5 (Debian 13.5-1.pgdg110+1))\nWARNING: psql major version 9.5, server major version 13.\n                Some psql features might not work.\nType \"help\" for help.\noms_postgres_db_local=#\n</code></pre></li> <li>Test connection to the DB from inside the container     <pre><code>&gt; psql --host=cf-spm-dev4 --port=5432 --user aljsdalsd -d oms_postgres_db_local\n...\n</code></pre></li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html","title":"All.docker.tutorial","text":""},{"location":"tools/docker/all.docker.tutorial.html#docker","title":"Docker","text":""},{"location":"tools/docker/all.docker.tutorial.html#introduction","title":"Introduction","text":"<ul> <li>Docker is an open-source tool designed to make our life typically easier     (although it takes energy and time to master) when creating, building,     deploying, and running software applications.</li> <li>Docker can package an application and its dependencies in a virtual container     that can run on any Linux, Windows, or macOS computer.</li> <li>Our Docker containers have everything required (e.g. OS packages, Python     packages) inside to run certain applications/code.</li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#concepts","title":"Concepts","text":""},{"location":"tools/docker/all.docker.tutorial.html#docker_image","title":"Docker image","text":"<ul> <li>A Docker image is a read-only template with instructions for creating a Docker     container</li> <li>Typically a Docker image includes needed libraries and packages and their     versions</li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#dockerfile","title":"Dockerfile","text":"<ul> <li>A <code>Dockerfile</code> is a text document that contains all the commands to call on     the command line to assemble an image. E.g.     <code>//cmamp/devops/docker_build/dev.Dockerfile</code>.</li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#docker_container","title":"Docker container","text":"<ul> <li>A Docker container is a runnable instance of an image. One can run code inside     a Docker container having all requirements installed.</li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#docker_registry","title":"Docker registry","text":"<ul> <li>A Docker registry stores Docker images. In other words, Docker registry for     docker images is like GitHub for code.</li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#poetry","title":"Poetry","text":"<ul> <li>Poetry is a tool for managing Python packages and dependencies and allows to:<ul> <li>List packages you want to install with some constraints<ul> <li>E.g., <code>pandas</code> must be above 1.0 in <code>devops/docker_build/pyproject.toml</code></li> </ul> </li> <li>Given a list of packages you need to install to get the desired environment,     <code>poetry</code> \"optimizes\" the package versions and generate     <code>devops/docker_build/poetry.lock</code>, which contains the list of versions of     the packages to install</li> <li>If there is a new version of a package re-running <code>poetry</code> might give you an     updated list of packages to install</li> </ul> </li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#build_a_docker_image","title":"Build a Docker image","text":""},{"location":"tools/docker/all.docker.tutorial.html#general","title":"General","text":"<ul> <li> <p>A docker image is built from a <code>Dockerfile</code>. The image is then used to run a     Docker container.</p> <p></p> </li> <li> <p>There is <code>/devops</code> dir under a project's dir that contains Docker-related     files, e.g. <code>cmamp/devops</code></p> </li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#base_image","title":"Base image","text":"<ul> <li>A <code>Dockerfile</code> should start with specifying a base image.</li> <li>The base image is an image that a new image is built on top of. A new Docker     image will have all the packages/dependencies that are installed in the base     image.</li> <li>Use <code>FROM</code> statement to specify a base image, e.g.     <pre><code>FROM ubuntu:20.4\n</code></pre></li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#copy_files","title":"Copy files","text":"<ul> <li>Copy files that are required to build a Docker image to the Docker filesystem</li> <li>To copy a file from <code>/source_dir</code> (your filesystem) to <code>/dst_dir</code> (Docker     filesystem) do:     <pre><code>COPY source_dir/file dst_dir\n</code></pre></li> <li>E.g., the command below will copy <code>install_packages.sh</code> from     <code>devops/docker_build</code> to the Docker's root directory so that     <code>install_packages.sh</code> can be accessed by Docker     <pre><code>COPY devops/docker_build/install_packages.sh .\n</code></pre></li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#install_os_packages","title":"Install OS packages","text":"<ul> <li>Install OS packages that are needed for a Docker app, but that are not     installed for a base image</li> <li>Use <code>RUN</code> instruction to install a package, e.g.     <pre><code>RUN apt-get install postgresql-client\n</code></pre></li> <li>Alternatively you can package all installation instructions in a <code>.sh</code> file     and run it. Do not forget to copy a <code>.sh</code> file to the Docker filesystem so     that Docker can see it. E.g.,     <pre><code>COPY devops/docker_build/install_packages.sh .\nRUN /bin/sh -c \"./install_packages.sh\"\n</code></pre></li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#install_python_packages","title":"Install Python packages","text":"<ul> <li>We prefer to install Python packages with <code>poetry</code></li> <li>Make sure that there is instruction to install <code>pip3</code> and <code>poetry</code>. You can     either put it in a <code>Dockerfile</code> or in a separate file like     <code>install_packages.sh</code>.     <pre><code>RUN apt-get install python3-pip\nRUN pip3 install poetry\n</code></pre></li> <li>Copy poetry-related files to the Docker filesystem so that files can be     accessed by Docker     <pre><code>COPY devops/docker_build/poetry.toml\nCOPY devops/docker_build/poetry.lock\n</code></pre></li> <li>Install Python packages     <pre><code>RUN poetry install\n</code></pre></li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#build_an_image_from_a_dockerfile","title":"Build an image from a Dockerfile","text":"<ul> <li>To build an image from a <code>Dockerfile</code> run:     <pre><code>&gt; docker build .\n</code></pre></li> <li>The <code>Dockerfile</code> must be called <code>Dockerfile</code> and located in the root of the     build context</li> <li>You can point to any <code>Dockerfile</code> by using <code>-f</code>:     <pre><code>&gt; docker build -f /path/to/dockerfile\n</code></pre></li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#run_multi-container_docker_application","title":"Run multi-container Docker application","text":"<ul> <li>Docker Compose is a tool for defining and running multi-container Docker     applications</li> <li> <p>With Docker Compose you use a <code>YAML</code> file to configure your application's     services</p> <p></p> </li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#version","title":"Version","text":"<ul> <li>At the beginning of a <code>docker-compose.yaml</code> file specify the <code>docker-compose</code>     version. For more information see     the official documents <pre><code>version: \"3.0\"\n</code></pre></li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#images","title":"Images","text":"<ul> <li>You can either re-use a public image or build a new one from a <code>Dockerfile</code></li> <li>The <code>app</code> service below uses the image that is built from the <code>dev.Dockerfile</code> <pre><code>app:\n    build:\n        context: .\n        dockerfile: dev.Dockerfile\n</code></pre></li> <li>The <code>im_postgres_local</code> service below uses the public <code>postgres</code> image pulled     from the Docker hub registry <pre><code>im_postgres_local:\n    image: postgres: 13\n</code></pre></li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#bind_mount","title":"Bind mount","text":"<ul> <li>If you want to be able to share files between the host and a Docker container,     you should bind-mount a directory</li> <li>E.g. mount current directory to <code>/app</code> dir inside a Docker container:     <pre><code>app:\n    volumes:\n        - .:/app\n</code></pre></li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#environment_variables","title":"Environment variables","text":"<ul> <li>You can either use variables directly from the environment or pass them in a     <code>docker-compose.yaml</code> file</li> <li>It is supposed that <code>POSTGRES_VERSION</code> is already defined in the shell.     <pre><code>db:\n    image: \"postgres:${POSTGRES_VERSION}\"\n</code></pre></li> <li>Set environment variable in a service's container     <pre><code>db:\n    environment:\n        - POSTGRES_VERSION=13\n        image: \"postgres:${POSTGRES_VERSION}\"\n</code></pre></li> <li>Set environment variable with <code>.env</code> file     <pre><code>db:\n    env_file:\n        - ./postgres_env.env\n        image: \"postgres:${POSTGRES_VERSION}\"\n</code></pre></li> <li>File <code>postgres_env.env</code> <pre><code>&gt; cat ./postgres_env.env\nPOSTGRES_VERSION=13\n</code></pre></li> </ul>"},{"location":"tools/docker/all.docker.tutorial.html#basic_commands","title":"Basic commands","text":"<ul> <li> <p>To check more advanced usage, please see     the official documentation.</p> </li> <li> <p>Let's assume that the <code>docker-compose.yaml</code> file is located in the current dir</p> <pre><code># Build, (re)create, start, and attach to containers for a service.\n&gt; docker-compose up\n\n# List containers\n&gt; docker-compose ps\n\n# Stop containers created with `up`\n&gt; docker-compose down\n</code></pre> </li> </ul>"},{"location":"tools/docker/all.dockerhub.how_to_guide.html","title":"All.dockerhub.how to guide","text":""},{"location":"tools/docker/all.dockerhub.how_to_guide.html#dockerhub","title":"Dockerhub","text":""},{"location":"tools/docker/all.dockerhub.how_to_guide.html#login_dockerhub","title":"Login Dockerhub","text":"<p>https://hub.docker.com/</p> <p>Username: sorrentum Email: gp@crypto-kaizen.com</p> <p>There are several public images</p> <ul> <li>Sorrentum/cmamp</li> </ul> <p>Used in DATA605:</p> <ul> <li>Sorrentum/sorrentum</li> <li>Sorrentum/defi</li> <li>Sorrentum/jupyter</li> </ul> <p>The page corresponding to the Sorrentum repo is https://hub.docker.com/u/sorrentum</p>"},{"location":"tools/docker/all.dockerhub.how_to_guide.html#login_through_cli","title":"Login through CLI","text":"<p>docker login --username sorrentum --password XYZ</p>"},{"location":"tools/docker/all.dockerhub.how_to_guide.html#list_all_the_images","title":"List all the images","text":"<ul> <li>Without authentication <pre><code>&gt; curl -s \"https://hub.docker.com/v2/repositories/sorrentum/?page_size=100\" | jq '.results|.[]|.name'\n\"sorrentum\"\n\"cmamp\"\n\"jupyter\"\n\"defi\"\n</code></pre></li> </ul>"},{"location":"tools/docker/all.dockerhub.how_to_guide.html#rename_an_image","title":"Rename an image","text":"<p>docker pull yourusername/oldimagename:tag docker tag yourusername/oldimagename:tag yourusername/newimagename:tag docker push yourusername/newimagename:tag</p> <ul> <li>To delete the old image you need to go through the GUI</li> </ul>"},{"location":"tools/docker/all.dockerized_flow.explanation.html","title":"All.dockerized flow.explanation","text":""},{"location":"tools/docker/all.dockerized_flow.explanation.html#dockerized_executable_flow","title":"Dockerized Executable Flow","text":""},{"location":"tools/docker/all.dockerized_flow.explanation.html#the_concept_of_dockerized_executables","title":"The concept of \"dockerized\" executables","text":"<ul> <li> <p>The objective of \"dockerized\" executables is to execute software applications     (e.g., <code>prettier</code>, LaTeX, <code>pandoc</code>) within a Docker container with all the     needed dependencies</p> </li> <li> <p>This approach eliminates the need for installing these applications directly on     the host system, in a virtual environment, or within a development container</p> </li> <li> <p>In other words, instead of install and execute <code>prettier</code> on the host     <pre><code>&gt; install prettier\n&gt; prettier ...cmd opts...\n</code></pre>     you want to run it in a container with minimal changes to the system call:     <pre><code>&gt; dockerized_prettier ...cmd opts...\n</code></pre></p> </li> </ul>"},{"location":"tools/docker/all.dockerized_flow.explanation.html#templates","title":"Templates","text":"<ul> <li> <p>There are two template for dockerized scripts:</p> <ul> <li><code>/dev_scripts_helpers/dockerize/dockerized_template.py</code></li> <li><code>/dev_scripts_helpers/dockerize/dockerized_template.sh</code></li> </ul> </li> <li> <p>As always, prefer to use the Python approach, instead of shell scripts</p> </li> </ul>"},{"location":"tools/docker/all.dockerized_flow.explanation.html#examples_of_dockerized_executables","title":"Examples of Dockerized Executables","text":"<ul> <li> <p>We support several dockerized executables</p> <ul> <li><code>prettier</code></li> <li><code>pandoc</code></li> <li><code>markdown-toc</code></li> <li><code>plantuml</code></li> <li><code>mermaid</code></li> <li>Latex</li> <li><code>llm_transform</code> (which relies on <code>helpers/hllm.py</code>)</li> </ul> </li> <li> <p>Examples of dockerized Python scripts are:</p> <ul> <li><code>/dev_scripts_helpers/llms/llm_transform.py</code><ul> <li>Run a Python script using <code>helpers</code> in a container with <code>openai</code> packages</li> </ul> </li> <li><code>/dev_scripts_helpers/documentation/dockerized_prettier.py</code><ul> <li>Run <code>prettier</code> in a container</li> </ul> </li> <li><code>/dev_scripts_helpers/documentation/convert_docx_to_markdown.py</code><ul> <li>Run <code>pandoc</code> in a container</li> </ul> </li> </ul> </li> <li> <p>You can find all the Python dockerized executable with:     <pre><code>&gt; ffind.py dockerized | grep py\n./dev_scripts_helpers/dockerize/dockerized_template.py\n./dev_scripts_helpers/documentation/dockerized_graphviz.py\n./dev_scripts_helpers/documentation/dockerized_latex.py\n./dev_scripts_helpers/documentation/dockerized_mermaid.py\n./dev_scripts_helpers/documentation/dockerized_pandoc.py\n./dev_scripts_helpers/documentation/dockerized_prettier.py\n./dev_scripts_helpers/documentation/dockerized_tikz_to_bitmap.py\n./dev_scripts_helpers/documentation/test/test_dockerized_pandoc.py\n./dev_scripts_helpers/documentation/test/test_dockerized_prettier.py\n./dev_scripts_helpers/github/dockerized_invite_gh_contributors.py\n./dev_scripts_helpers/github/dockerized_sync_gh_issue_labels.py\n...\n./linters/dockerized_ty.py\n</code></pre></p> </li> <li> <p>Examples of dockerized shell scripts are:</p> <ul> <li><code>/dev_scripts_helpers/documentation/lint_latex.sh</code></li> <li><code>/dev_scripts_helpers/documentation/latexdockercmd.sh</code></li> <li><code>/dev_scripts_helpers/documentation/run_latex.sh</code></li> <li>TODO(gp): Convert the scripts in Python and remove these</li> </ul> </li> </ul>"},{"location":"tools/docker/all.dockerized_flow.explanation.html#directory_and_module_structure","title":"Directory and Module Structure","text":""},{"location":"tools/docker/all.dockerized_flow.explanation.html#core_infrastructure_modules","title":"Core Infrastructure Modules","text":"<ul> <li> <p><code>helpers/hdocker.py</code></p> <ul> <li>Core Docker infrastructure module providing low-level Docker operations:<ul> <li>Container lifecycle management (build, run, remove)</li> <li>Image building and caching with content-based hashing</li> <li>Path conversion between host and container filesystems</li> <li>Mount point configuration for different container types (children vs     sibling)</li> <li>Architecture compatibility checking</li> </ul> </li> <li>Contains generic utilities that work with any Docker container</li> <li>Examples: <code>build_container_image()</code>,     <code>convert_caller_to_callee_docker_path()</code>, <code>get_docker_mount_info()</code></li> </ul> </li> <li> <p><code>helpers/hdockerized_executables.py</code></p> <ul> <li>High-level wrappers for specific external tools (prettier, pandoc, latex,     mermaid, etc.)</li> <li>Uses <code>hdocker.py</code> functions to run tools inside Docker containers</li> <li>Handles tool-specific requirements:<ul> <li>Custom Dockerfiles for each tool</li> <li>Command-line argument parsing and conversion</li> <li>Input/output file path mapping</li> <li>Tool-specific configuration options</li> </ul> </li> <li>Contains functions like <code>run_dockerized_prettier()</code>,     <code>run_dockerized_pandoc()</code>, <code>run_dockerized_latex()</code></li> </ul> </li> </ul>"},{"location":"tools/docker/all.dockerized_flow.explanation.html#script_architecture_pattern","title":"Script Architecture Pattern","text":"<p>The dockerized executable pattern follows a three-layer architecture:</p> <ol> <li>Entry Point Scripts (<code>XYZ.py</code>)</li> <li>User-facing command-line interface</li> <li>Handles argument parsing and validation</li> <li>Calls the appropriate dockerized function from <code>hdockerized_executables.py</code></li> <li> <p>Examples: </p> <ul> <li><code>dev_scripts_helpers/llms/llm_transform.py</code></li> <li><code>dev_scripts_helpers/documentation/dockerized_prettier.py</code></li> </ul> </li> <li> <p>Dockerized Wrapper Functions</p> </li> <li>Located in <code>helpers/hdockerized_executables.py</code></li> <li>Manages Docker container execution</li> <li>Converts file paths between host and container contexts</li> <li> <p>Examples: <code>run_dockerized_prettier()</code>, <code>run_dockerized_pandoc()</code></p> </li> <li> <p>Core Business Logic (Optional)</p> </li> <li>Complex functionality can be separated into dedicated helper modules</li> <li>Examples: <ul> <li>Image extraction logic in <code>helpers/hjupyter.py</code></li> <li>LLM operations in <code>helpers/hllm.py</code></li> </ul> </li> </ol>"},{"location":"tools/docker/all.dockerized_flow.explanation.html#file_naming_conventions","title":"File Naming Conventions","text":"<ul> <li><code>dockerized_XYZ.py</code>: Scripts that run inside containers (deprecated pattern)</li> <li><code>XYZ.py</code>: User entry points that invoke dockerized functions</li> <li><code>run_dockerized_XYZ()</code>: Functions in <code>hdockerized_executables.py</code> that manage container execution</li> </ul>"},{"location":"tools/docker/all.dockerized_flow.explanation.html#running_a_dockerized_executable","title":"Running a Dockerized executable","text":""},{"location":"tools/docker/all.dockerized_flow.explanation.html#children-_vs_sibling-container","title":"Children- vs Sibling-container","text":"<ul> <li> <p>There are several scenarios when one needs to run a dockerized executable     inside another docker container</p> <ul> <li>E.g., run an executable which has system and package dependencies:<ul> <li>in the thin environment, outside of a dev container</li> <li>inside the dev container while developing</li> <li>as part of unit testing (both CI and not CI)</li> </ul> </li> </ul> </li> <li> <p>In this case we need to use one of the following approaches:</p> <ul> <li>Children-container (aka Docker-in-Docker)<ul> <li>Run a Docker container inside another container</li> <li>It requires elevated privileges</li> </ul> </li> <li>Sibling-container:<ul> <li>More efficient and secure compared to children container approach</li> <li>It comes with greater usage restrictions</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/docker/all.dockerized_flow.explanation.html#bind_mounting_a_directory_for_dockerized_executables","title":"Bind Mounting a Directory for Dockerized Executables","text":"<ul> <li>Files that needs to be processed by dockerized executables needs to be visible     and referred to in the file system of the dockerized executable</li> <li> <p>So we need to convert them to paths that are valid inside the filesystem of the     new Docker container</p> </li> <li> <p>Problem: There are multiple scenarios to consider</p> <ul> <li> <p>Files can be specified as absolute or relative path in the caller file system</p> </li> <li> <p>We can run a Dockerized executable:</p> <ul> <li>On the host; or</li> <li>Inside a Docker container</li> </ul> </li> <li> <p>The dockerized executables can be run:</p> <ul> <li>As children-container (aka docker-in-docker, dind); or</li> <li>As sibling-container</li> </ul> </li> </ul> </li> <li> <p>Let's consider the problems and how to solve them</p> </li> <li> <p>Children-container</p> <ul> <li>In this case bind mounting a directory does not pose any issues, since the     dockerized executable uses the same filesystem as the hosting container</li> </ul> </li> <li> <p>Sibling-container</p> <ul> <li>The mounted directory must be accessible from the host system</li> <li>For instance, when a local directory is mounted within the container at     <code>/src</code> (which is shared with the host):<ul> <li>The reference name within the container is <code>/src</code>, but the corresponding     name outside on the host system is different</li> <li>This introduces dependencies that can complicate the development     environment</li> <li>For example, the local directory <code>/tmp</code> on the host is not visible from     the development container</li> </ul> </li> </ul> </li> <li> <p>Assumption:</p> <ul> <li><code>src_root</code> and <code>dst_root</code> are the dirs used to bind mount the dockerized     executable</li> <li>For both children-container and sibling-containers we assume that the bind     mount point is from the Git root of the outermost repo to <code>dst_root=/src</code> of     the container</li> <li>In the case of nested containers, the \"style\" of container (i.e., children-     or sibling-) is the same. E.g., we assume that if the external container is     children-container (or sibling), also the internal one is children-container     (or sibling)</li> <li>In the case of sibling-container, we need to use the dir from the host     filesystem to mount a directory</li> <li>In the case of children-container, to mount a directory we can use the dir     from the caller filesystem</li> </ul> </li> <li> <p>Let's consider the 4 scenarios and how filesystems of the caller and called     dockerized executable are mapped onto each other</p> <ol> <li> <p>Caller=host, callee=children-container  <pre><code>caller=host\n\ncallee=docker\n- src_root=//host/users/.../git_root1\n- dst_root=//docker/src\n\n&gt; exec.py -i foo/bar\n&gt; exec.py -i /users/.../git_root1/foo/bar\n&gt; (cd foo; exec.py -i bar)\n\n//host/users/.../git_root1/foo/bar -&gt; /foo/bar -&gt; //docker/src/foo/bar\n</code></pre></p> </li> <li> <p>Caller=host, callee=sibling-container  <pre><code>caller=host\n\ncallee=docker\n- src_root=//host/users/.../git_root1\n- dst_root=//docker/src\n\n&gt; exec.py -i foo/bar\n&gt; exec.py -i /users/.../src/foo/bar\n&gt; (cd foo; exec.py -i bar)\n\n//host/users/.../git_root1/foo/bar -&gt; /foo/bar -&gt; //docker/src/foo/bar\n</code></pre></p> </li> <li> <p>Caller=children-container, callee=children-container  <pre><code>caller=docker1\n- src_root=//host/users/.../git_root1\n- dst_root=//docker1/src\n\ncallee=docker2\n- src_root=//docker1/src (which corresponds to the Git root)\n- dst_root=//docker2/src\n\n&gt; exec.py -i foo/bar\n&gt; exec.py -i /src/foo/bar\n\n//docker1//src/foo/bar -&gt; /foo/bar -&gt; //docker2/src/foo/bar\n</code></pre></p> </li> <li> <p>Caller=sibling-container, callee=sibling-container  <pre><code>caller=docker1\n- src_root=//host/users/.../git_root1\n- dst_root=//docker1/src\n\ncallee=docker2\n- src_root=//host/users/.../git_root1\n- dst_root=//docker2/src\n\n&gt; exec.py -i foo/bar\n&gt; exec.py -i /src/foo/bar\n\n//docker1//src/foo/bar -&gt; /foo/bar -&gt; //docker2/src/foo/bar\n</code></pre></p> </li> </ol> </li> <li> <p>The algorithm is:</p> <ul> <li>Normalize the input path to the caller filesystem (i.e., host or docker1)</li> <li>Compute the path as relative to the mount point of the caller</li> <li>Use the mount point of the caller container</li> </ul> </li> </ul>"},{"location":"tools/docker/all.dockerized_flow.explanation.html#testing_a_dockerized_executable","title":"Testing a dockerized executable","text":"<ul> <li>Testing a dockerized executable can be complex, since in our development     system <code>pytest</code> is executed within a container environment.</li> <li>Thus the dockerized executable needs to be run inside the container running     <code>pytest</code>, rather than executing outside of Docker as it typically would when     called by a user.</li> <li> <p>The layers in this setup are</p> <ul> <li><code>host</code><ul> <li><code>dev container</code><ul> <li><code>pytest</code><ul> <li><code>dockerized executable</code></li> </ul> </li> </ul> </li> </ul> </li> </ul> </li> <li> <p>Existing Approaches:</p> <ul> <li>Approach 1:<ul> <li> <p>Overwrite the entrypoint to wait for an injected file, then run the     container's main command:</p> <p><pre><code>#!/bin/bash\n\n# Wait until a specific file is copied into the container\nwhile [ ! -f \"/path/in/container/ready_file\" ]; do\n    echo \"Waiting for files...\"\n    sleep 1\ndone\n\n# Run the container's main command\nexec \"$@\"\n</code></pre>         - Then write files in the running container     - Approach 2:         - Inject files into the Docker image by creating an additional layer using a Dockerfile: - Build an image with the test files injected. - Execute the test inside the container processing the input file. - Pause the container. - Transfer the output file from the container to the host system. - Terminate the container.</p> </li> </ul> </li> </ul> </li> <li> <p>Preferred Approach: Simulated Usage Testing</p> <p>Instead of modifying the build context or patching the Dockerfile, we prefer to simulate real-world usage by testing the dockerized executable exactly as it will be used in production. This approach involves: - Using the <code>hdocker</code> Module Directly:</p> <pre><code>Run the container using the helper function (e.g.,\nrun_dockerized_notebook_image_extractor()) as-is, without any additional\nfile injection or Dockerfile modifications.\n</code></pre> <ul> <li> <p>Realistic Environment Simulation:</p> <p>The container is executed with its standard entrypoint and configuration, mimicking the actual user invocation.     - Output Verification:</p> <p>After execution, assert the presence and correctness of output files or log messages. If needed, you can verify the file system or container logs to confirm that the expected actions were performed.</p> </li> </ul> <p>Benefits - Simplifies the testing setup by reducing pytest configuration complexity - Ensures that tests mirror the actual behavior of the dockerized executable     in production - Avoids the overhead of additional layers or entrypoint modifications</p> <p>Example: <code>/dev_scripts_helpers/notebooks/test/test_extract_notebook_images.py</code></p> </li> </ul>"},{"location":"tools/docker/all.dockerized_flow.explanation.html#examples","title":"Examples","text":""},{"location":"tools/docker/all.dockerized_flow.explanation.html#example_1_notebook_image_extraction","title":"Example 1: Notebook Image Extraction","text":"<ul> <li> <p>Executable Script:</p> <ul> <li>Location:<code>/dev_scripts_helpers/notebooks/extract_notebook_images.py</code></li> <li>Role: Acts as the entry point for users. It parses command-line arguments     and orchestrates the workflow by invoking Docker operations from the     helpers/<code>hdocker</code> module</li> </ul> </li> <li> <p>Core Functionalities:</p> <ul> <li>Location: <code>helpers/hjupyter</code></li> <li>Role: Contains the logic for extracting images from Jupyter notebooks. This     module implements the actual image extraction process used by the executable     script</li> </ul> </li> <li> <p>Docker Management:</p> <ul> <li>Location: <code>helpers/hdocker</code></li> <li>Role: Encapsulates all Docker-related operations such as building the     container, defining Docker commands, and running the container. This module     provides the function (e.g., <code>run_dockerized_notebook_image_extractor()</code>)     that the executable script calls to execute the image extraction inside a     Docker container</li> </ul> </li> <li> <p>Testing:</p> <ul> <li>Location:     <code>/dev_scripts_helpers/notebooks/test/test_extract_notebook_images.py</code></li> <li>Role: Contains tests for the dockerized executable. The tests simulate     real-world usage by invoking the Docker container using the standard process     defined in <code>helpers/hdocker</code>, and then asserting that the expected output     (such as extracted images) is produced</li> </ul> </li> </ul>"},{"location":"tools/docker/all.dockerized_flow.explanation.html#example_2_llm_transform","title":"Example 2: llm_transform","text":"<p>The example illustrates how the dockerized executable for llm_transform manages file path conversions and container invocation in two different scenarios. Here's a breakdown:</p> <ul> <li> <p>Overview</p> <p>The tool (<code>llm_transform.py</code>) transforms a markdown file based on a given type (here, md_rewrite) and supports two configurations controlled by: - <code>is_caller_host</code>: Determines if the command is initiated from the host. - <code>use_sibling_container_for_callee</code>: Indicates if a sibling container is used     to execute the transformation.</p> </li> <li> <p>How File Paths Are Managed</p> <p>When you run the command, the tool converts file paths from the caller's context (either the host or within a container) to the paths that will be valid inside the target container. For instance: - Input File Conversion: The caller's <code>tmp.llm_transform.in.txt</code> is mapped to     <code>/app/tmp.llm_transform.in.txt</code> in the container - Output File Conversion: Similarly, <code>tmp.llm_transform.out.txt</code> is mapped to     <code>/app/tmp.llm_transform.out.txt</code></p> </li> <li> <p>Script and Directory Conversion: The script located at     <code>/dev_scripts_helpers/llms/dockerized_llm_transform.py</code>     is converted to <code>/app/dev_scripts_helpers/llms/dockerized_llm_transform.py</code> so that it     can be accessed inside the container.</p> </li> <li> <p>Docker Run Command Construction</p> <p>After converting the file paths, the system constructs a docker run command. - For the first scenario (when <code>is_caller_host = True</code>):     - Mounting: The host directory (eg: <code>/Users/saggese/src/helpers1</code>) is         mounted into the container at <code>/app</code>     - Environment and Working Directory: Environment variables (like         <code>OPENAI_API_KEY</code>) are passed, and the working directory is set to <code>/app</code>     - Command Execution:</p> <pre><code>The container then executes the transformed script\n(`/app/dev_scripts_helpers/llms/dockerized_llm_transform.py`) with the converted input\nand output paths and additional flags (e.g.,\n`transformation type -t md_rewrite and verbosity -v DEBUG`).\n</code></pre> <ul> <li>For the second scenario (when <code>is_caller_host = False</code>):<ul> <li>The conversion adjusts for the fact that the command is executed inside     the container.</li> <li>The mount paths and target paths differ (e.g., the container might mount     <code>/app</code> to <code>/src</code>), but the concept remains the same: ensure that the file     paths used in the command correspond correctly to those inside the     container.</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/documentation_toolchain/all.extract_notes.reference.html","title":"All.extract notes.reference","text":""},{"location":"tools/documentation_toolchain/all.extract_notes.reference.html#_1","title":"All.extract notes.reference","text":"<ul> <li> <p>The documentation is:</p> <ul> <li><code>docs/tools/documentation_toolchain/all.extract_notebook_images.how_to_guide.md</code></li> <li><code>docs/tools/documentation_toolchain/all.extract_notebook_images.reference.md</code></li> </ul> </li> <li> <p>This is implemented as a dockerized executables and thus there are two scripts:</p> <ul> <li><code>dev_scripts_helpers/notebooks/extract_notebook_images.py</code><ul> <li>Parses the command line options</li> <li>Create a Docker image with all the dependencies and run it</li> </ul> </li> <li><code>dev_scripts_helpers/notebooks/dockerized_extract_notebook_images.py</code><ul> <li>Instantiate <code>_NotebookImageExtractor</code></li> <li>Run the image extraction</li> </ul> </li> </ul> </li> <li> <p>The testing of the scripts are:</p> <ul> <li><code>dev_scripts_helpers/notebooks/test/test_extract_notebook_images.py</code><ul> <li>Test the end-to-end script with a handcrafted notebook     <code>dev_scripts_helpers/notebooks/test/outcomes/Test_run_dockerized_notebook_image_extractor1.test_run_dockerized_notebook_image_extractor/input/test_notebook_image_extractor.ipynb</code></li> </ul> </li> <li><code>dev_scripts_helpers/notebooks/test/test_dockerized_extract_notebook_images.py</code></li> </ul> </li> </ul>"},{"location":"tools/documentation_toolchain/all.latex_toolchain.how_to_guide.html","title":"All.latex toolchain.how to guide","text":""},{"location":"tools/documentation_toolchain/all.latex_toolchain.how_to_guide.html#definitions","title":"Definitions","text":"<ul> <li> <p>\"Notes\" are <code>txt</code> files in extended markdown that include:</p> <ul> <li>Latex</li> <li>Block comments</li> <li>Calls to external tools, such as <code>mermaid</code>, <code>plantuml</code>, <code>tikz</code>, ...</li> </ul> </li> <li> <p>Notes files can be converted to:</p> <ul> <li>PDF (through a conversion to an intermediate Latex file)</li> <li>Slides (through beamer)</li> <li>HTML</li> <li>Questions / answers (through Anki)</li> </ul> </li> </ul>"},{"location":"tools/documentation_toolchain/all.latex_toolchain.how_to_guide.html#typical_use","title":"Typical Use","text":""},{"location":"tools/documentation_toolchain/all.latex_toolchain.how_to_guide.html#files","title":"Files","text":"<pre><code>&gt; ls -1 dev_scripts_helpers/documentation\n</code></pre> <ul> <li>In the directory <code>//helpers/dev_scripts_helpers/documentation</code><ul> <li><code>convert_docx_to_markdown.py</code><ul> <li>Convert Docx file to markdown using Dockerized <code>pandoc</code> and save the figs     in a directory</li> </ul> </li> <li><code>dockerized_pandoc.py</code><ul> <li>Run <code>pandoc</code> inside a Docker container, building a container if needed</li> <li>Not tested directly but through <code>run_dockerized_pandoc()</code> in     <code>/helpers/test/test_hdocker.py</code></li> </ul> </li> <li><code>dockerized_prettier.py</code><ul> <li>Run <code>prettier</code> inside a Docker container to ensure consistent formatting     across different environments, building a container if needed</li> <li>Not tested directly but through <code>run_dockerized_prettier()</code> in     <code>/helpers/test/test_hdocker.py</code></li> </ul> </li> <li><code>generate_latex_sty.py</code><ul> <li>One-off script to generate the latex file with abbreviations</li> </ul> </li> <li><code>generate_script_catalog.py</code><ul> <li>Generate a markdown file with the docstring for any script in the repo</li> <li>TODO(gp): Unclear what to do with this. This can be a way to create an     index of all the scripts, if we use some consistent docstring</li> </ul> </li> <li><code>lint_txt.py</code><ul> <li>Lint \"notes\" files.</li> <li>Tested by     <code>/dev_scripts_helpers/documentation/test/test_lint_txt.py</code></li> </ul> </li> <li><code>latex_abbrevs.sty</code><ul> <li>Latex macros</li> </ul> </li> <li><code>latexdockercmd.sh</code><ul> <li>Wrapper for Latex docker container</li> <li>TODO(gp): probably obsolete</li> </ul> </li> <li><code>lint_latex.sh</code><ul> <li>Dockerized Linter for Latex using <code>prettier</code></li> <li>TODO(gp): This is the new flow, but it needs to be converted in Python</li> </ul> </li> <li><code>lint_latex2.sh</code><ul> <li>Dockerized Linter for Latex using <code>latexindent.pl</code></li> <li>TODO(gp): This is the old flow</li> </ul> </li> <li><code>notes_to_pdf.py</code><ul> <li>Convert a txt file into a PDF / HTML / slides using <code>pandoc</code></li> </ul> </li> <li><code>open_md_in_browser.sh</code><ul> <li>Render a markdown using <code>pandoc</code> (installed locally) and then open it in a     browser</li> </ul> </li> <li><code>open_md_on_github.sh</code><ul> <li>Open a markdown filename on GitHub</li> </ul> </li> <li><code>pandoc.latex</code><ul> <li><code>latex</code> template used by <code>notes_to_pdf.py</code></li> </ul> </li> <li><code>preprocess_notes.py</code><ul> <li>Convert a notes text file into markdown suitable for <code>notes_to_pdf.py</code></li> </ul> </li> <li><code>notes_to_pdf.py</code><ul> <li>Convert a <code>txt</code> file storing nodes into a PDF / HTML / beamer slides using     <code>pandoc</code></li> </ul> </li> <li><code>open_md_on_github.sh</code><ul> <li>Render a markdown using Pandoc and then open it in a browser.</li> </ul> </li> <li><code>open_md_on_github.sh</code><ul> <li>Open a markdown filename on GitHub.</li> </ul> </li> <li><code>process_md_headers.py</code><ul> <li>Extract headers from a Markdown file and generate a Vim cfile</li> </ul> </li> <li><code>publish_notes.py</code><ul> <li>Publish all notes to a Google dir.</li> </ul> </li> <li><code>render_images.py</code><ul> <li>Replace sections of image code with rendered images, commenting out the     original code, if needed.</li> </ul> </li> <li><code>replace_latex.py</code>, <code>replace_latex.sh</code><ul> <li>Scripts for one-off processing of latex files</li> </ul> </li> <li><code>run_latex.sh</code><ul> <li>Dockerized latex flow</li> <li>TODO(gp): Convert to Python</li> </ul> </li> <li><code>run_pandoc.py</code><ul> <li>Run pandoc on stdin/file to stdout/file.</li> </ul> </li> <li><code>test_lint_latex.sh</code><ul> <li>Run latex Linter and check if the file was modified</li> </ul> </li> <li><code>transform_notes.py</code><ul> <li>Perform one of several transformations on a text file, e.g.,<ol> <li><code>toc</code>: create table of context from the current file, with 1 level</li> <li><code>format</code>: format the current file with 3 levels</li> <li><code>increase</code>: increase level</li> </ol> </li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/documentation_toolchain/all.latex_toolchain.how_to_guide.html#editing_txt_files","title":"Editing <code>Txt</code> Files","text":""},{"location":"tools/documentation_toolchain/all.latex_toolchain.how_to_guide.html#generate_the_summary_of_the_headers","title":"Generate the Summary of the Headers","text":"<ul> <li>In <code>vim</code> <pre><code>:!helpers_root/dev_scripts_helpers/documentation/process_md_headers.py -i % -m 1\nProbability 1\nRandom variables 735\nMathematical expectation of RVs 1161\nInteresting RVs 1803\nProbability inequalities 2124\nStatistical Inference 2194\nStatistical test 3707\n</code></pre></li> <li> <p>This script also generates a <code>vim</code> <code>cfile</code> that can be navigated with <code>vic</code></p> </li> <li> <p>To get the summary up to 2 levels:     <pre><code>:!helpers_root/dev_scripts_helpers/documentation/process_md_headers.py -i % -m 2\n</code></pre></p> </li> </ul>"},{"location":"tools/documentation_toolchain/all.latex_toolchain.how_to_guide.html#format_a_chunk_of_txt_file","title":"Format a Chunk of <code>Txt</code> File","text":"<ul> <li>In vim     <pre><code>:'&lt;,'&gt;!helpers_root/dev_scripts_helpers/llms/llm_transform.py -i - -o - -t md_format\n</code></pre></li> </ul>"},{"location":"tools/documentation_toolchain/all.latex_toolchain.how_to_guide.html#list_possible_llm_transforms","title":"List Possible LLM Transforms","text":"<ul> <li>Use <code>llm_transform.py -t list</code> <pre><code>code_comment\ncode_docstring\ncode_type_hints\ncode_unit_test\ncode_1_unit_test\nmd_rewrite\nmd_format\nslide_improve\nslide_colorize\n</code></pre></li> </ul>"},{"location":"tools/documentation_toolchain/all.latex_toolchain.how_to_guide.html#convert_notes_to_slides","title":"Convert Notes to Slides","text":"<ul> <li>Convert notes to slides:     <pre><code>&gt; notes_to_pdf.py --input lectures_source/Lesson1-Intro.txt --output tmp.pdf -t slides\n</code></pre></li> </ul>"},{"location":"tools/documentation_toolchain/all.latex_toolchain.how_to_guide.html#latex_toolchain","title":"Latex Toolchain","text":""},{"location":"tools/documentation_toolchain/all.latex_toolchain.how_to_guide.html#running_and_linting_latex_files","title":"Running and Linting Latex Files","text":"<ul> <li>We organize each project is in a directory (e.g., under <code>//papers</code>)</li> <li> <p>Under each dir there are several scripts that assign some variables and then     call the main scripts to perform the actual work by calling     <code>run_notes_to_pdf.py</code></p> <ul> <li><code>run_latex.sh</code></li> <li><code>lint_latex.sh</code></li> </ul> </li> <li> <p>Scripts are \"dockerized\" scripts, which build a Docker container with     dependencies and then run use it to process the data</p> </li> <li> <p>To run the Latex flow we assume (as usual) that user runs from the top of the     tree</p> </li> <li> <p>To create the PDF from the Latex files:</p> <pre><code>&gt; papers/DataFlow_stream_computing_framework/run_latex.sh\n...\n</code></pre> </li> <li> <p>To lint the Latex file:     <pre><code>&gt; papers/DataFlow_stream_computing_framework/lint_latex.sh\n...\n&gt; docker run --rm -it --workdir /Users/saggese/src/cmamp1 --mount type=bind,source=/Users/saggese/src/cmamp1,target=/Users/saggese/src/cmamp1 lint_latex:latest sh -c ''\\''./tmp.lint_latex.sh'\\''' papers/DataFlow_stream_computing_framework/DataFlow_stream_computing_framework.tex\npapers/DataFlow_stream_computing_framework/DataFlow_stream_computing_framework.tex 320ms (unchanged)\n</code></pre></p> </li> </ul>"},{"location":"tools/documentation_toolchain/all.notes_to_pdf.explanation.html","title":"All.notes to pdf.explanation","text":""},{"location":"tools/documentation_toolchain/all.notes_to_pdf.explanation.html#flow_explanation","title":"Flow Explanation","text":"<ul> <li>This document walks through the architecture of the <code>notes_to_pdf.py</code> script.</li> </ul>"},{"location":"tools/documentation_toolchain/all.notes_to_pdf.explanation.html#goal","title":"Goal","text":"<ul> <li>Convert a lightweight, annotated plain-text notes file (usually <code>*.txt</code>) into     a share-ready document.<ul> <li>Formats include PDF, HTML, or Beamer slide deck</li> </ul> </li> <li>Ensure the following:<ul> <li>Honor rich Markdown features and custom shorthand.</li> <li>Inline auto-generated diagrams:<ul> <li>PlantUML</li> <li>Mermaid</li> <li>TikZ</li> <li>Graphviz</li> <li>LaTeX tables</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/documentation_toolchain/all.notes_to_pdf.explanation.html#architecture_diagram","title":"Architecture diagram","text":"<pre><code>%%{init: {'theme':'default'}}%%\nC4Context\n\nSystem_Ext(user, \"User\", \"Author preparing course notes\")\nSystem(doc, \"Documentation Toolchain\", \"Python &amp; LaTeX\")\n\nSystem_Boundary(doc_boundary, \"\") {\n    Container(notes2pdf, \"notes_to_pdf.py\", \"Python CLI\", \"Orchestrates conversion: clean -&gt; images -&gt; Pandoc -&gt; LaTeX\")\n    Container(render, \"render_images.py\", \"Python module\", \"Renders diagram blocks to images. Caches results.\")\n    Container(preproc, \"preprocess_notes.py\", \"Python module\", \"Cleans notes &amp; expands macros (pre-Pandoc)\")\n    Container(style, \"latex_abbrevs.sty\", \"LaTeX style\", \"Provides LaTeX math &amp; formatting shortcuts\")\n}\n\nRel(user, notes2pdf, \"Invokes via CLI\")\nRel(notes2pdf, preproc, \"Uses for Note Pre-processing\")\nRel(notes2pdf, render, \"Calls to Render Images\")\nRel(notes2pdf, style, \"Injects LaTeX Style (.sty)\")</code></pre>"},{"location":"tools/documentation_toolchain/all.notes_to_pdf.explanation.html#steps","title":"Steps","text":"<ol> <li> <p>Clean-up &amp; augmentation</p> </li> <li> <p>Performed by: <code>preprocess_notes.py</code></p> </li> <li> <p>Key ideas:</p> <ul> <li>Normalizes headers</li> <li>Expands arrow shorthand (<code>-&gt;</code> to <code>\\rightarrow</code>)</li> <li>Deals with comments</li> <li>Inserts Pandoc YAML front-matter</li> <li>Inserts optional navigation slides</li> </ul> </li> <li> <p>Diagram extraction</p> </li> <li> <p>Performed by: <code>render_images.py</code></p> </li> <li> <p>Key ideas:</p> <ul> <li>Scans code blocks (e.g., ` plantuml)</li> <li>Renders diagrams via Docker containers</li> <li>Replaces the code with <code>![](figs/...)</code> include</li> <li>Comments out the original block</li> <li>Uses a SHA-256 cache to skip unchanged diagrams</li> </ul> </li> <li> <p>Orchestration</p> </li> <li> <p>Performed by: <code>notes_to_pdf.py</code></p> </li> <li> <p>Key ideas:</p> <ul> <li>Calls Stage 1 and Stage 2, then Pandoc, then (for PDF) LaTeX</li> <li>Flags control each sub-action to allow skipping, debugging, or re-running     steps individually</li> </ul> </li> <li> <p>Document synthesis</p> </li> <li> <p>Performed by: Pandoc + LaTeX</p> </li> <li>Key ideas:<ul> <li>Pandoc converts Markdown to LaTeX (or HTML / Beamer)</li> <li><code>latex_abbrevs.sty</code> is copied next to the generated <code>.tex</code> file</li> <li>Ensures vector/matrix macros (<code>\\vv{}</code>, <code>\\mat{}</code>), deep lists, and color     helpers compile correctly</li> </ul> </li> </ol>"},{"location":"tools/documentation_toolchain/all.notes_to_pdf.explanation.html#dependencies","title":"Dependencies","text":""},{"location":"tools/documentation_toolchain/all.notes_to_pdf.explanation.html#preprocess_notespy","title":"<code>preprocess_notes.py</code>","text":"<ul> <li>Input: Raw notes.</li> <li>Output: Pandoc\u2011ready Markdown.</li> <li>Handles<ul> <li>Formatting banner frames.</li> <li>Question formatting.</li> <li>Colour commands (<code>\\red{}</code> -&gt; <code>\\textcolor{red}{...}</code>).</li> <li>TOC injection.</li> </ul> </li> </ul>"},{"location":"tools/documentation_toolchain/all.notes_to_pdf.explanation.html#render_imagespy","title":"<code>render_images.py</code>","text":"<ul> <li>Docker\u2011wrapper around PlantUML, Mermaid CLI, TikZ, Graphviz to convert image     description in a file, replacing the text with the picture.     <code>figs/&lt;basename&gt;.&lt;index&gt;.png</code></li> </ul>"},{"location":"tools/documentation_toolchain/all.notes_to_pdf.explanation.html#latex_abbrevssty","title":"<code>latex_abbrevs.sty</code>","text":"<ul> <li>Custom style for Latex documents, including:<ul> <li>Bold-underlined vectors (<code>\\vv{x}</code>)</li> <li>Matrices</li> <li>Colour presets</li> <li>9-level <code>enumitem</code> lists</li> <li>Symbol shorthands</li> </ul> </li> <li>Copied automatically; you rarely touch this unless you need new macros.</li> </ul>"},{"location":"tools/documentation_toolchain/all.render_images.explanation.html","title":"All.render images.explanation","text":""},{"location":"tools/documentation_toolchain/all.render_images.explanation.html#render_imagespy_tool","title":"<code>render_images.py</code> tool","text":"<ul> <li>The <code>render_images.py</code> tool replaces image code in Markdown/LaTeX files (e.g.,     <code>plantUML</code> or <code>mermaid</code> code for diagrams) with rendered images.</li> <li>Location: <code>dev_scripts_helpers/documentation/render_images.py</code></li> <li>Typical usage to render images in a Markdown file:     <pre><code>&gt; render_images.py -i knowledge_graph/vendors/README.md --action render --run_dockerized\n</code></pre></li> </ul>"},{"location":"tools/documentation_toolchain/all.render_images.explanation.html#how_to_use","title":"How to use","text":"<ol> <li> <p>If you don't include the option <code>--run_dockerized</code>, make sure <code>plantuml</code> and    <code>mermaid</code> are installed on your machine. The easiest way is to use the Docker    container. All the packages typically needed for development are installed in    the container.</p> </li> <li> <p>How to use:    <pre><code>&gt; render_images.py -h\n</code></pre></p> </li> <li> <p>We try to let the rendering engine do its job of deciding where to put stuff     even if sometimes it's not perfect. Otherwise, with any update of the text we     need to iterate on making it look nice: we don't want to do that.</p> </li> <li> <p><code>.md</code> files should be linted by our tools.</p> </li> <li> <p>If you want to use <code>open</code> action, make sure that your machine is able to open    <code>.html</code> files in the browser.</p> </li> </ol>"},{"location":"tools/documentation_toolchain/all.render_images.explanation.html#processing_multiple_files","title":"Processing Multiple Files","text":"<p>The tool supports three ways to process multiple files:</p> <ol> <li>Comma-separated list: Use <code>--files=\"file1.md,file2.md,file3.md\"</code> to specify    multiple files separated by commas.</li> </ol> <pre><code>&gt; render_images.py --files=\"file1.md,file2.md,file3.md\" --action render\n</code></pre> <ol> <li>File containing list: Use <code>--from_files=\"list.txt\"</code> where <code>list.txt</code>    contains one file path per line. Empty lines and lines starting with <code>#</code> are    ignored.</li> </ol> <p>Example <code>list.txt</code>:    <pre><code># Files to render\ndocs/chapter1.md\ndocs/chapter2.md\n\n# More files\ndocs/chapter3.md\n</code></pre></p> <pre><code>&gt; render_images.py --from_files=\"list.txt\" --action render\n</code></pre> <ol> <li>Repeated argument: Use <code>--input</code> multiple times to specify each file.</li> </ol> <pre><code>&gt; render_images.py --input file1.md --input file2.md --input file3.md --action render\n</code></pre> <p>Notes: - When processing multiple files, rendering is always done in-place     - The <code>-o</code> option causes an error when used together with multiple files - The tool shows a progress bar when processing multiple files. - All three methods are mutually exclusive: you can only use one at a time. - The single <code>-i</code> option works for processing one file.</p>"},{"location":"tools/git/all.git.how_to_guide.html","title":"All.git.how to guide","text":""},{"location":"tools/git/all.git.how_to_guide.html#git","title":"Git","text":""},{"location":"tools/git/all.git.how_to_guide.html#git_workflow_and_best_practices","title":"Git workflow and best practices","text":""},{"location":"tools/git/all.git.how_to_guide.html#before_you_start","title":"Before you start","text":"<ul> <li>GitHub is the place where we keep our code</li> <li><code>git</code> is the tool (program) for version control</li> <li>We interact with GitHub via <code>git</code></li> <li>Use public key for authorization<ul> <li>You can add a new public key here     GH -&gt; Personal settings -&gt; SSH keys</li> <li>More details about what is public key you can find in     all.ssh.how_to_guide.md</li> </ul> </li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#readings","title":"Readings","text":"<ul> <li>Read at least the first 3 chapters of     Git book</li> <li>Read about     Git Submodules<ul> <li>We use Git submodules to compose and share code about repos</li> </ul> </li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#workflow","title":"Workflow","text":"<ul> <li> <p>Run <code>git fetch</code> <pre><code># Fetch all the data from origin.\n&gt; git fetch\n\n# List all the branches.\n&gt; git branch -r\norigin/HEAD -&gt; origin/master\norigin/PTask274\n...\n</code></pre></p> </li> <li> <p>Checkout master and pull</p> <ul> <li>You want to branch from the latest version of master to avoid a merge:     <pre><code># Checkout the `master` branch.\n&gt; git checkout master\n\n# Make sure your local `master` is in sync with the remote.\n&gt; git pull --rebase\n</code></pre></li> <li>Alternatively, and especially if you have local changes to move to a new     branch, run     <pre><code>&gt; git checkout master\n&gt; i git_pull\n</code></pre></li> </ul> </li> <li> <p>Name a branch after its corresponding issue</p> <ul> <li>The canonical name for a new feature branch is obtained by running     <code>i gh_issue_title</code>:     <pre><code>&gt; i gh_issue_title -i 274\nINFO: &gt; cmd='/Users/saggese/src/venv/amp.client_venv/bin/invoke gh_issue_title -i 274'\nreport_memory_usage=False report_cpu_usage=False\n## gh_issue_title: issue_id='274', repo_short_name='current'\n## gh_login:\n07:35:54 - INFO  lib_tasks_gh.py gh_login:48                            account='sorrentum'\nexport GIT_SSH_COMMAND='ssh -i /Users/saggese/.ssh/id_rsa.sorrentum.github'\ngh auth login --with-token &lt;/Users/saggese/.ssh/github_pat.sorrentum.txt\n\n# Copied to system clipboard:\nCmTask274_Update_names: https://github.com/sorrentum/sorrentum/pull/274\n</code></pre><ul> <li>Before running verify that GitHub cli <code>gh</code> works     <pre><code>&gt; gh --version\ngh version 2.29.0 (2023-05-10)\nhttps://github.com/cli/cli/releases/tag/v2.29.0\n</code></pre></li> </ul> </li> <li>The name is <code>CmTask274_Update_names</code></li> <li>To use multiple branches for a given task, append a numeral to the name,     e.g., <code>CmTask274_Update_names_v02</code></li> <li>Make sure the names of all your branches follow this format</li> </ul> </li> <li> <p>Create and checkout the branch     <pre><code>&gt; git branch my_feature\n&gt; git checkout my_feature\n</code></pre></p> <ul> <li>Alternatively, you can create and checkout in one command with     <pre><code>&gt; git checkout -b my_feature\n</code></pre></li> <li>From this point on, you commit only in the branch and changes to master will     not affect your branch</li> <li>If the branch already exists, check out the branch by executing     <pre><code>&gt; git checkout my_feature\n</code></pre></li> </ul> </li> <li>Commit your work early and often<ul> <li>Commits on your feature branch do not affect master. Checkpoint your work     regularly by committing:     <pre><code>&gt; git status On branch my_feature\n&gt; git add ...\n&gt; git commit -m \"...\"\n[my_feature 820b296] My feature is awesome!\n</code></pre></li> <li>Commits stay local (not seen on GitHub) until you explicitly tell git to     \"upload\" the commits through git push (see next)</li> </ul> </li> <li>Push your feature branch changes upstream<ul> <li>When you commit, commits are local (not seen on GitHub)</li> <li>When you want your code to be pushed to the server (e.g., to back up or to     share the changes with someone else), you need to push the branch upstream     <pre><code>&gt; git push -u origin my_feature\n...\n30194fc..820b296  my_feature -&gt; my_feature\nBranch 'my_feature' set up to track remote branch 'my_feature' from 'origin'.\n</code></pre></li> <li>Note that <code>-u</code> tells git to set the upstream of this branch to origin</li> <li>This operation is needed only the first time you create the branch and not     for each <code>git push</code></li> </ul> </li> <li>Merge <code>master</code> into your feature branch regularly<ul> <li>Merge <code>master</code> into your feature branch at least once a day, if the branch     stays around that long:     <pre><code># Get the .git from the server\n&gt; git fetch\n# Make your master up to origin/master.\n&gt; git checkout master\n&gt; git pull\n# Merge master into my_feature branch.\n&gt; git checkout my_feature\n&gt; git merge master\n</code></pre></li> <li>A simpler flow which should be equivalent<ul> <li>TODO(gp): Verify that     <pre><code># Get the .git from the server\n&gt; git fetch\n# Merge master into my_feature branch.\n&gt; git checkout my_feature\n&gt; git merge origin/master\n</code></pre></li> </ul> </li> </ul> </li> <li>Request a review of your work by making a pull request (PR)<ul> <li>Verify that your work is ready for a review by going through this checklist:<ul> <li>The PR is self-contained</li> <li>The latest <code>master</code> has been merged into the feature branch</li> <li>All files in the PR have been linted with our Linter tool     (<code>i lint --files=\"...\"</code>)</li> <li>All tests pass</li> </ul> </li> <li>If your work is ready for review, make a pull request<ul> <li>Use the GitHub UI (for now; we may replace with a script). Go to the     branch on the web interface and push \"Compare &amp; pull request\"</li> <li>Assign appropriate people as reviewers (when in doubt, ask your team lead)</li> </ul> </li> <li>Follow up on all comments and mark as resolved any requested changes that     you resolve</li> </ul> </li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#best_practices","title":"Best Practices","text":""},{"location":"tools/git/all.git.how_to_guide.html#do_not_check_in_large_data_files","title":"Do not check in large data files","text":"<ul> <li>Avoid checking in large data files<ul> <li>The reason is that large files bloat the repo</li> <li>Once a large file is checked in, it never goes away</li> <li>Therefore, DO NOT CHECK IN DATA FILES IN EXCESS OF 500K</li> <li>If in doubt (even on a branch), ask first!</li> </ul> </li> <li>Sometimes is makes sense to check in some representative data for unit tests</li> <li>BUT, larger tests should obtain their data from s3 or MongoDB</li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#write_helpful_commit_messages","title":"Write helpful commit messages","text":"<ul> <li>Use short but informative commit messages - this eases navigation for yourself     and reviewers<ul> <li>A good commit message follows the format     <code>IssueTag: High-level commit description</code></li> <li>E.g. <code>HelpersTask123: Add filtering for the inputs</code></li> <li>Do not make commit messages too long</li> <li>Do not mention the file that the commit has updated in the commit message -     it's already clear from the commit itself</li> </ul> </li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#branch_workflow_best_practices","title":"Branch workflow best practices","text":""},{"location":"tools/git/all.git.how_to_guide.html#branches_are_cheap","title":"Branches are cheap","text":"<ul> <li>One of the advantages of working with Git is that branches are cheap</li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#master_is_sacred","title":"<code>master</code> is sacred","text":"<ul> <li>In an ideal world <code>master</code> branch is sacred (see Platinum rule of Git)<ul> <li>Development should never be done directly on master</li> <li>Changes to master should only happen by pull-request or merge</li> <li>One should avoid working in master except in rare cases, e.g., a simple     urgent bug-fix needed to unblock people</li> <li><code>master</code> should never be broken (\"green build\": all tests are passing and it     is deployable)</li> </ul> </li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#always_work_in_a_branch","title":"Always work in a branch","text":"<ul> <li>Generally it is best to be the sole contributor to your branch<ul> <li>If you need to collaborate with somebody on a branch, remember that the     golden rule of rebase still applies to this \"public\" branch: \"do not rebase     pushed commits\"</li> </ul> </li> <li>It is ok to open multiple branches for a given task if needed<ul> <li>E.g., if you have multiple chunks of work or multiple people are working on     orthogonal changes</li> <li>It might be that the task is too big and needs to be broken in smaller bugs</li> </ul> </li> <li>All the rules that apply to <code>master</code> apply also to a branch<ul> <li>E.g., commit often, use meaningful commit messages.</li> <li>We are ok with a little looser attitude in your branch</li> <li>E.g., it might be ok to not run unit tests before each commit, but be     careful!</li> </ul> </li> <li>Use a branch even if working on a research notebook<ul> <li>Try to avoid modifying notebooks in multiple branches simultaneously, since     notebook merges can be painful</li> <li>Working in a branch in this case facilitates review</li> <li>Working in a branch protects the codebase from accidental pushes of code     changes outside of the notebook (e.g., hacks to get the notebook working     that need to be cleaned up)</li> </ul> </li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#keep_different_changes_in_separate_branches","title":"Keep different changes in separate branches","text":"<ul> <li>It is easier for you to keep work sane and separated</li> <li>Cons of multiple conceptual changes in the same branches</li> <li>You are testing / debugging all at once which might make your life more     difficult</li> <li>Reviewing unrelated changes slows down the review process</li> <li>Packaging unrelated changes together that means no change gets merged until     all of the changes are accepted</li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#pull_request_pr_best_practices","title":"Pull request (PR) best practices","text":"<ul> <li>Make sure your PR is coherent<ul> <li>It may not need to do everything the Task requires, but the PR should be     self-contained and not break anything</li> </ul> </li> <li>If you absolutely need changes under review to keep going, create the new     branch from the old branch rather than from master (less ideal)<ul> <li>Try to avoid branching from branches<ul> <li>This creates dependencies on the order of committing branches</li> <li>You end up with a spiderweb of branches</li> </ul> </li> </ul> </li> <li>Frequent small PRs are easier to review<ul> <li>You will also experience faster review turnaround</li> <li>Reviewers like working on smaller changes more than working on larger ones</li> <li>PR review time does not scale linearly with lines changed (may be more like     exponential)</li> </ul> </li> <li>Merging changes frequently means other people can more easily see how the code     is progressing earlier on in the process, and give you feedback<ul> <li>E.g., \"here is a much simpler way of doing this\", or even better \"you don't     need to write any code, just do \" <li>Merged changes are tested through GH Actions</li>"},{"location":"tools/git/all.git.how_to_guide.html#deleting_a_branch","title":"Deleting a branch","text":"<ul> <li>You can run the script     <code>/dev_scripts_helpers/git/git_branch.sh</code>     to get all the branches together with some information, e.g., last commit and     creator</li> <li>E.g., let's assume we believe that <code>PTask354_INFRA_Populate_S3_bucket</code> is     obsolete and we want to delete it:<ul> <li>Get <code>master</code> up to date     <pre><code>&gt; git checkout master\n&gt; git fetch\n&gt; git pull\n</code></pre></li> <li>Merge <code>master</code> into the target branch</li> <li>Pull and merge     <pre><code>&gt; git checkout PTask354_INFRA_Populate_S3_bucket\n&gt; git pull\n&gt; git merge master\n</code></pre></li> <li>Resolve conflicts     <pre><code>&gt; git commit\n&gt; git pull\n</code></pre></li> <li>Ask Git if the branch is merged<ul> <li>One approach is to ask Git if all the changes in master are also in the     branch     <pre><code>&gt; git branch `PTask354_INFRA_Populate_S3_bucket` --no-merged PTask354_INFRA_Populate_S3_bucket\n</code></pre></li> <li>Note that Git is very strict here, e.g.,     <code>PTask354_INFRA_Populate_S3_bucket</code> is not completely merged since I've     moved code \"manually\" (not only through <code>git cherry-pick, git merge</code>)</li> <li>One approach is to just merge <code>PTask354_INFRA_Populate_S3_bucket</code> into     master and run <code>git branch</code> again</li> </ul> </li> <li>Manually check if there is any textual difference<ul> <li>Another approach is to check what the differences are between the branch     and <code>origin/master</code> <pre><code>&gt; git log master..HEAD\n6465b0c saggese, 25 seconds ago : Merge branch 'master' into PTask354_INFRA_Populate_S3_bucket  (HEAD -&gt; PTask354_INFRA_Populate_S3_bucket, origin/PTask354_INFRA_Populate_S3_bucket)\n&gt; git log HEAD..master\n</code></pre></li> <li>Here we see that there are no textual differences</li> <li>So we can either merge the branch into <code>master</code> or just kill directly</li> </ul> </li> <li>Kill-kill-kill!<ul> <li>To delete both the local and remote branch you can do     <pre><code>&gt; git branch -d PTask354_INFRA_Populate_S3_bucket\n&gt; git push origin --delete PTask354_INFRA_Populate_S3_bucket\n</code></pre></li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#how-to_and_troubleshooting","title":"How-to and troubleshooting","text":""},{"location":"tools/git/all.git.how_to_guide.html#do_not_mess_up_your_branch","title":"Do not mess up your branch","text":"<ul> <li>If you are working in a branch, before doing <code>git push</code> make sure the branch     is not broken (e.g., from a mistake in merge / rebase mess)</li> <li>A way to check that the branch is sane is the following:<ul> <li>Make sure that you don't have extra commits in your branch:<ul> <li>The difference between your branch and master     <code>bash &gt; git fetch &gt; git checkout &lt;BRANCH&gt; &gt; git log origin/master..HEAD</code>     shows only commits made by you or, if you are not the only one working on     the branch, only commits belonging to the branch with the same <code>PTaskXYZ</code></li> <li>E.g., if George is working on <code>PTask275</code> and sees that something funny is     going on:     <pre><code>a379826 Ringo, 3 weeks ago : LemTask54: finish dataflow through\ncross-validation\n33a46b2 George, 2 weeks ago : PTask275 Move class attributes docstrings to init, change logging\n</code></pre></li> </ul> </li> <li>Make sure the files modified in your branch are only the files you expect to     be modified     <pre><code>&gt; git fetch\n&gt; git checkout &lt;BRANCH&gt;\n&gt; git diff --name-only master..HEAD\n</code></pre></li> <li>If you see that there is a problem, don't push upstream (because the branch     will be broken for everybody) and ask a Git expert</li> </ul> </li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#analyzing_commits","title":"Analyzing commits","text":""},{"location":"tools/git/all.git.how_to_guide.html#show_files_modified_in_a_commit","title":"Show files modified in a commit","text":"<ul> <li>You can see the files modified in a given commit hash with:     <pre><code>&gt; git show --name-only $HASH\n</code></pre></li> <li>E.g.,     <pre><code>&gt; git show --name-only 39a9e335298a3fe604896fa19296d20829801cf2\n\ncommit 39a9e335298a3fe604896fa19296d20829801cf2\nAuthor: Julia &lt;julia@...&gt;\nDate:   Fri Sep 27 11:43:41 2019\n\nPTask274 lint\n\nvendors/cme/utils.py\nvendors/first_rate/utils.py\n</code></pre></li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#conflicts","title":"Conflicts","text":""},{"location":"tools/git/all.git.how_to_guide.html#getting_the_conflicting_files","title":"Getting the conflicting files","text":"<ul> <li>To see the files in conflicts     <pre><code>git diff --name-only --diff-filter=U\n</code></pre></li> <li>This is what the script     <code>/dev_scripts_helpers/git/git_conflict_files.sh</code>     does</li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#accepting_theirs","title":"Accepting \"theirs\"","text":"<pre><code>&gt; git checkout --theirs $FILES\n&gt; git add $FILES\n</code></pre> <ul> <li>TODO(gp): Fix this ours and theirs. The first option represents the current     branch from which you executed the command before getting the conflicts, and     the second option refers to the branch where the changes are coming from.     <pre><code>&gt; git show :1:README\n&gt; git show :2:README\n&gt; git show :3:README\n</code></pre></li> <li>Stage #1 is the common ancestor of the files, stage #2 is the target-branch     version, and stage #3 is the version you are merging from.</li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#how_to_get_out_of_a_messyun-mergeable_branch","title":"How to get out of a messy/un-mergeable branch","text":"<ul> <li>If one screws up a branch:<ul> <li>Rebase to master</li> <li>Resolve the conflicts<ul> <li>E.g., pick the <code>master</code> version when needed:     <pre><code>git checkout --theirs ...; git add ...\n</code></pre></li> </ul> </li> <li>Diff the changes in the branch vs another client at <code>master</code> <pre><code>&gt; diff_to_vimdiff.py --dir1 $DIR1/amp --dir2 $DIR2/amp --skip_vim\nSaving log to file '/Users/saggese/src/...2/amp/dev_scripts/diff_to_vimdiff.py.log'\n10-06_15:22 INFO : _parse_diff_output:36  : Reading '/tmp/tmp.diff_to_vimdiff.txt'\n#       DIFF: README.md\n#       DIFF: core/dataflow.py\n#       DIFF: core/dataflow_core.py\n#       DIFF: core/test/test_core.py\n#       DIFF: dev_scripts/diff_to_vimdiff.py\n#       ONLY: diff_to_vimdiff.py.log in $DIR1/dev_scripts\n#       DIFF: dev_scripts/grc\n#       ONLY: code_style.txt in $DIR2/docs/notes\n...\n#       DIFF: vendors/test/test_vendors.py\n</code></pre></li> <li>Diff / merge manually the files that are different     <pre><code>&gt; diff_to_vimdiff.py --dir1 $DIR1/...2/amp --dir2 $DIR2/...3/amp --skip_vim\n&gt; --only_diff_content\n#       DIFF: README.md\n#       DIFF: core/dataflow.py\n#       DIFF: core/dataflow_core.py\n#       DIFF: core/test/test_core.py\n...\n</code></pre></li> </ul> </li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#reverting","title":"Reverting","text":""},{"location":"tools/git/all.git.how_to_guide.html#reverting_the_last_local_commit","title":"Reverting the last local commit","text":"<pre><code>&gt; git reset --soft HEAD~\n</code></pre>"},{"location":"tools/git/all.git.how_to_guide.html#branching","title":"Branching","text":""},{"location":"tools/git/all.git.how_to_guide.html#checking_what_work_has_been_done_in_a_branch","title":"Checking what work has been done in a branch","text":"<ul> <li>Look at all the branches available:     <pre><code># Fetch all the data from origin.\n&gt; git fetch\n# List all the branches.\n&gt; git branch -r\norigin/HEAD -&gt; origin/master\norigin/PTask274\n...\n</code></pre></li> <li>Go to the branch:     <pre><code>&gt; git checkout PTask274\n</code></pre></li> <li>Check what are the commits that are in the current branch HEAD but not in     <code>master</code>:     <pre><code>&gt; gll master..HEAD\n&gt; git log master..HEAD\neb12233 Julia PTask274 verify dataset integrity ( 13 hours ago) Sat Sep 28 18:55:12 2019 (HEAD -&gt; PTask274, origin/PTask274) ...\na637594 saggese PTask274: Add tag for review ( 3 days ago) Thu Sep 26 17:13:33 2019\n</code></pre></li> <li>To see the actual changes in a branch you can't do (Bad) \\     <code>&gt; git diff master..HEAD</code> since <code>git diff</code> compares two commits and not a     range of commits like <code>git log</code> (yes, Git has a horrible API)</li> <li>What you need to do is to get the first commit in the branch and the last from     <code>git log</code> and compare them:     <pre><code>&gt; git difftool a637594..eb12233\n&gt; gd a637594..eb12233\n</code></pre></li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#checking_if_you_need_to_merge_master_into_your_feature_branch","title":"Checking if you need to merge <code>master</code> into your feature branch","text":"<ul> <li>You can see what commits are in master but missing in your branch with:     <pre><code>&gt; gll ..master\nde51a7c saggese Improve script to help diffing trees in case of difficult merges. Add notes from reviews ( 5 hours ago) Sat Oct 5 11:24:11 2019 (origin/master, origin/HEAD, master)\n8acd60c saggese Add a basic end-to-end unit test for the linter ( 19 hours ago) Fri Oct 4 21:28:09 2019 ...\n</code></pre></li> <li>You want to <code>rebase</code> your feature branch onto <code>master</code></li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#comparing_the_difference_of_a_directory_among_branches","title":"Comparing the difference of a directory among branches","text":"<ul> <li>This is useful if we want to focus on changes in a single dir     <pre><code>&gt; git ll master..PTask274 vendors/cme\n39a9e33 Julia PTask274 lint ( 2 days ago) Fri Sep 27 11:43:41 2019\nc8e7e1a Julia PTask268 modify according to review16 ( 2 days ago) Fri Sep 27\n11:41:47 2019\na637594 saggese PTask274: Add tag for review ( 3 days ago) Thu Sep 26 17:13:33\n2019\n</code></pre> <pre><code>&gt; git diff --name-only a637594..33a46b2 -- vendors helpers\nhelpers/csv.py\nvendors/cme/utils.py\nvendors/first_rate/Task274_verify_datasets.ipynb\nvendors/first_rate/Task274_verify_datasets.py\nvendors/first_rate/reader.py\nvendors/first_rate/utils.py\nvendors/test/test_vendors.py\n</code></pre></li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#resources","title":"Resources","text":"<ul> <li>Use https://learngitbranching.js.org/ to     practice and understand the concept of branching</li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#merging_master","title":"Merging <code>master</code>","text":"<ul> <li>If your branch lives long, you want to apply changes made on master to show on     your branch</li> <li>Assume your branch is clean<ul> <li>E.g., everything is committed, or stashed</li> </ul> </li> <li>Pull changes from <code>master</code> on the remote repo     <pre><code>&gt; git checkout master\n&gt; git pull\n</code></pre></li> <li>Checkout your feature branch     <pre><code>&gt; git checkout my_feature\n</code></pre></li> <li>Merge stuff from <code>master</code> to <code>my_feature</code> <pre><code>&gt; git merge master --no-ff\n... editor will open a message for the merge commit ...\n</code></pre></li> <li>In few informal words, the <code>--no-ff</code> option means that commits are not     \"inlined\" (similar to rebase) even if possible, but a merge commit is always     used<ul> <li>The problem is that if the commits are \"inlined\" then you can't revert the     change in one shot like we would do for a merge commit, but you need to     revert all the inlined changes</li> </ul> </li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#rebasing","title":"Rebasing","text":"<ul> <li>For now, we suggest avoiding the rebase flow</li> <li>The reason is that rebase makes things cleaner when used properly, but can get     you into deep trouble if not used properly</li> <li>You can rebase onto <code>master</code>, i.e., you re-apply your changes to <code>master</code></li> <li>Not the other way around: that would be a disaster!     <pre><code>&gt; git checkout my_feature\n# See that you have that master doesn't have.\n&gt; git ll origin/master..\n# See that master has that you don't have.\n&gt; git ll ..origin/master\n&gt; git rebase master\n&gt; git ll ..origin/master\n# Now you see that there is nothing in master you don't have\n&gt; git ll origin/master..\n# You can see that you are ahead of master\n</code></pre></li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#merging_pull_requests","title":"Merging pull requests","text":"<ul> <li>The procedure for manual merges is as follows</li> <li>Do not merge yourself unless explicitly requested by a reviewer</li> <li>Pull changes from remote <code>master</code> branch     <pre><code>&gt; git checkout master\n&gt; git pull\n</code></pre></li> <li>Merge your branch into <code>master</code> without fast-forward     <pre><code>&gt; git merge --no-ff my_feature\n</code></pre></li> <li>Push the newly merged master     <pre><code>&gt; git push\n</code></pre></li> <li>Delete the branch, if you are done with it:     <pre><code>&gt; git branch -d my_feature\n</code></pre></li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#submodules","title":"Submodules","text":""},{"location":"tools/git/all.git.how_to_guide.html#adding_a_submodule","title":"Adding a submodule","text":"<ul> <li>Following the instructions in     https://git-scm.com/book/en/v2/Git-Tools-Submodules</li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#working_in_a_submodule","title":"Working in a submodule","text":"<ul> <li>When you work in a submodule, the flow should be like:<ul> <li>Create a branch in a submodule</li> <li>Do your job</li> <li>Push the submodule branch</li> <li>Create a PR in the submodule when you are done</li> </ul> </li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#updating_a_submodule_to_the_latest_commit","title":"Updating a submodule to the latest commit","text":"<ul> <li>After the submodule PR is merged:<ul> <li>Checkout the submodule in the master branch and do <code>git pull</code></li> <li>In the main repo, create a branch like <code>PTask1234_update_submodule</code></li> <li>From the new branch do <code>git add &lt;submodule_name&gt;</code>, e.g.,     <code>git add helpers_root</code></li> <li>Commit changes, push</li> <li>Create a PR</li> </ul> </li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#to_check_if_supermodule_and_the_amp_submodule_are_in_sync","title":"To check if supermodule and the <code>amp</code> submodule are in sync","text":"<ul> <li>Run the script:     <pre><code>&gt; dev_scripts_helpers/git/git_submodules_are_updated.sh\n</code></pre></li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#roll_forward_pointers_to_the_amp_submodule","title":"Roll forward pointers to the <code>amp</code> submodule:","text":"<ul> <li>Run the script:     <pre><code>&gt; dev_scripts_helpers/git/git_submodules_roll_fwd.sh\n</code></pre></li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#to_clean_all_the_repos","title":"To clean all the repos","text":"<pre><code>&gt; git submodule foreach git clean -fd\n</code></pre>"},{"location":"tools/git/all.git.how_to_guide.html#pull_a_branch_without_checkout","title":"Pull a branch without checkout","text":"<ul> <li>This is useful when merging <code>master</code> in a different branch and we don't want     to checkout master just to pull     <pre><code>&gt; git fetch origin master:master\n</code></pre></li> </ul>"},{"location":"tools/git/all.git.how_to_guide.html#to_force_update_all_the_submodules","title":"To force update all the submodules","text":"<ul> <li>Run the script <code>&gt; dev_scripts_helpers/git/git_submodules_pull.sh</code> or     <pre><code>&gt; git submodule update --init --recursive`\n&gt; git submodule foreach git pull --autostash\n</code></pre></li> </ul>"},{"location":"tools/git/all.git_hooks.how_to_guide.html","title":"All.git hooks.how to guide","text":""},{"location":"tools/git/all.git_hooks.how_to_guide.html#setup","title":"Setup","text":""},{"location":"tools/git/all.git_hooks.how_to_guide.html#configuration","title":"Configuration","text":"<ul> <li> <p>Git hooks are installed by default when the user activates the thin     environment via the <code>setenv.sh</code> script</p> </li> <li> <p>Although not recommended, users can explicitly disable the hooks for the     entire repo by adding the following configuration in the <code>repo_config.yaml</code>:     <pre><code>repo_info:\n    ...\n    # Enable git-commit hooks.\n    enable_git_commit_hook: False\n...\n</code></pre></p> </li> </ul>"},{"location":"tools/git/all.git_hooks.how_to_guide.html#installation","title":"Installation","text":"<ul> <li> <p>To manually install the hooks, run</p> <pre><code>&gt; dev_scripts_helpers/git/git_hooks/install_hooks.py --action install\n</code></pre> </li> <li> <p>To manually remove the hooks, run     <pre><code>&gt; dev_scripts_helpers/git/git_hooks/install_hooks.py --action remove\n</code></pre></p> </li> </ul>"},{"location":"tools/git/all.git_hooks.how_to_guide.html#usage","title":"Usage","text":""},{"location":"tools/git/all.git_hooks.how_to_guide.html#commit_changes","title":"Commit changes","text":"<ul> <li>Once installed, the hooks will be run automatically when a user tries to     commit changes</li> <li> <p>If the pre-commit and the commit-msg checks pass, the commit will be created</p> <pre><code>&gt; git commit -m \"Lint\"\n# Running git pre-commit hook ...\n\n##### check_master ######\n&gt; git rev-parse --abbrev-ref HEAD\nBranch is 'CmampTask11073_Document_git_hooks'\n'check_master' passed\n\n##### check_author ######\n&gt; git config user.name\n&gt; git config --show-origin user.name\n&gt; git config user.email\n&gt; git config --show-origin user.email\nuser_email='dummy@gmail.com'\n'check_author' passed\n\n##### check_file_size ######\nmax file size=512 KB\n'check_file_size' passed\n\n##### check_python_compile ######\nCompiling 'dev_scripts_helpers/git/git_hooks/install_hooks.py'...\n'check_python_compile' passed\n\n##### check_gitleaks ######\n'check_gitleaks' passed\n\n##### All pre-commit hooks passed: committing ######\n\nRun git commit-msg hook ...\n\n##### commit-msg hook passed: committing ######\n[CmampTask11073_Document_git_hooks 02f2c08] Lint\n1 file changed, 11 insertions(+), 9 deletions(-)\n</code></pre> </li> <li> <p>The pre-commit checks that were run and passed to the commit are also     automatically added to the commit messages</p> <pre><code>&gt; git log 02f2c08\ncommit 02f2c08b1677627a95a43c21246219462f9ae339 (HEAD -&gt; CmampTask11073_Document_git_hooks, origin/CmampTask11073_Document_git_hooks)\nAuthor: Dummy &lt;dummy@gmail.com&gt;\nDate:   Mon Apr 28 22:36:50 2025 -0400\n\n        Lint\n\n        Pre-commit checks:\n        All checks passed \u2705\n</code></pre> </li> </ul>"},{"location":"tools/git/all.git_hooks.how_to_guide.html#skip_the_checks","title":"Skip the checks","text":"<ul> <li>To skip the checks for a specific commit, use the <code>--no-verify</code> option     <pre><code>&gt; git commit -m \"Enable copilot review by default\" --no-verify\n</code></pre></li> </ul>"},{"location":"tools/git/all.git_hooks.reference.html","title":"All.git hooks.reference","text":""},{"location":"tools/git/all.git_hooks.reference.html#git_hooks","title":"Git hooks","text":""},{"location":"tools/git/all.git_hooks.reference.html#overview","title":"Overview","text":"<ul> <li> <p>A Git hook is a script that Git automatically executes before or after certain     events such as committing code, merging branches, or pushing changes</p> </li> <li> <p><code>dev_scripts_helpers/git/git_hooks</code>: contains our custom Git hooks</p> <ul> <li><code>./install_hooks.py</code>: can be used to install or remove the hooks</li> <li><code>./pre-commit.py</code>: runs before a commit is created</li> <li><code>./commit-msg.py</code>: checks and/or edits the commit message</li> </ul> </li> </ul>"},{"location":"tools/git/all.git_hooks.reference.html#pre-commit_hook","title":"Pre-commit hook","text":"<ul> <li>The <code>pre-commit.py</code> script enforces a set of invariants before allowing a     <code>git commit</code> to succeed</li> <li>It ensures that essential checks are passed, such as verifying the branch,     author information, file size limits, forbidden words, Python file     compilations, secret leaks...etc.</li> </ul>"},{"location":"tools/git/all.git_hooks.reference.html#commit-msg_hook","title":"Commit-msg hook","text":"<ul> <li>The <code>commit-msg.py</code> script enforces rules related to git commit messages     before allowing a commit to succeed</li> <li>It checks that commit messages follow required conventions</li> <li>It also adds the pre-commit checks that were run and passed to the commit     messages</li> </ul>"},{"location":"tools/git/all.gitleaks.how_to_guide.html","title":"All.gitleaks.how to guide","text":""},{"location":"tools/git/all.gitleaks.how_to_guide.html#gitleaks_how_to_guide","title":"Gitleaks How to Guide","text":""},{"location":"tools/git/all.gitleaks.how_to_guide.html#how_to_run_gitleaks_locally","title":"How to run Gitleaks locally","text":"<p>The easiest way to run Gitleaks locally is with Docker</p> <ul> <li> <p>First, pull the image:</p> <pre><code>&gt; docker pull zricethezav/gitleaks:latest\n</code></pre> </li> <li> <p>Scan git repositories for secrets (including git history)</p> <pre><code>&gt; docker run -v $(pwd):/path zricethezav/gitleaks:latest git /path -v -c /path/.github/gitleaks-rules.toml\n        \u25cb\n        \u2502\u2572\n        \u2502 \u25cb\n        \u25cb \u2591\n        \u2591    gitleaks\n\n7:52PM INF 1540 commits scanned.\n7:52PM INF scanned ~51542901 bytes (51.54 MB) in 46.4s\n7:52PM INF no leaks found\n</code></pre> </li> <li> <p>Scan directories or files for secrets</p> <pre><code>&gt; docker run -v $(pwd):/path zricethezav/gitleaks:latest dir /path -v -c /path/.github/gitleaks-rules.toml\n        \u25cb\n        \u2502\u2572\n        \u2502 \u25cb\n        \u25cb \u2591\n        \u2591    gitleaks\n\n8:00PM INF scanned ~23901530 bytes (23.90 MB) in 26.1s\n8:00PM INF no leaks found\n</code></pre> </li> </ul>"},{"location":"tools/git/all.gitleaks.how_to_guide.html#how_to_deal_with_false_positives","title":"How to deal with false positives","text":"<ul> <li>Some secrets are detected by Gitleaks that are not actually secrets but false     positives</li> <li> <p>To deal with false positives, we can use the following methods:</p> </li> <li> <p>Use inline comments to allow specific lines of code</p> </li> </ul> <pre><code>&gt; aws_access_key_id=*** # gitleaks:allow\n</code></pre> <ol> <li>Add the fingerprint to the <code>.gitleaksignore</code> file</li> </ol> <pre><code>&gt; cat .gitleaksignore\n&gt; ck.infra/infra/terraform/environments/preprod/ap-northeast-1/terraform.tfvars:rule3:429\n&gt; 93f292c3dfa2649ef91f8925b623e79546fa992e:README.md:aws-access-token:121\n</code></pre> <ol> <li>Adjust the <code>allowlists</code> or <code>rules</code> in the <code>gitleaks-rules.toml</code> file to    reduce false positives</li> </ol> <pre><code>&gt; cat .github/gitleaks-rules.toml\ntitle = \"gitleaks config\"\n\n[[allowlists]]\ndescription = \"global allow lists\"\npaths = [\n        # Gitleaks rules file.\n        '''(^|.*/)gitleaks-rules\\.toml$''',\n        # Compressed files.\n        '''.*\\.(csv|txt)\\.gz$''',\n        # Zip files.\n        '''.*\\.zip$''',\n        # Gitleaks ignore file.\n        '''.gitleaksignore$''',\n]\n...\n[[rules]]\n        id = \"rule2\"\n        description = '''AWS API Key'''\n        regex = '''AKIA[0-9A-Z]{16}'''\n        tags = [\"secret\"]\n</code></pre>"},{"location":"tools/git/all.gitleaks.how_to_guide.html#how_to_remove_leaks_from_previous_commits_in_pr","title":"How to remove leaks from previous commits in PR","text":"<ul> <li>When leaks are committed to a PR, they remain in the commit history even after     removal</li> <li>The Gitleaks GitHub Actions will fail due to these leaks in the commit history</li> <li> <p>We can remove leaks from the commit history using the following methods:</p> </li> <li> <p>Option 1: Soft reset and combine all commits in the PR into a single commit</p> <ul> <li>Use this method if you want to discard all commit history in the PR</li> </ul> <pre><code># Checkout the PR branch\n&gt; git checkout &lt;PR-branch-name&gt;\n\n# Reset to the base commit but keep changes staged\n&gt; git reset --soft $(git merge-base HEAD master)\n\n# Create a new commit with all changes\n&gt; git commit -m \"&lt;commit-message&gt;\"\n\n# Force push to the remote branch\n&gt; git push -f\n</code></pre> </li> <li> <p>Option 2: Rebase and squash only the commits that contain the leaks</p> <ul> <li>Use this method if you want to retain some commit history in the PR</li> <li>See this guide for     more details on how to rebase and squash commits</li> </ul> </li> </ul>"},{"location":"tools/git/all.gitleaks.reference.html","title":"All.gitleaks.reference","text":""},{"location":"tools/git/all.gitleaks.reference.html#gitleaks","title":"Gitleaks","text":"<ul> <li>Gitleaks is a SAST tool used for detecting and preventing hardcoded secrets     such as passwords, API keys, and tokens in a directory or git repository</li> <li>It detects secrets not only in the codebase but also in the git commit history</li> <li>Gitleaks can be integrated into our workflow to prevent secrets from being     accidentally added to our codebase</li> <li>It is integrated into our dev system via:<ul> <li>Git hooks (Refer to     /docs/tools/git/all.git_hooks.reference.md))</li> <li>GitHub actions (Refer to     /docs/build_system/all.gitleaks_workflow.explanation.md</li> </ul> </li> </ul>"},{"location":"tools/git/all.gitleaks.reference.html#configuration","title":"Configuration","text":"<ul> <li>The rules for Gitleaks are specified in <code>.github/gitleaks-rules.toml</code></li> <li>To avoid redundancy, the file is symlinked to a common file in <code>//helpers</code>     located at     <code>/dev_scripts_helpers/git/gitleaks/gitleaks-rules.toml</code>     that can be shared across all repos</li> </ul>"},{"location":"tools/git/all.gitleaks.reference.html#allowlists","title":"<code>allowlists</code>","text":"<ul> <li>We can use allowlists to make exceptions to certain files or lines of code     based on paths or regex patterns</li> <li>If we want to exclude \"specific\" commits, lines, or rules, use the inline     <code># gitleaks:allow</code> comment or the <code>.gitleaksignore</code> file instead     <pre><code>[[allowlists]]\ndescription = \"global allow lists\"\npaths = [\n    '''.github/gitleaks-rules.toml''',\n]\n</code></pre></li> </ul>"},{"location":"tools/git/all.gitleaks.reference.html#rule_extension","title":"Rule extension","text":"<ul> <li>We can extend our custom ruleset to include the default ruleset provided by     Gitleaks with:     <pre><code>[extend]\nuseDefault = true\n</code></pre></li> </ul>"},{"location":"tools/git/all.gitleaks.reference.html#rules","title":"<code>rules</code>","text":"<ul> <li>Each rule is defined with:<ul> <li><code>id</code> - A unique identifier for each rule</li> <li><code>description</code> - Short human readable description of the rule</li> <li><code>regex</code> - Golang regular expression used to detect secrets</li> <li><code>tags</code> - Array of strings used for metadata and reporting purposes</li> </ul> </li> <li>For example:     <pre><code>[[rules]]\n    id = \"rule2\"\n    description = '''AWS API Key'''\n    regex = '''AKIA[0-9A-Z]{16}'''\n    tags = [\"secret\"]\n</code></pre></li> </ul>"},{"location":"tools/git/all.gitleaks.reference.html#gitleaksignore","title":"<code>.gitleaksignore</code>","text":"<ul> <li>To prevent specific lines of code from being scanned by Gitleaks, we can use     the <code>.gitleaksignore</code> file</li> <li>It uses \"fingerprints\" to define the leaks</li> <li>Gitleaks generates these fingerprints when it detects a leak, which can then     be added to the file</li> <li>Examples of fingerprints:     <pre><code>&gt; ck.infra/infra/terraform/environments/preprod/ap-northeast-1/terraform.tfvars:rule3:429\n&gt; 93f292c3dfa2649ef91f8925b623e79546fa992e:README.md:aws-access-token:121\n</code></pre></li> <li>The <code>.gitleaksignore</code> file can be placed at the root directory of a repo</li> </ul>"},{"location":"tools/git/all.gitleaks.reference.html#additional_resource","title":"Additional Resource","text":"<ul> <li>The official GitHub page for Gitleaks -     https://github.com/gitleaks/gitleaks https://github.com/gitleaks/gitleaks-action/tree/master</li> <li>The custom ruleset was based on -     https://github.com/mazen160/secrets-patterns-db</li> </ul>"},{"location":"tools/git/all.integrate_helpers.how_to_guide.html","title":"All.integrate helpers.how to guide","text":"<p>This mainly follows the process described in //cmamp/docs/coding/all.integrate_repos.how_to_guide.md</p> <ul> <li> <p>Create a branch in both clients (e.g., <code>/Users/saggese/src/cmamp1</code> and     <code>/Users/saggese/src/helpers1</code>)</p> <pre><code>&gt; cd /Users/saggese/src/cmamp1\n&gt; git pull\n&gt; i git_branch_create -b CmampTask10048_Integrate_helpers_20240922\n\n&gt; cd /Users/saggese/src/helpers1\n&gt; git pull\n&gt; i git_branch_create -b CmampTask10048_Integrate_helpers_20240922\n</code></pre> </li> <li> <p>Diff the dirs     <pre><code>&gt; diff_to_vimdiff.py --dir1 /Users/saggese/src/cmamp1/helpers --dir2 ~/src/helpers1/helpers\n&gt; diff_to_vimdiff.py --dir1 /Users/saggese/src/cmamp1/helpers --dir2 /Users/saggese/src/cmamp2/helpers_root/helpers/\n</code></pre></p> </li> </ul>"},{"location":"tools/git/all.invite_gh_contributors.explanation.html","title":"All.invite gh contributors.explanation","text":""},{"location":"tools/git/all.invite_gh_contributors.explanation.html#invite_gh_contributorspy_explanation","title":"<code>invite_gh_contributors.py</code> Explanation","text":"<p>This document is about how this script works and flows.</p>"},{"location":"tools/git/all.invite_gh_contributors.explanation.html#public_interface","title":"Public interface","text":"<pre><code># Google Sheet Source\ndev_scripts_helpers/github/invite_gh_contributors.py \\\n        --drive_url &lt;google\u2011sheet\u2011url&gt;  \\\n        --gh_token  &lt;github\u2011pat&gt;       \\\n        --org_name  &lt;github\u2011org&gt;       \\\n        --repo_name &lt;repo&gt;             \\\n        [--log_level 20]\n\n# CSV source (mutually exclusive with --drive_url)\ndev_scripts_helpers/github/invite_gh_contributors.py \\\n        --csv_file  &lt;/path/to/users.csv&gt; \\\n        --gh_token  &lt;github\u2011pat&gt;         \\\n        --org_name  &lt;github\u2011org&gt;         \\\n        --repo_name &lt;repo&gt;               \\\n        [--log_level 20]\n</code></pre> <ul> <li><code>drive_url</code>/<code>csv_file</code>: Spreadsheet containing a <code>GitHub user</code> column.</li> <li><code>gh_token</code>: PAT with <code>repo</code> scope (or fine\u2011grained \"Repository     administration\").</li> <li><code>org_name</code> / <code>repo_name</code>: identify thtarget repository.</li> <li><code>log_level</code>: standard Python numeric levels (10\u00a0= DEBUG, 20\u00a0=\u00a0INFO).</li> </ul>"},{"location":"tools/git/all.invite_gh_contributors.explanation.html#execution_flow","title":"Execution flow","text":"<pre><code>flowchart TD\n        A[parse CLI args] --&gt; B[init logging]\n        B --&gt; C[extract_usernames_from_gsheet/csv]\n        C --&gt;|\"list[str]\"| D[send_invitations]\n        D --&gt; E{already collaborator?}\n        E -- yes --&gt; F[skip + log]\n        E -- no --&gt; G[_invite wrapper]\n        G --&gt;|add_to_collaborators| H[GitHub API]\n        subgraph Rate-limit\n                direction TB\n                G\n                note(\"@ratelimit.limits 50 calls / 24h \u2192 sleep_and_retry if exceeded\")\n        end</code></pre>"},{"location":"tools/git/all.invite_gh_contributors.explanation.html#key_implementation_choices","title":"Key implementation choices","text":"<ul> <li>Dependency auto\u2011install: the small <code>pip install</code> loop avoids a separate     requirements file when the script runs in fresh environments, at the cost of     start\u2011up time.</li> <li>Service\u2011account auth: credentials path is hard\u2011coded but can be fed via     env\u2011var if desired; the helper supports both.</li> <li>Idempotence: <code>repo.has_in_collaborators()</code> prevents duplicate invites     counting toward the daily quota.</li> <li>Sleep strategy: we rely entirely on <code>ratelimit.sleep_and_retry</code>, so the     process may block for hours. Even if the process is terminated, the     idempotence measure will prevent the added names from contributing to the     quota</li> </ul>"},{"location":"tools/git/all.invite_gh_contributors.how_to_guide.html","title":"All.invite gh contributors.how to guide","text":""},{"location":"tools/git/all.invite_gh_contributors.how_to_guide.html#inviting_github_collaborators_from_google_sheets","title":"Inviting GitHub Collaborators from Google\u00a0Sheets","text":""},{"location":"tools/git/all.invite_gh_contributors.how_to_guide.html#prerequisites","title":"Prerequisites","text":"<ul> <li> <p>GitHub personal\u2011access token (PAT) with the classic <code>repo</code> scope, or a     fine\u2011grained token granting Repository\u00a0administration for the target     repository.</p> <pre><code>export GH_PAT=github_pat_...\n</code></pre> </li> <li> <p>Google service\u2011account JSON key</p> <ul> <li>Create a service account in Google\u00a0Cloud.</li> <li>Enable the Drive\u00a0API on that project.</li> <li>Download the key as JSON and place it at <code>/app/DATA605/google_secret.json</code>     (or change the path in the script).</li> <li>Share the spreadsheet with the service\u2011account address.</li> </ul> </li> </ul>"},{"location":"tools/git/all.invite_gh_contributors.how_to_guide.html#running_the_script","title":"Running the script","text":"<pre><code>dev_scripts_helpers/github/invite_gh_contributors.py \\\n        --drive_url \"https://docs.google.com/spreadsheets/d/...\" \\  # or  --csv_file  &lt;/path/to/users.csv&gt;\n        --gh_token  \"$GH_PAT\" \\\n        --org_name  causify-ai \\\n        --repo_name tutorials \\\n        --log_level 20          # INFO\n</code></pre> <ul> <li><code>--drive_url</code>/<code>--csv_file</code>: full URL of the Google\u00a0Sheet containing a     column named <code>GitHub user</code>.</li> <li><code>--gh_token</code>: your PAT (or set <code>GH_PAT</code> and pass <code>--gh_token \"$GH_PAT\"</code>).</li> <li><code>--org_name</code> / <code>--repo_name</code>: where the invitations will be sent.</li> <li>Increase <code>--log_level</code> to <code>10</code> for verbose debug logs.</li> </ul>"},{"location":"tools/helpers/all.asyncio.explanation.html","title":"All.asyncio.explanation","text":""},{"location":"tools/helpers/all.asyncio.explanation.html#asyncio_best_practices","title":"Asyncio Best Practices","text":"<p>Asynchronous programming is a powerful paradigm in Python that allows you to write non-blocking, concurrent code that can greatly improve the efficiency of your applications when I/O and computation can be overlapped.</p> <p>The official documentation is https://docs.python.org/3/library/asyncio.html This document provides an overview of how asyncio works and offers best practices to avoid common pitfalls.</p>"},{"location":"tools/helpers/all.asyncio.explanation.html#nomenclature_in_asyncio","title":"Nomenclature in asyncio","text":"<ul> <li> <p>Event Loop</p> <ul> <li>Asyncio operates on an event loop that manages the execution of asynchronous     tasks. Whenever one wants to execute the asynchronous tasks we do     <code>asyncio.run()</code> or <code>asyncio.run_until_complete()</code>: both of these methods     will start the event loop and it will be set to running yielding control to     it.</li> <li>In asyncio, you can obtain the event loop using either     <code>asyncio.get_event_loop()</code> or <code>asyncio.get_running_loop()</code>. In the latest     version of asyncio, both methods now serve the same purpose. However, it is     recommended to use <code>get_running_loop</code> because <code>get_event_loop</code> has been     deprecated since version 3.12. This change ensures consistency and future     compatibility with asyncio.</li> </ul> </li> <li> <p>Coroutines (aka \"async functions\" defined with <code>async def</code>)</p> <ul> <li>These functions can be paused and resumed without blocking other tasks.</li> </ul> </li> <li> <p><code>await</code></p> <ul> <li>The <code>await</code> keyword is used only within coroutines to pause execution until     an asynchronous operation (e.g., I/O) is completed. While waiting, the event     loop can execute other tasks.</li> </ul> </li> </ul>"},{"location":"tools/helpers/all.asyncio.explanation.html#common_pitfalls_and_solutions","title":"Common Pitfalls and Solutions","text":""},{"location":"tools/helpers/all.asyncio.explanation.html#1_avoid_running_multiple_event_loops","title":"1. Avoid Running Multiple Event Loops","text":"<p>One common error is <code>Event loop is already running</code>. When you use <code>asyncio.run()</code> or <code>run_until_complete()</code>, the event loop is started. Attempting to start a new event loop while one is already running will result in this error.</p> <p>To avoid this:</p> <ul> <li> <p>Solution 1: use <code>nest_asyncio</code></p> <ul> <li><code>nest_asyncio</code> is a library that allows you to create nested event loops.     While this may seem like a solution but may lead to complex issues. This was     mainly developed to run <code>asyncio</code> in Jupyter/ipython which already runs an     event loop in backend. This library also does not support     <code>asyncio_solipsism</code> so there is another trade-off.</li> <li>Here's how nest_asyncio works:<ul> <li>It saves the current event loop, if any, that is running in the     environment.</li> <li>It sets up a new event loop specifically for running asyncio code.</li> <li>You can run your asyncio code within this nested event loop.</li> <li>When you're done running asyncio code, <code>nest_asyncio</code> restores the     original event loop, ensuring compatibility with the environment.</li> </ul> </li> </ul> </li> <li> <p>Solution 2: use threads</p> <ul> <li>Instead of starting a new event loop, run that specific part of your code in     a separate thread to prevent conflicts. This solves the issue but using     thread has its own complications such as race conditions which can be     difficult to debug</li> </ul> </li> <li> <p>Solution 3: embrace \"async all the way up\" approach</p> <ul> <li>Use <code>await</code> instead of nested call to <code>asyncio.run</code> and make your methods     asynchronous using <code>async def</code> all the way</li> </ul> </li> </ul>"},{"location":"tools/helpers/all.asyncio.explanation.html#example_code","title":"Example Code","text":"<p>Consider the following coroutines</p> <ul> <li><code>A</code> that sleeps and then calls <code>B</code></li> <li><code>B</code> which calls <code>C</code></li> <li> <p><code>C</code> sleeps</p> <p><pre><code>graph TD\n        A[async def A] --&gt; B[def B]\n        B --&gt;C[ async def C]\n\n        style A fill:#FFA07A, stroke:#FF6347\n        style B fill:#98FB98, stroke:#2E8B57\n        style C fill:#ADD8E6, stroke:#4682B4</code></pre> <pre><code>import asyncio\nimport helpers.hasyncio as hasynci\n\n# Corresponds to `submit twap` in CmampTask5842\nasync def A():\n        print(\"IN A\")\n        await asyncio.sleep(2)\n        print(\"ENTER B\")\n        B()\n\n# Corresponds to `get_fill_per_order`\nasync def C():\n        print(\"IN C\")\n        await asyncio.sleep(2)\n        print(\"EXIT C\")\n\n# get_fill\ndef B():\n        print(\"IN B\")\n        cor = C()\n        asyncio.get_running_loop().run_until_complete(cor)\n        print(\"EXIT B\")\n\n# Call A.\nhasynci.run(A(), asyncio.get_event_loop(), close_event_loop=False)\n</code></pre></p> </li> <li> <p>The code above won't work and will give     <pre><code>Error: \"Event loop is already running\"\n</code></pre></p> <p>This error arises because, when <code>run()</code> is invoked, it initializes the event loop on the current thread. Subsequently, if <code>run()</code> is called within the function <code>B()</code>, the system checks for the running state of the event loop. If the event loop is already in progress, the system raises the 'Event loop is already running' error.\"</p> </li> <li> <p>Adding     <pre><code>import nest_asyncio\n\nnest_asyncio.apply()\n</code></pre></p> <p>the code above will work</p> </li> <li> <p>If <code>nest_asyncio</code> is present the following code does not work     <pre><code>with hasynci.solipsism_context() as event_loop:\n    hasynci.run(A(), event_loop, close_event_loop=False)\n</code></pre>     failing with the error     <pre><code>Error: \"Event loop is already running\"\n</code></pre></p> </li> </ul>"},{"location":"tools/helpers/all.asyncio.explanation.html#2_timesleep_vs_asynciosleep","title":"2. time.sleep() vs asyncio.sleep()","text":"<p>One common error is to use <code>time.sleep()</code> with asynchronous methods.</p> <p>This blocks the execution of that method and the event loop cannot proceed to task until the sleep period is over. This negates the primary purpose of the asyncio and doesn't allow us to simulate systems with <code>solipsism</code>.</p> <p>We should almost never use this, and use <code>asyncio.sleep</code> instead.</p>"},{"location":"tools/helpers/all.hcache.explanation.html","title":"All.hcache.explanation","text":""},{"location":"tools/helpers/all.hcache.explanation.html#cache","title":"Cache","text":"<ul> <li> <p>This document explains the design and flow of a caching system implemented in     <code>/helpers/hcache.py</code>.</p> </li> <li> <p><code>hcache</code> provides a dual-layer cache (memory and disk) with tagging, global     and function-specific isolation, and deterministic modes for complex projects,     improving performance and persistency across sessions.</p> </li> </ul>"},{"location":"tools/helpers/all.hcache.explanation.html#overview","title":"Overview","text":"<ul> <li>In performance-sensitive systems, repeated evaluations of the same expensive     function can degrade efficiency (for example, calling an expensive function     twice with the same arguments returns instantly on the second call due to     caching).</li> <li> <p>The <code>hcache</code> module addresses this through a robust, dual-layer caching     mechanism that reduces recomputation, enables persistency across sessions, and     improves responsiveness in both scripts and interactive notebooks.</p> </li> <li> <p>Unlike lightweight alternatives like <code>hcache_simple</code>, <code>hcache</code> is suited for     complex use cases where cache configuration, inspection, tagging, and sharing     are necessary. It supports memory- and disk-based layers, function-level     control, and tagged caches for environment separation (e.g., test vs prod).</p> </li> </ul>"},{"location":"tools/helpers/all.hcache.explanation.html#usage_example","title":"Usage example","text":"<pre><code>from helpers.hcache import cache\n\n@cache(use_mem_cache=True, use_disk_cache=True, tag=\"unit_tests\")\ndef expensive_compute(x, y):\n        # heavy work...\n        return x * y\n\n# First call: computes and caches\nres1 = expensive_compute(3, 4)\n# Second call: instant return from memory\nres2 = expensive_compute(3, 4)\n</code></pre>"},{"location":"tools/helpers/all.hcache.explanation.html#core_concepts","title":"Core concepts","text":"<ul> <li> <p>Source Code Tracking: Detects changes in the wrapped function's bytecode     pointer to invalidate stale cache entries.</p> </li> <li> <p>Two-Level Cache: Cascading lookup in memory first (via <code>joblib.Memory</code>     over <code>tmpfs</code>), then on disk (via <code>joblib.Memory</code> at specified directory).</p> </li> <li> <p>Lookup and Store Flow: On function call, check memory \u2192 check disk \u2192     execute function if miss \u2192 store result in both layers.</p> </li> <li> <p>Global Cache: Default backend shared across all cached functions in a Git     repo, located at <code>$GIT_ROOT/tmp.cache.{mem,disk}</code>.</p> <ul> <li>Tagged Global Cache: Namespaces cache per <code>tag</code> parameter (e.g.,     <code>unit_tests</code> vs default) to isolate environments.</li> </ul> </li> <li> <p>Function-Specific Cache: Customizable cache directories for individual     functions managed via <code>.set_cache_directory()</code>, <code>.get_cache_directory()</code>, and     <code>.clear_function_cache()</code>.</p> </li> <li> <p>Deterministic Modes: <code>enable_read_only</code> and <code>check_only_if_present</code>     options enforce strict cache-only or read-only behaviors, supporting testing     and debugging.</p> </li> </ul>"},{"location":"tools/helpers/all.hcache.explanation.html#how_the_cache_works","title":"How the <code>Cache</code> works","text":"<ul> <li> <p><code>Cache</code> tracks changes in the source code of the wrapped function</p> <ul> <li>For performance reasons, it checks the code only one time unless the pointer     to the function is changed, e.g. in notebooks</li> </ul> </li> <li> <p>By default, it uses two levels of caching:</p> <ul> <li><code>Memory</code> level</li> <li><code>Disk</code> level</li> </ul> </li> <li> <p>When a call is made to the wrapped function:</p> <ul> <li>Firstly the <code>Memory</code> level is being checked</li> <li>If there's no hit in the <code>Memory</code>, the <code>Disk</code> level is checked</li> <li>If there's no hit in <code>Disk</code> level, the wrapped function is called</li> <li>The result is then stored in both <code>Disk</code> and <code>Memory</code> levels</li> </ul> </li> <li> <p><code>Cache</code> is equipped with a <code>get_last_cache_accessed()</code> method to understand if     the call hit the cache and on which level</p> </li> </ul>"},{"location":"tools/helpers/all.hcache.explanation.html#disk_level","title":"Disk level","text":"<ul> <li><code>Disk</code> level is implemented via     joblib.Memory</li> </ul>"},{"location":"tools/helpers/all.hcache.explanation.html#memory_level","title":"Memory level","text":"<ul> <li> <p>Initially, the idea was to use     functools.lru_cache     for memory cache</p> </li> <li> <p>Pros:</p> <ol> <li>Standard library implementation</li> <li>Quietly fast in-memory implementation</li> </ol> </li> <li> <p>Cons:</p> <ol> <li>Only hashable arguments are supported</li> <li>No access to cache, it's not possible to check if an item is in cache or  not</li> <li>It does not work properly in notebooks</li> </ol> </li> <li> <p>Because Cons outweighed Pros, we decided to implement <code>Memory</code> level as     joblib.Memory     over <code>tmpfs</code></p> </li> <li>In this way we reuse the same code for <code>Disk</code> level cache but over a RAM-based     disk<ul> <li>This implementation overcomes the Cons listed above, although it is slightly     slower than the pure <code>functools.lru_cache</code> approach</li> </ul> </li> </ul>"},{"location":"tools/helpers/all.hcache.explanation.html#global_cache","title":"Global cache","text":"<ul> <li>By default, all cached functions save their cached values in the default     global cache</li> <li>The cache is \"global\" in the sense that:<ul> <li>It is unique per-user and per Git client</li> <li>It serves all the functions of a Git client</li> </ul> </li> <li>The cached data stored in a folder <code>$GIT_ROOT/tmp.cache.{mem,disk}.[tag]</code></li> <li> <p>This global cache is being managed via global functions named     <code>*_global_cache</code>, e.g., <code>set_global_cache()</code></p> </li> <li> <p>TODO(gp): maybe a better name is</p> <ul> <li>Global -&gt; local_cache, client_cache</li> <li>Function_specific -&gt; global or shared</li> </ul> </li> </ul>"},{"location":"tools/helpers/all.hcache.explanation.html#tagged_global_cache","title":"Tagged global cache","text":"<ul> <li>A global cache can be specific of different applications (e.g., for unit tests     vs normal code)<ul> <li>It is controlled through the <code>tag</code> parameter</li> <li>The global cache corresponds to <code>tag = None</code></li> </ul> </li> </ul>"},{"location":"tools/helpers/all.hcache.explanation.html#function-specific_cache","title":"Function-specific cache","text":"<ul> <li>It is possible to create function-specific caches, e.g., to share the result     of a function across clients and users</li> <li>In this case the client needs to set <code>disk_cache_directory</code> and / or     <code>mem_cache_directory</code> parameters in the decorator or in the <code>Cached</code> class     constructor</li> <li>If cache is set for the function, it can be managed with     <code>.set_cache_directory()</code>, <code>.get_cache_directory()</code>, <code>.destroy_cache()</code> and     <code>.clear_function_cache()</code> methods.</li> </ul>"},{"location":"tools/helpers/all.hcache.explanation.html#design_rationale_and_trade-offs","title":"Design rationale and trade-offs","text":"<p>We chose these approaches to balance performance, persistence, and configurability.</p> <p>Below is a summary of our key design choices and their trade-offs.</p> Choice Trade-off <code>joblib.Memory</code> over <code>lru_cache</code> More flexible and persistent, but slightly slower <code>copy.deepcopy()</code> on retrieval Ensures immutability but adds overhead Global + function-specific backends Powerful but adds complexity for setup and cleanup Verbose cache control (<code>enable_read_only</code>, <code>check_only_if_present</code>) Good for testing and debugging; may be overkill for casual use"},{"location":"tools/helpers/all.hcache.explanation.html#common_misunderstandings","title":"Common misunderstandings","text":"<ul> <li>Caches aren't auto-cleaned: Old entries may accumulate; manual clearing is     needed via <code>clear_global_cache()</code> or <code>clear_function_cache()</code>.</li> <li>Not all functions are cache-safe: Side effects, non-determinism (e.g.,     random values or timestamps), and unhashable arguments can lead to incorrect     or missing cache behavior.</li> <li>Function code changes may invalidate cache: <code>joblib</code> hashes the function     code, so altering it causes cache misses unless overridden intentionally via     <code>update_func_code_without_invalidating_cache()</code>.</li> </ul>"},{"location":"tools/helpers/all.hcache.explanation.html#execution_flow_diagram","title":"Execution flow diagram","text":"<p>Figure: Execution flow of the caching mechanism, showing decorator setup, lookup order, and advanced features.</p> <pre><code>flowchart LR\n    %% Decorator System\n    subgraph DecoratorSystem[\"Decorator System\"]\n        dec[\"@cache(use_mem_cache, use_disk_cache, disk_cache_path)\"]\n        CachedClass[\"CachedClass\"]\n        dec --&gt; CachedClass\n    end\n\n    %% Cached Class Components\n    subgraph CachedClassComponents[\"Cached Class Components\"]\n        memCache[\"_create_function_memory_cache()\"]\n        diskCache[\"_create_function_disk_cache()\"]\n        CachedClass --&gt; memCache\n        CachedClass --&gt; diskCache\n\n        memCache --&gt; globalType[\"get_global_cache_type(tag)\"]\n        diskCache --&gt; globalType\n        globalType --&gt; backendFactory[\"_create_global_cache_backend()\"]\n\n        backendFactory --&gt; globalPath[\"_get_global_cache_path()\"]\n        backendFactory --&gt; globalName[\"_get_global_cache_name()\"]\n        backendFactory --&gt; clearGlobal[\"clear_global_cache()\"]\n        backendFactory --&gt; infoGlobal[\"get_global_cache_info()\"]\n        backendFactory --&gt; clearFunc[\"clear_function_cache()\"]\n        backendFactory --&gt; funcPath[\"get_function_cache_path()\"]\n        backendFactory --&gt; hasFunc[\"has_function_cache()\"]\n    end\n\n    %% Cache Types &amp; Paths\n    subgraph CacheTypesAndPaths[\"Cache Types &amp; Paths\"]\n        memoryPath[\"Memory Cache Path\\n/tmp/jbill/mem\"]\n        diskPath[\"Disk Cache Path\\n~/.cache/hj/cache.disk\"]\n        funcSpecific[\"Function-specific Path\"]\n        globalPath --&gt; memoryPath\n        globalName --&gt; diskPath\n        funcPath   --&gt; funcSpecific\n    end\n\n    %% Joblib Integration\n    subgraph JoblibIntegration[\"Joblib Integration\"]\n        MemCache[\"MEMORY_CACHE\\njoblib.Memory\"]\n        DiskCache2[\"DISK_CACHE\\njoblib.Memory\"]\n        MemCache  --&gt; MemFunction[\"joblib.MemoryFunc\"]\n        DiskCache2 --&gt; MemFunction\n        MemFunction --&gt; StoreBackend[\"Store Backend\"]\n        StoreBackend --&gt; CodeTracking[\"Function Code Tracking\"]\n    end\n\n    %% Function Wrapper\n    subgraph FunctionWrapper[\"Function Wrapper\"]\n        Wrapper[\"call() \u2013 Main caching logic\"]\n        CachedClass --&gt; Wrapper\n        Wrapper --&gt; GetResult[\"get_memorized_result()\"]\n        Wrapper --&gt; StoreVersion[\"store_cached_version()\"]\n        Wrapper --&gt; GlobalMgmt[\"_IS_CACHE_ENABLED = true\"]\n    end\n\n    %% Advanced Features\n    subgraph AdvancedFeatures[\"Advanced Features\"]\n        CodeTracking --&gt; ReadOnly[\"enable_read_only()\"]\n        CodeTracking --&gt; CheckOnly[\"enable_check_only_if_present()\"]\n        CodeTracking --&gt; S3Support[\"S3 Backend Support\"]\n        CodeTracking --&gt; LastAccessed[\"_get_last_cache_accessed()\"]\n        CodeTracking --&gt; UpdateCode[\"update_func_code_without_invalidating_cache()\"]\n    end</code></pre>"},{"location":"tools/helpers/all.hcache_simple.explanation.html","title":"All.hcache simple.explanation","text":""},{"location":"tools/helpers/all.hcache_simple.explanation.html#cache_simple","title":"Cache Simple","text":"<ul> <li> <p>This document explains the design and flow of the caching system implemented in     <code>/helpers/hcache_simple.py</code>.</p> </li> <li> <p><code>hcache_simple</code> is a lightweight, decorator-based module designed for     individual function caching, offering basic in\u2011memory and disk storage (via     JSON or pickle) with manual management and performance tracking.</p> </li> <li> <p>In contrast to <code>hcache</code> which is a robust, global caching solution that     supports tagged caches, automatic invalidation, and shared cache directories     across multiple functions and users, using advanced tools</p> </li> <li> <p>A tutorial of the cache is <code>/helpers/notebooks/hcache_simple.tutorial.ipynb</code></p> </li> </ul>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#overview","title":"Overview","text":"<ul> <li> <p>The caching system supports two storage layers:</p> <ul> <li><code>Memory Cache</code>: A Python dictionary storing function results for rapid     retrieval</li> <li><code>Disk Cache</code>: Persistent storage using either <code>JSON</code> or <code>pickle</code> files,     ensuring that cached results persist across sessions</li> </ul> </li> <li> <p>Additionally, the system monitors cache performance and allows users to     configure caching behavior via <code>user</code> and <code>system</code> properties</p> </li> <li> <p>Cache files are stored in a configurable cache directory:</p> <ul> <li>Default: Current working directory (<code>.</code>)</li> <li>Can be set using <code>set_cache_dir(cache_dir)</code></li> <li>Retrieved using <code>get_cache_dir()</code></li> </ul> </li> </ul>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#design_rationale_and_trade-offs","title":"Design Rationale and Trade-offs","text":"<ul> <li> <p>Memory vs Disk: Memory cache provides fast access but is volatile and     non-persistent. Disk cache persists across sessions but comes with I/O     overhead. The design allows combining both for flexibility.</p> </li> <li> <p>Pickle vs JSON: Pickle supports a wider range of Python-native types (like     objects, sets, etc.), while JSON is more portable and human-readable but     limited to basic types. The user can choose based on their use case.</p> </li> <li> <p>Property Storage: Properties are stored in a single pickle file     (<code>tmp.cache.property.pkl</code>) that contains both user and system properties for     all cached functions.</p> </li> <li> <p>Performance Tracking is Optional: Monitoring is off by default to avoid     runtime overhead and is opt-in via <code>enable_cache_perf</code>.</p> </li> </ul>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#memory_cache","title":"Memory Cache","text":"<ul> <li> <p>Implementation:</p> <ul> <li>A global dictionary <code>_CACHE</code> stores cached data</li> <li>A different nested dictionary is used for each function name</li> <li>The key is derived from the function's positional arguments (converted to     string format), and the value is the function result</li> </ul> </li> <li> <p>Flow example:</p> <ul> <li>When a decorated function is called with arguments <code>(3,)</code>, the system:<ul> <li>Checks if <code>_CACHE</code> contains the key <code>'{\"args\": [3], \"kwargs\": {}}'</code></li> <li>Returns the cached value if found <code>(cache hit)</code></li> <li>Otherwise, calls the function to compute the result, stores it in     <code>_CACHE</code>, and then returns it</li> </ul> </li> </ul> </li> <li> <p>Interface:</p> <ul> <li><code>get_cache(func_name)</code> returns the cache for a given function (loads from     disk if not in memory)</li> <li><code>get_mem_cache(func_name)</code> returns only the in-memory cache without loading     from disk</li> <li><code>reset_mem_cache(func_name)</code> clears the in-memory cache for the function</li> </ul> </li> </ul>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#disk_cache","title":"Disk Cache","text":"<ul> <li> <p>File naming convention:</p> <ul> <li>Disk cache files are named using the pattern     <code>tmp.cache.&lt;func_name&gt;.&lt;extension&gt;</code>, where the extension depends on the     cache type:<ul> <li><code>JSON</code>: <code>.json</code></li> <li><code>Pickle</code>: <code>.pkl</code></li> </ul> </li> </ul> </li> <li> <p>Flow example:</p> <ul> <li>When a cache is flushed to disk:<ul> <li>The system determines the file name by checking the system cache property     <code>type</code> (set to <code>json</code> or <code>pickle</code>)</li> <li>The memory cache (a small dictionary of keys and values) is written to the     file using the appropriate format</li> <li>On subsequent runs, if the memory cache is empty, the system will load     cached results from disk</li> </ul> </li> </ul> </li> <li> <p>Interface:</p> <ul> <li><code>flush_cache_to_disk(func_name)</code> writes the current memory cache to the disk     file<ul> <li>If <code>func_name</code> is empty, flushes all cached functions to disk</li> </ul> </li> <li><code>force_cache_from_disk(func_name)</code> loads the disk cache and updates the     in-memory cache<ul> <li>If <code>func_name</code> is empty, loads all disk caches into memory</li> </ul> </li> <li><code>reset_disk_cache(func_name, interactive)</code> removes disk cache files<ul> <li>If <code>func_name</code> is empty, resets all disk cache files</li> <li>If <code>interactive=True</code>, prompts for confirmation before resetting</li> </ul> </li> <li><code>reset_mem_cache(func_name)</code> clears the in-memory cache<ul> <li>If <code>func_name</code> is empty, resets all in-memory caches</li> </ul> </li> <li><code>reset_cache(func_name, interactive)</code> resets both memory and disk cache<ul> <li>Combines <code>reset_mem_cache</code> and <code>reset_disk_cache</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#cache_performance_monitoring","title":"Cache Performance Monitoring","text":"<ul> <li> <p>This tracks how effective the caching is by recording total <code>calls</code>,     <code>cache hits</code>, and <code>cache misses</code></p> </li> <li> <p>Implementation:</p> <ul> <li>A global dictionary <code>_CACHE_PERF</code> stores performance data per function</li> <li>When enabled (via <code>enable_cache_perf</code>), it keeps counters:<ul> <li><code>tot</code>: Total number of calls</li> <li><code>hits</code>: Number of times the cache returned a value</li> <li><code>misses</code>: Number of times the function had to be called due to a cache     miss</li> </ul> </li> </ul> </li> <li> <p>Flow example:</p> <ul> <li>For a function call:<ul> <li>The system increments <code>tot</code></li> <li>If the <code>value</code> exists in the cache, <code>hits</code> is incremented</li> <li>Otherwise, <code>miss</code> is incremented and the function is executed</li> <li>The stats can then be printed with <code>get_cache_perf_stats</code> which returns a     summary string</li> </ul> </li> </ul> </li> <li> <p>Interface:</p> <ul> <li><code>enable_cache_perf(func_name)</code>: enable cache performance tracking for a     specific function</li> <li><code>disable_cache_perf(func_name)</code>: disable cache performance tracking<ul> <li>If <code>func_name</code> is empty, disables for all cached functions</li> </ul> </li> <li><code>reset_cache_perf(func_name)</code>: reset performance counters to zero<ul> <li>If <code>func_name</code> is empty, resets all functions</li> </ul> </li> <li><code>get_cache_perf(func_name)</code>: returns the performance dict (tot, hits,     misses) or None</li> <li><code>get_cache_perf_stats(func_name)</code>: returns a formatted string with     performance metrics including hit rate</li> </ul> </li> </ul>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#cache_inspection_and_statistics","title":"Cache Inspection and Statistics","text":"<ul> <li> <p>The system provides several utility functions for inspecting and debugging the     cache state</p> </li> <li> <p><code>cache_stats_to_str(func_name)</code>: Returns a pandas DataFrame showing cache     statistics</p> <ul> <li>If <code>func_name</code> is empty, returns stats for all cached functions</li> <li>Shows both memory and disk cache sizes for each function</li> <li>Example output:     <pre><code>         memory  disk\nfind_email        -  1044\nverify_email      -  2322\n</code></pre></li> </ul> </li> <li> <p><code>get_cache_func_names(type_)</code>: Retrieves list of cached function names</p> <ul> <li><code>type_='all'</code>: Returns all functions with either memory or disk cache</li> <li><code>type_='mem'</code>: Returns only functions with memory cache</li> <li><code>type_='disk'</code>: Returns only functions with disk cache files</li> </ul> </li> <li> <p><code>cache_property_to_str(func_name)</code>: Converts cache properties to string</p> <ul> <li>If <code>func_name</code> is empty, returns properties for all cached functions</li> <li>Shows all configured properties (both user and system) for each function</li> </ul> </li> <li> <p><code>get_mem_cache(func_name)</code>: Directly retrieves the memory cache dictionary for     a function</p> </li> </ul>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#cache_properties_user_and_system","title":"Cache Properties: User and System","text":"<ul> <li> <p>There are two types of properties:</p> <ul> <li><code>User Properties</code>: Configurable by the user to alter caching behavior. For     example:<ul> <li><code>abort_on_cache_miss</code>: Whether to raise an error if a cache miss occurs</li> <li><code>report_on_cache_miss</code>: Whether to return a special value (\"cache_miss\")     on a cache miss</li> <li><code>enable_perf</code>: Whether to enable performance statistics tracking (hits,     misses, total calls)</li> <li><code>force_refresh</code>: Whether to bypass the cache and refresh the value</li> </ul> </li> <li><code>System Properties</code>: Internal settings like <code>type</code> (e.g., \"json\" or     \"pickle\"), <code>write_through</code>, and <code>exclude_keys</code></li> </ul> </li> <li> <p>Persistent storage:</p> <ul> <li>All cache properties are stored on disk in a single pickle file:     <code>tmp.cache.property.pkl</code></li> <li>This file contains a nested dictionary: <code>func_name -&gt; property_name -&gt;     value</code></li> </ul> </li> <li> <p>Flow example:</p> <ul> <li>When a function is decorated, the system sets its system property (e.g., the     cache type) using <code>set_cache_property(func_name, \"type\", cache_type)</code></li> <li>Later, when retrieving a cached value, it checks user properties (like     <code>force_refresh</code>) to decide whether to use the cached value or to recompute     the result</li> </ul> </li> <li> <p>Interface:</p> <ul> <li><code>set_cache_property(func_name, property_name, value)</code>: set a property for a     function and persist to disk</li> <li><code>get_cache_property(func_name, property_name)</code>: get the value of a property     for a function</li> <li><code>reset_cache_property()</code>: reset user properties for all functions (preserves     system properties like <code>type</code>, <code>write_through</code>, <code>exclude_keys</code>)</li> <li><code>cache_property_to_str(func_name)</code>: convert cache properties to string     representation</li> <li><code>get_cache_property_file()</code>: get the path to the cache property file     (<code>tmp.cache.property.pkl</code>)</li> </ul> </li> </ul>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#decorator","title":"Decorator","text":"<ul> <li> <p>Purpose:</p> <ul> <li>The decorator simplifies caching by wrapping any function so that its     results are automatically stored and retrieved from cache</li> </ul> </li> <li> <p>Decorator parameters:</p> <ul> <li><code>cache_type</code>: The type of cache storage to use (<code>\"json\"</code> or <code>\"pickle\"</code>)<ul> <li>Default: <code>\"json\"</code></li> <li>JSON is human-readable but limited to basic types</li> <li>Pickle supports any Python object but is not human-readable</li> </ul> </li> <li><code>write_through</code>: If True, flush cache to disk immediately after each update<ul> <li>Default: <code>True</code></li> <li>Ensures persistence across sessions but may impact performance for     frequently called functions</li> <li>Set to <code>False</code> for better performance when persistence is not critical</li> </ul> </li> <li><code>exclude_keys</code>: List of keyword argument names to exclude from cache key     generation<ul> <li>Default: <code>None</code> (empty list)</li> <li>Useful for excluding session-specific or non-deterministic parameters like     API clients, database connections, or logging objects</li> <li>These parameters are still passed to the function but don't affect cache     key matching</li> </ul> </li> </ul> </li> <li> <p>Flow:</p> <ul> <li>Initialization:<ul> <li>When the function is decorated with, for example,     <code>@simple_cache(cache_type=\"json\")</code>, the decorator sets the system property     for the cache type</li> </ul> </li> <li>Wrapper execution:<ul> <li>Key generation: The wrapper generates a <code>cache key</code> from both arguments     and keyword arguments.<ul> <li>Exclude Keys: The wrapper excludes certain keys from the cache key by     using the <code>exclude_keys</code> argument in the decorator. These keys are     omitted from <code>kwargs</code> when forming the cache key.</li> </ul> </li> <li>Cache lookup:<ul> <li>If the key exists in the memory cache (and no force refresh is     requested), it returns the cached value</li> <li>If the key is missing (or a force refresh is requested), it calls the     original function</li> </ul> </li> <li>Performance stats:<ul> <li>The system updates performance statistics for every call (incrementing     total, hits, or misses accordingly)</li> </ul> </li> <li>Cache update:<ul> <li>After computing the value, the result is stored in the memory cache (and     optionally written through to disk if <code>write_through</code> is set)</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>Runtime parameters:</p> <ul> <li>Decorated functions accept special keyword arguments to control caching     behavior at call time:<ul> <li><code>force_refresh=True</code>: Bypass cache and recompute the result even if it     exists in cache</li> <li><code>abort_on_cache_miss=True</code>: Raise a <code>ValueError</code> if cache miss occurs     instead of computing the value</li> <li><code>report_on_cache_miss=True</code>: Return the sentinel string <code>\"_cache_miss_\"</code>     instead of computing on cache miss</li> </ul> </li> <li>Alternative: Use <code>cache_mode</code> parameter with predefined modes:<ul> <li><code>cache_mode=\"REFRESH_CACHE\"</code>: Force cache refresh (equivalent to     <code>force_refresh=True</code>)</li> <li><code>cache_mode=\"HIT_CACHE_OR_ABORT\"</code>: Abort on cache miss (equivalent to     <code>abort_on_cache_miss=True</code>)</li> <li><code>cache_mode=\"DISABLE_CACHE\"</code>: Completely bypass caching for this call     only, compute fresh result without reading from or writing to cache</li> </ul> </li> </ul> </li> <li> <p>Flow Example:</p> <ul> <li>Suppose we have a function defined as follows:     <code>python @simple_cache(cache_type=\"json\")     def multiply_by_two(x):     return x * 2</code></li> <li>First call:<ul> <li>When you call <code>multiply_by_two(4)</code>, the cache key is generated (in this     case, <code>{\"args\": [4], \"kwargs\": {}}</code> as a string)</li> <li>Since the key is not in the cache, the function is executed, returning     <code>8</code>, which is then stored in the <code>memory cache</code>.</li> </ul> </li> <li>Subsequent call:<ul> <li>Calling <code>multiply_by_two(4)</code> again finds the key in the cache and     immediately returns <code>8</code> without executing the function again.</li> </ul> </li> <li>Force Refresh:<ul> <li>If the user property <code>force_refresh</code> is enabled for this function, even if     the key exists in the cache, the function is executed again, and the cache     is updated.</li> </ul> </li> </ul> </li> <li> <p>Configuration examples:</p> <ul> <li>Set Force Refresh:<ul> <li>With this property set, each call to <code>multiply_by_two(4)</code> will recompute     the result and update the cache.</li> </ul> </li> <li>Using runtime parameters:<ul> <li>Force a single cache refresh without changing global properties:     <code>python result = multiply_by_two(4, force_refresh=True)</code></li> <li>Use cache_mode to control behavior:     ```python</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#disable_cache_for_this_specific_call","title":"Disable cache for this specific call","text":"<p>result = multiply_by_two(4, cache_mode=\"DISABLE_CACHE\")</p>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#ensure_cache_is_hit_or_abort","title":"Ensure cache is hit or abort","text":"<p>result = multiply_by_two(4, cache_mode=\"HIT_CACHE_OR_ABORT\")             <code>- Enable `write_through`:         - When using `@simple_cache(write_through=True)`, the decorator will flush             the memory cache to disk immediately after updating.     - Exclude certain keys from cache key:         - Suppose we have a function that uses an OpenAI client to fetch             completions, but the actual output depends only on the prompt. The             `client` object should be excluded from the cache key because it varies             per session:</code>python @simple_cache(exclude_keys=[\"client\"]) def get_summary(prompt: str, client: Any):         return client.complete(prompt=prompt)             <code>``         - Without</code>exclude_keys=[\"client\"]<code>, each call with a different</code>client<code>instance (even for the same prompt) would result in a cache miss. This             exclusion ensures the cache key is based only on the</code>prompt`, improving             hit rates.</p>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#mock_cache","title":"Mock Cache","text":"<ul> <li> <p>Purpose:</p> <ul> <li>The <code>mock_cache</code> function allows testing of cached functions without     executing expensive operations (e.g., API calls, database queries, LLM     calls)</li> <li>Useful for unit testing when you want to simulate cached values without     actually calling the real function</li> </ul> </li> <li> <p>Function signature:     <code>python def mock_cache(func_name: str, args: Any, kwargs: Any, value: Any) -&gt; None</code></p> </li> <li> <p>Parameters:</p> <ul> <li><code>func_name</code>: The name of the cached function to mock</li> <li><code>args</code>: The positional arguments for the function (as a list)</li> <li><code>kwargs</code>: The keyword arguments for the function (as a dict)</li> <li><code>value</code>: The value to store in the cache (the return value to mock)</li> </ul> </li> <li> <p>Safety requirement:</p> <ul> <li><code>mock_cache</code> requires using a temporary cache directory (not the main cache     directory) to prevent accidentally polluting the production cache</li> <li>Use <code>set_cache_dir()</code> to configure a test-specific cache directory before     calling <code>mock_cache</code></li> </ul> </li> <li> <p>Typical workflow:</p> <ol> <li>Set up a temporary cache directory (e.g., using <code>self.get_scratch_space()</code>  in tests)</li> <li>(Optional) Warm up the cache by calling the function once to capture the  real cached value</li> <li>(Optional) Read the cached value for later reuse</li> <li>Reset the cache to clear all cached data</li> <li>Use <code>mock_cache()</code> to insert a known value for specific arguments</li> <li>Call the cached function with <code>abort_on_cache_miss=True</code> to verify the  cache is hit</li> </ol> </li> <li> <p>Flow example:</p> <ul> <li>Testing an expensive LLM call:     ```python import helpers.hcache_simple as hcacsimp</li> </ul> </li> </ul> <p>@hcacsimp.simple_cache(cache_type=\"json\") def call_llm(prompt: str) -&gt; str:         # Expensive LLM API call         return expensive_llm_api(prompt)</p>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#in_test","title":"In test:","text":"<p>def test_llm_function():         # Set up temporary cache directory         temp_dir = \"/tmp/test_cache\"         hcacsimp.set_cache_dir(temp_dir)</p> <pre><code>    # Mock the cache with a known response\n    test_prompt = \"Hello, world!\"\n    mock_response = \"Mocked LLM response\"\n    hcacsimp.mock_cache(\"call_llm\", [test_prompt], {}, mock_response)\n\n    # Verify cache hit (function not actually called)\n    result = call_llm(test_prompt, abort_on_cache_miss=True)\n    assert result == mock_response\n    ```\n</code></pre> <ul> <li>Use cases:<ul> <li>Testing functions that call expensive external APIs (OpenAI, AWS, etc.)</li> <li>Testing functions with non-deterministic behavior by providing fixed values</li> <li>Creating reproducible test scenarios without network dependencies</li> <li>Speeding up test suites by avoiding actual expensive computations</li> </ul> </li> </ul>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#common_misunderstandings","title":"Common Misunderstandings","text":"<ul> <li> <p>Cached Function Must Be Deterministic: The cache assumes the same inputs     always produce the same outputs. Functions with side effects or     non-deterministic behavior (e.g., randomness, time-based logic) may yield     inconsistent results.</p> </li> <li> <p><code>force_refresh</code> Must Be Reset: Once <code>force_refresh</code> is set, every call     recomputes the result. Users must manually unset this flag if they want to     resume normal caching.</p> </li> <li> <p>Disk Cache Is Persistent: Cache files on disk are not automatically     cleaned up or rotated. Old or unused caches may accumulate over time.</p> </li> <li> <p>write_through Default is True: By default, <code>write_through=True</code> causes     cache updates to be immediately written to disk. This ensures persistence but     may impact performance for frequently cached operations. Set to <code>False</code> if you     plan to manually flush caches.</p> </li> <li> <p>Cache Keys Include Both Args and Kwargs: The cache key is generated from     both positional arguments and keyword arguments. Two calls with the same     values but different parameter passing styles (positional vs keyword) may     create different cache entries unless normalized.</p> </li> </ul>"},{"location":"tools/helpers/all.hcache_simple.explanation.html#execution_flow_diagram","title":"Execution Flow Diagram","text":"<pre><code>flowchart TD\n        %% Decorator Setup %%\n        subgraph \"Decorator Setup\"\n                A1[Function Decorated with @simple_cache]\n                A2[Set System Property: type: json/pickle]\n                A3[Wrap Function with Caching Wrapper]\n                A1 --&gt; A2\n                A2 --&gt; A3\n        end\n\n        %% Function Call Flow %%\n        subgraph \"Function Call Flow\"\n                B1[Function Called with Args, Keyword Arguments]\n                B2[Generate Cache Key]\n                B3[Update Performance Totals]\n                B4{force_refresh Enabled?}\n                B5{Key in Memory Cache?}\n                B6[Cache Hit: Return Cached Value]\n                B7[Cache Miss: Evaluate Properties]\n                B8[Call Original Function]\n                B9[Store Result in Memory Cache]\n                B10{write_through Enabled?}\n                B11[Flush Memory Cache to Disk]\n                B12[Return Result]\n\n                A3 --&gt; B1\n                B1 --&gt; B2\n                B2 --&gt; B3\n                B3 --&gt; B4\n                B4 -- Yes --&gt; B8\n                B4 -- No --&gt; B5\n                B5 -- Yes --&gt; B6\n                B5 -- No --&gt; B7\n                B7 --&gt; B8\n                B8 --&gt; B9\n                B9 --&gt; B10\n                B10 -- Yes --&gt; B11\n                B10 -- No --&gt; B12\n                B11 --&gt; B12\n        end\n\n        %% Disk Cache Operations %%\n        subgraph \"Disk Cache Operations\"\n                C1[Flush Cache to Disk]\n                C2[Force Cache from Disk]\n        end\n\n        %% Cache Properties &amp; Performance %%\n        subgraph \"Properties &amp; Performance\"\n                D1[User Properties:&lt;br&gt;force_refresh, abort_on_cache_miss,&lt;br&gt;report_on_cache_miss]\n                D2[System Properties:&lt;br&gt;cache type: json/pickle]\n                D3[Performance Stats:&lt;br&gt;tot, hits, misses]\n        end\n\n        %% Connections for Reference %%\n        B12 --- C1\n        C2 --- B9\n        D1 --- B4\n        D2 --- A2\n        D3 --- B3</code></pre>"},{"location":"tools/helpers/all.hllm.explanation.html","title":"All.hllm.explanation","text":""},{"location":"tools/helpers/all.hllm.explanation.html#hllm_explanation","title":"hllm \u2013 Explanation","text":""},{"location":"tools/helpers/all.hllm.explanation.html#overview","title":"Overview","text":"<ul> <li><code>hllm.get_completion()</code> is a helper function that sends prompts to LLMs     (OpenAI or OpenRouter) and returns their responses</li> <li> <p>It includes a custom caching mechanism to reduce redundant requests and allow     unit testing</p> </li> <li> <p>An example call to the LLM interface is</p> <p>```python from helpers import hllm</p> </li> </ul> <p>response = hllm.get_completion(         user_prompt=\"What is machine learning?\",         system_prompt=\"You are a helpful assistant.\",         model=\"gpt-4o-mini\",         cache_mode=\"DISABLE_CACHE\",         cache_file=\"cache.get_completion.json\",         temperature=0.5 )     ```</p> <ul> <li>The parameters used in the example are:<ul> <li><code>user_prompt</code>: User's message to the LLM.</li> <li><code>system_prompt</code>: Context-setting instruction for the assistant.</li> <li><code>model</code>: OpenAI or OpenRouter model to use.</li> <li><code>cache_mode</code>: One of:<ul> <li><code>\"DISABLE_CACHE\"</code>: No caching.</li> <li><code>\"HIT_CACHE_OR_ABORT\"</code>: Only use cached response; raise error if not     found.</li> <li><code>\"NORMAL\"</code>: Use cache if available, else make an API call.</li> <li><code>\"REFRESH_CACHE\"</code>: Always make an API call and update the cache.</li> </ul> </li> <li><code>cache_file</code>: Path to JSON cache file.</li> <li><code>temperature</code>: Sampling temperature (0-2).</li> <li><code>**create_kwargs</code>: Additional arguments passed to the API.</li> </ul> </li> </ul>"},{"location":"tools/helpers/all.hllm.explanation.html#caching_logic","title":"Caching Logic","text":"<ul> <li> <p>The caching mechanism uses a hashed key generated from:</p> <ul> <li><code>user_prompt</code></li> <li><code>system_prompt</code></li> <li><code>model</code></li> <li><code>temperature</code></li> <li>Additional parameters</li> </ul> </li> <li> <p>The caching layer</p> <ul> <li>Reads from <code>cache_file</code> on load</li> <li>Writes to disk when cache is updated</li> <li>Tracks metadata:<ul> <li><code>hits</code> : Number of times the cache returned a value.</li> <li><code>misses</code>: Number of times the function looked for response in cache but     didn't find</li> <li>Timestamps : Stores both <code>created_at</code> and <code>last_updated</code> timestamps.</li> </ul> </li> </ul> </li> <li> <p>The cache storage format:     <pre><code>{\n    \"version\": \"1.0\",\n    \"metadata\": {\n        \"created_at\": \"...\",\n        \"last_updated\": \"...\",\n        \"hits\": 10,\n        \"misses\": 5\n    },\n    \"entries\": {\n        \"&lt;hash_key&gt;\": {\n            \"request\": { ... },\n            \"response\": { ... }\n        }\n    }\n}\n</code></pre></p> </li> </ul>"},{"location":"tools/helpers/all.hllm.explanation.html#cost_calculation","title":"Cost Calculation","text":""},{"location":"tools/helpers/all.hllm.explanation.html#openai_models","title":"OpenAI Models","text":"<ul> <li>For OpenAI models like <code>gpt-4o</code> or <code>gpt-3.5-turbo</code>, the cost is computed using     hardcoded pricing from OpenAI's pricing page</li> <li> <p>Each model has a per-token price for both the prompt and completion     components:</p> <p><code>python pricing = {     \"gpt-3.5-turbo\": {\"prompt\": 0.5, \"completion\": 1.5},     \"gpt-4o-mini\": {\"prompt\": 0.15, \"completion\": 0.60},     ... }</code></p> </li> <li> <p>The formula used is:     <pre><code>cost = (prompt_tokens / 1e6) * prompt_price + (completion_tokens / 1e6) * completion_price\n</code></pre></p> </li> </ul>"},{"location":"tools/helpers/all.hllm.explanation.html#openrouter_models","title":"OpenRouter Models","text":"<ul> <li>For OpenRouter models the price is extracted through the API<ol> <li>If the local file <code>tmp.openrouter_models_info.csv</code> does not exist:</li> <li>It queries <code>https://openrouter.ai/api/v1/models</code></li> <li>Saves the returned model pricing and metadata to a CSV file</li> <li>The cost is computed using:  <code>python cost = prompt_tokens * prompt_price + completion_tokens * completion_price</code></li> <li>Note: OpenRouter prices are already in per-token format.</li> </ol> </li> </ul>"},{"location":"tools/helpers/all.hllm.explanation.html#runtime_behavior","title":"Runtime Behavior","text":"<ul> <li>The cost is printed if <code>print_cost=True</code></li> <li>It's also stored in the cache JSON under <code>response[\"cost\"]</code></li> <li>All costs (if <code>start_logging_costs()</code> is called) accumulate in a global     counter accessible via <code>get_current_cost()</code></li> </ul>"},{"location":"tools/helpers/all.hllm.explanation.html#entire_flow","title":"Entire Flow","text":"<p>This section summarizes how <code>get_completion()</code> operates internally.</p> <ol> <li>Input Handling</li> <li>Accepts <code>user_prompt</code>, <code>system_prompt</code>, <code>model</code>, <code>cache_mode</code>, and other      parameters.</li> <li> <p>Builds OpenAI-compatible input according to the API specifications.</p> </li> <li> <p>Cache Key Creation</p> </li> <li> <p>Calls <code>_CompletionCache.hash_key_generator()</code> using model, prompts, and      parameters to produce a unique hash key.</p> </li> <li> <p>Cache Behavior</p> </li> <li>If <code>cache_mode == \"HIT_CACHE_OR_ABORT\"</code>:<ul> <li>Looks up the response using hash key.</li> <li>If not found, raises an error.</li> </ul> </li> <li>If <code>cache_mode == \"NORMAL\"</code>:<ul> <li>Returns cached response if available.</li> <li>Otherwise proceeds to make an API call and saves the new response to    cache.</li> </ul> </li> <li>If <code>cache_mode == \"REFRESH_CACHE\"</code>:<ul> <li>Always makes a fresh API call and updates cache.</li> </ul> </li> <li> <p>If <code>cache_mode == \"DISABLE_CACHE\"</code>:</p> <ul> <li>Makes a fresh API call and does not touch cache.</li> </ul> </li> <li> <p>API Call Execution</p> </li> <li>Calls OpenAI API synchronously (with or without streaming).</li> <li> <p>Collects the full LLM output and underlying text response.</p> </li> <li> <p>Cost Estimation</p> </li> <li>Uses <code>_calculate_cost()</code> to compute token usage cost.</li> <li> <p>If enabled, accumulates cost using <code>start_logging_costs()</code>.</p> </li> <li> <p>Response Caching</p> </li> <li>Saves response to cache via <code>_CompletionCache.save_response_to_cache()</code> (if      applicable).</li> <li> <p>Cost and response metadata are saved in JSON.</p> </li> <li> <p>Return</p> </li> <li>Returns either the full LLM output including metadata, or only its text       contents.</li> <li> <p>The type of returned value is controlled by the <code>return_raw</code> flag.</p> </li> <li> <p>All caching operations are handled by the <code>_CompletionCache</code> class.</p> </li> </ol>"},{"location":"tools/helpers/all.hllm.explanation.html#how_testing_works","title":"How Testing Works","text":"<ul> <li>During unit tests, the cache:<ul> <li>Is set in <code>HIT_CACHE_OR_ABORT</code> mode to avoid real API calls (tests raise     error if the required response is not cached)</li> <li>Uses for cache a file that is checked into the repo</li> <li>Expected prompts and responses are cached beforehand or as tests are     executed</li> </ul> </li> </ul>"},{"location":"tools/helpers/all.hllm.explanation.html#cache_refreshing","title":"Cache Refreshing","text":"<ul> <li> <p>When testing, it might be necessary to regenerate cached responses, e.g.,</p> <ul> <li>Prompts or expected completions have changed.</li> <li>You are adding a new test using a LLM prompt</li> <li>You want to ensure the cache reflects the latest LLM output.</li> </ul> </li> <li> <p>When testing, it might be necessary to regenerate cached responses after     making prompt or model changes. You can trigger cache refreshing using:</p> <p><pre><code>&gt; pytest --update_llm_cache\n</code></pre> - This sets the global <code>UPDATE_LLM_CACHE</code> flag (defined in your conftest or     test setup for now later it will be moved to <code>hllm.py</code>). - Internally, this sets <code>cache_mode=\"REFRESH_CACHE\"</code> when calling     <code>get_completion()</code>.     - All API calls will be re-executed even if cached versions exist.     - The cache file (e.g., <code>cache.get_completion.json</code>) is updated with new         responses.     - Metadata like <code>last_updated</code>, <code>hits</code>, and <code>misses</code> are also updated.</p> </li> <li> <p>Note that the cache might contain old prompts that are not needed anymore</p> <ul> <li>If you want to generate a cache with all and only what is needed, you can     delete the unit test cache and then run all the tests with     <code>--update_llm_cache</code></li> </ul> </li> <li> <p>Once the cache is refreshed, the cache should be reviewed and committed the     updated cache file to version control</p> </li> </ul>"},{"location":"tools/helpers/all.hllm.explanation.html#proposal_for_integrating_hcache_simplesimple_cache","title":"Proposal for integrating <code>hcache_simple.simple_cache()</code>","text":"<ul> <li> <p>Consolidating the bespoke <code>_CompletionCache</code> logic in <code>hllm.get_completion()</code>     by adopting the <code>simple_cache()</code> decorator from <code>helpers.hcache_simple</code>.</p> </li> <li> <p>Instead of wrapping the top\u2010level <code>get_completion()</code>, apply caching directly     to the internal <code>_call_api_sync</code> function where the actual OpenAI/OpenRouter     API call is made:</p> <p>```python from helpers import hcache_simple as hcacsimp</p> </li> </ul> <p>@hcacsimp.simple_cache(         write_through=True,         exclude_keys=[\"client\", \"cache_mode\"], ) def _call_api_sync_cached(         cache_mode: str,         client: openai.OpenAI,         user_prompt: str,         system_prompt: str,         temperature: float,         model: str,         ,         images_as_base64: Optional[Tuple[str, ...]] = None,         cost_tracker: Optional[LLMCostTracker] = None,         use_responses_api: bool = False,         create_kwargs, ) -&gt; Dict[str, Any]:         hdbg.dassert_in(cache_mode, (\"REFRESH_CACHE\", \"HIT_CACHE_OR_ABORT\", \"NORMAL\"))         return _call_api_sync(                 client=client,                 user_prompt=user_prompt,                 system_prompt=system_prompt,                 temperature=temperature,                 model=model,                 images_as_base64=images_as_base64,                 cost_tracker=cost_tracker,                 use_responses_api=use_responses_api,                 *create_kwargs,         )     ```</p> <ul> <li> <p>In <code>get_completion()</code>, map the existing <code>cache_mode</code> values to the     <code>simple_cache()</code>'s parameters:</p> <ul> <li><code>REFRESH_CACHE</code> \u2192 <code>force_refresh=True</code></li> <li><code>HIT_CACHE_OR_ABORT</code> \u2192 <code>abort_on_cache_miss=True</code></li> </ul> </li> <li> <p>Benefits</p> <ul> <li>Leverages <code>hcache_simple</code>'s tested in\u2010memory and disk caching.</li> <li>Eliminates custom JSON serialization and metadata management.</li> <li>Simplifies <code>hllm.py</code> by removing the <code>_CompletionCache</code> class.</li> </ul> </li> <li> <p>Trade-offs</p> <ul> <li>The legacy prompt normalization (lowercasing and whitespace trimming) must     be handled upstream if still required.</li> <li>Cache metadata format and statistics will follow <code>hcache_simple</code> conventions     rather than the custom JSON schema.</li> </ul> </li> </ul>"},{"location":"tools/helpers/all.hplayback.how_to_guide.html","title":"All.hplayback.how to guide","text":""},{"location":"tools/helpers/all.hplayback.how_to_guide.html#playback","title":"Playback","text":"<ul> <li> <p><code>Playback</code> is a way to automatically generate a unit test for a given function     by capturing the inputs applied to the function by the external world</p> </li> <li> <p>The working principle is:</p> <ol> <li>Instrument the target function <code>f()</code> to test with a <code>Playback</code> object or  with a decorator <code>@playback</code></li> <li>Run the function <code>f()</code> using the external code to drive its inputs</li> <li>E.g., while the function is executed as part of a more complex system, or    in a notebook</li> <li>The playback framework:</li> <li>Captures the inputs and the output of the function <code>f()</code></li> <li>Generates Python code to apply the stimuli to <code>f()</code> and to check its    output against the expected output</li> <li>Modify the code automatically generated by <code>Playback</code> to create handcrafted  unit tests</li> </ol> </li> </ul>"},{"location":"tools/helpers/all.hplayback.how_to_guide.html#code_and_tests","title":"Code and tests","text":"<ul> <li>The code for <code>Playback</code> is located at <code>helpers/hplayback.py</code></li> <li>Unit tests for <code>Playback</code> with useful usage examples are located at     <code>helpers/test/test_playback.py</code></li> </ul>"},{"location":"tools/helpers/all.hplayback.how_to_guide.html#using_playback","title":"Using playback","text":""},{"location":"tools/helpers/all.hplayback.how_to_guide.html#quick_start","title":"Quick start","text":"<ul> <li>Given a function to test like:</li> </ul> <pre><code>def function_under_test(...) -&gt; ...:\n        ...\n        &lt;code&gt;\n        ...\n        res = ...\n        return res\n</code></pre> <pre><code>def function_under_test(...) -&gt; ...:\n        import helpers.hplayback as hplayb\n        playback = hplayb.Playback(\"assert_equal\")\n\n        ...\n        &lt;code&gt;\n        ...\n\n        res = ...\n        code = playback.run(res)\n        print(code)\n        return res\n</code></pre>"},{"location":"tools/helpers/all.hplayback.how_to_guide.html#example_1_testing_get_sum","title":"Example 1: testing <code>get_sum()</code>","text":"<ul> <li> <p>Assume that we want unit test a function <code>get_sum()</code></p> <p><code>python def get_sum(a: List[int], b: List[int]) -&gt; Any:     c = a + b     return c</code></p> </li> <li> <p>Assume that typically <code>get_sum()</code> gets its inputs from a complex pipeline</p> <p><code>python def complex_data_pipeline() -&gt; Tuple[List[int], List[int]]:    # Incredibly complex pipeline generating:    a = [1, 2, 3]    b = [4, 5, 6]    return a, b</code></p> </li> <li> <p>The function is called with:</p> <p><code>python a, b = complex_data_pipeline() c = get_sum(a, b)</code></p> </li> <li> <p>We don't want to compute by hand the inputs <code>a, b</code>, but we can reuse     <code>complex_data_pipeline</code> to create a realistic workload for the function under     test</p> </li> <li> <p>Instrument the code with <code>Playback</code>:</p> <p>```python import helpers.playback as hplayb</p> </li> </ul> <p>def get_sum(a: List[int], b: List[int]) -&gt; Any:         playback = hplayb.Playback(\"assert_equal\")         c = a + b         code = playback.run(res)         print(code)         return c     ```</p> <ul> <li> <p>Create the playback object</p> <p><code>python playback = hplayb.Playback(\"assert_equal\")</code></p> <p>which specifies: - The unit test mode: \"check_string\" or \"assert_equal\" - The function name that is being tested: in our case, \"get_sum\" - The function parameters that were created earlier</p> </li> <li> <p>Run it with:</p> <p><code>python a, b = complex_data_pipeline() c = get_sum(a, b)</code></p> </li> <li> <p>Run the playback passing the expected outcome as a parameter</p> <p><code>python code = playback.run(res)</code></p> </li> <li> <p>The output <code>code</code> will contain a string with the unit test for <code>get_sum()</code></p> <p>```python import helpers.unit_test as hut</p> </li> </ul> <p>class TestGetSum(hut.TestCase):         def test1(self) -&gt; None:                 # Initialize function parameters.                 a = [1, 2, 3]                 b = [4, 5, 6]                 # Get the actual function output.                 act = get_sum(a, b)                 # Create the expected function output.                 exp = [1, 2, 3, 4, 5, 6]                 # Check whether the expected value equals the actual value.                 self.assertEqual(act, exp)     ```</p>"},{"location":"tools/helpers/all.hplayback.how_to_guide.html#example_2_testing_render_images_from_render_imagespy","title":"Example 2: testing <code>_render_images()</code> from <code>render_images.py</code>","text":"<ul> <li> <p>Copy real <code>im_architecture.md</code> to a test location</p> </li> <li> <p>Add playback into the code:</p> <p><code>python ... import helpers.playback as hplayb ... def _render_images(     in_lines: List[str], out_file: str, dst_ext: str, dry_run: bool ) -&gt; List[str]:     # Generate test.     playback = hplayb.Playback(\"check_string\")     print(prnt.frame(playback.run(None)))     ... ...</code></p> </li> <li> <p>Run <code>render_images.py -i im_architecture.md</code></p> </li> <li> <p>The following output is prompted:</p> <p>```python</p> </li> </ul> <p>class TestRenderImages(hut.TestCase):         def test1(self) -&gt; None:                 # Define input variables.                 in_lines = [\"\", ..., \"\", \"&gt; GP:: Not urgent\", \"\"]                 out_file = \"im_architecture.md\"                 dst_ext = \"png\"                 dry_run = False                 # Call function to test.                 act = _render_images(in_lines=in_lines, out_file=out_file, dst_ext=dst_ext, dry_run=dry_run)                 act = str(act)                 # Check output.                 self.check_string(act)     ```</p> <ul> <li><code>in_lines</code> value is too long to keep it in test - needed to be replaced with     previously generated file. Also some cosmetic changes are needed and code is     ready to paste to the existing test:     <code>python def test_render_images_playback1(self) -&gt; None:         \"\"\"Test real usage for im_architecture.md.test\"\"\"         # Define input variables.         file_name = \"im_architecture.md.test\"         in_file = os.path.join(self.get_input_dir(), file_name)         in_lines = io_.from_file(in_file).split(\"\\n\")         out_file = os.path.join(self.get_scratch_space(), file_name)         dst_ext = \"png\"         dry_run = True         # Call function to test.         act = rmd._render_images(                 in_lines=in_lines, out_file=out_file, dst_ext=dst_ext, dry_run=dry_run         )         act = \"\\n\".join(act)         # Check output.         self.check_string(act)</code></li> </ul>"},{"location":"tools/helpers/all.hplayback.how_to_guide.html#test_created_for_main_render_images","title":"Test created for main._render_images","text":"<p>import helpers.unit_test as hut import jsonpickle import pandas as pd</p>"},{"location":"tools/helpers/all.qgrid.how_to_guide.html","title":"All.qgrid.how to guide","text":""},{"location":"tools/helpers/all.qgrid.how_to_guide.html#qgrid","title":"Qgrid","text":""},{"location":"tools/helpers/all.qgrid.how_to_guide.html#some_documentation","title":"Some documentation","text":"<ul> <li>GitHub: https://github.com/quantopian/qgrid</li> <li>Official documentation: https://qgrid.readthedocs.io/en/latest</li> <li>Interesting demo:     https://mybinder.org/v2/gh/quantopian/qgrid-notebooks/master?filepath=index.ipynb</li> </ul>"},{"location":"tools/helpers/all.qgrid.how_to_guide.html#testing","title":"Testing","text":"<ul> <li> <p>Pandas &gt;1.0 needs qgrid at least 1.3.0 which is installed in our</p> <p><code>python print(qgrid.__version__) 1.3.0</code></p> </li> <li> <p>Go to the gallery notebook as in:     http://localhost:10002/notebooks/amp/core/notebooks/gallery_examples.ipynb#Qgrid</p> </li> <li> <p>Make sure you can see the output of the cells</p> </li> <li> <p>If not you might need to apply the fix as per     https://github.com/quantopian/qgrid/issues/253</p> <ul> <li>Stop the notebook server</li> <li>Execute</li> </ul> <p><pre><code>&gt; jupyter nbextension enable --py --sys-prefix qgrid\n/Users/saggese/.conda/envs/develop/bin/jupytext\njupyter nbextension enable --py --sys-prefix widgetsnbextensionEnabling notebook extension qgrid/extension...\n            - Validating: OK\n\n&gt; jupyter nbextension enable --py --sys-prefix widgetsnbextension\n/Users/saggese/.conda/envs/develop/bin/jupytext\nEnabling notebook extension jupyter-js-widgets/extension...\n            - Validating: OK\n</code></pre> - Restart the notebook - Test again with the gallery notebook</p> </li> </ul>"},{"location":"tools/helpers/all.str_to_df.how_to_guide.html","title":"All.str to df.how to guide","text":""},{"location":"tools/helpers/all.str_to_df.how_to_guide.html#converting_a_string_into_a_pandas_df","title":"Converting a string into a Pandas df","text":""},{"location":"tools/helpers/all.str_to_df.how_to_guide.html#rationale","title":"Rationale","text":"<p>Standard ways to construct a Pandas dataframe from data (e.g., from a dict or a list of lists) are extremely cumbersome, especially for longer dataframes with many rows. Our goal is to introduce a tool that allows to create a Pandas dataframe from its string representation, which is much more readable.</p> <p>Compare the data needed to create a df in a standard way:</p> <pre><code>data = {\n        1030828978: [0.20136, 0.20158, 0.20162, 0.20128, 0.20134, 0.20110],\n        1464553467: [\n                1838.812,\n                1839.690,\n                1839.936,\n                1839.430,\n                1840.016,\n                1839.615,\n        ]\n}\ntimestamps = pd.date_range(\n        start=\"2023-08-15 11:45:00\",\n        end=\"2023-08-15 12:10:00\",\n        tz=\"America/New_York\",\n        freq=\"5T\",\n)\n</code></pre> <p>To the data needed to create a df with our tool:</p> <pre><code>df_as_str = \"\"\"\n                               1030828978  1464553467\nend_timestamp\n\"2023-08-15 11:45:00-04:00\"     0.20136    1838.812\n\"2023-08-15 11:50:00-04:00\"     0.20158    1839.690\n\"2023-08-15 11:55:00-04:00\"     0.20162    1839.936\n\"2023-08-15 12:00:00-04:00\"     0.20128    1839.430\n\"2023-08-15 12:05:00-04:00\"     0.20134    1840.016\n\"2023-08-15 12:10:00-04:00\"     0.20110    1839.615\"\"\"\n</code></pre>"},{"location":"tools/helpers/all.str_to_df.how_to_guide.html#how_to_use","title":"How to use","text":"<ul> <li>The function is <code>str_to_df()</code>, located in <code>helpers/hpandas.py</code></li> <li>To use the function, one needs to provide a string representation of the df     and the mappings between the columns and the desired types of column names and     values</li> <li>For example, given the string representation of a df in the previous section     and the following mappings:</li> </ul> <pre><code>col_to_type = {\n        \"__index__\": pd.Timestamp,\n        \"1030828978\": float,\n        \"1464553467\": float,\n}\ncol_to_name_type = {\n        \"1030828978\": int,\n        \"1464553467\": int,\n}\n</code></pre> <p><code>str_to_df()</code> will output the following dataframe:</p> <p></p> <ul> <li>More usage examples can be found, e.g.:<ul> <li>In the dedicated unit tests in     <code>helpers/test/test_hpandas.py::Test_str_to_df</code></li> <li>In practical use cases in <code>oms/order/test/test_order_converter.py</code></li> </ul> </li> </ul>"},{"location":"tools/helpers/all.str_to_df.how_to_guide.html#notes","title":"Notes","text":"<ul> <li>The string representation used as an input to the function should be largely     the same as the output of <code>hpandas.df_to_str()</code>. Note that it is not the same     as the output of <code>str()</code>, which is much less controlled and therefore messier     than of <code>df_to_str()</code> (e.g., the column names are often split into different     rows far away from each other, etc)</li> <li>There are several differences between the raw output of <code>df_to_str()</code> and the     required format of the input to <code>str_to_df()</code>:<ul> <li>If the number of rows is over a certain number, then <code>df_to_str()</code> cuts     them, leaving only the head and the tail of the df, and everything in     between is replaced by the \"[...]\" placeholder. In <code>str_to_df()</code>, the     placeholder \"[...]\" is simply removed and the data it stands for cannot be     restored</li> <li>In the input to <code>str_to_df()</code>, values that contain spaces (e.g., a timestamp     like \"2000-01-01 09:00:00\") need to be enclosed in double quotation marks.     If there are values with spaces in the input to <code>df_to_str()</code>, then it will     convert them into strings but will not automatically put quotation marks     around them, which means that if we attempt to convert the output string     back into a df with <code>str_to_df()</code> without adding the quotation marks     manually, these values will be split into two different columns, possibly     also breaking the whole process due to the column number mismatch</li> </ul> </li> </ul>"},{"location":"tools/linter/all.amp_fix_md_links.explanation.html","title":"All.amp fix md links.explanation","text":""},{"location":"tools/linter/all.amp_fix_md_links.explanation.html#fixing_link_formatting_in_markdown_files","title":"Fixing link formatting in Markdown files","text":""},{"location":"tools/linter/all.amp_fix_md_links.explanation.html#problem","title":"Problem","text":"<ul> <li>Our Markdown documentation typically contains many links to various files;     however, the formatting of the links is not always uniform<ul> <li>E.g., a link to a figure can follow the HTML standard:     <code>&lt;img src=\"PATH_TO_FIG\"&gt;</code></li> <li>Or it can follow the Markdown standard: <code>![](PATH_TO_FIG)</code></li> </ul> </li> <li>Links may also become obsolete, for example, if a file gets renamed, moved     elsewhere or deleted but the Markdown is not updated</li> <li>We want the links to have consistent formatting and not to point to     non-existent files</li> </ul>"},{"location":"tools/linter/all.amp_fix_md_links.explanation.html#solution","title":"Solution","text":"<ul> <li>Add a Linter step <code>amp_fix_md_links</code> that<ul> <li>Regularizes the format of file links and figure pointers</li> <li>Issues a warning if a link is pointing to a file that does not exist</li> </ul> </li> </ul>"},{"location":"tools/linter/all.amp_fix_md_links.explanation.html#formatting_conventions","title":"Formatting conventions","text":"<ul> <li>We adopt the following conventions regarding the formatting of links in     Markdown:<ul> <li>The format of a link is     <code>[/DIR_NAME/FILE_NAME](/DIR_NAME/FILE_NAME)</code><ul> <li>E.g., <code>[/dir1/dir2/file.py](/dir1/dir2/file.py)</code></li> <li>The link text is the same as the link<ul> <li>Unless it is a regular text (not a file path), e.g.,     <code>[here](/dir1/dir2/file.py)</code></li> </ul> </li> <li>The link is an absolute path to the file (not a relative path and not a     URL)</li> </ul> </li> <li>A bare file path <code>/DIR_NAME/FILE_NAME</code> is converted into a     link, which should conform to the conventions described above<ul> <li>E.g., <code>/dir1/dir2/file{dot}py</code> is converted into     <code>[/dir1/dir2/file.py](/dir1/dir2/file.py)</code></li> </ul> </li> <li>The format of a figure pointer is     <code>&lt;img src=\"figs/DIR_NAME/FILE_NAME\"&gt;</code><ul> <li>E.g., <code>&lt;img src=\"figs/all.docs.md/file.png\"&gt;</code></li> <li><code>DIR_NAME</code> is the same as the name of the Markdown file where the figure     pointer is located</li> <li>An additional warning is issued if the actual path to the figure does not     conform to this format</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/linter/all.developing_linter.how_to_guide.html","title":"All.developing linter.how to guide","text":""},{"location":"tools/linter/all.developing_linter.how_to_guide.html#linter","title":"Linter","text":"<ul> <li>Linter enforces coding rules we aim to follow</li> <li>It is a set of Python scripts that check and possibly modify the code to     improve its readability and style, detect bugs and other technical issues</li> </ul>"},{"location":"tools/linter/all.developing_linter.how_to_guide.html#structure_of_a_linter_script","title":"Structure of a Linter script","text":"<ul> <li>Each Linter script contains a <code>linters.action.Action</code> class<ul> <li>It has the following implemented interface methods:<ul> <li><code>_execute(self, file_name: str, pedantic: int) -&gt; List[str])</code> --- returns     a list of lines where the script detected a failure, along with the     failure description</li> <li><code>check_if_possible(self) -&gt; bool</code> --- returns True if it is possible to     execute an action in the current environment</li> </ul> </li> <li>It accepts a list of files as an argument for the <code>run()</code> method</li> <li>Executing a script is running the <code>_execute()</code> method on all the files from     the list of files passed to <code>run()</code></li> </ul> </li> <li>Normally, a Linter script checks whether the input files conform to certain     conventions and (optionally) modifies them if they do not</li> <li>For an example of how a Linter script should look like, refer to any of the     existing ones in <code>linters/</code></li> </ul>"},{"location":"tools/linter/all.developing_linter.how_to_guide.html#how_to_introduce_a_new_linter_step","title":"How to introduce a new Linter step","text":"<ul> <li> <p>Create a Python script with the new functionality in <code>linters/</code></p> <ul> <li>Regarding the style and structure of the code, follow the example of the     existing Linter scripts</li> </ul> </li> <li> <p>Add the new Action to the list of actions in     <code>/linters/base.py</code></p> <ul> <li>Add to <code>_MODIFYING_ACTIONS</code> if it is supposed to modify the files it runs on     (e.g., fix mistakes, remove or add code)</li> <li>Add to <code>_NON_MODIFYING_ACTIONS</code> if it only checks the files and reports the     results (e.g., warns about incorrect formatting)</li> <li>Specify the name of the action (usually the name of the script without the     \"amp_\" prefix and without the extension), a short description of what it     does and a reference to the action class</li> </ul> </li> <li>Unit test the new code in <code>linters/test/</code><ul> <li>Add a specific test file for the new code (follow the example of the     existing test files)</li> <li>(Optional) Add some lines that you expect to trigger and not to trigger the     new Linter step to the string in     <code>Test_linter_py1._get_horrible_python_code1()</code> in     <code>/linters/test/test_amp_dev_scripts.py</code>,     and verify that your expectations are correct by updating the golden     outcomes of the tests in this test file</li> </ul> </li> <li>Add the new Linter script with a short description to the list below (in     alphabetical order)</li> </ul>"},{"location":"tools/linter/all.developing_linter.how_to_guide.html#list_of_linter_scripts","title":"List of Linter scripts","text":""},{"location":"tools/linter/all.developing_linter.how_to_guide.html#bringing_the_files_in_accordance_with_our_rules_modifying","title":"Bringing the files in accordance with our rules (modifying)","text":"<ul> <li> <p><code>add_python_init_files.py</code></p> <ul> <li>Adds missing <code>__init__.py</code> files to directories</li> </ul> </li> <li> <p><code>amp_add_class_frames.py</code></p> <ul> <li>Adds frames with class names before the classes are initialized</li> </ul> </li> <li> <p><code>amp_add_toc_to_notebook.py</code></p> <ul> <li>Adds a table of contents to the first cell of an IPython notebook</li> </ul> </li> <li> <p><code>amp_autoflake.py</code></p> <ul> <li>A wrapper around <code>autoflake</code></li> <li>Removes unused imports and variables</li> </ul> </li> <li> <p><code>amp_black.py</code></p> <ul> <li>A wrapper around <code>black</code></li> </ul> </li> <li> <p><code>amp_check_md_toc_headers.py</code></p> <ul> <li>Checks that there is no content before TOC and ensures header levels are     following hierarchical order without skipping levels.</li> </ul> </li> <li> <p><code>amp_class_method_order.py</code></p> <ul> <li>Sorts methods in classes so that they are in the order of<ul> <li>Init</li> <li>Magic</li> <li>Public static</li> <li>Public regular</li> <li>Private static</li> <li>Private regular</li> </ul> </li> </ul> </li> <li> <p><code>amp_doc_formatter.py</code></p> <ul> <li>A wrapper around <code>docformatter</code> and     <code>pydocstyle</code></li> </ul> </li> <li> <p><code>amp_fix_comments.py</code></p> <ul> <li>Reflows, capitalizes and adds punctuation to comment lines</li> <li>NB! Currently disabled due to instability.</li> </ul> </li> <li> <p><code>amp_fix_md_links.py</code></p> <ul> <li>Regularizes the format of links to files (incl. figure pointers) in Markdown     and checks if the files referenced by the links exist</li> </ul> </li> <li> <p><code>amp_fix_whitespaces.py</code></p> <ul> <li>Standardizes the use of whitespace characters (spaces, tabs, newlines, etc.)</li> </ul> </li> <li> <p><code>amp_format_separating_line.py</code></p> <ul> <li>Normalizes separating lines in the code</li> </ul> </li> <li> <p><code>amp_isort.py</code></p> <ul> <li>A wrapper around <code>isort</code></li> </ul> </li> <li> <p><code>amp_lint_md.py</code></p> <ul> <li>A wrapper around <code>prettier</code>.</li> <li>Cleans up Markdown files and updates the table of contents</li> </ul> </li> <li> <p><code>amp_normalize_import.py</code></p> <ul> <li>Normalizes imports in the code and in the docstring according to our     conventions</li> </ul> </li> <li> <p><code>amp_processjupytext.py</code></p> <ul> <li>A wrapper around <code>jupytext</code></li> <li>Keeps paired <code>.ipynb</code> and <code>.py</code> files synchronized</li> </ul> </li> <li> <p><code>amp_remove_empty_lines_in_function.py</code></p> <ul> <li>Cleans up empty lines inside functions and methods</li> </ul> </li> </ul>"},{"location":"tools/linter/all.developing_linter.how_to_guide.html#checking_if_the_files_are_in_accordance_with_our_rules_non-modifying","title":"Checking if the files are in accordance with our rules (non-modifying)","text":"<ul> <li> <p><code>amp_check_file_size.py</code></p> <ul> <li>Checks that files do not exceed the maximum size</li> </ul> </li> <li> <p><code>amp_check_filename.py</code></p> <ul> <li>Checks that test files and notebooks are located in <code>test</code>/<code>notebooks</code> dirs     respectively</li> <li>Checks that the names of non-Master notebooks contain a reference to a task</li> </ul> </li> <li> <p><code>amp_check_import.py</code></p> <ul> <li>Checks that the <code>from ... import ...</code> pattern is used only for the <code>typing</code>     package</li> <li>Confirms that the short import length in <code>import ... as ...</code> is no longer     than 8 symbols</li> </ul> </li> <li> <p><code>amp_check_md_reference.py</code></p> <ul> <li>Checks if the markdown file is referenced in README.md</li> </ul> </li> <li> <p><code>amp_check_merge_conflict.py</code></p> <ul> <li>Checks the file for git merge conflict markers (e.g. \"&lt;&lt;&lt;&lt;&lt;&lt;&lt; \")</li> </ul> </li> <li> <p><code>amp_check_shebang.py</code></p> <ul> <li>Check that all and only executable Python files start with a shebang</li> <li>NB! Currently disabled, see DevToolsTask97.</li> </ul> </li> <li> <p><code>amp_flake8.py</code></p> <ul> <li>A wrapper around <code>flake8</code></li> </ul> </li> <li> <p><code>amp_mypy.py</code></p> <ul> <li>A wrapper around <code>mypy</code></li> </ul> </li> <li> <p><code>amp_pylint.py</code></p> <ul> <li>A wrapper around <code>pylint</code></li> </ul> </li> <li> <p><code>amp_warn_incorrectly_formatted_todo.py</code></p> <ul> <li>Checks that TODO comments follow the <code># TODO(assignee): task.</code> format</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.add_toc_to_notebook.how_to_guide.html","title":"All.add toc to notebook.how to guide","text":""},{"location":"tools/notebooks/all.add_toc_to_notebook.how_to_guide.html#adding_a_table_of_contents_to_a_notebook","title":"Adding a table of contents to a notebook","text":""},{"location":"tools/notebooks/all.add_toc_to_notebook.how_to_guide.html#problem","title":"Problem","text":"<ul> <li>The Jupyter Notebook's extension that adds a table of contents (TOC) to a     notebook only works on the Jupyter server. When the notebook is published as     HTML or rendered on GitHub, the TOC added by this extension is not displayed</li> <li>We want to be able to add a TOC to a notebook in a way that is also visible in     these environments</li> </ul>"},{"location":"tools/notebooks/all.add_toc_to_notebook.how_to_guide.html#solution","title":"Solution","text":"<ul> <li>Create a custom script that adds a TOC to a notebook by parsing its contents</li> <li>The script:     /dev_scripts/notebooks/add_toc_to_notebook.py</li> </ul>"},{"location":"tools/notebooks/all.add_toc_to_notebook.how_to_guide.html#how_it_works","title":"How it works","text":"<ul> <li>Parse the JSON representation of the notebook's contents</li> <li>Identify cells that contain headings<ul> <li>Headings are located in Markdown-type cells, start at the beginning of a     line and consist of one or more hash signs, followed by at least one     whitespace and then the heading text</li> <li>E.g., \"# First heading\"</li> </ul> </li> <li>Add HTML anchors to the cells where headings were found<ul> <li>E.g., <pre><code>&lt;a name=\"first-heading\"&gt;&lt;/a&gt;\n</code></pre></li> </ul> </li> <li>Compose a TOC from the extracted headings, using anchors to create internal     links to the notebook cells</li> <li> <p>Add the TOC to the first cell of the notebook</p> <ul> <li>If there is already a TOC in that cell, replace it with the new one to     ensure the TOC is up-to-date</li> </ul> </li> <li> <p>The flow of the script resembles     this 3rd-party solution.     The principal difference is that we are not using the <code>nbformat</code> library and     instead parse the JSON representation of the notebook's code directly</p> </li> <li>The reason is that we prioritize transparency in parsing and prefer not to     rely on external libraries that may unexpectedly change their behavior in the     future</li> </ul>"},{"location":"tools/notebooks/all.add_toc_to_notebook.how_to_guide.html#how_to_use","title":"How to use","text":"<ul> <li>Run on one or more notebooks:</li> </ul> <pre><code>&gt; dev_scripts/notebooks/add_toc_to_notebook.py \\\n        --input_files dir1/file1.ipynb dir2/file2.ipynb\n</code></pre> <ul> <li>Run on a directory to process all the notebooks in it:</li> </ul> <pre><code>&gt; dev_scripts/notebooks/add_toc_to_notebook.py \\\n        --input_dir dir1/\n</code></pre>"},{"location":"tools/notebooks/all.add_toc_to_notebook.how_to_guide.html#limitations","title":"Limitations","text":"<ul> <li>If a notebook with the TOC added by the script is rendered on GitHub, the TOC     is displayed but its links are broken (they do not lead to the cells with the     corresponding headings)</li> <li>This is due to a known issue with how GitHub renders notebooks, see, for     example, discussions     here     and     here</li> <li>If the notebook is published as HTML, the TOC is displayed and its links work     as expected</li> </ul>"},{"location":"tools/notebooks/all.gsheet_into_pandas.how_to_guide.html","title":"All.gsheet into pandas.how to guide","text":""},{"location":"tools/notebooks/all.gsheet_into_pandas.how_to_guide.html#connecting_google_sheets_to_pandas","title":"Connecting Google Sheets to Pandas","text":"<ul> <li>There are two layers of the API<ul> <li>gspread<ul> <li>This allows to connect to Google Sheets API</li> </ul> </li> <li>gspread-pandas<ul> <li>This allows to interact with Google Sheets through Pandas DataFrames,     using <code>gspread</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.gsheet_into_pandas.how_to_guide.html#installation","title":"Installation","text":"<ul> <li> <p>To check that the library is installed in the dev container, you can run:</p> <ul> <li> <p>In a notebook</p> <p><pre><code>import gspread\nprint(gspread.__version__)\n5.11.3\n\nimport gspread_pandas\nprint(gspread_pandas.__version__)\n3.2.3\n</code></pre>     - In the dev container <pre><code>docker&gt; python -c \"import gspread; print(gspread.__version__); import gspread_pandas; print(gspread_pandas.__version__)\"\n5.10.0\n</code></pre></p> </li> </ul> </li> <li> <p>If the library is not installed in the Dev container, you can install it in the     notebook with:     <pre><code>notebook&gt; !pip install gspread-pandas\n</code></pre></p> </li> <li> <p>Or in the Docker container with:</p> <pre><code>docker&gt; sudo /bin/bash -c \"(source /venv/bin/activate; pip install gspread)\"\n</code></pre> </li> </ul>"},{"location":"tools/notebooks/all.gsheet_into_pandas.how_to_guide.html#authentication","title":"Authentication","text":"<ul> <li>Check if you already have the authentication token     <pre><code>&gt; cat ~/.config/gspread_pandas/google_secret.json\n{\n    \"type\": \"service_account\", # gitleaks:allow\n    \"project_id\": \"gspread-gp\",\n    \"private_key_id\": \"...\n    \"private_key\": \"-----BEGIN PRIVATE KEY-----\\n...\n    \"client_email\": \"gp-gspread@...\",\n    \"client_id\": \"101087234904396404157\",\n    \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n    \"token_uri\": \"https://oauth2.googleapis.com/token\",\n    \"auth_provider_x509_cert_url\": \"https://www.googleapis.com/oauth2/v1/certs\",\n    \"client_x509_cert_url\": \"https://www.googleapis.com/robot/v1/metadata/x509/gp-gspread%40gspread-gp.iam.gserviceaccount.com\",\n    \"universe_domain\": \"googleapis.com\"\n}\n</code></pre></li> <li>Note that this needs to be visible from Docker as <code>.config</code> is automatically     mounted     <pre><code>docker&gt; cat ~/.config/gspread_pandas/google_secret.json\n</code></pre></li> </ul>"},{"location":"tools/notebooks/all.gsheet_into_pandas.how_to_guide.html#official_reference","title":"Official reference","text":"<ul> <li> <p>Since <code>gspread-pandas</code> leverages <code>gspread</code>, you can follow the instructions     for gspread at https://docs.gspread.org/en/v6.0.0/oauth2.html</p> </li> <li> <p>More details are in</p> <ul> <li><code>gspread</code>: https://docs.gspread.org/en/latest/oauth2.html</li> <li><code>gspread-pandas</code>:     https://gspread-pandas.readthedocs.io/en/latest/configuration.html</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.gsheet_into_pandas.how_to_guide.html#authentication_in_short","title":"Authentication in short","text":"<ul> <li>There are two ways to authenticate:     1) OAuth Client ID     2) Service account key</li> <li> <p>It's best to access Google API using a \"Service Account\", which is used for a     bots</p> </li> <li> <p>Go to Google Developers Console and create a new project or select one you     already have</p> <ul> <li>E.g., name \"gp-gspread\" and ID \"gp-gspread-426713\"</li> </ul> </li> <li>Search for \"Google Drive API\" and click on \"Enable API\"</li> <li>Search for \"Google Sheets API\" and click on \"Enable API\"</li> <li>Go to Credentials<ul> <li>Create credentials -&gt; Service account key</li> </ul> </li> <li>Service account details<ul> <li>Service account name: gspread</li> <li>Service account ID: gspread</li> <li>Email address: gspread@gp-gspread-426713.iam.gserviceaccount.com</li> <li>Role: owner</li> </ul> </li> <li> <p>Click on <code>gspread</code></p> <ul> <li>Keys -&gt; Create new key -&gt; JSON</li> </ul> </li> <li> <p>A file is downloaded     <pre><code>&gt; more ~/Downloads/gspread-gp-94afb83adb02.json\n{\n    \"type\": \"service_account\", # gitleaks:allow\n    \"project_id\": \"gspread-gp\",\n    \"private_key_id\": \"94afb...5258ac\",\n    \"private_key\": \"-----BEGIN PRIVATE KEY-----\\nMIIEvg...FtmcXiHuZ46EMouxnQCEqrT5\\n-----END PRIVATE KEY-----\\n\",\n    \"client_email\": \"gp-gspread@...\",\n    \"client_id\": \"101087234904396404157\",\n    \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n    \"token_uri\": \"https://oauth2.googleapis.com/token\",\n    \"auth_provider_x509_cert_url\": \"https://www.googleapis.com/oauth2/v1/certs\",\n    \"client_x509_cert_url\": \"https://www.googleapis.com/robot/v1/metadata/x509/gp-gspread%40gspread-gp.iam.gserviceaccount.com\",\n    \"universe_domain\": \"googleapis.com\"\n}\n</code></pre></p> </li> <li> <p>Move the key in the right place     <pre><code>&gt; mv ~/Downloads/gspread-gp-94afb83adb02.json ~/.config/gspread_pandas/google_secret.json\n</code></pre></p> </li> <li> <p>Check that the key is visible In the Docker container     <pre><code>docker&gt; more ~/.config/gspread_pandas/google_secret.json\n...\n</code></pre></p> </li> <li> <p>Go to your spreadsheet and share it with a <code>client_email</code> from the step above     If you don\u2019t do this, you\u2019ll get a <code>gspread.exceptions.SpreadsheetNotFound</code>     exception when trying to access this spreadsheet from your application or a     script</p> </li> </ul>"},{"location":"tools/notebooks/all.gsheet_into_pandas.how_to_guide.html#testing_gspread-pandas","title":"Testing gspread-pandas","text":"<ul> <li> <p>The notebook with the usage example is located at     <code>amp/core/notebooks/gsheet_into_pandas_example.ipynb</code>.</p> </li> <li> <p>Don't feel stupid if you need multiple iterations to get this stuff     working</p> <ul> <li>Clicking on GUI is always a recipe for low productivity</li> <li>Go command line and vim!</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html","title":"All.jupyter notebook.how to guide","text":""},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#jupyter_notebook","title":"Jupyter Notebook","text":""},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#jupyter_notebook_best_practices","title":"Jupyter notebook best practices","text":""},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#when_to_use_a_jupyter_notebook","title":"When to use a Jupyter notebook","text":"<ul> <li>A notebook can be used for various goals:<ul> <li>Tutorial / gallery<ul> <li>Show how some code works (e.g., functions in <code>signal_processing.py</code> or     <code>data_encyclopedia.ipynb</code>)</li> <li>The code should always work</li> <li>We might want to add unit tests for it</li> </ul> </li> <li>Prototyping / one-off<ul> <li>E.g.,<ul> <li>We prototype some code, before it becomes library code</li> <li>We did some one-off analysis</li> </ul> </li> </ul> </li> <li>Analysis<ul> <li>Aka \"master\" notebooks</li> <li>The notebook should always work so we need to treat it as part of the code     base</li> <li>We might want to add unit tests for it</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#general_structure_of_a_notebook","title":"General structure of a notebook","text":""},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#description","title":"Description","text":"<ul> <li> <p>At the top of the notebook add a description section explaining a notebook's     goal and what it does, e.g.,     <pre><code># Description\n\nThis notebook was used for prototyping / debugging code that was moved in the file `abc.py`\n</code></pre></p> </li> <li> <p>Convert section headers and cells with description text to a Markdown format     by selecting a cell and then at Jupyter interface do     <code>Cell -&gt; Cell Type -&gt; Markdown</code></p> </li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#imports","title":"Imports","text":"<ul> <li>Add a code section importing the needed libraries<ul> <li>Autoreload modules to keep Jupyter and local code updated in real-time</li> <li>Standard imports, e.g. <code>os</code></li> <li>Third-party imports, e.g. <code>pandas</code></li> <li>Local imports from our lib</li> </ul> </li> <li> <p>It's better to put all the imports in one cell and separate different import     types by 1 empty line, e.g.:     <pre><code># Imports\n\n%load_ext autoreload\n%autoreload 2\n\nimport logging\nimport os\n\nimport matplotlib.pyplot as plt\nimport pandas as pd\n\nimport helpers.dbg as dbg\nimport helpers.env as env\nimport helpers.printing as prnt\nimport core.explore as exp\nimport core.signal_processing as sigp\n...\n</code></pre></p> </li> <li> <p>In this way executing one cell is enough to configure the notebook</p> </li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#configuration","title":"Configuration","text":"<ul> <li> <p>You can configure the notebooks with some utils, logging, and report info on     how the notebook was executed (e.g., Git commit, libs, etc.) by using the     following cell:     <pre><code># Configure logger.\nhdbg.init_logger(verbosity=logging.INFO)\n_LOG = logging.getLogger(__name__)\n\n# Print system signature.\n_LOG.info(\"%s\", henv.get_system_signature()[0])\n\n# Configure the notebook style.\nhprint.config_notebook()\n</code></pre></p> </li> <li> <p>The output of the cell looks like:     <pre><code>INFO: &gt; cmd='/venv/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/.local/share/jupyter/runtime/kernel-a48f60fd-0f96-48b4-82d8-879385f2be91.json'\nWARNING: Running in Jupyter\nDEBUG Effective logging level=10\nDEBUG Shut up 1 modules: asyncio\nDEBUG &gt; (cd . &amp;&amp; cd \"$(git rev-parse --show-toplevel)/..\" &amp;&amp; (git rev-parse --is-inside-work-tree | grep -q true)) 2&gt;&amp;1\nDEBUG &gt; (git rev-parse --show-toplevel) 2&gt;&amp;1\n...\n# Packages\npython: 3.8.10\ncvxopt: 1.3.0\ncvxpy: 1.2.2\ngluonnlp: ?\ngluonts: 0.6.7\njoblib: 1.2.0\nmxnet: 1.9.1\nnumpy: 1.23.4\npandas: 1.5.1\npyarrow: 10.0.0\nscipy: 1.9.3\nseaborn: 0.12.1\nsklearn: 1.1.3\nstatsmodels: 0.13.5\n</code></pre></p> </li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#make_the_notebook_flow_clear","title":"Make the notebook flow clear","text":"<ul> <li>Each notebook needs to follow a clear and logical flow, e.g:<ul> <li>Load data</li> <li>Compute stats</li> <li>Clean data</li> <li>Compute stats</li> <li>Do analysis</li> <li>Show results</li> </ul> </li> <li>The flow should be highlighted using headings in markdown:     <pre><code># Level 1\n## Level 2\n### Level 3\n</code></pre></li> <li>Use the extension for navigating the notebook (see our suggestions for Jupyter     plug-ins)</li> <li>Keep related code and analysis close together so:<ul> <li>Readers can understand the logical flow</li> <li>One could \"easily\" split the notebook in parts (e.g., when it becomes too     big)</li> <li>You can collapse the cells and don't scroll back and forth too much</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#general_best_practices","title":"General best practices","text":""},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#update_calls_only_for_mastergallery_notebooks","title":"Update calls only for Master/Gallery notebooks","text":""},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#convention","title":"Convention:","text":"<ul> <li>We do our best to update the calls in the Master/Gallery notebooks but we     don't guarantee that the fix is correct</li> <li>For other notebooks we either do the fix (e.g., changing a name of a function)     and tweak the call to enforce the old behavior, or even not do anything if     there are too many changes</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#rationale","title":"Rationale:","text":"<ul> <li>We have dozens of ad-hoc research notebooks</li> <li>When a piece of code is updated (e.g., <code>ImClient</code>) the change should be     propagated everywhere in the code base, including the notebooks</li> <li>This results in excessive amount of maintenance work which we want to avoid</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#keep_code_that_belongs_together_in_one_cell","title":"Keep code that belongs together in one cell","text":"<ul> <li>It's often useful to keep in a cell computation that needs to be always     executed together<ul> <li>E.g., compute something and then print results</li> </ul> </li> <li>In this way a single cell execution computes all data together</li> <li>Often computation starts in multiple cells, e.g., to inline debugging, and     once we are more confident that it works correctly we can merge it in a cell     (or even better in a function)</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#write_beautiful_code_even_in_notebooks","title":"Write beautiful code, even in notebooks","text":"<ul> <li>Follow the conventions and suggestions for     Python code style</li> <li>When prototyping with a notebook, the code can be of lower quality than code     in a final library, but still needs to be readable and robust</li> <li>In our opinion it's just better to always do write robust and readable code:     it doesn't buy much time to cut corners</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#show_how_data_is_transformed_as_you_go","title":"Show how data is transformed as you go","text":"<ul> <li>Print a few lines of data structures (e.g., <code>df.head(3)</code>) so one can see how     data is transformed through the cells</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#use_keyboard_shortcuts","title":"Use keyboard shortcuts","text":"<ul> <li>Learn the default keyboard shortcuts to edit efficiently</li> <li>You can use the vim plug-in (see below) and become 3x more ninja</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#strive_for_simplicity","title":"Strive for simplicity","text":"<ul> <li>Always make the notebook easy to be understood and run by somebody else</li> <li>Explain what happens</li> <li>Organize the code in a logical way</li> <li>Use decent variable names</li> <li>Comment the results, when possible / needed</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#dependencies_among_cells","title":"Dependencies among cells","text":"<ul> <li>Try to avoid dependencies between cells</li> <li>Even better avoid any dependency between cells, e.g.:<ul> <li>Put all the imports in one cell at the beginning, so with one cell execution     you can make sure that all the imports are done</li> <li>Compare this approach with the case where the imports are randomly sprinkled     in the notebook, then you need to go execute them one by one if you     re-initialize the notebook</li> </ul> </li> <li>For the same reason group functions in one cell that you can easily re-execute</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#re-execute_from_scratch","title":"Re-execute from scratch","text":"<ul> <li>Once in a while (e.g., once a day)</li> <li>Commit your changes</li> <li>Make sure you can re-execute everything from the top with     <code>Kernel -&gt; Restart &amp; Clean output</code> and then <code>Kernel -&gt; Run all</code></li> <li>Visually verify that the results didn't change, so that there is no weird     state or dependency in the code</li> <li>Before a commit (and definitively before a PR) do a clean run</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#add_comments_for_complex_cells","title":"Add comments for complex cells","text":"<ul> <li>When a cell is too long, explain in a comment what a cell does, e.g.,     <pre><code>## Count stocks with all nans.\nnum_nans = np.isnan(rets).sum(axis=0)\nnum_nans /= rets.shape[0]\nnum_nans = num_nans.sort_values(ascending=False)\nnum_stocks_with_no_nans = (num_nans == 0.0).sum()\nprint(\"num_stocks_with_no_nans=%s\" % hprint.perc(num_stocks_with_no_nans, rets.shape[1]))\n</code></pre></li> <li>Another approach is to factor out the code in functions with clear names and     simplify the flow</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#do_not_cut_paste_code","title":"Do not cut &amp; paste code","text":"<ul> <li>Cutting + paste + modify is NEVER a good idea</li> <li>It takes more time to clean up cut &amp; paste code than doing right in the first     place</li> <li>Just make a function out of the code and call it!</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#avoid_wall-of-code_cell","title":"Avoid \"wall-of-code\" cell","text":"<ul> <li>Obvious</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#avoid_data_biases","title":"Avoid data biases","text":"<ul> <li>Try to compute statistics on the entire data set so that results are     representative and not dependent on a particular slice of the data</li> <li>You can sample the data and check stability of the results</li> <li>If it takes too long to compute the statistics on the entire data set, report     the problem and we can think of how to speed it up</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#avoid_hardwired_constants","title":"Avoid hardwired constants","text":"<ul> <li>Don't use hardwired constants</li> <li>Try to parametrize the code</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#explain_where_data_is_coming_from","title":"Explain where data is coming from","text":"<ul> <li>If you are using data from a file (e.g., <code>/data/wd/RP_1yr_13_companies.pkl</code>),     explain in a comment how the file was generated<ul> <li>Ideally report a command line to regenerate the data</li> </ul> </li> <li>The goal is for other people to be able to re-run the notebook from scratch</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#fix_warnings","title":"Fix warnings","text":"<ul> <li>A notebook should run without warnings</li> <li>Warnings can't be ignored since they indicate that the code is relying on a     feature that will change in the future, e.g.,     <pre><code>FutureWarning: Sorting because non-concatenation axis is\nnot aligned. A future version of pandas will change to not sort by\ndefault.\nTo accept the future behavior, pass 'sort=False'.\nTo retain the current behavior and silence the warning, pass 'sort=True'.\n</code></pre></li> <li>Another example: after a cell execution the following warning appears:     <pre><code>A value is trying to be set on a copy of a slice from a DataFrame\nSee the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n</code></pre><ul> <li>This is a typical pandas warning telling us that we created a view on a     dataframe (e.g., by slicing) and we are modifying the underlying data     through the view</li> <li>This is dangerous since it can create unexpected side effects and coupling     between pieces of code that can be painful to debug and fix</li> </ul> </li> <li>If we don't fix the issue now, the next time we create a conda environment the     code might either break or (even worse) have a different behavior, i.e.,     silent failure</li> <li>It's better to fix the warning now that we can verify that the code does what     we want to do, instead of fixing it later when we don't remember anymore what     exactly we were doing</li> <li>If you have warnings in your code or notebook you can't be sure that the code     is doing exactly what you think it is doing<ul> <li>For what we know your code might be deleting your hard-disk, moving money     from your account to mine, starting World War 3, ...</li> <li>You don't ever want to program by coincidence</li> </ul> </li> <li>Typically the warnings are informative and tell us what's the issue and how to     fix it, so please fix your code<ul> <li>If it's not obvious how to interpret or fix a warning, file a bug reporting     clearly a repro case and the error message</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#make_cells_idempotent","title":"Make cells idempotent","text":"<ul> <li>Try to make a notebook cell able of being executed multiple times without     changing its output value, e.g.,<ul> <li>Bad <pre><code>df[\"id\"] = df[\"id\"] + 1\n</code></pre><ul> <li>This computation is not idempotent, since if you execute it multiple times     is going to increment the column <code>id</code> at every iteration</li> </ul> </li> <li>Good <pre><code>df[\"incremented_df\"] = df[\"id\"] + 1\n</code></pre><ul> <li>A better approach is to always create a new \"copy\"</li> </ul> </li> </ul> </li> <li>Another example:<ul> <li>Bad <pre><code>tmp = normalize(tmp)\n</code></pre></li> <li>Good <pre><code>tmp_after_normalize = normalize(tmp)\n</code></pre><ul> <li>In this way it's easy to add another stage in the pipeline without     changing everything</li> <li>Of course the names <code>tmp_1</code>, <code>tmp_2</code> are a horrible idea since they are     not self-explanatory and adding a new stage screws up the numbering</li> </ul> </li> </ul> </li> <li>For data frames and variables is a good idea to create copies of the data     along the way:     <pre><code>df_without_1s = df[df[\"id\"] != 1].copy()\n</code></pre></li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#always_look_at_the_discarded_data","title":"Always look at the discarded data","text":"<ul> <li>Filtering the data is a risky operation since once the data is dropped, nobody     is going to go back and double check what exactly happened</li> <li>Everything downstream (e.g., all the results, all the conclusions, all the     decisions based on those conclusions) rely on the filtering being correct</li> <li>Any time there is a <code>dropna</code> or a filtering / masking operation, e.g.:     <pre><code>compu_data = compu_data.dropna(subset=[\"CIK\"])\n</code></pre>     or     <pre><code>selected_metrics = [...]\ncompu_data = compu_data[compu_data[\"item\"].apply(lambda x : x in selected_metrics)]\ncompu_data = compu_data[compu_data[\"datadate\"].apply(date_is_quarter_end)]\n</code></pre></li> <li>Always count what percentage of the rows you dropped (e.g., do a back of the     envelope check that you are dropping what you would expect)     <pre><code>import helpers.printing as hprint\n...\nn_rows = compu_form_df.shape[0]\ncompu_form_df = compu_form_df.drop_duplicates()\nn_rows_after = compu_form_df.shape[0]\n_LOG.debug(\"After dropping duplicates kept: %s\", hprint.perc(n_rows_after, n_rows))\n</code></pre></li> <li>Make absolutely sure you are not dropping important data<ul> <li>E.g., has the distribution of the data changed in the way you would expect?</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#use_a_progress_bar","title":"Use a progress bar","text":"<ul> <li>Always use progress bars (even in notebooks) so that user can see how long it     will take for a certain computation.</li> <li>It is also possible to let <code>tqdm</code> automatically choose between console or     notebook versions by using     <pre><code>from tqdm.autonotebook import tqdm\n</code></pre></li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#notebooks_and_libraries","title":"Notebooks and libraries","text":"<ul> <li>It's ok to use functions in notebooks when building the analysis to leverage     notebook interactivity</li> <li>Once the notebook is \"stable\", often it's better to move the code in a     library, i.e., a Python file.</li> <li>Make sure you add autoreload modules in <code>Imports</code> section     <pre><code>%load_ext autoreload\n%autoreload 2\n</code></pre><ul> <li>Otherwise, if you change a function in the lib, the notebook will not pull     this change and use the old version of the function</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#pros","title":"Pros","text":"<ul> <li>The same notebook code can be used for different notebooks<ul> <li>E.g., the function to read the data from disk is an obvious example</li> </ul> </li> <li>More people can reuse the same code for different analyses</li> <li>If one changes the code in a library, Git can help tracking changes and     merging, while notebooks are difficult to diff / merge</li> <li>Cleaning up / commenting / untangling the code can help reason carefully about     the assumptions to find issues</li> <li>The notebook becomes more streamlined and easy to understand since now it's a     sequence of functions <code>do_this_and_that</code> and presenting the results</li> <li>One can speed up / parallelize analyses with multiprocessing<ul> <li>Notebooks are not great for this</li> <li>E.g., when one does the analyses on a small subset of the data and then     wants to run on the entire large dataset</li> </ul> </li> <li>The exploratory analysis can be moved towards modeling and then production</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#cons","title":"Cons","text":"<ul> <li>One has to scroll back and forth between the notebook and the libraries to     execute the cell with the functions and fix all the possible mistakes</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#recommendations_for_plots","title":"Recommendations for plots","text":""},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#use_the_proper_y-scale","title":"Use the proper y-scale","text":"<ul> <li>If one value can vary from -1.0 to 1.0, force the y-scale between those limits     so that the values are absolutes, unless this would squash the plot</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#make_each_plot_self-explanatory","title":"Make each plot self-explanatory","text":"<ul> <li>Make sure that each plot has a descriptive title, x and y label</li> <li>Explain the set-up of a plot / analysis<ul> <li>E.g., what is the universe of stocks used? What is the period of time?</li> <li>Add this information also to the plots</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#avoid_wall-of-text_tables","title":"Avoid wall-of-text tables","text":"<ul> <li>Try to use plots summarizing the results besides the raw results in a table</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#use_common_axes_to_allow_visual_comparisons","title":"Use common axes to allow visual comparisons","text":"<ul> <li>Try to use same axes for multiple graphs when possible to allow visual     comparison between graphs</li> <li>If that's not possible or convenient, make individual plots with different     scales and add a plot with multiple graphs inside on the same axis (e.g., with     y-log)</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#use_the_right_plot","title":"Use the right plot","text":"<ul> <li>Pick the right type of graph to make your point<ul> <li><code>pandas</code>, <code>seaborn</code>, <code>matplotlib</code> are your friends</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#useful_plugins","title":"Useful plugins","text":"<ul> <li>You can access the extensions menu:<ul> <li><code>Edit -&gt; nbextensions config</code></li> <li><code>http://localhost:XYZ/nbextensions/</code></li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#vim_bindings","title":"Vim bindings","text":"<ul> <li>VIM binding     will change your life</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#table_of_contents","title":"Table of contents","text":"<ul> <li>To see the entire logical flow of the notebook, when you use the headers     properly</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#executetime","title":"ExecuteTime","text":"<ul> <li>To see how long each cell takes to execute</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#spellchecker","title":"Spellchecker","text":"<ul> <li>To improve your English!</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#autosavetime","title":"AutoSaveTime","text":"<ul> <li>To save the code automatically every minute</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#notify","title":"Notify","text":"<ul> <li>Show a browser notification when kernel becomes idle</li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#jupytext","title":"Jupytext","text":"<ul> <li>We use Jupytext as standard part of our development flow</li> <li>See     <code>all.jupytext.how_to_guide.md</code></li> </ul>"},{"location":"tools/notebooks/all.jupyter_notebook.how_to_guide.html#gspread","title":"Gspread","text":"<ul> <li>Allow to read g-sheets in Jupyter Notebook</li> <li>First, one needs to configure Google API, just follow the instructions from     here</li> <li>Useful links:<ul> <li>Examples of gspread Usage</li> <li>Enabling Gsheet API</li> <li>Adding service email if it's not working</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html","title":"All.jupytext.how to guide","text":""},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#jupytext","title":"Jupytext","text":""},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#why_jupytext","title":"Why Jupytext?","text":"<ul> <li> <p>In few words Jupytext associates a     Python representation to a notebook, which is kept in sync with the notebook     in a sensible way</p> </li> <li> <p>Jupytext allows to:</p> <ul> <li>Edit notebooks with your favorite editor (hopefully) vi or PyCharm</li> <li>Use a Python version of your notebook to run long computations from shell     instead of using a notebook</li> <li>Do a code review, diff changes, resolve conflicts using the Python code</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#reference_documentation","title":"Reference documentation","text":"<ul> <li>https://github.com/mwouts/jupytext</li> <li>https://jupytext.readthedocs.io/en/latest/</li> <li>https://jupytext.readthedocs.io/en/latest/faq.html</li> </ul>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#installation","title":"Installation","text":"<ul> <li> <p>Check what version you have:</p> <pre><code>&gt; jupytext --version\n1.2.1\n</code></pre> </li> <li> <p>Check if you have a Jupyter config:</p> <pre><code>&gt; ls ~/.jupyter/jupyter_notebook_config.py\n</code></pre> </li> <li> <p>If you don't have a config, generate it with:</p> <pre><code>&gt; jupyter notebook --generate-config\n</code></pre> </li> <li> <p>Edit <code>~/.jupyter/jupyter_notebook_config.py</code> and append the following:</p> <p>```python</p> </li> <li> <p>Now you need to restart the notebook server to pick up Jupytext</p> </li> <li>We use the \"percent\" format where cells are delimited by a <code>%%</code> comment<ul> <li>Pycharm, black, and other tools understand / respect that this is a     delimiter for jupyter cells</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#------------------------------------------------------------------------------","title":"------------------------------------------------------------------------------","text":""},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#jupytext_1","title":"Jupytext","text":""},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#------------------------------------------------------------------------------_1","title":"------------------------------------------------------------------------------","text":"<p>c.NotebookApp.contents_manager_class = \"jupytext.TextFileContentsManager\"</p>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#always_pair_ipynb_notebooks_to_py_files","title":"Always pair ipynb notebooks to py files","text":"<p>c.ContentsManager.default_jupytext_formats = \"ipynb,py\"</p>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#use_the_percent_format_when_saving_as_py","title":"Use the percent format when saving as py","text":"<p>c.ContentsManager.preferred_jupytext_formats_save = \"py:percent\" c.ContentsManager.outdated_text_notebook_margin = float(\"inf\") ```</p>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#using_jupytext","title":"Using Jupytext","text":"<ul> <li>Now when you <code>git add</code> a <code>.ipynb</code> file you always need to add also the paired     <code>.py</code> file</li> <li>Same thing if you rename with <code>git mv</code> or delete a notebook<ul> <li>You need to explicitly take care of renaming and deleting also the <code>.py</code>     file</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#example_of_uses","title":"Example of uses","text":""},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#test-that-the-conversion-works","title":"Test that the conversion works","text":"<ul> <li>Jupytext keeps a notebook and the paired <code>.py</code> file in sync     <pre><code>&gt; jupytext Task22.ipynb --test --to py:percent --stop\n&gt; jupytext Task22.ipynb --test-strict --to py:percent\n</code></pre></li> </ul>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#manual_sync","title":"Manual sync","text":"<pre><code>    ```bash\n    &gt; jupytext --sync --to py:percent XYZ.ipynb\n    ```\n</code></pre>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#automatic_syncing_when_using_the_jupyter_server","title":"Automatic syncing when using the Jupyter server","text":"<ul> <li> <p>After you have installed the jupytext extension, open a notebook with your     Jupyter server</p> <ul> <li>You should see that there is a <code>.py</code> file close to the <code>.ipynb</code> file you     opened</li> <li>Open the <code>.py</code> file</li> <li>You can see that there is the code in the cells separated by <code>%%</code></li> </ul> </li> <li> <p>Changes to the notebook are reflected in the file:</p> <ul> <li>Modify the notebook and save the notebook</li> <li>Open the <code>.py</code></li> <li>Note that the cell that you modified in the notebook has changed in the     <code>.py</code> file</li> </ul> </li> <li> <p>Changes to the file are reflected in the notebook:</p> <ul> <li>Modify the <code>.py</code> file, e.g., changing one cell</li> <li>Go to the jupyter notebook and reload it</li> <li>The cell you modified has changed!</li> </ul> </li> </ul>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#convert_a_notebook_to_script","title":"Convert a notebook to script","text":"<pre><code>    ```bash\n    &gt; jupytext --to py:percent XYZ.ipynb\n    ```\n</code></pre>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#convert_a_script_into_a_notebook","title":"Convert a script into a notebook","text":"<pre><code>&gt; jupytext --to notebook XYZ.py\n</code></pre>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#remove_metadata_from_a_notebook","title":"Remove metadata from a notebook","text":"<ul> <li>This is equivalent to transforming the paired <code>.py</code> file in a notebook     <pre><code>&gt; jupytext --to notebook XYZ.py\n</code></pre></li> </ul>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#linter","title":"Linter","text":"<ul> <li>Linter automatically reformats the <code>.py</code> files and then updates the <code>.ipynb</code>     without losing the formatting     <pre><code>&gt; i lint --files=\"XYZ.py\"\n&gt; jupytext --sync --to py:percent XYZ.py\n</code></pre></li> </ul>"},{"location":"tools/notebooks/all.jupytext.how_to_guide.html#refresh_all_the_scripts","title":"Refresh all the scripts","text":"<ul> <li> <p>The script <code>dev_scripts/notebooks/process_jupytext.py</code> automates some of the     workflow in Jupytext (see the help)</p> </li> <li> <p>The script <code>dev_scripts/notebooks/process_all_jupytext.sh</code> applies     <code>process_jupytext.py</code> to all the <code>ipynb</code> files     <pre><code>&gt; dev_scripts/notebooks/process_all_jupytext.sh &lt;ACTION&gt;\n</code></pre></p> </li> </ul>"},{"location":"tools/notebooks/all.plotting.how_to_guide.html","title":"All.plotting.how to guide","text":""},{"location":"tools/notebooks/all.plotting.how_to_guide.html#best_practices_for_writing_plotting_functions","title":"Best practices for writing plotting functions","text":""},{"location":"tools/notebooks/all.plotting.how_to_guide.html#cosmetic_requirements","title":"Cosmetic requirements","text":"<p>A plot should be easy to interpret. This means:</p> <ul> <li>It should have a title</li> <li>Axes should have labels</li> <li>Ticks should be placed in an interpretable way; if there are few of them,     place their labels with zero rotation</li> <li>If there are several lines on the plot, it should have a legend</li> </ul>"},{"location":"tools/notebooks/all.plotting.how_to_guide.html#technical_requirements","title":"Technical requirements","text":"<ul> <li>Do not add <code>plt.show()</code> at the end of the function. It prevents the user from     using this plot as a subplot and from tweaking it.</li> <li>Expose the <code>ax</code> parameter</li> </ul>"},{"location":"tools/notebooks/all.plotting.how_to_guide.html#multiple_plots","title":"Multiple plots","text":"<ul> <li>If the function plots multiple plots, it is usually better to create a single     figure for them. This way, the output is more concise and can be copied as one     image.</li> <li>In <code>amp/core/plotting.py</code>, there is a helper called <code>get_multiple_plots()</code>     that is used for generating a figure and axes</li> <li>Add <code>plt.tight_layout()</code> in the end only if you are sure this figure will not     be wrapped inside another figure</li> <li>If there is a possibility the figure will be wrapped, try passing in a list of     axes</li> <li>To combine multiple figures with subplots into one, use     GridSpec</li> </ul>"},{"location":"tools/notebooks/all.publish_notebook.how_to_guide.html","title":"All.publish notebook.how to guide","text":""},{"location":"tools/notebooks/all.publish_notebook.how_to_guide.html#publishing_a_notebook","title":"Publishing a notebook","text":""},{"location":"tools/notebooks/all.publish_notebook.how_to_guide.html#what_it_is_about","title":"What it is about","text":"<ul> <li><code>publish_notebook.py</code> is a little tool that allows to:<ol> <li>Opening a notebook in your browser (useful for read-only mode)</li> <li>E.g., without having to use Jupyter notebook (which modifies the file in    your client) or github preview (which is slow or fails when the notebook    is too large)</li> <li>Sharing a notebook with others in a simple way</li> <li>Pointing to detailed documentation in your analysis Google docs</li> <li>Reviewing someone's notebook</li> <li>Comparing multiple notebooks against each other in different browser  windows</li> <li>Taking a snapshot / checkpoint of a notebook as a backup or before making  changes</li> <li>This is a lightweight alternative to \"unit testing\" to capture the    desired behavior of a notebook</li> <li>One can take a snapshot and visually compare multiple notebooks    side-by-side for changes</li> </ol> </li> </ul> <p>You can get details by running: <code>dev_scripts/notebooks/publish_notebook.py -h</code></p>"},{"location":"tools/notebooks/all.publish_notebook.how_to_guide.html#opening_a_notebook","title":"Opening a notebook","text":"<ul> <li>Inside the dev container     <pre><code>docker&gt; FILE=datapull/common/universe/notebooks/Master_universe_analysis.ipynb; publish_notebook.py --file $FILE --action convert\n</code></pre></li> <li>This converts the <code>ipynb</code> file into a <code>HTML</code></li> <li>Then you can open it from outside your container     <pre><code>&gt; open Master_universe_analysis.20231214-081257.html\n</code></pre>     or pointing the browser to it</li> </ul>"},{"location":"tools/notebooks/all.publish_notebook.how_to_guide.html#what_has_changed","title":"What has changed","text":"<p>We've deployed the new service for storing notebooks in HTML format</p> <ul> <li>From now on <code>publish_notebook.py</code> will work from the Docker container. The new     version of <code>publish_notebook.py</code> works using HTTP protocol and does not     require ssh key authorization as it was before</li> <li>We've synchronized all documents. So all old docs already available on the new     service</li> </ul>"},{"location":"tools/notebooks/all.run_jupyter_notebook.how_to_guide.html","title":"All.run jupyter notebook.how to guide","text":""},{"location":"tools/notebooks/all.run_jupyter_notebook.how_to_guide.html#run_jupyter_notebook","title":"Run Jupyter notebook","text":""},{"location":"tools/notebooks/all.run_jupyter_notebook.how_to_guide.html#general","title":"General","text":"<p>Every notebook should have a config that controls its parameters.</p> <p>A notebook can be run in two ways:</p> <ol> <li>Automatically: via a Python script</li> <li>Manually: via Jupyter from a web-browser</li> </ol>"},{"location":"tools/notebooks/all.run_jupyter_notebook.how_to_guide.html#running_a_notebook_using_a_python_script","title":"Running a notebook using a Python script","text":"<p>Use <code>run_notebook.py</code> to run the notebook via script.</p> <p>Here is an example of the run command inside the dev container, <code>cmamp</code> repository:</p> <pre><code>/app/dev_scripts/notebooks/run_notebook.py \\\n        --notebook /app/oms/notebooks/Master_broker_portfolio_reconciliation.ipynb \\\n        --config_builder 'amp.oms.execution_analysis_configs.get_broker_portfolio_reconciliation_configs_Cmtask5690(\"/shared_data/ecs/test/system_reconciliation/C11a/prod/20240320_134000.20240320_143500/system_log_dir.manual/process_forecasts\")' \\\n        --dst_dir . \\\n        --tee --no_suppress_output --num_threads 'serial' \\\n        --publish_notebook -v DEBUG\n</code></pre> <ul> <li>The script propagates a pointer to a config builder function via environment     variables <code>__CONFIG_BUILDER__</code>, <code>__CONFIG_IDX__</code>, <code>__CONFIG_DST_DIR__</code></li> <li>Given the environment variables above, a notebooks builds a config from a     config builder function</li> </ul> <p>The script also saves a config to a Pickle file. Path to a config file is stored in the <code>__NOTEBOOK_CONFIG_PATH__</code> environment variable which is displayed in a notebook so that a user knows where a config file is stored.</p>"},{"location":"tools/notebooks/all.run_jupyter_notebook.how_to_guide.html#run_a_notebook_manually","title":"Run a notebook manually","text":"<ol> <li> <p>Load <code>Config</code> from a file</p> </li> <li> <p>Use case: when re-running a notebook that was already run using the Python     script</p> </li> <li>How to get a path to a config file: in a published notebook, search for the     <code>__NOTEBOOK_CONFIG_PATH__</code> environment variable and copy its value</li> <li> <p>Where to use a path: pass the value as <code>config_file_name</code> in     <code>get_notebook_config()</code></p> <ul> <li>Note: Make sure to set <code>replace_ecs_tokyo = True</code> to replace the <code>ecs_tokyo</code>     with <code>ecs</code> in the actual pathh</li> </ul> </li> <li> <p>Specify a config builder function manually</p> </li> <li> <p>Use case: there is no config file saved</p> </li> <li>This way one needs to specify all of the parameters of a config builder     function manually</li> </ol>"},{"location":"tools/notebooks/all.run_jupyter_notebook.how_to_guide.html#example_of_the_run_flow","title":"Example of the run flow","text":"<pre><code>flowchart TD\nsubgraph A1[Run a notebook via the `run_notebook.py`]\n        A[Pass the string pointer to a config builder function\n        to the notebook as a parameter] --&gt; B[Save the Config object to a file]\n        B --&gt; C[Display path to a config file inside a notebook]\nend\nsubgraph B1[Run a notebook manually]\n        D{Config source}\n        E[Load the Config object from a file]\n        F[Manually define the Config object]\n        D --&gt; E &amp; F\nend\nA1 ==&gt; B1\nC ..-&gt;|copy-paste\\nfile path| E</code></pre>"},{"location":"tools/thin_environment/all.gh_and_thin_env_requirements.reference.html","title":"All.gh and thin env requirements.reference","text":""},{"location":"tools/thin_environment/all.gh_and_thin_env_requirements.reference.html#required_packages_for_the_thin_environment_and_gh_actions","title":"Required Packages for the thin environment and GH Actions","text":""},{"location":"tools/thin_environment/all.gh_and_thin_env_requirements.reference.html#thin_environment","title":"Thin environment","text":"<p>File location:</p> <ul> <li>requirements.txt</li> </ul>"},{"location":"tools/thin_environment/all.gh_and_thin_env_requirements.reference.html#packages","title":"Packages","text":"<ul> <li> <p><code>boto3</code></p> <ul> <li>Interacts with the AWS services:</li> <li><code>boto3</code> import in the <code>haws</code></li> <li><code>haws</code> usage in the <code>lib_tasks_docker_release.py</code></li> </ul> </li> <li> <p><code>invoke</code></p> <ul> <li>Need for running the invoke targets:</li> <li>_run_tests</li> </ul> </li> <li> <p><code>poetry</code></p> <ul> <li>Manage dependencies in the dev image:</li> <li>docker_build_local_image</li> </ul> </li> <li> <p><code>pytest</code></p> <ul> <li>To run <code>Docker image QA tests</code>:</li> <li>_run_qa_tests</li> </ul> </li> <li> <p><code>tqdm</code></p> <ul> <li>Widely used for showing the progress of the process for example:</li> <li>_fix_invalid_owner</li> </ul> </li> <li> <p><code>s3fs</code></p> <ul> <li>Needed for some invoke targets, for example:</li> <li>docker_update_prod_task_definition</li> </ul> </li> <li> <p><code>requests</code></p> <ul> <li>Dependency for the <code>docker</code>, for now pinned to the version <code>2.31.0</code> since     the versions &gt;=<code>2.32.1</code> is causing the issue with the <code>docker-compose</code>:     https://github.com/psf/requests/issues/6707</li> <li>See the https://github.com/cryptokaizen/cmamp/issues/8340 for details</li> </ul> </li> </ul>"},{"location":"tools/thin_environment/all.gh_and_thin_env_requirements.reference.html#candidate_packages_to_remove","title":"Candidate Packages to remove","text":"<ul> <li><code>docker</code> and <code>docker-compose</code> should be moved to OS installation     https://github.com/cryptokaizen/cmamp/issues/6498</li> </ul>"},{"location":"tools/thin_environment/all.gh_and_thin_env_requirements.reference.html#gh_actions","title":"GH Actions","text":"<p>File location:</p> <ul> <li>gh_requirements.txt</li> </ul>"},{"location":"tools/thin_environment/all.gh_and_thin_env_requirements.reference.html#packages_1","title":"Packages","text":"<ul> <li><code>invoke</code></li> <li><code>poetry</code></li> <li><code>pytest</code></li> <li><code>tqdm</code></li> <li><code>s3fs</code></li> <li><code>requests</code></li> </ul> <p>For above packages, see descriptions in the Thin environment/Packages section.</p>"},{"location":"tools/thin_environment/all.gh_and_thin_env_requirements.reference.html#candidate_packages_to_remove_1","title":"Candidate Packages to remove","text":"<ul> <li><code>docker</code> and <code>docker-compose</code> see in the     Thin environment section</li> </ul>"},{"location":"tools/thin_environment/all.gh_thin_env_dependencies.how_to_guide.html","title":"All.gh thin env dependencies.how to guide","text":""},{"location":"tools/thin_environment/all.gh_thin_env_dependencies.how_to_guide.html#thin_environment_dependencies","title":"Thin Environment Dependencies","text":""},{"location":"tools/thin_environment/all.gh_thin_env_dependencies.how_to_guide.html#description","title":"Description","text":"<ul> <li> <p>We have 3 sources of package requirements in the project:</p> <ol> <li>The thin environment to run <code>invoke</code> targets outside the container</li> <li>/dev_scripts/client_setup/requirements.txt</li> <li>This is managed with <code>pip</code></li> <li>GitHub requirements used for GitHub Actions specifically</li> <li>/.github/gh_requirements.txt</li> <li>This is managed with <code>pip</code></li> <li>Requirements necessary for the container:</li> <li>/devops/docker_build/pyproject.toml</li> <li>This is managed with <code>poetry</code></li> </ol> </li> <li> <p>We want to keep the thin environment as \"thin\" as possible (i.e., with fewer     dependencies)</p> </li> <li> <p>The thin environment and GitHub requirements have to be in sync</p> <ul> <li>The only difference is that the GitHub requirements have some limitations     due to the GitHub Actions environment</li> <li>TODO(Vlad): Still not clear what exact difference between the two     requirements files</li> </ul> </li> <li> <p>This document provides a step-by-step guide for adding or make any changes in     the requirements file of both the thin env and GitHub</p> </li> </ul>"},{"location":"tools/thin_environment/all.gh_thin_env_dependencies.how_to_guide.html#change_in_requirements_file","title":"Change in Requirements File","text":"<ul> <li>Some reasons for updating/changing the <code>requirements.txt</code> file are:<ul> <li>A new feature requires a new package outside the container, e.g., a new or     updated <code>invoke</code> target</li> <li>Upgrading the package version since the current one is outdated</li> <li>Removing a package since it is not used anymore</li> </ul> </li> </ul>"},{"location":"tools/thin_environment/all.gh_thin_env_dependencies.how_to_guide.html#confirm_with_build_team","title":"Confirm with Build Team","text":"<ul> <li>Changes in any of the requirement files should be confirmed with the Build     team before merging the PR<ul> <li>Is the new dependencies really needed?</li> <li>If the new dependencies is really needed, can we limit the scope of the     dependency? E.g.,<ul> <li>Move the related imports to where it is strictly needed in the code</li> <li>Do a try-catch <code>ImportError</code></li> </ul> </li> </ul> </li> </ul> <p>Example:</p> <ul> <li>The /helpers/lib_tasks_gh.py module has some     <code>invoke</code> targets that are executed only in the container</li> <li>If the new package is needed for the <code>invoke</code> target only in the container, we     should move the import to the function where it is strictly needed</li> <li>See the <code>gh_publish_buildmeister_dashboard_to_s3()</code> in the     /helpers/lib_tasks_gh.py     for reference.</li> </ul>"},{"location":"tools/thin_environment/all.gh_thin_env_dependencies.how_to_guide.html#update_requirements_file","title":"Update Requirements File","text":"<ul> <li>Update both the requirements file if relevant     /dev_scripts/client_setup/requirements.txt     and /.github/gh_requirements.txt<ul> <li>This file should be changed in every repository (e.g., <code>cmamp</code>,     <code>kaizenflow</code>, <code>orange</code>)</li> </ul> </li> <li>After adding the new requirements the build team will run all the tests     locally as well as on GitHub</li> </ul>"},{"location":"tools/thin_environment/all.gh_thin_env_dependencies.how_to_guide.html#update_documentation","title":"Update Documentation","text":"<ul> <li>Update the     /docs/tools/thin_environment/all.gh_and_thin_env_requirements.reference.md</li> </ul>"},{"location":"tools/thin_environment/all.gh_thin_env_dependencies.how_to_guide.html#notify_team","title":"Notify Team","text":"<p>In the <code>#team-eng</code> Slack channel, notify the team about the new package and ask them to rebuild the thin env.</p> <p>Example: <pre><code>Hi! In the PR: https://github.com/cryptokaizen/cmamp/pull/6800 we removed\nunused packages from the thin environment.\n\nYou need to update the thin environment by running:\n\n&gt; cd ~/src/cmamp1\n&gt; dev_scripts/client_setup/build.sh\n</code></pre></p> <p>Last review: GP on 2024-05-07</p>"},{"location":"tools/thin_environment/all.thin_environment.reference.html","title":"All.thin environment.reference","text":""},{"location":"tools/thin_environment/all.thin_environment.reference.html#basic_concepts","title":"Basic concepts","text":"<p>Each repo relies on several concept:</p> <ul> <li>\"thin environment\": a Python environment that contains the minimal number of     packages to run commands and start the development system in Docker</li> <li>\"set env\" script: it is used to configured a shell inside the thin environment</li> <li>\"tmux\" script: it is used to create a <code>tmux</code> session with our standard setup     for the repo (e.g., multiple windows on different repo and sub-repos)</li> <li>\"Docker environment\": it contains all the libraries, packages, and     dependencies for the actual development (e.g., run the tools, run the unit     tests)</li> <li>\"devops\": it contains all the code to build containers for the specific repo</li> </ul>"},{"location":"tools/thin_environment/all.thin_environment.reference.html#naming_objects_composed_across_repos","title":"Naming objects composed across repos","text":"<ul> <li>We add a suffix representing the name of the repo any time we need to     distinguish different objects<ul> <li>E.g., <code>dev_scripts_helpers</code> vs <code>dev_scripts_cmamp</code></li> </ul> </li> <li>For runnable dirs that are not top level, the suffix includes the name of the     repo followed by the name of the runnable dir<ul> <li>E.g., <code>dev_scripts_cmamp_infra</code>, <code>dev_scripts_tutorial_tensorflow</code></li> </ul> </li> <li> <p>We can't always use the <code>.</code> to separate the fields since <code>.</code> creates problems     when importing Python files, and so we resort to using <code>_</code></p> </li> <li> <p>On the one hand, we agree that the directory structure should help distinguish     different objects</p> <ul> <li>E.g., <code>//helpers/.../dev_scripts_helpers</code> vs <code>//cmamp/.../dev_scripts_cmamp</code></li> </ul> </li> <li> <p>We keep files named in the same way underneath different directories</p> </li> <li> <p>Pros</p> <ul> <li>It's easy to diff files in corresponding dirs</li> </ul> </li> <li>Cons<ul> <li>The name is not enough to disambiguate files, but one needs to account for     the full path of each file across different repos / directories</li> </ul> </li> </ul>"},{"location":"tools/thin_environment/all.thin_environment.reference.html#files","title":"Files","text":"<ul> <li>The files involved are:     <pre><code>&gt; ls -l -1 dev_scripts_helpers/thin_client/\n__init__.py\nbuild.py\nrequirements.txt\nsetenv.sh\nsync_repo_thin_client.sh\ntest_thin_client.sh\nthin_client_utils.py\nthin_client_utils.sh\ntmux.py\n</code></pre></li> </ul>"},{"location":"tools/thin_environment/all.thin_environment.reference.html#general_utils","title":"General utils","text":"<ul> <li><code>thin_client_utils.sh</code>: contain common Bash code for the scripts in this dir</li> <li><code>thin_client_utils.py</code>: contain common Python code for the scripts in this dir</li> </ul>"},{"location":"tools/thin_environment/all.thin_environment.reference.html#building_the_thin_environment","title":"Building the thin environment","text":"<ul> <li><code>build.py</code>: build the thin environment</li> <li><code>requirements.txt</code>: list of Python packages needed in the thin environment</li> </ul>"},{"location":"tools/thin_environment/all.thin_environment.reference.html#configuring_a_shell","title":"Configuring a shell","text":"<ul> <li><code>setenv.sh</code>: configure a shell to run the thin environment</li> </ul>"},{"location":"tools/thin_environment/all.thin_environment.reference.html#tmux_session","title":"Tmux session","text":"<ul> <li><code>tmux.py</code>: a script to create the standard <code>tmux</code> set up</li> </ul>"},{"location":"tools/thin_environment/all.thin_environment.reference.html#how_to_test","title":"How to test","text":"<ul> <li> <p>The script     <code>/dev_scripts_helpers/thin_client/test_helpers.sh</code>     tests <code>helpers</code></p> </li> <li> <p>Build thin environment     <pre><code>&gt; dev_scripts_helpers/thin_client/build.py\n</code></pre></p> </li> <li>Source setenv     <pre><code>&gt; source dev_scripts_helpers/thin_client/setenv.sh\n</code></pre></li> <li>Create the tmux session     <pre><code>&gt; dev_scripts_helpers/thin_client/tmux.py --create_global_link\n&gt; dev_scripts_helpers/thin_client/tmux.py --index 1\n</code></pre></li> </ul>"},{"location":"tools/thin_environment/all.thin_environment.reference.html#build_container","title":"Build container","text":"<ul> <li> <p>Build the container</p> <pre><code>&gt; i docker_build_local_image --version 1.0.0\n&gt; i docker_tag_local_image_as_dev --version 1.0.0\n</code></pre> </li> <li> <p>Run the container     <pre><code>&gt; i docker_bash --skip-pull\n&gt; i docker_jupyter\n</code></pre></p> </li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html","title":"All.run unit tests.how to guide","text":""},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#run_unit_tests","title":"Run Unit Tests","text":""},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#run_unit_tests_1","title":"Run Unit Tests","text":"<ul> <li>We use <code>pytest</code> and <code>unittest</code> as testing framework</li> <li>Before any PR (and ideally after a few commits), we want to run all the unit     tests to make sure we didn't introduce any new bugs</li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#test_lists","title":"Test Lists","text":"<ul> <li>We have different test set lists:<ul> <li><code>fast</code><ul> <li>Tests that are quick to execute (typically less than 5 secs per test     class)</li> <li>We want to run these tests before/after every commit/PR to make sure     things are not broken</li> </ul> </li> <li><code>slow</code><ul> <li>Tests that we don't want to run all the times because they are:<ul> <li>Slow (typically less than 20 seconds per test)</li> <li>They are related to pieces of code that don't change often<ul> <li>E.g., external APIs we don't want to hit continuously</li> </ul> </li> </ul> </li> </ul> </li> <li><code>superslow</code><ul> <li>Tests that run long workload, e.g., running a production model, a long     simulation</li> <li>No time limit but we need to be judicious with length<ul> <li>Anything above 5-15 mins is problematic</li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#using_invoke","title":"Using <code>Invoke</code>","text":"<ul> <li><code>invoke</code> is a task execution framework which     allows to execute some typical workflows in a simple way</li> <li>In our config script <code>invoke</code> is aliased to <code>i</code> to reduce typing</li> <li> <p>E.g., we use it to run the test suites:</p> <pre><code># Run only fast tests.\n&gt; i run_fast_tests\n# Run only slow tests.\n&gt; i run_slow_tests\n# Run only superslow tests.\n&gt; i run_superslow_tests\n</code></pre> </li> <li> <p>To see the options use <code>--help</code> option, e.g. <code>i --help run_fast_tests</code>:</p> <pre><code>Usage: inv[oke] [--core-opts] run_fast_tests [--options] [other tasks here ...]\n\nDocstring:\n    Run fast tests.\n    :param stage: select a specific stage for the Docker image\n    :param pytest_opts: option for pytest\n    :param skip_submodules: ignore all the dir inside a submodule\n    :param coverage: enable coverage computation\n    :param collect_only: do not run tests but show what will be executed\n    :param tee_to_file: save output of pytest in `tmp.pytest.log`\n    :param kwargs: kwargs for `ctx.run`\n\nOptions:\n    -c, --coverage\n    -k, --skip-submodules\n    -o, --collect-only\n    -p STRING, --pytest-opts=STRING\n    -s STRING, --stage=STRING\n    -t, --tee-to-file\n    -v STRING, --version=STRING\n</code></pre> </li> <li> <p>Docker image stage and version</p> <ul> <li> <p>To select a specific stage for Docker image use the <code>--stage</code> option. E.g.,     this might be useful when a user wants to run regressions on the local     Docker image to verify that nothing is broken before promoting it to <code>dev</code>     image.</p> <p><pre><code>&gt; i run_fast_tests --stage local\n</code></pre>     - To run the tests on the specific version of a Docker image, use the <code>--version</code> option. - E.g., this might be useful when releasing a new version of an image.     <pre><code>&gt; i run_fast_tests --stage local --version 1.0.4\n</code></pre></p> </li> </ul> </li> <li> <p>Specifying <code>pytest</code> options</p> <ul> <li>With the option <code>--pytest-opts</code> it is possible to pass any <code>pytest</code> option     to <code>invoke</code>.</li> </ul> </li> <li> <p>Running in debug mode</p> <ul> <li>If a user wants to run the tests in debug mode to show the output     <pre><code>&gt; i run_fast_tests -s --dbg\n</code></pre></li> <li>This is equivalent to specifying <code>-v DEBUG</code> through the command line of one     of the executables</li> </ul> </li> <li> <p>Save test output to a file</p> <ul> <li>To save the output of <code>pytest</code> to <code>tmp.pytest.log</code> use the <code>--tee-to-file</code>     option.     <pre><code>&gt; i run_fast_tests --tee-to-file\n</code></pre></li> </ul> </li> <li> <p>Show the tests but do not run</p> <ul> <li>To list, but not run, the tests that will be executed, use <code>--collect-only</code>.     <pre><code>&gt; i run_fast_tests --collect-only\n</code></pre></li> </ul> </li> <li> <p>Skip submodules</p> <ul> <li>To skip running tests in submodules, use the <code>--skip-submodules</code> option.</li> <li>This option is useful in repos with Git submodules so that you can run only     the tests specific to the repo, skipping the tests in the submodule<ul> <li>E.g., to run only the tests in <code>cmamp</code> but not in <code>helpers</code> (which is a     submodule)     <pre><code>&gt; cd cmamp1\n&gt; i run_fast_tests --skip-submodules\n</code></pre></li> </ul> </li> </ul> </li> <li> <p>Compute test coverage</p> <ul> <li> <p>Use the <code>--coverage</code> option</p> <pre><code>&gt; i run_fast_tests --coverage\n</code></pre> </li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#timeout","title":"Timeout","text":"<ul> <li>We use the <code>pytest-timeout</code>     package to limit durations of fast, slow, and superslow tests</li> <li>The timeout restricts the running time of the test methods, including     <code>set_up_test()</code> and <code>tear_down_test()</code> time, if they are run at the     beginning/end of the methods</li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#rerunning_timed_out_tests","title":"Rerunning Timed Out Tests","text":"<ul> <li>Running tests can take different amounts of time depending on workload and     machine</li> <li>Because of this, we rerun failing tests using     <code>pytest-rerunfailures</code></li> <li><code>pytest-rerunfailures</code> is not completely compatible with <code>pytest-timeout</code>.     This is why we have to add the <code>-o timeout_func_only=true</code> flag to     <code>pytest-timeout</code>. See     https://github.com/pytest-dev/pytest-rerunfailures/issues/99     for more information</li> <li>We rerun time outed fast tests twice and time outed slow and superslow tests     once</li> <li>There is a     way     to provide a rerun delay for individual tests. However, we can't use it for     now due to     #693 (comment)</li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#compute_test_coverage","title":"Compute Test Coverage","text":"<ul> <li> <p>The documentation for the Python package <code>coverage</code> is     here.</p> </li> <li> <p>Run a set of unit tests enabling coverage:</p> <pre><code># Run the coverage for a single test:\n&gt; i run_fast_tests --coverage -p oms/test/test_broker.py::TestSimulatedBroker1\n\n# Run coverage for an entire module like `oms`:\n&gt; i run_fast_tests --coverage -p oms\n</code></pre> </li> <li> <p>This generates and runs a pytest command inside Docker like:</p> <pre><code>docker&gt; pytest -m \"not slow and not superslow\" oms/test/test_broker.py::TestSimulatedBroker1 --cov=. --cov-branch --cov-report term-missing --cov-report html\n</code></pre> <p>which generates: - A binary <code>.coverage</code> file that contains the coverage information - A default coverage report - An <code>htmlcov</code> directory with a browsable HTML coverage report</p> </li> <li> <p>You can post-process the coverage report in different ways using the command     <code>coverage</code> inside a docker container, since the code was run (as always)     inside the Docker container that contains all the dependencies</p> <pre><code>&gt; coverage -h\n\nCoverage.py, version 5.5 with C extension\nMeasure, collect, and report on code coverage in Python programs.\n\nusage: `coverage &lt;command&gt;` [options] [args]\n\nCommands:\n        annotate    Annotate source files with execution information.\n        combine     Combine a number of data files.\n        debug       Display information about the internals of coverage.py\n        erase       Erase previously collected coverage data.\n        help        Get help on using coverage.py.\n        html        Create an HTML report.\n        json        Create a JSON report of coverage results.\n        report      Report coverage stats on modules.\n        run         Run a Python program and measure code execution.\n        xml         Create an XML report of coverage results.\n\nUse `coverage help &lt;command&gt;` for detailed help on any command.\nFull documentation is at https://coverage.readthedocs.io\n</code></pre> <pre><code>&gt; coverage report -h\n\nUsage: coverage report [options] [modules]\n\nReport coverage statistics on modules.\n\nOptions:\n    --contexts=REGEX1,REGEX2,...\n                                                Only display data from lines covered in the given\n                                                contexts. Accepts Python regexes, which must be\n                                                quoted.\n    --fail-under=MIN      Exit with a status of 2 if the total coverage is less\n                                                than MIN.\n    -i, --ignore-errors   Ignore errors while reading source files.\n    --include=PAT1,PAT2,...\n                                                Include only files whose paths match one of these\n                                                patterns. Accepts shell-style wildcards, which must be\n                                                quoted.\n    --omit=PAT1,PAT2,...  Omit files whose paths match one of these patterns.\n                                                Accepts shell-style wildcards, which must be quoted.\n    --precision=N         Number of digits after the decimal point to display\n                                                for reported coverage percentages.\n    --sort=COLUMN         Sort the report by the named column: name, stmts,\n                                                miss, branch, brpart, or cover. Default is name.\n    -m, --show-missing    Show line numbers of statements in each module that\n                                                weren't executed.\n    --skip-covered        Skip files with 100% coverage.\n    --no-skip-covered     Disable --skip-covered.\n    --skip-empty          Skip files with no code.\n    --debug=OPTS          Debug options, separated by commas. [env:\n                                                COVERAGE_DEBUG]\n    -h, --help            Get help on this command.\n    --rcfile=RCFILE       Specify configuration file. By default '.coveragerc',\n                                                'setup.cfg', 'tox.ini', and 'pyproject.toml' are\n                                                tried. [env: COVERAGE_RCFILE]\n</code></pre> </li> <li> <p>Report the coverage for all the files under <code>oms</code> using the workload above     (i.e., the fast tests under <code>oms/test/test_broker.py::TestSimulatedBroker1</code>)</p> <pre><code>&gt; i docker_bash\ndocker&gt; coverage report --include=\"oms/*\"\nName                                    Stmts   Miss Branch BrPart  Cover\n-------------------------------------------------------------------------\noms/__init__.py                             0      0      0      0   100%\noms/api.py                                154     47     36      2    70%\noms/broker.py                             200     31     50      9    81%\noms/broker_example.py                      23      0      4      1    96%\noms/call_optimizer.py                      31      0      0      0   100%\noms/devops/__init__.py                      0      0      0      0   100%\noms/devops/docker_scripts/__init__.py       0      0      0      0   100%\noms/locates.py                              7      7      2      0     0%\noms/mr_market.py                           55      1     10      1    97%\noms/oms_db.py                              47      0     10      3    95%\noms/oms_lib_tasks.py                       64     39      2      0    38%\noms/oms_utils.py                           34     34      6      0     0%\noms/order.py                              101     30     22      0    64%\noms/order_example.py                       26      0      0      0   100%\noms/place_orders.py                       121      8     18      6    90%\noms/pnl_simulator.py                      326     42     68      8    83%\noms/portfolio.py                          309     21     22      0    92%\noms/portfolio_example.py                   32      0      0      0   100%\noms/tasks.py                                3      3      0      0     0%\noms/test/oms_db_helper.py                  29     11      2      0    65%\noms/test/test_api.py                      132     25     12      0    83%\noms/test/test_broker.py                    33      5      4      0    86%\noms/test/test_mocked_portfolio.py           0      0      0      0   100%\noms/test/test_mr_market.py                 46      0      2      0   100%\noms/test/test_oms_db.py                   114     75     14      0    38%\noms/test/test_order.py                     24      0      4      0   100%\noms/test/test_place_orders.py              77      0      4      0   100%\noms/test/test_pnl_simulator.py            235      6     16      0    98%\noms/test/test_portfolio.py                135      0      6      0   100%\n-------------------------------------------------------------------------\nTOTAL                                    2358    385    314     30    82%\n</code></pre> </li> <li> <p>To exclude the test files, which could inflate the coverage</p> <pre><code>&gt; coverage report --include=\"oms/*\" --omit=\"*/test_*.py\"\n\nName                                    Stmts   Miss Branch BrPart  Cover\n-------------------------------------------------------------------------\noms/__init__.py                             0      0      0      0   100%\noms/api.py                                154     47     36      2    70%\noms/broker.py                             200     31     50      9    81%\noms/broker_example.py                      23      0      4      1    96%\noms/call_optimizer.py                      31      0      0      0   100%\noms/devops/__init__.py                      0      0      0      0   100%\noms/devops/docker_scripts/__init__.py       0      0      0      0   100%\noms/locates.py                              7      7      2      0     0%\noms/mr_market.py                           55      1     10      1    97%\noms/oms_db.py                              47      0     10      3    95%\noms/oms_lib_tasks.py                       64     39      2      0    38%\noms/oms_utils.py                           34     34      6      0     0%\noms/order.py                              101     30     22      0    64%\noms/order_example.py                       26      0      0      0   100%\noms/place_orders.py                       121      8     18      6    90%\noms/pnl_simulator.py                      326     42     68      8    83%\noms/portfolio.py                          309     21     22      0    92%\noms/portfolio_example.py                   32      0      0      0   100%\noms/tasks.py                                3      3      0      0     0%\noms/test/oms_db_helper.py                  29     11      2      0    65%\n-------------------------------------------------------------------------\nTOTAL                                    1562    274    252     30    80%\n</code></pre> </li> <li> <p>To open the line coverage from outside Docker, go with your browser to     <code>/htmlcov/index.html</code></p> </li> <li> <p>The <code>htmlcov</code> is re-written with every coverage run with the     <code>--cov-report html</code> option</p> <ul> <li>If you move out <code>index.html</code> from <code>htmlcov</code> dir some html features (e.g.,     filtering) will not work.</li> </ul> <pre><code># On macOS:\n&gt; open htmlcov/index.html\n</code></pre> <p></p> </li> <li> <p>By clicking on a file you can see which lines are not covered</p> <p></p> </li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#an_example_coverage_session","title":"An Example Coverage Session","text":"<ul> <li> <p>You want to measure the unit test coverage of <code>oms</code> component from both <code>fast</code>     and <code>slow</code> test suites</p> </li> <li> <p>Start by running the fast tests for the <code>oms</code> dir</p> <pre><code>&gt; i run_fast_tests --coverage -p oms\ncollected 66 items / 7 deselected / 59 selected\n...\n</code></pre> </li> <li> <p>Compute the coverage for the module sorting by coverage</p> <pre><code>docker&gt; coverage report --include=\"oms/*\" --omit=\"*/test_*.py\" --sort=cover\n\nName                                    Stmts   Miss Branch BrPart  Cover\n-------------------------------------------------------------------------\noms/locates.py                              7      7      2      0     0%\noms/oms_utils.py                           34     34      6      0     0%\noms/tasks.py                                3      3      0      0     0%\noms/oms_lib_tasks.py                       64     39      2      0    38%\noms/order.py                              101     30     22      0    64%\noms/test/oms_db_helper.py                  29     11      2      0    65%\noms/api.py                                154     47     36      2    70%\noms/broker.py                             200     31     50      9    81%\noms/pnl_simulator.py                      326     42     68      8    83%\noms/place_orders.py                       121      8     18      6    90%\noms/portfolio.py                          309     21     22      0    92%\noms/oms_db.py                              47      0     10      3    95%\noms/broker_example.py                      23      0      4      1    96%\noms/mr_market.py                           55      1     10      1    97%\noms/__init__.py                             0      0      0      0   100%\noms/call_optimizer.py                      31      0      0      0   100%\noms/devops/__init__.py                      0      0      0      0   100%\noms/devops/docker_scripts/__init__.py       0      0      0      0   100%\noms/order_example.py                       26      0      0      0   100%\noms/portfolio_example.py                   32      0      0      0   100%\n-------------------------------------------------------------------------\nTOTAL                                    1562    274    252     30    80%\n</code></pre> </li> <li> <p>You see that some files have low coverage, so you want to see what exactly is     not covered</p> </li> <li> <p>Generate the same report in a browsable format:</p> <p><pre><code>docker&gt; rm -rf htmlcov; coverage html --include=\"oms/*\" --omit=\"*/test_*.py\"\n# Wrote HTML report to `htmlcov/index.html`\n\n&gt; open htmlcov/index.html\n</code></pre> - The low coverage for <code>tasks.py</code> and <code>oms_lib_tasks.py</code> is due to the fact     that we are running code through invoke that doesn't allow <code>coverage</code> to     track it</p> </li> <li> <p>Now, we run the coverage for the slow tests</p> <pre><code># Save the coverage from the fast tests run\n&gt; cp .coverage .coverage_fast_tests\n\n&gt; i run_slow_tests --coverage -p oms\ncollected 66 items / 59 deselected / 7 selected\n\n&gt; cp .coverage .coverage_slow_tests\n\n&gt; coverage report --include=\"oms/*\" --omit=\"*/test_*.py\" --sort=Cover\n\nName                                    Stmts   Miss Branch BrPart  Cover\n-------------------------------------------------------------------------\noms/locates.py                              7      7      2      0     0%\noms/oms_utils.py                           34     34      6      0     0%\noms/tasks.py                                3      3      0      0     0%\noms/pnl_simulator.py                      326    280     68      1    13%\noms/place_orders.py                       121    100     18      0    15%\noms/mr_market.py                           55     44     10      0    17%\noms/portfolio.py                          309    256     22      0    18%\noms/call_optimizer.py                      31     25      0      0    19%\noms/broker.py                             200    159     50      0    20%\noms/order.py                              101     78     22      0    20%\noms/order_example.py                       26     19      0      0    27%\noms/broker_example.py                      23     14      4      0    33%\noms/portfolio_example.py                   32     21      0      0    34%\noms/api.py                                154    107     36      0    36%\noms/oms_lib_tasks.py                       64     39      2      0    38%\noms/oms_db.py                              47      5     10      2    84%\noms/__init__.py                             0      0      0      0   100%\noms/devops/__init__.py                      0      0      0      0   100%\noms/devops/docker_scripts/__init__.py       0      0      0      0   100%\noms/test/oms_db_helper.py                  29      0      2      0   100%\n-------------------------------------------------------------------------\nTOTAL                                    1562   1191    252      3    23%\n</code></pre> </li> <li> <p>We see that the coverage from the slow tests is only 23% for 7 tests</p> <pre><code>docker&gt; coverage combine .coverage_fast_tests .coverage_slow_tests\nCombined data file .coverage_fast_tests\nCombined data file .coverage_slow_tests\n</code></pre> </li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#an_example_with_customized_pytest-cov_html_run","title":"An Example with Customized <code>Pytest-Cov</code> Html Run","text":"<ul> <li> <p>You want to measure unit test coverage specifically for one test in     <code>datapull/common/data/transform/</code> and to save generated <code>htmlcov</code> in the same     directory.</p> </li> <li> <p>Run the command in the container:</p> <pre><code>&gt; i docket_bash\ndocker&gt; pytest --cov-report term-missing\n    --cov=datapull/common/data/transform/ datapull/common/data/transform/test/test_transform_utils.py\n    --cov-report html:datapull/common/data/transform/htmlcov\n\n...\n---------- coverage: platform linux, python 3.8.10-final-0 -----------\nName                                                              Stmts Miss Cover Missing\n-----------------------------------------------------------------------------------------------\ndatapull/common/data/transform/convert_csv_to_pq.py                  55    55   0%    2-159\ndatapull/common/data/transform/extract_data_from_db.py               55    55   0%    2-125\ndatapull/common/data/transform/pq_convert.py                         126   126  0%    3-248\ndatapull/common/data/transform/transform_pq_by_date_to_by_asset.py   131   131  0%    2-437\ndatapull/common/data/transform/transform_utils.py                    22    0    100%\n-----------------------------------------------------------------------------------------------\nTOTAL                                                             389   367  6%\nCoverage HTML written to dir datapull/common/data/transform/htmlcov\n</code></pre> </li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#generate_coverage_report_with_invoke","title":"Generate Coverage Report with <code>Invoke</code>","text":"<ul> <li> <p>You can compute test coverage for a specified directory and generate text and     HTML reports automatically using <code>invoke task run_coverage_report</code></p> <pre><code>&gt; i --help run_coverage_report\nINFO: &gt; cmd='/data/grisha/src/venv/amp.client_venv/bin/invoke --help run_coverage_report'\n\nUsage: inv[oke] [--core-opts] run_coverage_report [--options] [other tasks here ...]\n\nDocstring:\n\n    Compute test coverage stats.\n\n:param target_dir: directory to compute coverage stats for running-unit-tests\n:param generate_html_report: whether to generate HTML coverage report or not\n:param publish_html_on_s3: whether to publish HTML coverage report or not\n:param aws_profile: the AWS profile to use for publishing HTML report\n\nOptions:\n    -a STRING, --aws-profile=STRING\n    -g, --[no-]generate-html-report\n    -p, --[no-]publish-html-on-s3\n    -t STRING, --target-dir=STRING\n</code></pre> </li> <li> <p>Compute coverage for <code>market_data</code> dir, generate text and HTML reports and     publish HTML report on S3</p> <pre><code>&gt; i run_coverage_report --target-dir market_data\n...\nName                                   Stmts   Miss Branch BrPart  Cover\n------------------------------------------------------------------------\nmarket_data/real_time_market_data.py     100     81     32      0    16%\nmarket_data/replayed_market_data.py      111     88     24      0    19%\nmarket_data/abstract_market_data.py      177    141     24      0    19%\nmarket_data/market_data_example.py       124     97     10      0    20%\nmarket_data/market_data_im_client.py      66     50     18      0    21%\nmarket_data/__init__.py                    5      0      0      0   100%\n------------------------------------------------------------------------\nTOTAL                                    583    457    108      0    19%\nWrote HTML report to htmlcov/index.html\n\n20:08:53 - INFO  lib_tasks.py _publish_html_coverage_report_on_s3:3679  HTML coverage report is published on S3: path=`s3://cryptokaizen-html/html_coverage/grisha_CmTask1038_Tool_to_extract_the_dependency_from_a_project`\n</code></pre> </li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#publishing_html_report_on_s3","title":"Publishing HTML Report on S3","text":"<ul> <li>To make a dir with the report unique, you decorate the dir with a linux user     and a Git branch name, e.g.,     <code>html_coverage/grisha_CmTask1038_Tool_to_extract_the_dependency_from_a_project</code><ul> <li><code>html_coverage</code> is the common dir on S3 for coverage reports</li> </ul> </li> <li>After publishing the report, you can open the report via a local web browser<ul> <li>See the details in     htmlcov server</li> <li>E.g.     http://172.30.2.44/html_coverage/grisha_CmTask1038_Tool_to_extract_the_dependency_from_a_project/</li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#running_pytest_directly","title":"Running <code>Pytest</code> Directly","text":""},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#basic_rules","title":"Basic Rules","text":"<ul> <li>Always run <code>pytest</code> from the Docker container to ensure consistency in our     environments     <pre><code>&gt; i docker_bash\n# Then from Docker, run pytest.\ndocker &gt; pytest &lt;test_file_name&gt;\n</code></pre></li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#usage_and_invocations_reference","title":"Usage and Invocations Reference","text":"<ul> <li>See <code>pytest</code> documentation</li> <li> <p>Some examples of useful command lines:</p> <pre><code># Stop at first failure\n&gt; pytest -x\n\n# Run a single test class\n&gt; pytest -k TestPcaFactorComputer1\n\n# Run a single test method\n&gt; pytest core/test/test_core.py::TestPcaFactorComputer1::test_linearize_eigval_eigvec\n\n    # Run all tests in a file\n&gt; pytest core/test/test_core.py\n\n# Remove cache artifacts\n\n&gt; find . -name \"__pycache__\" -o -name \".pytest_cache\"\n./.pytest_cache\n./dev_scripts/test/Test_linter_py1.test_linter1/tmp.scratch/__pycache__\n./dev_scripts/test/__pycache__\n./dev_scripts/__pycache__\n\n&gt; find . -name \"__pycache__\" -o -name \".pytest_cache\" | xargs rm -rf\n\n# Run with a clear cache\n&gt; pytest --cache-clear\n\n# Run the tests that last failed (this data is stored in .pytest_cache/v/cache/lastfailed)\n&gt; pytest --last-failed\n</code></pre> </li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#custom_pytest_options_behaviors","title":"Custom <code>Pytest</code> Options Behaviors","text":"<ul> <li> <p>Enable logging</p> <ul> <li> <p>To enable logging of <code>_LOG.debug</code> for a single test run:</p> <pre><code># Enable debug info\n&gt; pytest oms/test/test_broker.py::TestSimulatedBroker1 -s --dbg\n</code></pre> </li> </ul> </li> <li> <p>Update golden outcomes</p> <ul> <li> <p>This switch allows to overwrite the golden outcomes that are used as     reference in the unit tests to detect failures</p> <pre><code>&gt; pytest --update_outcomes\n</code></pre> </li> </ul> </li> <li> <p>Incremental test mode</p> <ul> <li>This switch allows to reuse artifacts in the test directory and to skip the     clean up phase</li> <li> <p>It is used to rerun tests from the middle when they are very long and one     wants to debug them</p> <pre><code>&gt; pytest --incremental\n</code></pre> </li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#debugging_notebooks","title":"Debugging Notebooks","text":"<ol> <li>Run a failing test with <code>-s --dbg</code> to get detailed logs</li> <li>E.g., <code>&gt; pytest core/plotting/test/test_gallery_notebook.py -s --dbg</code></li> <li>From the logs take a <code>run_notebook.py</code> script command that was run by the    test</li> <li>E.g., starting like      <code>/app/dev_scripts/notebooks/run_notebook.py --notebook ...</code></li> <li>Append <code>--no_suppress_output</code> to this command and run it again directly from    the bash</li> <li>E.g., like      <code>&gt; /app/dev_scripts/notebooks/run_notebook.py --notebook ... --no_suppress_output</code></li> <li>Scroll up the logs and see a report about the problem, notebooks failures    will be displayed as well</li> <li>E.g.,      </li> </ol>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#running_tests_on_gh_actions","title":"Running Tests on GH Actions","text":"<ul> <li>The official documentation is     https://docs.github.com/en/actions</li> </ul>"},{"location":"tools/unit_test/all.run_unit_tests.how_to_guide.html#how_to_run_a_single_test_on_gh_action","title":"How to Run a Single Test on GH Action","text":"<ul> <li> <p>Unfortunately, there is no way to log in and run interactively on GH machines.     This is a feature requested but not implemented by GH yet.</p> </li> <li> <p>All the code to run GH Actions is in the <code>.github</code> directory in <code>lemonade</code> and     <code>amp</code>.</p> </li> <li> <p>E.g., to run a single test in the fast test target, instead of the entire     regression suite</p> <ul> <li> <p>You can modify <code>.github/workflows/fast_tests.yml</code>, by replacing</p> <p><pre><code># run: invoke run_fast_tests\nrun: invoke run_fast_tests --pytest-opts=\"helpers/test/test_git.py::Test_git_modified_files1::test_get_modified_files_in_branch1 -s --dbg\"\n</code></pre> - Note that the indentation matters since it's a YAML file</p> <pre><code>&lt;img src=\"../../code_guidelines/figs/unit_tests/image_3.png\"&gt;\n</code></pre> <ul> <li>The <code>-s --dbg</code> is to show <code>_LOG.debug</code> in case you care about that to get     more information<ul> <li>Commit the code to your branch (not in master, please) since GH runs tests independently per branch</li> <li>Kick-off manually the fast test through the GH interface</li> <li>After debugging, you can revert the change from your branch to <code>master</code> and move along with the usual PR flow</li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html","title":"All.write unit tests.how to guide","text":""},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#write_unit_tests","title":"Write Unit Tests","text":""},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#guidelines_about_writing_unit_tests","title":"Guidelines about writing unit tests","text":""},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#what_is_a_unit_test","title":"What is a unit test?","text":"<ul> <li>A unit test is a small, self-contained test of a (public) function or method     of a library</li> <li>The test specifies the given inputs, any necessary state, and the expected     output</li> <li>Running the test ensures that the actual output agrees with the expected     output</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#why_is_unit_testing_important","title":"Why is unit testing important?","text":"<ul> <li>Good unit testing improves software quality by:<ul> <li>Eliminating bugs (obvious)</li> <li>Clarifying code design and interfaces (\"Design to Test\")</li> <li>Making refactoring safer and easier (\"Refactor Early, Refactor Often\")</li> <li>Documenting expected behavior and usage</li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#the_pragmatic_programming_and_unit_testing","title":"The Pragmatic Programming and unit testing","text":"<ul> <li> <p>Unit testing is an integral part of     The Pragmatic Programming     approach</p> </li> <li> <p>Some of the tips that relate to unit testing are:</p> <ul> <li>Design with Contracts</li> <li>Refactor Early, Refactor Often</li> <li>Test Your Software, or Your Users Will</li> <li>Coding Ain't Done Till All the Tests Run</li> <li>Test State Coverage, Not Code Coverage</li> <li>You Can't Write Perfect Software</li> <li>Crash Early</li> <li>Design to Test</li> <li>Test Early. Test Often. Test Automatically.</li> <li>Use Saboteurs to Test Your Testing</li> <li>Find Bugs Once</li> </ul> </li> <li> <p>Read these wisdom pearls carefully and you will have made another step towards     programming mastery</p> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#unit_testing_tips","title":"Unit testing tips","text":""},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#test_one_thing","title":"Test one thing","text":"<ul> <li>A good unit test tests only one thing<ul> <li>A test class should test only one function / class</li> <li>A test method should only test a single case (e.g., \"for these inputs the     function responds with this output\"</li> </ul> </li> <li>Testing one thing keeps the unit test simple, relatively easy to understand,     and helps isolate the root cause when the test fails</li> <li>How do you test more than one thing? By having more than one unit test!</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#keep_tests_self-contained","title":"Keep tests self-contained","text":"<ul> <li>A unit test should be independent of all other unit tests</li> <li>Each test should be self-sufficient</li> <li>One should never assume that unit tests will be executed in a particular order</li> <li>A corollary of keeping tests self-contained is to keep all information needed     to understand the test within the test itself<ul> <li>Specify the data explicitly in the test where it is used</li> <li>This makes the test easier to understand and easier to debug when it fails</li> <li>If multiple unit tests use or can use the same initialization data, do not     hesitate repeating it in each test (or consider using parameterized testing)</li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#only_specify_data_related_to_what_is_being_tested","title":"Only specify data related to what is being tested","text":"<ul> <li>Specify the minimum of what is required to test what is being tested</li> <li>E.g., if a function that is being tested supports optional arguments, but     those optional arguments are not needed for a particular unit test, then do     not specify them in the test</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#test_realistic_corner_cases","title":"Test realistic corner cases","text":"<ul> <li>Can the function receive an empty list?</li> <li>Can it return an empty Series?</li> <li>What happens if it receives a numerical value outside of an expected range?<ul> <li>How should the function behave in those cases? Should it crash? Should it     return a reasonable default value?</li> </ul> </li> <li>Expect these questions to come up in practice and think through what the     appropriate behavior should be. Then, test for it.</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#test_a_typical_scenario","title":"Test a typical scenario","text":"<ul> <li>In ensuring that corner cases are covered, do not overlook testing basic     functionality for typical cases</li> <li>This is useful for verifying current behavior and to support refactoring.</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#test_executable_scripts_end-to-end","title":"Test executable scripts end-to-end","text":"<ul> <li>In some cases, like scripts, it is easy to get lost chasing the coverage %<ul> <li>E.g., covering every line of the original, including the parser</li> </ul> </li> <li>This is not always necessary<ul> <li>If you can run a script with all arguments present, it means that the parser     works correctly</li> <li>So an end-to-end smoke test will also cover the parser</li> <li>This saves a little time and reduces the bloat</li> </ul> </li> <li>If you need to test the functionality, consider factoring out as much code as     possible from <code>_main()</code><ul> <li>A good practice is to have a <code>_run()</code> function that does all the job and     <code>_main()</code> only brings together the parser and the executable part</li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#test_from_the_outside-in","title":"Test from the outside-in","text":"<ul> <li>Prefer testing end-to-end behaviors first, rather than starting with internal     implementation details.</li> <li>This helps focus tests on what the system should do, not how it's implemented.</li> <li>It also lowers maintenance costs when internal code is refactored, since     interface-level tests don't need to change.</li> <li>Start with public-facing methods or behaviors, and only add tests for internal     helpers if truly necessary.</li> <li>This approach supports flexible and safe refactoring, encourages clear     interfaces, and reduces test fragility.</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#conventions","title":"Conventions","text":""},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#naming_and_placement_conventions","title":"Naming and placement conventions","text":"<ul> <li> <p>We follow conventions that happen to be mostly the default to <code>pytest</code></p> </li> <li> <p>A directory <code>test</code> contains all the test code and artifacts</p> <ul> <li>The <code>test</code> directory contains all the <code>test_*.py</code> files and all inputs and     outputs for the tests.</li> <li>A unit test file should be close to the library / code it tests</li> </ul> </li> <li> <p>The test class should make clear reference to the code that is tested</p> <ul> <li>To test a class <code>FooBar</code>, the corresponding test class is named     <code>TestFooBar</code>, i.e. we use the CamelCase for the test classes</li> <li>To test a function <code>generate_html_tables()</code>, the corresponding test class is     named <code>Test_generate_html_tables</code></li> <li>To test a method <code>method_a()</code> of the class <code>FooBar</code>, the corresponding test     class is named <code>TestFooBar</code> and the test method in this class is named     <code>test_method_a</code></li> <li>To test a protected method <code>_gozilla()</code> of <code>FooBar</code>, the corresponding test     method is named <code>test__gozilla</code> (note the double underscore). This is needed     to distinguish testing the public method <code>FooBar.gozilla()</code> from     <code>FooBar._gozilla()</code></li> </ul> </li> <li> <p>Numbers can be used to differentiate between separate test cases clearly</p> <ul> <li>A number can be added to the test class name, e.g., <code>TestFooBar1()</code>, if     there are multiple test classes that are testing the code in different ways     (e.g., with different set up and tear down actions)</li> <li>We prefer to name classes <code>TestFooBar1</code> and methods <code>TestFooBar1.test1()</code>,     even if there is a single class / method, to make it easier to add another     test class, without having to rename class and <code>check_string</code> files</li> <li>We are OK with using suffixes like <code>01</code>, <code>02</code>, ... , when we believe it's     important that methods are tested in a certain order (e.g., from the     simplest to the most complex)</li> </ul> </li> <li> <p>A single test class can have multiple test methods, e.g., for     <code>FooBar.method_a()</code> and <code>FooBar.method_b()</code>, the test class contains the     following methods:</p> <p>```python class TestFooBar1(unittest2.TestCase):     def test_method_a(self):             ...</p> <pre><code>def test_method_b(self):\n        ...\n</code></pre> <p>```</p> </li> <li> <p>Split test classes and methods in a reasonable way so each one tests one     single thing in the simplest possible way</p> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#keep_testing_code_in_sync_with_tested_code","title":"Keep testing code in sync with tested code","text":"<ul> <li>If you change the name of a tested class, also the test should be changed</li> <li>If you change the name of a file also the name of the file with the testing     code should be changed</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#test_code_is_not_second-class_citizen","title":"Test code is not second-class citizen","text":"<ul> <li> <p>Test code is not second-class citizen, even though it's auxiliary to the code</p> </li> <li> <p>Add comments and docstring explaining what the code is doing</p> </li> <li> <p>Avoid repetition in test code, but use helper to factor out common code</p> </li> <li>Abhor copy-paste and keep the code DRY</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#testing_code_layout","title":"Testing code layout","text":"<ul> <li>The layout of a test dir should look like:     <pre><code>&gt; ls -1 helpers/test/\nTest_dassert1.test2\nTest_dassert1.test3\nTest_dassert1.test4\n...\nTest_dassert_misc1.test6\nTest_dassert_misc1.test8\nTest_system1.test7\ntest_dbg.py\ntest_helpers.py\ntest_system_interaction.py\n</code></pre></li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#our_framework_to_test_using_input_output_data","title":"Our framework to test using input / output data","text":"<ul> <li><code>/helpers/hunit_test.py</code> has some utilities to     easily create input and output dirs storing data for unit tests</li> <li> <p><code>hunitest.TestCase</code> has various methods to help you create dirs</p> <ul> <li><code>get_input_dir()</code>: return the name of the dir used to store the inputs</li> <li><code>get_scratch_space()</code>: return the name of a scratch dir to keep artifacts of     the test</li> <li><code>get_output_dir()</code>: probably not interesting for the user</li> </ul> </li> <li> <p>The directory structure enforced by the out <code>TestCase</code> is like:</p> <pre><code>&gt; tree -d edg/form_8/test/\nedg/form_8/test/\n\u00c3\u00a2\u00c2\u0094\u00c2\u0094\u00c3\u00a2\u00c2\u0094\u00c2\u0080\u00c3\u00a2\u00c2\u0094\u00c2\u0080 TestExtractTables1.test1\n        \u00c3\u00a2\u00c2\u0094\u00c2\u009c\u00c3\u00a2\u00c2\u0094\u00c2\u0080\u00c3\u00a2\u00c2\u0094\u00c2\u0080 input\n        \u00c3\u00a2\u00c2\u0094\u00c2\u0094\u00c3\u00a2\u00c2\u0094\u00c2\u0080\u00c3\u00a2\u00c2\u0094\u00c2\u0080 output\n</code></pre> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#use_text_and_not_pickle_files_as_inputoutputs","title":"Use text and not pickle files as input/outputs","text":"<ul> <li> <p>The problems with pickle files are the usual ones</p> <ul> <li>Pickle files are not stable across different versions of libraries</li> <li>Pickle files are not human-readable</li> </ul> </li> <li> <p>Prefer to use text file</p> <ul> <li>E.g., use a CSV file</li> </ul> </li> <li> <p>If the data used for testing is generated in a non-complicated way</p> <ul> <li>Document how it was generated</li> <li>Even better, add a test that generates the data</li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#small_testing_data_is_best","title":"Small testing data is best","text":"<ul> <li> <p>Use a subset of the input data</p> </li> <li> <p>The smaller, the better for everybody</p> <ul> <li>Fast tests</li> <li>Easier to debug</li> <li>More targeted unit test</li> </ul> </li> <li> <p>Do not check in 1 megabyte of test data!</p> </li> </ul> <p>Last review: GP on 2024-05-13</p>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#check_string_vs_selfassertequal","title":"<code>check_string</code> vs <code>self.assertEqual</code>","text":"<ul> <li>Use <code>self.assert_equal()</code> when you expect a simple, small string comparison.</li> <li>Use <code>self.check_string()</code> when:<ul> <li>The expected string is too large to inline in code.</li> <li>You want a frozen reference output stored on disk.</li> <li>The test output may change less frequently but still needs stable diffing.</li> </ul> </li> <li>Rule of thumb:<ul> <li>If it's simple \u2192 <code>assert_equal()</code></li> <li>If it's large, externalized, or behavioral regression \u2192 <code>check_string()</code>.</li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#use_selfassert_equal","title":"Use <code>self.assert_equal()</code>","text":"<ul> <li>This is a function that helps you understand what the mismatches are</li> <li>It works on <code>str</code></li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#how_to_split_unit_test_code_in_files","title":"How to split unit test code in files","text":"<ul> <li>The two extreme approaches are:<ul> <li>All the test code for a directory goes in one file     <code>foo/bar/test/test_$DIRNAME.py</code> (or <code>foo/bar/test/test_all.py</code>)</li> <li>Each file <code>foo/bar/$FILENAME</code> with code gets its corresponding     <code>foo/bar/test/test_$FILENAME.py</code><ul> <li>It should also be named according to the library it tests</li> <li>For example, if the library to test is called <code>pnl.py</code>, then a     corresponding unit test should be called <code>test_pnl.py</code></li> </ul> </li> </ul> </li> <li>Pros of 1) vs 2)<ul> <li>Less maintenance churn<ul> <li>It takes work to keep the code and the test files in sync, e.g.,<ul> <li>If you change the name of the code file, you don't have to change other     file names</li> <li>If you move one class from one file to another, you might not need to     move test code</li> </ul> </li> </ul> </li> <li>Fewer files opened in your editor</li> <li>Avoid many files with a lot of boilerplate code</li> </ul> </li> <li>Cons of 1) vs 2)<ul> <li>The single file can become huge!</li> </ul> </li> <li>Compromise solution: Start with a single file     <code>test_$DIRNAME.py</code>(or<code>test*dir_name.py</code>) * In the large file add a framed     comment like:     ```python</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#_1","title":"All.write unit tests.how to guide","text":""},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#unit_tests_for","title":"Unit tests for ...","text":""},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#_2","title":"All.write unit tests.how to guide","text":"<pre><code>```\n- So it's easy to find which file is tested were using grep\n</code></pre> <ul> <li>Then split when it becomes too big using <code>test_$FILENAME.py</code></li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#template_for_unit_test","title":"Template for unit test","text":"<ul> <li>Interesting unit tests are in <code>helpers/test</code></li> <li>A unit test looks like:     <code>python import helpers.hunit_test as hunitest class Test...(hunitest.TestCase):         def test...(self):                 ...</code></li> <li><code>pytest</code> will take care of running the code so you don't need:     <code>python if __name__ == '__main__': unittest.main()</code></li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#use_consistent_comments_in_test_methods","title":"Use consistent comments in test methods","text":"<p>We strongly encourage adding short, consistent comments at the start of each main action within your test methods to establish a unified structure:</p> <pre><code>import helpers.hunit_test as hunitest\n\nclass TestFooBar1(hunitest.TestCase):\n        def test_method_a(self):\n                # Prepare inputs.\n                input_value = 42\n                # Run.\n                actual = foo_bar_function(input_value)\n                # Check.\n                expected = \"some_expected_value\"\n                self.assert_equal(str(actual), expected)\n</code></pre> <p>This makes it easy to scan what the test is doing and quickly understand its three core steps. It also improves readability and consistency across all our test code.</p>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#hierarchical_testcase_approach","title":"Hierarchical <code>TestCase</code> approach","text":"<ul> <li>Whenever there is a hierarchy in classes, we also create a hierarchy of test     classes</li> <li>A parent test class looks like:     <code>python import helpers.hunit_test as hunitest class SomeClientTestCase(hunitest.TestCase):         def _test...1(self):                 ...         def _test...2(self):                 ...</code></li> <li>While a child test class looks like this, where test methods use the     corresponding methods from the parent test class:     <code>python class TestSomeClient(SomeClientTestCase):         def test...1(self):                 ...         def test...2(self):                 ...</code></li> <li>Each <code>TestCase</code> tests a \"behavior\" like a set of related methods</li> <li>Each <code>TestCase</code> is under the test dir</li> <li>Each derived class should use the proper <code>TestCase</code> classes to reach a decent     coverage</li> <li>It is OK to use non-private methods in test classes to ensure that the code is     in order of dependency so that the reader doesn't have to jump back / forth</li> <li> <p>We want to separate chunks of unit test code using:</p> <p>```python</p> </li> <li> <p>It is OK to skip a <code>TestCase</code> method if it is not meaningful, when coverage is     enough</p> </li> <li>As an example, see <code>datapull/common/data/client/test/im_client_test_case.py</code>     and <code>datapull/ccxt/data/client/test/test_ccxt_clients.py</code></li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#_3","title":"All.write unit tests.how to guide","text":"<p>```</p> <p>putting all the methods used by that chunk at the beginning and so on</p>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#use_the_appropriate_selfassert","title":"Use the appropriate <code>self.assert*</code>","text":"<ul> <li>When you get a failure, you don't want to get something like \"True is not     False\", rather an informative message like \"5 is not &lt; 4\"</li> <li>Bad <code>self.assertTrue(a &lt; b)</code></li> <li>Good <code>self.assertLess(a, b)</code></li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#do_not_use_hdbgdassert_in_testing","title":"Do not use <code>hdbg.dassert</code> in testing","text":"<ul> <li><code>dassert</code>s are for checking the self-consistency of the code</li> <li>The invariant is that you can remove <code>dbg.dassert</code> without changing the code's     behavior. Of course, you can't remove the assertion and get unit tests to work</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#always_explain_selfassertraises","title":"Always explain <code>self.assertRaises</code>","text":"<ul> <li>When testing for an assertion, always use the following idiom to clearly     explain what exception is expected and why:</li> </ul> <pre><code>with self.assertRaises(AssertionError) as cm:\n        hlitagit.git_patch_create(\n                ctx, mode, modified, branch, last_commit, files\n        )\nact = str(cm.exception)\nexp = r\"\"\"\n#### Failed assertion * '0' == '1' Specify only one among --modified,\n    --branch, --last-commit\n\"\"\"\nself.assert_equal(act, exp, fuzzy_match=True)\n</code></pre>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#test_from_the_outside-in_1","title":"Test from the outside-in","text":"<ul> <li>We want to start testing from the end-to-end methods towards the constructor     of an object</li> <li>Rationale: often, we start testing the constructor very carefully and then we     get tired / run out of time when we finally get to test the actual behavior</li> <li>Also, testing the important behavior automatically tests building the objects</li> <li>Use the code coverage to see what's left to test once you have tested the     \"most external\" code</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#we_dont_need_to_test_all_the_assertions","title":"We don't need to test all the assertions","text":"<ul> <li>Focus on behavioral correctness, not line coverage.</li> <li>We don't need to exhaustively test every <code>dassert</code> or input validation unless     it's part of the system's observable behavior.</li> <li>Behavioral coverage gives better ROI than aiming for 100% line coverage.</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#use_strings_to_compare_output_instead_of_data_structures","title":"Use strings to compare output instead of data structures","text":"<ul> <li> <p>Often, it's easier to do a check like:</p> <p>```python</p> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#better","title":"Better:","text":"<p>expected = str(...) expected = pprint.pformat(...)</p>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#worse","title":"Worse:","text":"<p>expected = [\"a\", \"b\", { ... }]     ```</p> <pre><code>rather than building the data structure\n</code></pre> <ul> <li>Some purists might not like this, but<ul> <li>It's much faster to use a string (which is or should be one-to-one to the     data structure), rather than the data structure itself<ul> <li>By extension, many of the more complex data structure have a built-in     string representation</li> </ul> </li> <li>It is often more readable and easier to diff (e.g., <code>self.assertEqual</code> vs     <code>self.assert_equal</code>)</li> <li>In case of mismatch, it's easier to update the string with copy-paste rather     than creating a data structure that matches what was created</li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#use_selfcheck_string_for_things_that_we_care_about_not_changing_or_are_too_big_to_have_as_strings_in_the_code","title":"Use <code>self.check_string()</code> for things that we care about not changing (or are too big to have as strings in the code)","text":"<ul> <li>Use <code>self.assert_equal()</code> for things that should not change (e.g., 1 + 1 = 2)</li> <li>When using <code>check_string</code> still try to add invariants that force the code to     be correct</li> <li>E.g., if we want to check the PnL of a model, we can freeze the output with     <code>check_string()</code>, but we want to add a constraint like there are more     timestamps than 0 to avoid the situation where we update the string to     something malformed</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#each_test_method_should_test_a_single_test_case","title":"Each test method should test a single test case","text":"<ul> <li>Rationale: we want each test to be clear, simple, fast</li> <li>If there is repeated code we should factor it out (e.g., builders for objects)</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#each_test_should_be_crystal_clear_on_how_it_is_different_from_the_others","title":"Each test should be crystal clear on how it is different from the others","text":"<ul> <li>Often, you can factor out all the common logic into a helper method</li> <li>Copy-paste is not allowed in unit tests in the same way it's not allowed in     production code</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#in_general_you_want_to_budget_the_time_to_write_unit_tests","title":"In general, you want to budget the time to write unit tests","text":"<ul> <li> <p>E.g., \"I'm going to spend 3 hours writing unit tests\". This is going to help     you focus on what's important to test and force you to use an iterative     approach rather than incremental (remember the Monalisa)</p> <p></p> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#write_a_template_of_unit_tests_and_ask_for_a_review_if_you_are_not_sure_how_what_to_test","title":"Write a template of unit tests and ask for a review if you are not sure how what to test","text":"<ul> <li>Aka \"testing plan\"</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#interesting_testing_functions","title":"Interesting testing functions","text":"<ul> <li>List of useful testing functions are:<ul> <li>General Python</li> <li>Numpy</li> <li>Pandas</li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#use_set_up_test_tear_down_test","title":"Use set_up_test / tear_down_test","text":"<ul> <li>If you have a lot of repeated code in your tests, you can make them shorter by     moving this code to <code>set_up_test/tear_down_test</code> methods:<ul> <li>These methods are our preferred alternative to <code>setUp()</code> and <code>tearDown()</code>     methods that are standardly used in the <code>unittest</code> framework. As a general     rule, we should avoid defining custom <code>setUp()</code> and <code>tearDown()</code> methods in     our test classes. The reason is that the <code>unittest</code>/<code>pytest</code> framework     relies on its built-in <code>setUp()</code> and <code>tearDown()</code> methods, and if we     introduce additional operations in these methods in the individual test     classes (e.g., mocking, opening DBs), it can interfere with the inner     workings of the framework.</li> <li>Instead of <code>setUp()</code>, we define a <code>set_up_test()</code> method within the test     class and then run it at the beginning of each test method.</li> <li>Similarly, instead of <code>tearDown()</code>, we define <code>tear_down_test()</code> and run it     at the end of each test method.</li> <li> <p>To make sure both <code>set_up_test()</code> and <code>tear_down_test()</code> run even if the     test itself fails, we wrap them in a     pytest fixture.</p> <p>Bad:</p> <p>```python def setUp(self) -&gt; None: super().setUp() ... ... # custom code ...</p> </li> </ul> </li> </ul> <p>def tearDown(self) -&gt; None:         ...         ... # custom code         ...         super().tearDown()</p> <p>def test1(self) -&gt; None:         ...         ```</p> <pre><code>    **Good**:\n\n    ```python\n</code></pre>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#this_will_be_run_before_and_after_each_test","title":"This will be run before and after each test.","text":"<p>@pytest.fixture(autouse=True) def setup_teardown_test(self):         # Run before each test.         self.set_up_test()         yield         # Run after each test.         self.tear_down_test()</p> <p>def set_up_test(self) -&gt; None:         ...         ... # custom code         ...</p> <p>def tear_down_test(self) -&gt; None:         ...         ... # custom code         ...</p> <p>def test1(self) -&gt; None:         ...         <code>``     - If there is nothing left in</code>setUp()<code>/</code>tearDown()<code>after removing</code>super().setUp()<code>/</code>super().tearDown()<code>, then</code>setUp()<code>/</code>tearDown()` can be         discarded completely.</p>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#nested_set_up_test_tear_down_test","title":"Nested set_up_test / tear_down_test","text":"<ul> <li>In nested inheritance:<ul> <li>The parent class uses <code>set_up_test()</code> / <code>tear_down_test()</code>.</li> <li>The child class uses <code>set_up_test2()</code> / <code>tear_down_test2()</code>, calling its     parent.</li> <li>Each further nested level adds a numeric suffix: <code>set_up_test3()</code>, etc.</li> </ul> </li> <li>This makes nested setup logic explicit and avoids framework collisions.</li> <li> <p>The following cases are possible with regard to the <code>setUp()</code>/<code>tearDown()</code>     configuration:</p> <ul> <li>Both of TestParent and TestChild have separate <code>setUp()</code>/<code>tearDown()</code>     methods. Then, in TestParent, <code>setUp()</code>/<code>tearDown()</code> should be replaced by     <code>set_up_test()</code>/<code>tear_down_test()</code> as described above; in TestChild,     <code>setUp()</code>/<code>tearDown()</code> should be replaced by     <code>set_up_test2()</code>/<code>tear_down_test2()</code>, which call     <code>set_up_test()</code>/<code>tear_down_test()</code> from the parent class. For example:</li> </ul> <p>```python class TestParent(hunitest.TestCase):     def setUp(self) -&gt; None:             super().setUp()             ...</p> <pre><code>def tearDown(self) -&gt; None:\n        ...\n        super().tearDown()\n\ndef test1(self) -&gt; None:\n        ...\n</code></pre> </li> </ul> <p>class TestChild(TestParent):         def setUp(self) -&gt; None:                 super().setUp()                 ...</p> <pre><code>    def tearDown(self) -&gt; None:\n            ...\n            super().tearDown()\n\n    def test1(self) -&gt; None:\n            ...\n```\n\nshould be replaced by:\n\n```python\n</code></pre> <p>class TestParent(hunitest.TestCase):         @pytest.fixture(autouse=True)         def setup_teardown_test(self):                 # Run before each test.                 self.set_up_test()                 yield                 # Run after each test.                 self.tear_down_test()</p> <pre><code>    def set_up_test(self) -&gt; None:\n            ...\n\n    def tear_down_test(self) -&gt; None:\n            ...\n\n    def test1(self) -&gt; None:\n            ...\n</code></pre> <p>class TestChild(TestParent):         @pytest.fixture(autouse=True)         def setup_teardown_test(self):                 # Run before each test.                 self.set_up_test2()                 yield                 # Run after each test.                 self.tear_down_test2()</p> <pre><code>    def set_up_test2(self) -&gt; None:\n            self.set_up_test()\n            ...\n\n    def tear_down_test2(self) -&gt; None:\n            ...\n            self.tear_down_test()\n\n    def test1(self) -&gt; None:\n            ...\n```\n- TestParent has `setUp()` and `tearDown()`, while TestChild does not. Then,\n    in TestParent, `setUp()`/`tearDown()` should be replaced by\n    `set_up_test()`/`tear_down_test()` as described above; in TestChild,\n    `set_up_test()`/`tear_down_test()` will run in the test methods\n    automatically via the inherited fixture. For example:\n\n```python\n</code></pre> <p>class TestParent(hunitest.TestCase):         def setUp(self) -&gt; None:                 super().setUp()                 ...</p> <pre><code>    def tearDown(self) -&gt; None:\n            ...\n            super().tearDown()\n\n    def test1(self) -&gt; None:\n            ...\n</code></pre> <p>class TestChild(TestParent):         def test1(self) -&gt; None:                 ...     ```</p> <pre><code>should be replaced by:\n\n```python\n</code></pre> <p>class TestParent(hunitest.TestCase):         @pytest.fixture(autouse=True)         def setup_teardown_test(self):                 # Run before each test.                 self.set_up_test()                 yield                 # Run after each test.                 self.tear_down_test()</p> <pre><code>    def set_up_test(self) -&gt; None:\n            ...\n\n    def tear_down_test(self) -&gt; None:\n            ...\n\n    def test1(self) -&gt; None:\n            ...\n</code></pre> <p>class TestChild(TestParent):         def test1(self) -&gt; None:                 ...     <code>``     - If TestParent only has one of the two, either</code>setUp()<code>or</code>tearDown()<code>,         then in both TestParent and TestChild, the test methods should run (from the         fixture), respectively, either</code>set_up_test()<code>or</code>tear_down_test()`, e.g.:</p> <pre><code>            ```python\n</code></pre> <p>class TestParent(hunitest.TestCase):         @pytest.fixture(autouse=True)         def setup_teardown_test(self):                 # Run before each test.                 self.set_up_test()                 yield</p> <pre><code>    def set_up_test(self) -&gt; None:\n            ...\n\n    def test1(self) -&gt; None:\n            ...\n</code></pre> <p>class TestChild(TestParent):         def test1(self) -&gt; None:                 ...                 <code>``     - A combination of the previous two options: TestParent has</code>setUp()<code>and</code>tearDown()<code>, and TestChild has one of them but not the other. Then, in         TestParent,</code>setUp()<code>/</code>tearDown()<code>should be replaced by</code>set_up_test()<code>/</code>tear_down_test()<code>as described above. In TestChild, the         method that was present,</code>setUp()<code>or</code>tearDown()<code>, should be replaced by</code>set_up_test2()<code>or</code>tear_down_test2()<code>, which should call</code>set_up_test()<code>or</code>tear_down_test()<code>from TestParent; the other method from TestParent,         which was absent in TestChild, should be added directly to TestChild's         fixture to run in its test methods. For example, for the case when TestChild         has</code>setUp()<code>but not</code>tearDown()`:</p> <pre><code>```python\n</code></pre> <p>class TestParent(hunitest.TestCase):         def setUp(self) -&gt; None:                 super().setUp()                 ...</p> <pre><code>    def tearDown(self) -&gt; None:\n            ...\n            super().tearDown()\n\n    def test1(self) -&gt; None:\n            ...\n</code></pre> <p>class TestChild(TestParent):         def setUp(self) -&gt; None:                 super().setUp()                 ...</p> <pre><code>    def test1(self) -&gt; None:\n            ...\n```\n\nshould be replaced by:\n\n```python\n</code></pre> <p>class TestParent(hunitest.TestCase):         @pytest.fixture(autouse=True)         def setup_teardown_test(self):                 # Run before each test.                 self.set_up_test()                 yield                 # Run after each test.                 self.tear_down_test()</p> <pre><code>    def set_up_test(self) -&gt; None:\n            ...\n\n    def tear_down_test(self) -&gt; None:\n            ...\n\n    def test1(self) -&gt; None:\n            ...\n</code></pre> <p>class TestChild(TestParent):         @pytest.fixture(autouse=True)         def setup_teardown_test(self):                 # Run before each test.                 self.set_up_test2()                 yield                 # Run after each test.                 self.tear_down_test()</p> <pre><code>    def set_up_test2(self) -&gt; None:\n            self.set_up_test()\n            ...\n\n    def test1(self) -&gt; None:\n            ...\n```\n- TestChild has `setUp()` and `tearDown()` (or just one of the two), while\n    TestParent does not. Then, in TestChild, `setUp()`/`tearDown()` should be\n    replaced by `set_up_test()`/`tear_down_test()` as described above;\n    TestParent undergoes no changes. For example:\n\n```python\n</code></pre> <p>class TestParent(hunitest.TestCase):         def test1(self) -&gt; None:                 ...</p> <p>class TestChild(TestParent):         def setUp(self) -&gt; None:                 super().setUp()                 ...</p> <pre><code>    def tearDown(self) -&gt; None:\n            ...\n            super().tearDown()\n\n    def test1(self) -&gt; None:\n            ...\n```\n\nshould be replaced by:\n\n```python\n</code></pre> <p>class TestParent(hunitest.TestCase):         def test1(self) -&gt; None:                 ...</p> <p>class TestChild(TestParent):         @pytest.fixture(autouse=True)         def setup_teardown_test(self):                 # Run before each test.                 self.set_up_test()                 yield                 # Run after each test.                 self.tear_down_test()</p> <pre><code>    def set_up_test(self) -&gt; None:\n            ...\n\n    def tear_down_test(self) -&gt; None:\n            ...\n\n    def test1(self) -&gt; None:\n            ...\n```\n</code></pre>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#use_setupclass_teardownclass","title":"Use setUpClass / tearDownClass","text":"<ul> <li> <p>If you need some expensive code parts to be done once for the whole test     class, such as opening a database connection, opening a temporary file on the     filesystem, loading a shared library for testing, etc., you can use     <code>setUpClass/tearDownClass</code> methods:</p> <ul> <li> <p><code>setUpClass()</code></p> <p>A class method called before tests in an individual class are run. <code>setUpClass</code> is called with the class as the only argument and must be decorated as a classmethod:</p> <p><code>python @classmethod def setUpClass(cls): ...</code>     - <code>tearDownClass()</code></p> <p>A class method called after tests in an individual class have run. <code>tearDownClass</code> is called with the class as the only argument and must be decorated as a classmethod:</p> <p><code>python @classmethod def tearDownClass(cls): ...</code></p> </li> </ul> </li> <li> <p>For more information, see     official unittest docs</p> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#update_test_tags","title":"Update test tags","text":"<ul> <li>In the root of each repo there is a <code>pytest.ini</code> file with the list of tests'     tags</li> <li>In order to update the tags:<ul> <li>In the <code>markers</code> section, add a name of a new tag</li> <li>After a <code>:</code> add a short description</li> <li>Keep tags in the alphabetical order</li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#mocking","title":"Mocking","text":""},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#refs","title":"Refs","text":"<ul> <li>Introductory article is     https://realpython.com/python-mock-library/ </li> <li>Official Python documentation for the mock package can be seen here     unit test mock</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#our_philosophy_about_mocking","title":"Our Philosophy about mocking","text":""},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#mock_only_external_dependencies","title":"Mock only external dependencies","text":"<ul> <li> <p>Typically we want to mock interactions with only external components, e.g.,</p> <ul> <li>3rd party provider<ul> <li>CCXT</li> </ul> </li> <li>Cloud infra (e.g., AWS)<ul> <li>S3 (e.g., see <code>/helpers/hmoto.py)</code>)</li> <li>AWS Secrets ...</li> </ul> </li> <li>DataBase</li> <li>GitHub</li> <li>...</li> </ul> </li> <li> <p>E.g., assume there is a class that is interfacing with an external data     provider and our code places requests and gets values back</p> </li> <li> <p>We want to replace the provider with an object that responds to the requests     with the actual response of the provider</p> </li> <li> <p>If we want to interactions with GitHub we should mock the GitHub library and     not our API on top of it (since we want to test it)</p> <p>Good:</p> <p><code>python @umock.patch(\"github.Github\") def test_github_labels(self, mock_github):    # Mock only the external provider.    mock_repo = umock.Mock()    mock_github.return_value.get_repo.return_value = mock_repo    ...</code></p> <p>Bad:</p> <p>```python @umock.patch(\"helpers.get_labels\") def test_github_labels(self, mock_helper):</p> </li> <li> <p>We want our mock object to look just real enough for the code to run</p> <ul> <li> <p>Include only the attributes or return values your function actually uses</p> <p>Bad:</p> <p>```python mock_label = umock.Mock() mock_label.name = \"bug\"</p> </li> </ul> </li> </ul> <p>def test_process_labels(mock_repo):     labels = mock_repo.get_labels()     self.assert_equal(labels[0].name, \"bug\")         ```</p> <pre><code>    **Good**:\n\n    ```python\n</code></pre> <p>mock_label = umock.Mock()</p>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#do_not_mock_internal_helper","title":"Do not mock internal helper.","text":"<p>... ```</p>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#dont_add_unused_fields","title":"Don't add unused fields.","text":"<p>mock_label.color = \"f29513\" mock_label.description = \"Something is not working\" mock_label.created_at = \"2024\u00c3\u00a2\u00c2\u0080\u00c2\u009101\u00c3\u00a2\u00c2\u0080\u00c2\u009101\" mock_label.updated_at = \"2024\u00c3\u00a2\u00c2\u0080\u00c2\u009101\u00c3\u00a2\u00c2\u0080\u00c2\u009102\" ....</p>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#add_only_the_fields_the_function_uses","title":"Add only the fields the function uses.","text":"<p>mock_label.name = \"bug\" mock_repo = umock.Mock() mock_repo.get_labels.return_value = [mock_label] ...</p> <p>def test_process_labels(mock_repo):     labels = mock_repo.get_labels()     self.assert_equal(labels[0].name, \"bug\")         ```</p> <ul> <li>Do not test external providers themselves. E.g., when using OpenAI, we don't     need to verify that OpenAI's API behaves according to spec\u2014only that our code     handles the expected inputs/outputs.</li> <li>This avoids redundant tests and focuses coverage on our code, not third-party     behavior.</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#do_not_mock_internal_dependencies","title":"Do not mock internal dependencies","text":"<ul> <li>In general we don't want to mock any code that is inside our repo, since<ul> <li>We want to actually test the interaction of different pieces of our code</li> <li>It creates maintenance problems</li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#testing_end-to-end","title":"Testing end-to-end","text":"<ul> <li> <p>Often we want to test public methods of our class (and a few private methods)</p> <ul> <li>In other words, we want to test the end-to-end behavior and not how things     are achieved</li> <li>Rationale: if we start testing \"how\" things are done and not \"what\" is done,     we can't change how we do things (even if it doesn't affect the interface     and its behavior), without updating tons of methods</li> </ul> </li> <li> <p>We want to test the minimal amount of behavior that enforces what we care     about</p> <p>Bad:</p> <p><code>python @umock.patch(\"docker.build_container\") @umock.patch(\"helpers.get_labels\") @umock.patch(\"github.Github\") def test_github_labels(self, mock_get_labels, mock_build_container, mock_github):    # Don't mock too much, like internal Docker and helper functions.    mock_get_labels.return_value = [\"bug\"]    mock_build_container.return_value = \"image123\"    mock_repo = umock.Mock()    mock_github.return_value.get_repo.return_value = mock_repo</code></p> <p>Good:</p> <p><code>python @umock.patch(\"github.Github\") def test_GitHub_labels(self, mock_github):    # Mock only the behavior that needs to be tested.    mock_repo = umock.Mock()    mock_github.return_value.get_repo.return_value = mock_repo    ...</code></p> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#object_patch_with_return_value","title":"Object patch with return value","text":"<pre><code>import unittest.mock as umock\nimport datapull.ccxt.data.extract.extractor as ivcdexex\n\n@umock.patch.object(ivcdexex.hsecret, \"get_secret\")\ndef test_function_call1(self, mock_get_secret: umock.MagicMock):\n        mock_get_secret.return_value = \"dummy\"\n</code></pre> <ul> <li>Function <code>get_secret</code> in <code>helpers/hsecret.py</code> is mocked<ul> <li>Pay attention on where is <code>get_secret</code> mocked:<ul> <li>It is mocked in <code>datapull.ccxt.data.extract.extractor</code> as \"get_secret\" is     called there in function that is being tested</li> </ul> </li> <li><code>@umock.patch.object(hsecret, \"get_secret\")</code> will not work as mocks are     applied after all modules are loaded, hence the reason for using exact     location<ul> <li>If we import s module in test itself it will work as mock is applied</li> <li>For modules outside of test function it is too late as they are loaded     before mocks for test are applied</li> </ul> </li> </ul> </li> <li>On every call, it returns string \"dummy\"</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#path_patch_with_multiple_return_values","title":"Path patch with multiple return values","text":"<pre><code>import unittest.mock as umock\n\n@umock.patch(\"helpers.hsecret.get_secret\")\ndef test_function_call1(self, mock_get_secret: umock.MagicMock):\n\nmock_get_secret.side_effect = [\"dummy\", Exception]\n</code></pre> <ul> <li>On first call, string <code>dummy</code> is returned</li> <li>On second, <code>Exception</code> is raised</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#ways_of_calling_patch_and_patchobject","title":"Ways of calling <code>patch</code> and <code>patch.object</code>","text":"<ul> <li>Via decorator     <code>python @umock.patch(\"helpers.hsecret.get_secret\") def test_function_call1(self, mock_get_secret: umock.MagicMock):         pass</code></li> <li>In actual function     <code>python get_secret_patch = umock.patch(\"helpers.hsecret.get_secret\") get_secret_mock = get_secret_patch.start()</code><ul> <li>This is the only approach in which you need to start/stop patch!<ul> <li>The actual mock is returned as the return value of <code>start()</code> method!</li> </ul> </li> <li>In other two approaches, start/stop is handled under the hood and we are     always interacting with <code>MagicMock</code> object</li> </ul> </li> <li>Via <code>with</code> statement (also in function)     <code>python with umock.patch(\"\"helpers.hsecret.get_secret\"\") as get_secret_mock:         pass</code><ul> <li>One of the use cases for this is if we are calling a different function     inside a function that is being mocked<ul> <li>Mostly because it is easy for an eye if there are to much patches via     decorator and we do not need to worry about reverting the patch changes as     that is automatically done at the end of with statement</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#mock_object_state_after_test_run","title":"Mock object state after test run","text":"<pre><code>@umock.patch.object(exchange_class._exchange, \"fetch_ohlcv\")\ndef test_function_call1(self, fetch_ohlcv_mock: umock.MagicMock):\n        self.assertEqual(fetch_ohlcv_mock.call_count, 1)\n        actual_args = tuple(fetch_ohlcv_mock.call_args)\n        expected_args = (\n                        (\"BTC/USDT\",),\n                        {\"limit\": 2, \"since\": 1, \"timeframe\": \"1m\"},\n        )\n        self.assertEqual(actual_args, expected_args)\n</code></pre> <ul> <li>After <code>fetch_ohlcv</code> is patched, <code>Mock</code> object is passed to test<ul> <li>In this case, it is <code>fetch_ohlcv_mock</code></li> </ul> </li> <li> <p>From sample we can see that function is called once</p> <ul> <li>First value in a tuple are positional args passed to <code>fetch_ohlcv</code> function</li> <li>Second value in a tuple are keyword args passed to <code>fetch_ohlcv</code> function</li> <li> <p>As an alternative, <code>fetch_ohlcv_mock.call_args.args</code> and     <code>fetch_ohlcv_mock.call_args.kwargs</code> can be called for separate results of     args/kwargs</p> <p><code>python self.assertEqual(fetch_ohlcv_mock.call_count, 3) actual_args = str(fetch_ohlcv_mock.call_args_list) expected_args = r\"\"\" [call('BTC/USDT', since=1645660800000, bar_per_iteration=500), call('BTC/USDT', since=1645690800000, bar_per_iteration=500), call('BTC/USDT', since=1645720800000, bar_per_iteration=500)] \"\"\" self.assert_equal(actual_args, expected_args, fuzzy_match=True)</code></p> </li> </ul> </li> <li> <p>In sample above, that is continuation of previous sample,     <code>fetch_ohlcv_mock.call_args_list</code> is called that returns all calls to mocked     function regardless of how many times it is called</p> </li> <li>Useful for verifying that args passed are changing as expected</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#mock_common_external_calls_in_hunitesttestcase_class","title":"Mock common external calls in <code>hunitest.TestCase</code> class","text":"<pre><code>class TestCcxtExtractor1(hunitest.TestCase):\n        # Mock calls to external providers.\n        get_secret_patch = umock.patch.object(ivcdexex.hsecret, \"get_secret\")\n        ccxt_patch = umock.patch.object(ivcdexex, \"ccxt\", spec=ivcdexex.ccxt)\n\n        def set_up_test(self) -&gt; None:\n                self.get_secret_mock: umock.MagicMock = self.get_secret_patch.start()\n                self.ccxt_mock: umock.MagicMock = self.ccxt_patch.start()\n                # Set dummy credentials for all tests.\n                self.get_secret_mock.return_value = {\"apiKey\": \"test\", \"secret\": \"test\"}\n\n        def tear_down_test(self) -&gt; None:\n                self.get_secret_patch.stop()\n                self.ccxt_patch.stop()\n</code></pre> <ul> <li>For every unit test we want to isolate external calls and replace them with     mocks<ul> <li>This way tests are much faster and not influenced by external factors we can     not control</li> <li>Mocking them in <code>set_up_test()</code> (which is run at the beginning of the test     methods) will make the tests using this class simpler and ready out of the     box</li> </ul> </li> <li>In current sample we are mocking AWS secrets and <code>ccxt</code> library<ul> <li><code>umock.patch.object</code> is creating <code>patch</code> object that is not yet activated<ul> <li><code>patch.start()/stop()</code> is activating/deactivating patch for each test     where <code>set_up_test()</code> and <code>tear_down_test()</code> are run</li> <li><code>patch.start()</code> is returning a standard <code>MagicMock</code> object we can use to     check various states as mentioned in previous examples and control return     values<ul> <li><code>call_args</code>, <code>call_count</code>, <code>return_value</code>, <code>side_effect</code>, etc.</li> </ul> </li> </ul> </li> </ul> </li> <li>Note: Although patch initialization in static variables belongs to     <code>set_up_test()</code>, when this code is moved there patch is created for each test     separately. We want to avoid that and only start/stop same patch for each     test.</li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#mocks_with_specs","title":"Mocks with specs","text":"<pre><code>## Regular mock and external library `ccxt` is replaced with `MagicMock`\n@umock.patch.object(ivcdexex, \"ccxt\")\n## Only `ccxt` is spec'd, not actual components that are \"deeper\" in the `ccxt` library.\n@umock.patch.object(ivcdexex, \"ccxt\", spec=ivcdexex.ccxt)\n## Everything is spec'd recursively , including returning values/instances of `ccxt`\n## functions and returned values/instances of returned values/instances, etc.\n@umock.patch.object(ivcdexex, \"ccxt\", autospec=True)\n</code></pre> <ul> <li>First mock is not tied to any spec and we can call any attribute/function     against the mock and the call will be memorized for inspection and the return     value is new <code>MagicMock</code>.<ul> <li><code>ccxt_mock.test(123)</code> returns new <code>MagicMock</code> and raises no error</li> </ul> </li> <li>In second mock <code>ccxt.test(123)</code> would fail as such function does not exists<ul> <li>We can only call valid exchange such as <code>ccxt_mock.binance()</code> that will     return <code>MagicMock</code>, as exchange is not part of the spec</li> </ul> </li> <li>In third mock everything needs to be properly called<ul> <li><code>ccxt_mock.binance()</code> will return <code>MagicMock</code> with <code>ccxt.Exchange</code> spec_id     (in mock instance as meta)<ul> <li>As newly <code>exchange</code> instance is with spec, we can only call real     functions/attributes of <code>ccxt.Exchange</code> class</li> </ul> </li> </ul> </li> </ul>"},{"location":"tools/unit_test/all.write_unit_tests.how_to_guide.html#caveats","title":"Caveats","text":"<pre><code>## `datetime.now` cannot be patched directly, as it is a built-in method.\n## Error: \"can't set attributes of built-in/extension type 'datetime.datetime'\"\ndatetime_patch = umock.patch.object(imvcdeexut, \"datetime\", spec=imvcdeexut.datetime)\n</code></pre> <ul> <li> <p>Python built-in methods can not be patched</p> <p><code>python class TestExtractor1(hunitest.TestCase):     # Mock `Extractor`'s abstract functions.     abstract_methods_patch = umock.patch.object(             imvcdexex.MarketDataExtractor, \"__abstractmethods__\", new=set()     )     ohlcv_patch = umock.patch.object(             imvcdexex.MarketDataExtractor,             \"_download_ohlcv\",             spec=imvcdexex.MarketDataExtractor._download_ohlcv,     )</code></p> </li> <li> <p>Patching <code>__abstractmethods__</code> function of an abstract class enables us to     instantiate and test abstract class as any regular class</p> </li> </ul>"},{"location":"work_evaluation/all.asana_utiuls_guide.html","title":"All.asana utiuls guide","text":""},{"location":"work_evaluation/all.asana_utiuls_guide.html#asana_analytics_guide","title":"Asana Analytics Guide","text":"<p>We have a asana utils code at : <code>/helpers/asana_utils.py</code> which is a comprehensive Python module for analyzing team performance and productivity metrics in Asana.</p>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#overview","title":"Overview","text":"<p>The Asana Analytics module provides powerful tools to:</p> <ul> <li>Track individual and team task completion rates</li> <li>Analyze productivity across different time periods</li> <li>Generate comprehensive team performance reports</li> <li>Visualize metrics with publication-ready charts</li> <li>Calculate project completion percentages</li> </ul>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#extract_asana_access_token","title":"Extract Asana Access Token","text":""},{"location":"work_evaluation/all.asana_utiuls_guide.html#method_1_personal_access_token_recommended_for_personal_use","title":"Method 1: Personal Access Token (Recommended for Personal Use)","text":"<ul> <li>Log into Asana at app.asana.com</li> <li>Click your profile photo in the top right corner</li> <li>Select \"My Settings\"</li> <li>Navigate to the \"Apps\" tab</li> <li>Scroll down to \"Developer apps\"</li> <li>Click \"Manage Developer Apps\"</li> <li>Click \"+ Create new token\"</li> <li>Give your token a descriptive name (e.g., \"Analytics Script\")</li> <li>Click \"Create token\"</li> <li>Copy the token immediately - you won't be able to see it again!</li> <li>Store it securely (see setup instructions below)</li> </ul>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#method_2_oauth_application_for_productionmulti-user_apps","title":"Method 2: Oauth Application (For Production/Multi-User Apps)","text":"<p>If you're building an application that multiple users will access:</p> <ul> <li>Go to the Asana Developer Console</li> <li>Create a new OAuth application</li> <li>Follow the OAuth 2.0 flow to get access tokens</li> </ul>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#security_best_practices","title":"Security Best Practices","text":"<ul> <li>Never commit your token to version control!</li> </ul>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#installation_setup","title":"Installation &amp; Setup","text":""},{"location":"work_evaluation/all.asana_utiuls_guide.html#required_dependencies","title":"Required Dependencies","text":"<p><pre><code>pip install asana python-dateutil matplotlib numpy\n</code></pre> - We need to install the dependencies on the fly, for example in a notebook:</p> <pre><code>!sudo /bin/bash -c \"(source /venv/bin/activate; pip install -- asana python-dateutil)\"\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#import_the_module","title":"Import the Module","text":"<pre><code>import helpers.asana_utils as hasautil\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#quick_start","title":"Quick Start","text":""},{"location":"work_evaluation/all.asana_utiuls_guide.html#basic_usage_-_individual_user_stats","title":"Basic Usage - Individual User Stats","text":"<pre><code># Option 1: Pass Token Directly.\nanalytics = hasautil.AsanaAnalytics(access_token='your_token')\n\n# Option 2: Use Environment Variable (Recommended).\nanalytics = hasautil.AsanaAnalytics()  # Reads ASANA_ACCESS_TOKEN.\n\n# Get Workspace.\nworkspace_gid = analytics.get_workspace_gid()\n\n# Calculate Stats for a User (Last 3 Months).\nstats = analytics.calculate_user_stats(\n        workspace_gid,\n        'John Doe',  # Can use username or GID.\n        months_back=3\n)\n\nprint(f\"Tasks created: {stats['tasks_created']}\")\nprint(f\"Completion rate: {stats['completion_rate']:.1f}%\")\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#generate_a_team_report","title":"Generate a Team Report","text":"<pre><code># Full Team Report Across Multiple Time Periods.\nreport = analytics.generate_team_report(\n        workspace_gid,\n        time_periods=[1, 3, 12]  # Last month, quarter, year.\n)\n\n# Or Use Convenience Function.\nreport = hasautil.get_team_report(\n        'My Workspace',\n        time_periods=[1, 3, 12]\n)\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#function_reference","title":"Function Reference","text":"<ul> <li>Core Class: <code>AsanaAnalytics</code></li> </ul> Function Purpose Key Parameters Returns <code>__init__()</code> Initialize the analytics client <code>access_token</code> (optional) AsanaAnalytics instance <code>get_workspace_gid()</code> Get workspace ID <code>workspace_name</code> (optional) Workspace GID string <code>get_team_members()</code> List all workspace members <code>workspace_gid</code> List of user dicts with gid, name, email <code>get_user_by_name()</code> Find user by name <code>workspace_gid</code>, <code>username</code> User dict or None <code>get_user_tasks()</code> Get tasks for a user <code>workspace_gid</code>, <code>user_identifier</code>, <code>start_date</code>, <code>end_date</code> List of task dicts <code>calculate_user_stats()</code> Calculate user metrics <code>workspace_gid</code>, <code>user_identifier</code>, <code>months_back</code> or <code>start_date</code>/<code>end_date</code> Stats dictionary <code>generate_team_report()</code> Full team analysis <code>workspace_gid</code>, <code>time_periods</code> or <code>start_date</code>/<code>end_date</code>, <code>usernames</code> (optional) Team report dict <code>get_project_completion_percentage()</code> Project progress <code>project_gid</code>, <code>user_identifier</code> (optional) Completion stats dict"},{"location":"work_evaluation/all.asana_utiuls_guide.html#convenience_functions","title":"Convenience Functions","text":"Function Purpose Use Case <code>get_user_stats()</code> Quick user stats One-line user analysis without instantiating class <code>get_team_report()</code> Quick team report One-line team analysis with workspace name <code>list_workspace_users()</code> List all usernames Discover available users in workspace"},{"location":"work_evaluation/all.asana_utiuls_guide.html#visualization_functions","title":"Visualization Functions","text":"Function Creates Best For <code>plot_completion_rates()</code> Horizontal bar chart Comparing completion rates across team <code>plot_task_metrics()</code> Grouped bar chart Comparing created vs completed vs in-progress <code>plot_activity_metrics()</code> Bar chart Analyzing comments and activity levels <code>create_summary_dashboard()</code> 4-panel dashboard Executive overview with all metrics"},{"location":"work_evaluation/all.asana_utiuls_guide.html#usage_examples","title":"Usage Examples","text":""},{"location":"work_evaluation/all.asana_utiuls_guide.html#example_1_analyze_specific_team_members","title":"Example 1: Analyze Specific Team Members","text":"<pre><code># Analyze Only Specific Team Members.\nreport = hasautil.get_team_report(\n        'Engineering',\n        usernames=['GP', 'Krishna', 'Heanh'],\n        time_periods=[1, 3]\n)\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#example_2_custom_date_range_analysis","title":"Example 2: Custom Date Range Analysis","text":"<pre><code># Analyze Q1 2025.\nstart = datetime(2025, 1, 1, tzinfo=timezone.utc)\nend = datetime(2025, 3, 31, tzinfo=timezone.utc)\n\nstats = analytics.calculate_user_stats(\n        workspace_gid,\n        'Shaunak Dhande',\n        start_date=start,\n        end_date=end\n)\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#example_3_team_report_with_date_range","title":"Example 3: Team Report with Date Range","text":"<pre><code># Full Team Report for Specific Date Range.\nreport = analytics.generate_team_report(\n        workspace_gid,\n        start_date=start,\n        end_date=end\n)\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#example_4_project_completion_analysis","title":"Example 4: Project Completion Analysis","text":"<pre><code># Check Project Completion Percentage.\nproject_stats = analytics.get_project_completion_percentage(\n        project_gid='1234567890',\n        user_identifier='John Doe'  # Optional: filter to specific user.\n)\n\nprint(f\"Project: {project_stats['project_name']}\")\nprint(f\"Completion: {project_stats['completion_percentage']:.1f}%\")\nprint(f\"Progress: {project_stats['completed_tasks']}/{project_stats['total_tasks']} tasks\")\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#example_5_list_available_users","title":"Example 5: List Available Users","text":"<pre><code># See All Users in Workspace.\nusernames = hasautil.list_workspace_users('Marketing')\nprint(f\"Available users: {', '.join(usernames)}\")\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#visualization_examples","title":"Visualization Examples","text":""},{"location":"work_evaluation/all.asana_utiuls_guide.html#create_completion_rate_chart","title":"Create Completion Rate Chart","text":"<pre><code># Generate Team Report First.\nreport = hasautil.get_team_report('Engineering', time_periods=[1, 3, 12])\n\n# Create and Save Completion Rate Chart.\nhasautil.plot_completion_rates(\n        report,\n        period_key='3_month',  # Focus on quarterly data.\n        save_path='completion_rates.png'\n)\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#create_task_metrics_comparison","title":"Create Task Metrics Comparison","text":"<pre><code># Compare Tasks Created, Completed, and In-Progress.\nhasautil.plot_task_metrics(\n        report,\n        period_key='1_month',\n        figsize=(16, 8),\n        save_path='task_metrics.png'\n)\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#create_activity_metrics_chart","title":"Create Activity Metrics Chart","text":"<pre><code># Show Comments and Activity Levels.\nhasautil.plot_activity_metrics(\n        report,\n        period_key='1_month',\n        save_path='activity_metrics.png'\n)\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#create_complete_dashboard","title":"Create Complete Dashboard","text":"<pre><code># Generate Comprehensive 4-Panel Dashboard.\nhasautil.create_summary_dashboard(\n        report,\n        period_key='3_month',\n        figsize=(18, 12),\n        save_path='team_dashboard.png'\n)\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#understanding_the_stats_output","title":"Understanding the Stats Output","text":""},{"location":"work_evaluation/all.asana_utiuls_guide.html#user_stats_dictionary_structure","title":"User Stats Dictionary Structure","text":"<pre><code>{\n        'user_gid': '1234567890',\n        'username': 'John Doe',\n        'period_label': '3_months',\n        'start_date': '2024-07-10T00:00:00+00:00',\n        'end_date': '2024-10-10T00:00:00+00:00',\n        'tasks_created': 45,\n        'tasks_completed': 38,\n        'tasks_in_progress': 7,\n        'completion_rate': 84.4,  # Percentage.\n        'projects': ['Project A', 'Project B', 'Project C'],\n        'total_comments': 156,\n        'total_activity': 203,\n        'tasks_by_project': {\n                'Project A': 20,\n                'Project B': 15,\n                'Project C': 10\n        },\n        'completed_by_project': {\n                'Project A': 18,\n                'Project B': 12,\n                'Project C': 8\n        }\n}\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#team_report_structure","title":"Team Report Structure","text":"<pre><code>{\n        'generated_at': '2024-10-10T15:30:00',\n        'workspace_gid': '0987654321',\n        'time_periods': [1, 3, 12],  # or 'date_range' if using explicit dates.\n        'team_members': [\n                {\n                        'user': {\n                                'gid': '1234567890',\n                                'name': 'John Doe',\n                                'email': 'john@example.com'\n                        },\n                        'stats_by_period': {\n                                '1_month': { ... },\n                                '3_month': { ... },\n                                '12_month': { ... }\n                        }\n                },\n                # ... more team members\n        ]\n}\n</code></pre>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#tips_best_practices","title":"Tips &amp; Best Practices","text":""},{"location":"work_evaluation/all.asana_utiuls_guide.html#performance_optimization","title":"Performance Optimization","text":"<ul> <li><code>Rate Limiting</code>: The <code>Asana API</code> has rate limits. For large teams, the script includes automatic handling and logging of rate limit issues</li> <li><code>Caching</code>: For repeated analyses, store workspace and user GIDs to avoid redundant API calls</li> <li><code>Batch Processing</code>: When analyzing multiple users, use <code>generate_team_report()</code> instead of calling <code>calculate_user_stats()</code> repeatedly</li> </ul>"},{"location":"work_evaluation/all.asana_utiuls_guide.html#common_use_cases","title":"Common Use Cases","text":"Scenario Best Function Parameters Monthly performance review <code>generate_team_report()</code> <code>time_periods=[1]</code> Quarterly planning <code>generate_team_report()</code> <code>time_periods=[3]</code> Sprint retrospective <code>calculate_user_stats()</code> Custom <code>start_date</code>/<code>end_date</code> Project health check <code>get_project_completion_percentage()</code> <code>project_gid</code> Individual 1-on-1s <code>calculate_user_stats()</code> <code>user_identifier</code>, <code>months_back=1</code>"},{"location":"work_organization/all.buildmeister.how_to_guide.html","title":"All.buildmeister.how to guide","text":""},{"location":"work_organization/all.buildmeister.how_to_guide.html#buildmeister","title":"Buildmeister","text":""},{"location":"work_organization/all.buildmeister.how_to_guide.html#buildmeister_process","title":"Buildmeister Process","text":""},{"location":"work_organization/all.buildmeister.how_to_guide.html#general","title":"General","text":"<ul> <li>The Buildmeister rotates according to the schedule<ul> <li>To see who is the Buildmeister now refer to     Buildmeister gsheet</li> <li>Each rotation should be confirmed following the     Handover Process which includes a status report from     the outgoing Buildmeister and acknowledgment from the new one</li> </ul> </li> <li>The Buildmeister is responsible for:<ul> <li>Check build status using the     buildmeister dashboard everyday</li> <li>Pushing team members to fix broken tests</li> <li>Conducting post-mortem analysis<ul> <li>Why did the break happen?</li> <li>How can we avoid the problem next time, through process and automation?</li> </ul> </li> </ul> </li> <li>Refer to <code>.github</code> dir in the repo for update schedule of GH actions</li> <li>Additional information about tests:<ul> <li>write tests</li> <li>run tests</li> </ul> </li> </ul>"},{"location":"work_organization/all.buildmeister.how_to_guide.html#notification_system","title":"Notification System","text":"<ul> <li><code>Kaizen GitHub actions app</code> notifies the team about breaks via Slack channel     #build-notifications</li> <li>A notification contains:<ul> <li>Failing tests type: fast/slow/super-slow</li> <li>Repo</li> <li>Branch</li> <li>Event</li> <li>Link to a failing run</li> </ul> </li> </ul> <p>Example:</p> <ul> <li></li> </ul>"},{"location":"work_organization/all.buildmeister.how_to_guide.html#buildmeister_instructions","title":"Buildmeister Instructions","text":"<ul> <li>You receive a break notification from <code>Kaizen GitHub actions app</code></li> <li>Have a look at the message<ul> <li>Do it right away, this is always your highest priority task</li> </ul> </li> <li> <p>Notify the team</p> <ul> <li>If the break happened in <code>lemonade</code> repo, ping GP or Paul, since they are     the only ones with write access</li> </ul> </li> <li> <p>Post on the     #build-notifications Slack     channel what tests broke, e.g.,     <code>FAILED knowledge_graph/vendors/test/test_utils.py::TestClean::test_clean</code></p> <ul> <li>If unsure about the cause of failure (there is a chance that a failure is     temporary):<ul> <li>Do a quick run locally for the failed test</li> <li>If the test is specific and can not be run locally, rerun the regressions</li> </ul> </li> <li>Ask if somebody knows what is the problem<ul> <li>If you know who is in charge of that test (you can use <code>git blame</code>) ask     directly</li> </ul> </li> <li>If the offender says that it's fixing the bug right away, let him/her do it</li> <li>Otherwise, file a bug to track the issue</li> </ul> </li> <li> <p>File an Issue on GH to report the failing tests and the errors</p> <ul> <li>Example:     https://github.com/cryptokaizen/cmamp/issues/4386</li> <li>Issue title template <code>Build fail - {repo} {test type} ({run number})</code><ul> <li>Example: <code>Build fail - Cmamp fast_tests (1442077107)</code></li> </ul> </li> <li>Paste the URL of the failing run<ul> <li>Example:     https://github.com/causify-ai/cmamp/actions/runs/12738914526</li> </ul> </li> <li>Provide as much information as possible to give an understanding of the     problem</li> <li>List all the tests with FAILED status in a GitHub run, e.g.,     <pre><code>FAILED knowledge_graph/vendors/test/test_p1_utils.py::TestClean::test_clean\nFAILED knowledge_graph/vendors/nbsc/test/test_nbsc_utils.py::TestExposeNBSCMetadata::test_expose_nbsc_metadata\n</code></pre></li> <li>Stack trace or part of it (if it's too large)     <pre><code>Traceback (most recent call last): File\n\"/.../automl/hypotheses/test/test*rh_generator.py\", line 104, in test1\nkg_metadata, * = p1ut.load_release(version=\"0.5.2\") File\n\"/.../knowledge_graph/vendors/utils.py\", line 53, in load_release % version,\nFile \"/.../amp/helpers/dbg.py\", line 335, in dassert_dir_exists \\_dfatal(txt,\nmsg, \\*args) File \"/.../amp/helpers/dbg.py\", line 97, in \\_dfatal\ndfatal(dfatal_txt) File \"/.../amp/helpers/dbg.py\", line 48, in dfatal raise\nassertion_type(ret) AssertionError:\n##############################################################################\nFailed assertion \\*\n    dir='/fsx/research/data/kg/releases/timeseries_db/v0.5.2' doesn't exist or\n    it's not a dir The requested version 0.5.2 has directory associated with it.\n</code></pre></li> <li>If the failures are not connected to each other, file separate issues for     each of the potential root cause</li> <li>Keep issues grouped according to the codebase organization</li> </ul> </li> <li> <p>Post the issue reference on Slack channel     #build-notifications</p> <ul> <li>You can quickly discuss there who will take care of the broken tests, assign     that person</li> <li>Otherwise, assign it to the person who can reroute</li> </ul> </li> <li> <p>Our policy is \"fix it or revert\"</p> <ul> <li>The build needs to go back to green within 1 hr<ul> <li>Either the person responsible for the break fixes the issue within 1 hour,     or you need to push the responsible person to disable the test</li> <li>Do not make the decision about disabling the test yourself!</li> <li>First, check with the responsible person, and if he / she is ok with     disabling, do it</li> <li>IMPORTANT: Disabling a test is not the first choice, it's a measure of     last resort!</li> </ul> </li> </ul> </li> <li> <p>Regularly check issues related to build breaks.</p> <ul> <li>You have to update the break issues if the problem was solved or partially     solved.</li> <li>Pay special attention to the failures which resulted in disabling tests.</li> </ul> </li> <li> <p>When your time of the Buildmeister duties is over, confirm the rotation with     the next responsible person in the related Slack channel.</p> </li> </ul>"},{"location":"work_organization/all.buildmeister.how_to_guide.html#update_helpers_submodule_fails","title":"<code>Update_Helpers_Submodule</code> Fails","text":"<ul> <li> <p>When this happens, the first thing to do is attempt to update the <code>helpers</code>     pointer manually</p> </li> <li> <p>Instructions:     <pre><code>&gt; cd src/cmamp1\n&gt; git checkout master\n&gt; git pull --recurse-submodules\n&gt; cd helpers_root\n&gt; git checkout master\n&gt; git pull origin master\n&gt; cd ..\n&gt; git add helpers_root\n&gt; git commit -m \"Update helpers pointer\"\n</code></pre></p> </li> </ul>"},{"location":"work_organization/all.buildmeister.how_to_guide.html#daily_reporting_and_handover_process","title":"Daily Reporting and Handover Process","text":"<ul> <li> <p>The current Buildmeister must send a daily status report to eng@ at the start     of each workday with the TODO email</p> <ul> <li>The email subject should follow the format:     <code>[BM Report] Build Status - YYYY-MM-DD</code></li> <li>The email should include:<ul> <li>Current status of all builds (green/red)</li> <li>For any red (failing) builds:<ul> <li>Which tests are failing</li> <li>Why they are failing (if known)</li> <li>Who is responsible for fixing them</li> <li>Expected timeline for fixes</li> </ul> </li> <li>Confirmation that all breaks are tracked with GitHub issues<ul> <li>Include links to all open issues related to build breaks</li> </ul> </li> <li>A screenshot of the current Buildmeister dashboard<ul> <li>This provides a visual overview of the build status</li> </ul> </li> <li>Any additional relevant information or concerns</li> </ul> </li> </ul> </li> <li> <p>The current Buildmeister must also save the status report in a Log file at     Buildmesietr Log Doc</p> </li> <li> <p>When a new Buildmeister takes over the role:</p> <ul> <li>The new Buildmeister must respond to the most recent status report email</li> <li>The response should:<ul> <li>Acknowledge receipt of the handover</li> <li>Confirm understanding of current build status</li> <li>Include \"Acknowledged\" in the subject line</li> <li>CC the previous Buildmeister and eng@</li> </ul> </li> </ul> </li> <li> <p>Example email format:</p> <pre><code>Subject: BuildMeister Status\n\nBuild Status Summary:\n- cmamp/master: RED (2 failing tests)\n- helpers/master: GREEN\n- lemonade/master: GREEN\n\nPoint each break to a git Issue:\n- https://github.com/cryptokaizen/cmamp/issues/4386\n\nDashboard screenshot attached.\n\nAdditional notes if needed:\n- The failing tests have been occurring since yesterday's deployment\n- We may need to update the data path configuration in our CI environment\n</code></pre> </li> </ul>"},{"location":"work_organization/all.buildmeister.how_to_guide.html#buildmeister_dashboard","title":"Buildmeister Dashboard","text":"<p>The Buildmeister dashboard is a tool that provides a quick overview of the current state of the results of all GitHub Actions workflows. See run and publish the buildmeister dashboard for detailed information.</p> <p></p>"},{"location":"work_organization/all.buildmeister.how_to_guide.html#logic_used_to_determine_workflow_status","title":"Logic Used to Determine Workflow Status","text":"<p>The dashboard uses the following logic to determine the latest and most relevant status of each GitHub Actions workflow:</p> <ul> <li> <p>Workflow Run Selection:</p> <ul> <li>For each workflow in each repo, the dashboard fetches the 10 most recent     workflow runs on the <code>master</code> branch</li> <li>For workflows such as <code>\"Gitleaks Scan\"</code>, the dashboard prioritizes the     latest scheduled run (<code>event == \"schedule\"</code>) as these are used for CI health     checks</li> <li>If no scheduled run is found (or the workflow does not have scheduled runs),     it falls back to the most recent completed run with a <code>conclusion</code> of     <code>\"success\"</code> or <code>\"failure\"</code></li> </ul> </li> <li> <p>Overall Repository Status:</p> <ul> <li>A repository is marked as <code>Failed</code> if any of its workflows have a     <code>conclusion</code> of <code>failure</code></li> <li>Otherwise, it is marked as <code>Success</code></li> <li>In Jupyter notebooks, these statuses are color-coded:<ul> <li><code>Green</code>: <code>Success</code></li> <li><code>Red</code>: <code>Failure</code></li> </ul> </li> </ul> </li> <li> <p>Workflow Data and Display:</p> <ul> <li>For each workflow, the dashboard shows:<ul> <li><code>repo_name</code>: repository name (e.g., <code>cryptokaizen/cmamp</code>)</li> <li><code>workflow_name</code>: name of the workflow (e.g., <code>\"Allure fast tests\"</code>)</li> <li><code>conclusion</code>: overall status (<code>\"success\"</code> or <code>\"failure\"</code>)</li> <li><code>url</code>: link to the specific workflow run</li> </ul> </li> <li>All URLs in the dashboard are rendered as clickable links</li> <li>A timestamp indicating when the dashboard was last generated is included for     reference</li> </ul> </li> <li> <p>Handling Missing or Sparse Runs:</p> <ul> <li>If fewer than 10 runs are available for a workflow, the dashboard logs a     warning and skips the workflow</li> <li>This ensures that workflows which haven't run recently do not affect the     overall dashboard accuracy</li> </ul> </li> </ul>"},{"location":"work_organization/all.buildmeister.how_to_guide.html#allure_reports_analysis","title":"Allure Reports Analysis","text":"<ul> <li> <p>For a background on Allure, refer to these docs</p> <ul> <li>Detailed info can be found in the official     docs</li> <li>Allure Explanantion</li> <li>Allure How to Guide</li> </ul> </li> <li> <p>For now, the Buildmeister can get the link to the Allure reports by navigating     GitHub Actions page     https://github.com/cryptokaizen/cmamp/actions</p> <ul> <li>Select a particular workflow (Allure fast tests, Allure slow tests, Allure     superslow tests) based on the test types</li> <li>Click on the particular run for which to get the report. Latest is on the     top</li> <li>Access the report URL by clicking <code>Report URL</code> in the run link. For e.g.:     https://github.com/cryptokaizen/cmamp/actions/runs/7210433549/job/19643566697</li> <li>The report URL looks like:     http://172.30.2.44/allure_reports/cmamp/fast/report.20231212_013147</li> </ul> </li> <li> <p>Once a week the Buildmeister manually inspects     graph section of the     report</p> <ul> <li>The overall goal is to:<ul> <li> <p>Monitor the amount of skipped, failed, and broken tests using the     <code>Trend Chart</code>. It shows how a certain value changed over time. Each     vertical line corresponds to a certain version of the test report, with     the last line on the right corresponding to the current version</p> <p>         - Monitor the <code>Duration Trend</code> to check the time taken to the run all tests comparing to historical trends</p> <p>         - Monitor the <code>Duration Distribution</code>, where all the tests are divided into groups based on how long it took to complete them, and manually compare with the last week results</p> <p>         - Monitor the <code>Retries Trend</code> to check the number of retries occurred in a particular run</p> <p>         - The idea is to make sure it doesn't have drastic change in the values</p> </li> </ul> </li> </ul> </li> <li> <p>Steps to perform if a test fails, timeouts or breaks</p> <ul> <li>When a particular test fails, timeouts or breaks, Buildmeister should look     in report for<ul> <li>How long it was the case, e.g., did it occur in the past? Include this     info when filing an issue</li> <li>The very first run when it happened and add that info to the issue. This     could be useful for debugging purposes</li> <li>These info can be extracted by navigating the <code>Packages</code> section of the     report for that test. Any particular test has <code>history</code> and <code>retries</code>     section which shows the history of success and number of retries occured     for that test</li> </ul> </li> <li>The goal here is to provide more context when filing an issue so that we can     make better decisions</li> </ul> </li> </ul>"},{"location":"work_organization/all.buildmeister.how_to_guide.html#post-mortem_analysis_tbd","title":"Post-Mortem Analysis (TBD)","text":"<ul> <li> <p>We want to understand on why builds are broken so that we can improve the     system to make it more robust</p> <ul> <li>In order to do that, we need to understand the failure modes of the system</li> <li>For this reason we keep a log of all the issues and what was the root cause</li> </ul> </li> <li> <p><code>Date</code> column:</p> <ul> <li>Enter the date when the break took place</li> <li>Keep the bug ordered in reverse chronological order (i.e., most recent dates     first)</li> </ul> </li> <li> <p><code>Repo</code> column:</p> <ul> <li>Specify the repo where break occurred<ul> <li><code>amp</code></li> <li>...</li> </ul> </li> </ul> </li> <li> <p><code>Test type</code> column:</p> <ul> <li>Specify the type of the failing tests<ul> <li>Fast</li> <li>Slow</li> <li>Super-slow</li> </ul> </li> </ul> </li> <li> <p><code>Link</code> column:</p> <ul> <li>Provide a link to a failing run</li> </ul> </li> <li> <p><code>Reason</code> column:</p> <ul> <li>Specify the reason of the break<ul> <li>Merged a branch with broken tests</li> <li>Master was not merged in a branch</li> <li>Merged broken slow tests without knowing that</li> <li>Underlying data changed</li> </ul> </li> </ul> </li> <li> <p><code>Issue</code> column:</p> <ul> <li>Provide the link to the GH issue with the break description</li> </ul> </li> <li> <p><code>Solution</code> column:</p> <ul> <li>Provide the solution description of the problem<ul> <li>Problem that led to the break was solved</li> <li>Failing tests were disabled, i.e. problem was not solved</li> </ul> </li> </ul> </li> </ul>"},{"location":"work_organization/all.contributor_feedback.how_to_guide.html","title":"All.contributor feedback.how to guide","text":""},{"location":"work_organization/all.contributor_feedback.how_to_guide.html#contributor_feedback","title":"Contributor Feedback","text":""},{"location":"work_organization/all.contributor_feedback.how_to_guide.html#feedback_principles","title":"Feedback principles","text":"<ul> <li> <p>We want to evaluate and provide feedback to our contributors on different     aspects of their work</p> </li> <li> <p>As a way to formalize giving feedback, we assign numerical scores on a variety     of metrics</p> </li> <li> <p>Each metric is scored between 1 (poor), 3 (average) and 5 (excellent)</p> <ul> <li>We consider 4 as acceptable, anything less than 4 as problematic and needs     to improve</li> </ul> </li> <li> <p>We don't take non-perfect scores personally but just as a way to understand     what to improve</p> </li> <li> <p>Scoring is anonymous</p> </li> <li> <p>Everyone should be scored by at least 2 people</p> </li> <li> <p>Frequency:</p> <ul> <li>Every 2 weeks for interns</li> <li>Every month for permanent team members</li> </ul> </li> </ul>"},{"location":"work_organization/all.contributor_feedback.how_to_guide.html#scoring_metrics","title":"Scoring metrics","text":""},{"location":"work_organization/all.contributor_feedback.how_to_guide.html#general","title":"General","text":"<ul> <li> <p>Metrics should be independent</p> </li> <li> <p>We should provide</p> <ul> <li>Concrete questions to assess how people do on each metric</li> <li>Ways to improve the score (e.g., \"read this book!\", \"do more of this and     less of that\")</li> </ul> </li> <li> <p>Along with the numerical scores, there should be a possibility to add a     textual note that can be used to provide rationale of the feedback and to     suggest improvements</p> </li> </ul>"},{"location":"work_organization/all.contributor_feedback.how_to_guide.html#metrics_for_interns","title":"Metrics for interns","text":"<ul> <li>Sends good TODO emails<ul> <li>Doesn't forget to send one</li> <li>Follows our     formatting requirements</li> <li>Sets realistic ETAs</li> </ul> </li> <li>Reads docs with attention<ul> <li>Internalizes our conventions described in the docs</li> </ul> </li> <li>Able to follow procedures<ul> <li>Issue and PR-related workflows</li> <li>Org processes</li> </ul> </li> <li>Independence<ul> <li>Provides solutions rather than questions</li> <li>Doesn't need a lot of guidance</li> <li>Asks only \"good\" questions (not something that they should be able to solve     on their own)</li> </ul> </li> <li>Attention to detail<ul> <li>Doesn't forget to do small things, including but not limited to:<ul> <li>Follow style conventions</li> <li>Apply fixes everywhere appropriate</li> <li>Keep the branch up to date</li> <li>Make sure there are no tmp files checked in</li> </ul> </li> <li>Thinks about corner cases while writing code and tests</li> </ul> </li> <li>Git / GitHub knowledge<ul> <li>Doesn't run into problems with branches/PRs</li> </ul> </li> <li>Python knowledge / coding ability<ul> <li>Writes effective and beautiful code</li> </ul> </li> <li>Commitment to the project<ul> <li>Puts in the hours<ul> <li>This is a minor point: the number of hours doesn't really matter as long     as stuff is done</li> <li>On the other hand, if somebody consistently doesn't put enough time to get     stuff done, it can become a problem</li> </ul> </li> <li>Willing to learn and contribute</li> <li>Willing to solve problems</li> </ul> </li> <li>Productivity<ul> <li>Quick to successfully complete tasks</li> </ul> </li> <li>Learns from reviews<ul> <li>Doesn't repeat the same mistake twice</li> </ul> </li> </ul>"},{"location":"work_organization/all.contributor_feedback.how_to_guide.html#metrics_for_permanent_team_members","title":"Metrics for permanent team members","text":"<ul> <li>Quality of code<ul> <li>Writes elegant code</li> <li>Follows our standards and conventions</li> </ul> </li> <li>Quality of design<ul> <li>Designs beautiful but simple abstractions</li> <li>Adds abstractions only when needed</li> <li>Orchestrates software components properly</li> <li>Uses design patterns when needed</li> </ul> </li> <li>Attention to details<ul> <li>Thinks in terms of corner cases</li> <li>Debugs things carefully</li> <li>Takes pride in a well-done product (e.g., code, documentation)</li> </ul> </li> <li>Productivity<ul> <li>Closes issues effectively without unnecessary iterations</li> </ul> </li> <li>Makes and achieves ETAs<ul> <li>Accurately estimates complexity of issues</li> <li>Thinks of risks and unknown unknowns, best / average / worst ETAs</li> <li>Resolves issues in set ETAs</li> <li>Puts in a sufficient amount of hours to make progress</li> </ul> </li> <li>Autonomy<ul> <li>Understands specs</li> <li>Needs an acceptable level of supervision to execute the tasks</li> <li>Does what's right according to our shared way of doing things without     reminders</li> </ul> </li> <li>Follows our PR process<ul> <li>Learns from reviews and doesn't make the same mistakes</li> <li>Runs Linter consistently before each iteration</li> <li>Does a PR / day (even a draft)</li> </ul> </li> <li>Follows our organizational process<ul> <li>Sends a daily TODO email</li> <li>Updates their issues regularly</li> <li>Curates GitHub</li> </ul> </li> <li>Team work<ul> <li>Helps others on the team when others need help / supervision</li> <li>Takes the initiative and goes the extra mile when needed</li> <li>Sacrifices for the greater good (e.g., doing stuff that is not fun to do)</li> </ul> </li> <li>Communication<ul> <li>Files issues with clear specs</li> <li>Explains technical issues and gives updates properly and with clarity</li> <li>Reports problems and solutions with proper context</li> <li>Speaks and writes English well</li> </ul> </li> <li>Ability to run a team<ul> <li>Can juggle multiple topics at once</li> <li>Can split the work in issues</li> <li>Can provide clear and extensive specs</li> <li>Is ok with being interrupted to help team members</li> </ul> </li> <li>Positive energy<ul> <li>Has an upbeat approach to working even if sh*t doesn't work (since things     never work)</li> <li>Isn't a     Negative Nelly</li> </ul> </li> <li>Dev %, Data scientist %, Devops %<ul> <li>This measures how much of each role the team member can cover</li> </ul> </li> </ul>"},{"location":"work_organization/all.contributor_feedback.how_to_guide.html#roles","title":"Roles","text":"<ul> <li> <p>We want to determine how comfortable the team member is engaging in different     types of activities</p> <ul> <li>This is helpful to understand which roles a new hire can play</li> </ul> </li> <li> <p>Current roles:</p> <ul> <li>Data science<ul> <li>Example of activities:<ul> <li>Write notebooks</li> <li>Do research</li> <li>Debug data</li> </ul> </li> </ul> </li> <li>Dev<ul> <li>Example of activities:<ul> <li>Write code</li> <li>Refactor code</li> <li>Architecture code</li> <li>Debug code</li> <li>Unit test code</li> </ul> </li> </ul> </li> <li>DevOps<ul> <li>Example of activities:<ul> <li>Manage / supervise infra</li> <li>Airflow</li> <li>Docker</li> <li>AWS</li> <li>Administer Linux</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>E.g., X is a data scientist and has Data science=5, Dev=3, DevOps=1</p> </li> <li>Roles are not mutually exclusive<ul> <li>A jack-of-all-trades can get a high score for all the roles</li> </ul> </li> </ul>"},{"location":"work_organization/all.contributor_feedback.how_to_guide.html#scoring_process","title":"Scoring process","text":"<ul> <li> <p>The process is organized and guided by</p> <ul> <li>HiringMeister for interns</li> <li>FeedbackMeister for permanent team members</li> </ul> </li> <li> <p>Scoring is done via a Google Form, which is distributed to the scorers in     Asana</p> </li> <li> <p>Scores for each metric are averaged in a spreadsheet, which is then made     available to people as feedback</p> <ul> <li>If there are textual notes accompanying numerical scores, their summary is     also provided</li> </ul> </li> <li> <p>Contributors receive an email which includes the feedback and a link to this     doc to help interpret the metrics</p> </li> </ul>"},{"location":"work_organization/all.datapull_DAGmeister.how_to_guide.html","title":"all.datapull DAGmeister.how to guide","text":""},{"location":"work_organization/all.datapull_DAGmeister.how_to_guide.html#datapull_dagmeister","title":"Datapull Dagmeister","text":""},{"location":"work_organization/all.datapull_DAGmeister.how_to_guide.html#datapull_dagmeister_process","title":"DataPull DagMeister process","text":""},{"location":"work_organization/all.datapull_DAGmeister.how_to_guide.html#general","title":"General","text":"<ul> <li>The DagMeister rotates every 2 weeks<ul> <li>To see who is the DagMeister now refer to     DataPull_DagMeister gsheet</li> <li>Each rotation should be confirmed by a 'handshake' between the outgoing     DagMeister and the new one in the related Slack channel     <code>#notifs-preprod-datapull</code></li> <li>Transfer the assignee of     #8785 to new DagMeister</li> </ul> </li> <li>The DagMeister is responsible for:<ul> <li>Check the Slack channel for any failures from preprod DAGs.</li> <li>Raising the issue on Github for that failure by debugging the root cause of     the failure.<ul> <li>If the issue is already raised, comment the link of the failure in the     issue citing same reason.</li> </ul> </li> <li>Tag team leader in the issue to confirm if the issue needs to be fixed with     highest priority or not.</li> <li>All the failures from region <code>tokyo</code> are of highest priority and needs to be     resolved ASAP.</li> </ul> </li> </ul>"},{"location":"work_organization/all.datapull_DAGmeister.how_to_guide.html#notification_system","title":"Notification system","text":"<ul> <li><code>@CK_Airflow_bot</code> notifies the team about breaks via Slack channel     <code>Kaizen Preprod Datapull Notifications</code></li> <li>A notification contains:<ul> <li>DAG start timestamp</li> <li>Link fo broken DAG</li> </ul> </li> </ul>"},{"location":"work_organization/all.datapull_DAGmeister.how_to_guide.html#dagmeister_instructions","title":"DagMeister instructions","text":"<ul> <li>You receive a break notification from <code>@CK_Airflow_bot</code></li> <li>Have a look at the message<ul> <li>Do it right away, this is always your highest priority task</li> </ul> </li> <li> <p>Notify the team</p> <ul> <li>If the break happened in <code>tokyo</code> region for <code>bid_ask</code> or <code>OHLCV</code> DAGs ping     the channel by tagging the team leader.</li> <li>Reply on the failure to notify you are already looking into this.</li> <li>After the issue is raised reply back with the issue number.<ul> <li>There could be multiple failure due to the same reason so just reply with     same issue number.</li> </ul> </li> </ul> </li> <li> <p>File an Issue in GH to report the failing tests and the errors</p> <ul> <li>Paste the URL of the failing run<ul> <li>Example: #9110</li> </ul> </li> <li>Provide as much information as possible to give an understanding of the     problem</li> <li>Stack trace or part of it (if it's too large)</li> <li>Paste the link of QA notebook if QA failed.</li> </ul> </li> <li> <p>Fixing the issue</p> <ul> <li>If the bug is obvious and can be fixed easily. Fix it with highest priority.</li> <li>If fixing will require debugging time, tag the team leader to ask for     priority.<ul> <li>IMPORTANT: Disabling a DAG is not the first choice, it's a measure of last     resort! and should oly be done after the approval from the team leader.</li> </ul> </li> </ul> </li> <li> <p>When your time of the DAGMeister duties is over, confirm the rotation with the     next responsible person in the related Slack chat.</p> </li> </ul>"},{"location":"work_organization/all.github_projects_process.reference.html","title":"All.github projects process.reference","text":""},{"location":"work_organization/all.github_projects_process.reference.html#github_projects_process","title":"GitHub Projects process","text":""},{"location":"work_organization/all.github_projects_process.reference.html#overview","title":"Overview","text":"<ul> <li> <p>We use GitHub projects to track progress on individual     components/products/services</p> </li> <li> <p>The entrypoint to preview available projects is     Causify-ai GitHub Projects     TODO(Juraj): this link will work only for people who are directly members of     the organization (not collaborators)</p> </li> </ul>"},{"location":"work_organization/all.github_projects_process.reference.html#gh_project_structure","title":"GH project structure","text":"<ul> <li> <p>A GH project represents a long-term project that is composed of GH Issues,     executed by multiple team members according to Sprints</p> </li> <li> <p>Each GH project window consists of tabs called \"views\"</p> </li> <li> <p>A view can provide a specific perspective on the issues in the project, e.g.,     filter certain issues by their attributes, visualize them in a board/list</p> </li> <li> <p>We use a base     template     for all of our projects to ensure consistency between projects</p> </li> <li> <p>The base template consists of the following views:</p> <ul> <li>All issues: provides a table view of all issues present in the project</li> <li>Current sprint: provides a table view of issues in the currently running     sprint</li> <li>Next sprint: provides a table view of issues in the next sprint</li> <li>Backlog: list of a non-finished issues in a given project without a sprint     assigned</li> <li>Team capacity: aggregates \"estimate point\" for each collaborator in the     project</li> </ul> </li> </ul>"},{"location":"work_organization/all.github_projects_process.reference.html#issue_fields","title":"Issue fields","text":"<ul> <li> <p>Each view within a project contains specific fields:</p> <ul> <li>Assignee<ul> <li>Names of people the issue is assigned to</li> </ul> </li> <li>Status<ul> <li>What phase of the development the issue is in</li> <li>We have 7 status options available that should be in sync within all     projects<ul> <li>Todo (This item hasn't been started)</li> <li>In Progress (This is actively being worked on)</li> <li>Paused (Work was paused)</li> <li>Done (This has been completed)</li> <li>In Review (This is awaiting review or validation)</li> <li>PR back to author (Author needs to apply review feedback)</li> <li>QA (Change being tested in QA)</li> </ul> </li> </ul> </li> <li>Label (Bug, P0, P1)<ul> <li>Label assigned to the specific issue</li> <li>Current labels synced to all repos are located at     <code>/dev_scripts_helpers/github/labels/gh_issues_labels.yml</code></li> </ul> </li> <li>Estimate in terms of \"uninterrupted hours of work\"<ul> <li>What is the issues' estimated implementation difficulty</li> <li>We want to become good at estimating complexity and overcome being     uncomfortable in providing ETAs</li> <li>Estimating complexity in terms of hours of work is done to the best of our     ability acknowledging that higher priority issues come up, we get     interrupted sometimes, debugging or implementing a feature might take more     time than expected</li> <li>We are ok with doing our best to estimate and we are ok failing to meet     our expectations, so that we can learn and improve</li> </ul> </li> <li>Sprint<ul> <li>Which weekly sprint this issue belongs to</li> </ul> </li> <li>Linked Pull Request<ul> <li>The pull requests linked to the specific issue</li> </ul> </li> </ul> </li> <li> <p>It's possible to add new fields; the list above includes some of the agreed     upon fields shared across all projects</p> </li> </ul>"},{"location":"work_organization/all.github_projects_process.reference.html#how_to_set_up_a_new_project","title":"How to set up a new project","text":"<ul> <li> <p>Click on <code>Projects</code> tab in the desired repository, e.g.     causify-ai/cmamp</p> </li> <li> <p>Click on the green <code>New Project</code> button</p> </li> <li> <p>A new window with a pop-up should appear, in the pop-up choose     <code>Project templates</code> &gt; <code>From your organization</code> and choose ** [TEMPLATE]     Causify Project**</p> </li> <li> <p>Change the default name <code>@yourusername untitled project</code> to a relevant name</p> <ul> <li>The name should be short and representative of what needs to be done</li> <li>Ideally we want to complete a Project in 2-3 months, since we don't want to     have long-running projects linger forever on the board. Each project should     have a clear goal</li> <li>Long-running projects should be broken in smaller projects to show and     measure progress</li> <li>If a project can't be easily described in a phrase starting with a verb, it     means that the scope is too big</li> <li>Good names are:<ul> <li>\"CustomerXYZ Proof-of-concept\", e.g., \"ITSavvy Proof-of-concept\"</li> <li>\"Split cmamp into separate repos\"</li> <li>\"FAR trading\"</li> <li>\"Implement v0.1 of XYZ\", \"Deploy XYZ\", ...</li> </ul> </li> <li>Bad names are:<ul> <li>\"Config\". A better name is \"Make config robust\" or \"Config - Q1-2024     Goals\"</li> </ul> </li> </ul> </li> <li> <p>Click on the <code>Project details</code> button in the upper right corner next to the     three dots <code>...</code></p> <ul> <li>Provide a short description of the project, e.g., who is the customer</li> <li>What is the overarching goal of the project</li> <li>Who is the team leader</li> <li>Provide links to the key resources (Slack/Asana channel)</li> </ul> </li> <li> <p>Add team members to the project</p> <ul> <li>Click on the three dots <code>...</code> (View more button) and go to     <code>Settings &gt; Manage access &gt; Invite collaborators</code></li> <li>Set write access if you want a team member to be able to add new issues to     the project and manage the state of the issues</li> </ul> </li> <li> <p>Open Slack and create a channel for the project</p> <ul> <li>The naming convention is <code>proj-&lt;&lt;project-name&gt;&gt;</code></li> <li>The Slack channel is used to communicate with the team working on that     project, using our conventions of what's so urgent to require an IM</li> <li>Click on <code>Add Canvas</code> and create a <code>Channel Overview</code> canvas<ul> <li>Provide a short description (can be the same as in GitHub project)</li> <li>Include links to the GitHub and Asana</li> </ul> </li> </ul> </li> <li> <p>Open Asana and create a new project</p> <ul> <li>The naming convention is <code>Proj - &lt;&lt;project name&gt;&gt;</code></li> <li>The Asana project is used to<ul> <li>Track non-technical issues (i.e., track work that doesn't easily map in     terms of coding)</li> <li>To track the project at higher level than GH</li> </ul> </li> <li>The Asana board is typically used by the project Team leader to communicate     status to the other departments and Team leaders</li> <li>E.g., on Asana we can do high level planning and track work that is not     ready yet to be filed as GH Issues, similar to what we do with Google Docs</li> </ul> </li> <li> <p>In general there is not a clear cut distinction between what goes in GH     Project, GH Issues, Asana tasks, Google Docs planning</p> <ul> <li>We agree that a GH Project includes many GH Issues</li> <li>We agree that things can go in GH Project or in Asana tasks or in a Google     Doc planning docs</li> <li>We let people a bit of flexibility to do things however they are more     comfortable</li> <li>E.g., GP likes Google Docs to sketch out a project and track issues, Asana     to track at high-level, and one Issue per \"feature\" when the Issue is ready     to be executed</li> </ul> </li> </ul>"},{"location":"work_organization/all.github_projects_process.reference.html#special_types_of_project","title":"Special types of project","text":"<ul> <li> <p>Not all project need to have an explicit start and finish date</p> </li> <li> <p>Each team (Infra/Devops, DataPull, ML ops etc.) should have their catch-all     project to track the issues</p> </li> </ul>"},{"location":"work_organization/all.github_projects_process.reference.html#sprint_process","title":"Sprint process","text":"<ol> <li> <p>Sprints run on Sunday to Saturday schedule         - This is due to the fact that Friday is the preferred day to complete             status updates         - GitHub issue <code>sprint</code> field adheres to this convention</p> </li> <li> <p>Project owner creates a GitHub status update (by clicking on the Status         button on the upper right in a given project) until 11 AM ET each Friday         - The 11 AM deadline was chosen to facilitate easier completion of Asana             status updates which have a 12 AM deadline             - In practice the GitHub project status updates will often serve as the                 source of information for the Asana update         - The status update should include the following sections:             - Summary (what was accomplished, what kind of obstacles did the team run                 into)             - Next steps (explain work for the next 1-2 sprints)             - Example update:</p> <pre><code>        ```text\n            Summary\n            - We have finished updating ETL pipeline for historical bid/ask data\n                for additional symbols (the work started two sprints ago)\n            - We have started to run daily scheduled live trading runs (low\n                volume, short runs) using one of our off-the-shelf models\n                - This is a major step forward for the team as it involved\n                    collaboration between all engineering departments\n                - The runs were completed successfully from start to finish for the\n                    last couple of days\n            - The orderbook related ETL and backtest pipelines encountered some\n                unexpected obstacles (code-base related). It took a bit more time\n                than expected to resolve them, but it didn't take us off track.\n\n            Next steps\n            - Increase the length of daily low-volume trading to exercise the\n                whole system from start to finish in a more rigorous manner and\n                catch some corner-case behavior (mainly with regards interaction\n                with exchange API)\n            - Run back-test(s) for orderbook-based model(s)\n            - Kick-off work on a new model\n        ```\n</code></pre> </li> <li> <p>The status update is sent to customers (either external or internal sending         to all@)</p> </li> <li> <p>Project owner (or a TL) can ask other collaborators in the project to also         add status updates if needed, before broadcasting, to make sure we manage         expectations.</p> </li> </ol>"},{"location":"work_organization/all.github_projects_process.reference.html#automation","title":"Automation","text":""},{"location":"work_organization/all.github_projects_process.reference.html#built-in_workflows","title":"Built-in workflows","text":"<ul> <li> <p>GitHub offers a handful of     built-in workflows     to automate frequently run actions within projects</p> <ul> <li>For example: when an issue is closed, set the status to done</li> </ul> </li> <li> <p>To open the workflows menu, click on the <code>...</code> button in the upper right     corner of the project view and select \"Workflows\"</p> </li> <li> <p>In our     base template     we currently use     these automated     workflows</p> </li> </ul>"},{"location":"work_organization/all.github_projects_process.reference.html#github_actions_automations","title":"Github Actions automations","text":"<ul> <li>For more customized automated workflows we use GitHub actions</li> <li>A GitHub Action     sprint_iteration.yml     is set up to move items in active projects from last sprint to current sprint     at the beginning of each sprint.</li> <li>We have     sync_gh_issue_labels.py     to synchronize GitHub issue labels from a label inventory manifest file</li> <li>We also have     sync_gh_projects.py     to compare a source GitHub Project (the template) with a destination project     and ensures all global fields and views from the template exist in the     destination</li> </ul>"},{"location":"work_organization/all.github_projects_process.reference.html#parent_and_sub-issues","title":"Parent and sub-issues","text":"<ul> <li>GitHub offers     sub-issues     to breakdown complex or higher-level task into smaller chunks of works</li> <li>Our current convention is not to use this feature</li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html","title":"All.inframeister.how to guide","text":""},{"location":"work_organization/all.inframeister.how_to_guide.html#inframeister_responsibilities","title":"InfraMeister Responsibilities","text":""},{"location":"work_organization/all.inframeister.how_to_guide.html#overview","title":"Overview","text":"<p>The InfraMeister role is critical for maintaining the operational health of our infrastructure. This role entails proactive monitoring, alert management, cost control, and specific oversight of infrastructure-related incidents.</p>"},{"location":"work_organization/all.inframeister.how_to_guide.html#1_monitoring_and_alert_management","title":"1. Monitoring and Alert Management","text":""},{"location":"work_organization/all.inframeister.how_to_guide.html#review_alerts","title":"Review Alerts","text":"<ul> <li>AlertManager Overview: Prometheus AlertManager, is a tool integrated with     Prometheus to handle alerts sent by client applications such as Prometheus     server. It takes care of deduplicating, grouping, and routing them to the     correct receiver integrations such as email or Slack. It also ensures alert     silencing and inhibition logic.<ul> <li>Regularly check alerts generated by AlertManager to identify critical issues     that require immediate attention.</li> <li>Evaluate alerts to determine their impact and urgency, prioritizing actions     based on severity.</li> </ul> </li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#general_approach_to_critical_alerts","title":"General Approach to Critical Alerts","text":""},{"location":"work_organization/all.inframeister.how_to_guide.html#immediate_response","title":"Immediate Response","text":"<ul> <li>Acknowledge the Alert: Immediately confirm receipt of the alert to     mitigate escalations and inform the team that the issue is being addressed.</li> <li>Assess the Situation: Swiftly evaluate the metrics or logs relevant to the     alert to understand its immediacy and potential impact. For instance, if an     alert indicates high CPU usage, immediately access the CPU usage logs and     metrics on the Grafana dashboard to understand the severity (e.g., whether the     CPU usage is consistently above 90%).</li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#diagnosis","title":"Diagnosis","text":"<ul> <li>Review Data Trends: Analyze historical data to identify growth trends and     potential points of failure. For instance, review historical data available in     Grafana, to identify trends such as disk usage, memory leaks, or load patterns     that can forecast potential points of failure.</li> <li>Check for Anomalies: Investigate any unusual spikes or patterns that could     signify underlying problems, such as a sudden increase in response time or     failure rates.</li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#mitigation","title":"Mitigation","text":"<ul> <li>Implement Quick Fixes: Apply temporary solutions if necessary to stabilize     the environment while long-term solutions are devised.</li> <li>Optimize System Performance: Make adjustments to reduce the strain on     resources, which could include purging unnecessary data or tweaking system     settings.</li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#documentation_and_reporting","title":"Documentation and Reporting","text":"<ul> <li>Report Actions and Outcomes: Log all actions taken and outcomes achieved     in resolving the alert.<ul> <li>GitHub: Use for detailed incident tracking and resolution. File a GitHub     issue or update an existing one with comprehensive details of the incident     management process, including what was done, what was discovered, and how     the issue was resolved or mitigated.</li> <li>Google Docs: Maintain a running document for each major incident for     real-time collaboration and information sharing during the incident     response.</li> <li>Slack For immediate communications and quick updates during an incident.</li> </ul> </li> <li>Communicate with Stakeholders: Update all pertinent parties, including     management and technical leads, about the incident's status and resolution.     Use our designated Slack channels for real-time updates and discussions during     active incident management. This allows for immediate feedback and quick     coordination among the involved teams.</li> <li>Conduct Reviews: Hold post-mortem meetings if necessary to discuss the     root cause and lessons learned. Provide updates during weekly sprint meetings     with tech leads. Use this time for a more detailed discussion of recent     incidents, resolved issues, and any lessons learned.</li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#aws_rds_database_alarms","title":"AWS RDS Database Alarms","text":"<ul> <li>Immediate Expansion: If the database is critically low on storage (e.g.     90% of capacity), temporarily increase storage capacity to prevent service     disruption. Note that due to the nature of AWS RDS, any increase in storage     capacity is permanent as AWS does not support reducing allocated storage once     it is expanded. Therefore, it is crucial to carefully evaluate the necessity     of increasing storage.</li> <li>Data Management: Evaluate data retention policies and execute data     clean-up or archiving strategies to free up space. For example, evaluate     Kubernetes CronJobs or Airflow archiving tasks that automatically compress and     move older logs and data out of primary storage every month, ensuring system     efficiency and compliance with data policies.</li> <li>System Adjustment: Review and adjust the database configuration to     optimize storage utilization and performance.</li> <li>Long-term Storage Scaling: Plan for scalable storage solutions based on     the anticipated data growth and usage patterns.</li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#airflow_alerts","title":"Airflow Alerts","text":"<ul> <li>Test Stage DAGs: Alerts prefixed with <code>test.</code> generally require no action     unless specified.</li> <li>Preprod Stage DAGs: Investigate alerts through the Airflow UI to pinpoint     the underlying issues, focusing on whether they arise from task failures,     development glitches, or infrastructure problems.<ul> <li>If related to task failures or development issues:<ul> <li>Contact the responsible individual (e.g., Sonaal for DataPull DAGs, Nina     for Trading DAGs).</li> <li>File a GitHub issue detailing the problem and assign it to the responsible     party. Use     Troubleshoot Airflow DagRun scheduling delay #8705     as an example template for how to document and file these issues.</li> </ul> </li> <li>If stemming from infrastructure issues (e.g., Pod failures):<ul> <li>Coordinate with Shayan for resolution and follow-up actions.</li> </ul> </li> </ul> </li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#refinement_of_alerts","title":"Refinement of Alerts","text":"<ul> <li>Continuously improve monitoring tools and alerting mechanisms to minimize     irrelevant alerts and enhance operational efficiency.</li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#2_infrastructure_incident_management","title":"2. Infrastructure Incident Management","text":""},{"location":"work_organization/all.inframeister.how_to_guide.html#incident_response_protocol","title":"Incident Response Protocol","text":""},{"location":"work_organization/all.inframeister.how_to_guide.html#initial_assessment","title":"Initial Assessment","text":"<ul> <li>Identify the Alert: Quickly determine the scope and potential impact of     the alert.</li> <li>Prioritize the Incident: Classify the incident according to its severity     and potential impact on operations.</li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#investigation_and_troubleshooting","title":"Investigation and Troubleshooting","text":"<ul> <li>Gather Data: Collect relevant logs, metrics, and configurations that     pertain to the affected systems.</li> <li>Analyze Symptoms: Correlate the collected data to identify patterns or     anomalies that could indicate the root cause.</li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#resolution","title":"Resolution","text":"<ul> <li>Implement Fix: Apply the necessary fixes or workarounds to resolve the     incident.</li> <li>Monitor Outcomes: Closely monitor the system following the fix to ensure     stability and that the issue does not recur.</li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#review_and_documentation","title":"Review and Documentation","text":"<ul> <li>Document the Incident: Update the issue with a detailed incident report     outlining the cause, response, and resolution.</li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#filing_infrastructure_issues","title":"Filing Infrastructure Issues","text":"<ul> <li>File and Track Issues: Systematically file and track all     infrastructure-related issues under the dedicated EPIC     Infrastructure Alert and Failure Resolution #9721.     Use issue #9606 as an     example template for documenting and filing new issues to ensure consistency     and thoroughness.</li> <li>Incident Report: Ensure comprehensive report of each incident, including     its impact assessment, investigative steps, and resolution measures.</li> <li>Communication and Collaboration: Work with relevant technical leads to     develop and implement solutions.</li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#3_grafana_dashboard","title":"3. Grafana Dashboard","text":""},{"location":"work_organization/all.inframeister.how_to_guide.html#dashboard_reviews","title":"Dashboard Reviews","text":"<ul> <li>Regularly analyze Grafana dashboards to assess system performance and health.</li> <li>Identify trends, potential bottlenecks, or anomalies.</li> <li> <p>Suggest improvements or adjustments to dashboards to better reflect     operational status and metrics.</p> </li> <li> <p>Link to Grafana Dashboards: Access the Grafana dashboards directly through     this link.</p> </li> <li> <p>Link to AWS Dashboards: Review AWS dashboards for basic resource     utilization metrics through     this link.</p> </li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#4_cost_management","title":"4. Cost Management","text":""},{"location":"work_organization/all.inframeister.how_to_guide.html#aws_cost_monitoring","title":"AWS Cost Monitoring","text":"<ul> <li>Check AWS billing and usage every Monday and Friday for any anomalies or     unexpected charges. An anomaly is defined as any charge that exceeds a ~15%     increase compared to the average of the previous three months' spending on the     same service.</li> <li>Proactively suggest cost optimization strategies and implement approved     measures to manage cloud expenditure.</li> <li>AWS Cost Anomaly Detection: Utilize AWS Cost Anomaly Detection to     automatically monitor and alert on unexpected increases in spending. This tool     helps in identifying and addressing anomalies in AWS costs without manual     monitoring.<ul> <li>Regularly review alerts generated by AWS Cost Anomaly Detection which are     being sent to the <code>infra@causify.ai</code> e-mail address by the     <code>Alert subscription</code>.     The alerts are sent once a week if in that week there was a cost anomaly     which exceeded 15% and $120 above expected spend. Analyze any detected     anomalies in the <code>Overview</code> section of the     <code>Cost Anomaly Detection</code>     to determine their cause\u2014whether they are due to expected changes in usage     or inefficiencies that need correction.</li> </ul> </li> </ul>"},{"location":"work_organization/all.inframeister.how_to_guide.html#issue_reporting","title":"Issue Reporting","text":"<ul> <li>File sub-issues under the EPIC     AWS Cost Optimizations #8940     and within the Infra Project on GitHub for any significant deviations that     warrant further investigation or evaluation.</li> </ul>"},{"location":"work_organization/all.issue_workflow.explanation.html","title":"All.issue workflow.explanation","text":"<p>TODO(Grisha): consider merging the current doc with <code>/docs/work_organization/all.use_github.how_to_guide.md</code> into something like \"ck.planning.how_to_guide.md\".</p>"},{"location":"work_organization/all.issue_workflow.explanation.html#issue_workflow","title":"Issue workflow","text":"<pre><code>Idea -&gt; Project -&gt; Task (Issue)\n</code></pre>"},{"location":"work_organization/all.issue_workflow.explanation.html#idea","title":"Idea","text":"<p>An idea is often the starting point for new initiatives and can be abstract and unstructured.</p> <p>Examples:</p> <ul> <li>\"What if we expand our current trading universe?\"</li> <li>\"It would be nice to get historical bid/ask data\"</li> </ul> <p>We use Google Docs (Gdocs) to keep track of ideas.</p> <p>Example flow:</p> <ul> <li>You have an idea and you do not have time to think it through/execute at the     moment</li> <li>However, you would like to keep track of what could be done in the future</li> <li>You put a note in a Gdoc for your future self</li> <li>Use suggestion mode so that other people can track that (once in a while we     accept all the changes)</li> </ul> <p>This is helpful because:</p> <ul> <li>We keep track of work that could be done</li> <li>Simplifies the planning<ul> <li>E.g., if someone is blocked, he/she can go to a Gdoc and choose a project</li> </ul> </li> <li>People are notified of that change and see the text in suggestion mode</li> <li>It is quick to edit a Gdoc and has low friction</li> <li>Since an idea is abstract and unstructured it is easier to edit it later in a     Gdoc rather than in a GitHub issue</li> </ul>"},{"location":"work_organization/all.issue_workflow.explanation.html#project","title":"Project","text":"<p>Unlike ideas, projects have clear goals, defined scope, tangible outcomes and time constraints.</p> <p>We use GitHub Projects to track projects <code>/docs/work_organization/all.use_github.how_to_guide.md#projects</code>.</p> <p>To go from \"idea\" to \"project\" one needs to perform a through analysis:</p> <ul> <li>Identify a problem</li> <li>Suggest solutions for the problem</li> <li>Split the work into actionable tasks</li> <li>Estimate the complexity</li> </ul> <p>Team leaders are responsible for converting \"ideas\" into \"projects\". The outcome of the analysis is a GitHub Project with clear objectives, start/end dates, assignees and filed GitHub issues.</p>"},{"location":"work_organization/all.issue_workflow.explanation.html#task_issue","title":"Task (Issue)","text":"<p>A task is a specific, actionable item that needs to be completed, often as part of a project. Tasks are usually smaller in scope and more focused on single activities or steps within a project.</p> <p>We use GitHub Issues to track tasks. Every issue should belong to a GH Project <code>/docs/work_organization/all.use_github.how_to_guide.md#issue</code>.</p> <p>Last review: GP on 2024-05-25</p>"},{"location":"work_organization/all.organize_your_work.how_to_guide.html","title":"All.organize your work.how to guide","text":""},{"location":"work_organization/all.organize_your_work.how_to_guide.html#untitled","title":"Untitled","text":""},{"location":"work_organization/all.organize_your_work.how_to_guide.html#golden_rules","title":"Golden rules","text":"<ul> <li>Please <code>watch</code>, <code>star</code> and <code>fork</code> the repo.</li> <li>\"Remember to treat others the way you want to be treated\"</li> <li>Everybody comes from a different place and different skill-level, somebody has     a job, somebody has a full-time work</li> <li>Let's be polite, helpful, and supportive to each other</li> <li>I'll remind you an adage that I tell myself when my teammates drive me crazy:     \"If you want to go fast, go alone; if you want to go far, go together\"</li> <li>While being assigned a warm-up issue:<ul> <li>We highly value the importance of following instructions to ensure efficient     task completion. We intentionally select straightforward and simple issues     as the first tasks for you. So as your first step you should put primary     focus on following the rules. Failure to do so can result in wasting more of     our time than saving it.</li> <li>A pledge to put in the time you committed and not disappear</li> <li>If we don't find that you can meaningfully contribute, we will give you a     warning and help you improve, we will suggest you how to fill in your     knowledge gaps, and start not putting the time to help since we don't have     enough resources</li> <li>If we decide that you are not ready to contribute, we will drop you, without     discussions: this is our sole decision for the good of the project and the     other contributors</li> <li>You can study and try again in 6 months</li> </ul> </li> </ul>"},{"location":"work_organization/all.organize_your_work.how_to_guide.html#roles","title":"Roles","text":""},{"location":"work_organization/all.organize_your_work.how_to_guide.html#tech_leads","title":"Tech leads","text":"<ul> <li> <p>Tech leads are contributors that have put more effort in KaizenFlow and / or     have more experience in research and development</p> </li> <li> <p>The same project (e.g., Web3, Model, Arbitrage, NLP) can have multiple tech     leads</p> <ul> <li>One becomes a tech lead by technical excellence and dedication, and for no     other reason (e.g., seniority or degree)</li> </ul> </li> <li> <p>What tech leads do:</p> <ul> <li>Organize the work in their specific project together with GP / Paul and the     other full-time contributors</li> <li>Help young team members, e.g., answering their questions, showing how we do     things</li> <li>Answer other team members questions, even in different projects</li> <li>Following our process, advertising it, and explaining it to new team members</li> <li>Understand what other people in your team are doing and coordinate with them</li> <li>Make sure code, notebooks, and data are reused and shared</li> </ul> </li> <li> <p>What tech leads gain from being a tech lead:</p> <ul> <li>Learn how to run a research / dev team</li> <li>Practice leadership skills (which mainly entail technical excellence and     patience)</li> <li>Work closely with GP / Paul</li> <li>Material benefits (e.g., higher KaizenFlow bonuses once the reward system is     in place)</li> </ul> </li> </ul>"},{"location":"work_organization/all.organize_your_work.how_to_guide.html#developers","title":"Developers","text":"<ul> <li>People on teams working on the same project or on related projects can:<ol> <li>Work together on the same tasks (you can coordinate on GitHub, Slack, or  do a Zoom)</li> <li>Work together and split the work (still you need coordination)</li> <li>Each can \"replicate\" the work so that both of you understand (no  coordination)</li> </ol> </li> </ul>"},{"location":"work_organization/all.organize_your_work.how_to_guide.html#how_to_organize_your_research","title":"How to organize your research","text":"<ul> <li> <p>The GH issues are for:</p> <ul> <li>Reporting issues (e.g., \"I am getting this error. What should I do?\")</li> <li>Updates (e.g., \"I've made a bunch of progress and the details are in the     gdoc )</li> </ul> </li> <li> <p>Commit the code in a PR (even the same PR) so that it's easier to review the     details together</p> <ul> <li>You can say \"this is what I'm doing, what do you think?\"</li> <li>E.g., create a dir like 'SorrIssueXYZ_...' under     https://github.com/kaizen-ai/kaizenflow/tree/master/sorrentum_sandbox/examples/ml_projects</li> <li>E.g., see the PR under https://github.com/kaizen-ai/kaizenflow/pull/31</li> </ul> </li> <li> <p>Work in the Docker container so that you use the standard flow and it's easy     to collaborate</p> <ul> <li>It's ok if you want to use your different flow, but still try to commit     often</li> </ul> </li> <li> <p>Save all the files in     Project dir</p> <ul> <li>You can use Google Desktop to keep     the dir synced locally on your computer so when you work on your project the     data is always in sync with what others view</li> </ul> </li> <li> <p>Keep a detailed research log in a Google Doc in the     Project dir</p> <ul> <li>Document what you are doing, take screenshot, explain the results</li> <li>You can make progress only if you are organized and consistent</li> </ul> </li> <li> <p>Avoid emails any time possible</p> <ul> <li>Communication should happen on GitHub around specific Issues</li> <li>Read     General Rules of Collaboration     for more details</li> </ul> </li> <li> <p>Use Slack channel/DMs when you are blocked on something</p> <ul> <li>Try to use GitHub Issues when not urgent to provide context</li> <li>Don't abuse Slack, learning what is urgent and what's not</li> </ul> </li> <li> <p>On GitHub</p> <ul> <li>Provide context about the problem</li> <li>Explain clearly what is the problem and what you are trying to do</li> <li>Writing good bug updates is an art that takes time</li> </ul> </li> <li> <p>When you are done with your task and you need more work ping your project chat</p> </li> <li> <p>Work with your team (especially if you are a tech lead)</p> <ul> <li>Answer other people questions</li> <li>Understand what other people in your team are doing</li> <li>Coordinate with them</li> <li>We can only make progress together as a team and not as a single person (get     over being shy)</li> </ul> </li> </ul>"},{"location":"work_organization/all.organize_your_work.how_to_guide.html#about_the_project_you_choose","title":"About the project you choose","text":"<ul> <li>We let you pick the project you like because we believe that one needs to be     excited about something to work on that through the late night, on Sat and     Sunday</li> <li> <p>On the other side, in 15 years of leading, mentoring, hiring, and firing     people I've never found one person not complaining about their project being     \"boring\"</p> <ul> <li>People working on exploratory analysis want to do machine learning</li> <li>People want to do \"machine learning\" when 95% of the machine learning work     is building data pipelines and doing exploratory analysis</li> <li>People running models complain about that being uninspiring and would rather     to do exploratory analysis</li> <li>People writing code want to do machine learning (since that's the cool     stuff!)</li> <li>Software engineers would like to be lawyers (since they want to interact     with people and computers), and lawyers want to be engineers (since they     can't take dealing with people anymore)</li> </ul> </li> <li> <p>The problem is that everything is interesting and boring at the same time. It     depends on your mindset</p> <ul> <li>If you say \"this is boring\", it will be boring for sure</li> <li>If you look for finding interesting pieces in what you need to do, it will     become suddenly super interesting</li> <li>The people that succeed are the ones that do their best at their job no     matter what, that find joy in solving whatever problem brings value</li> </ul> </li> </ul>"},{"location":"work_organization/all.rollout.how_to_guide.html","title":"All.rollout.how to guide","text":""},{"location":"work_organization/all.rollout.how_to_guide.html#rollout","title":"Rollout","text":""},{"location":"work_organization/all.rollout.how_to_guide.html#roll-out_process","title":"Roll-out process","text":"<ul> <li>Implement</li> <li>Prepare documentation</li> <li>Dogfood by RPs or subset of target audience</li> <li>Initial roll-out</li> <li>Full rollout: Distribute it your team</li> <li> <p>Deprecate the old system</p> <ul> <li>The deadline is blah: do it!</li> <li>Shut down from old</li> </ul> </li> <li> <p>File an Issue with the content of the email</p> <ul> <li>The assignee is the person in charge of making sure the rollout is done</li> </ul> </li> <li>Send an ORG email with the same content of the Issue</li> </ul>"},{"location":"work_organization/all.rollout.how_to_guide.html#roll-out_documentation","title":"Roll-out documentation","text":"<ul> <li>A roll-out should address the following points:<ul> <li>Short summary</li> <li>Who is the intended audience</li> <li>What you need to do</li> <li>Where is the reference documentation</li> <li>What has changed</li> <li>Why is it important</li> <li>Whom to ask for help</li> </ul> </li> </ul>"},{"location":"work_organization/all.rollout.how_to_guide.html#an_example_of_roll-out_email","title":"An example of roll-out email","text":"<pre><code>Hello team,\n\n### Intended audience\n\nAnybody using Jupyter notebooks\n\n### What it is about\n\n- `publish_notebook.py` is a little tool that allows to:\n    1. Opening a notebook in your browser (useful for read-only mode)\n     - E.g., without having to use Jupyter notebook (which modifies the file in\n       your client) or github preview (which is slow or fails when the notebook\n       is too large)\n    2. Sharing a notebook with others in a simple way\n    3. Pointing to detailed documentation in your analysis Google docs\n    4. Reviewing someone's notebook\n    5. Comparing multiple notebooks against each other in different browser\n     windows\n    6. Taking a snapshot / checkpoint of a notebook as a backup or before making\n     changes\n     - This is a lightweight alternative to \"unit testing\" to capture the\n       desired behavior of a notebook\n     - One can take a snapshot and visually compare multiple notebooks\n       side-by-side for changes\n\nYou can get details by running: `dev_scripts/notebooks/publish_notebook.py -h`\n\n### What you need to do\n\nPlease update your branches from the `master` for all the submodules.\n\nYou can use our shortcut:\n\n&gt; make git_pull\n\n### What has changed\n\nWe've deployed the new service for storing notebooks in HTML format. From now on\n`publish_notebook.py` will work from the Docker container. The new version of\n`publish_notebook.py` works using HTTP protocol and does not require ssh key\nauthorization as it was before We've synchronized all documents. So all old docs\nalready available on the new service The old links http://research:8077/...\nwon't work from now on, we need to replace them with the new ones\n(http://notebook-keeper.p1/...) If you see any link starts with\nhttp://research:8077 replace them with http://notebook-keeper.p1 .\n\n### Reference documentation\n//amp/docs/coding/all.publish_notebook.how_to_guide.md\n</code></pre>"},{"location":"work_organization/all.scrum.explanation.html","title":"All.scrum.explanation","text":""},{"location":"work_organization/all.scrum.explanation.html#refs","title":"Refs","text":"<ul> <li>From \"Lacey, The Scrum Field Guide: Practical Advice for Your First Year,     2012\"</li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#roles","title":"Roles","text":""},{"location":"work_organization/all.scrum.explanation.html#goal_of_scrum_methodology","title":"Goal of Scrum methodology","text":"<ul> <li>Work in the interests of customers and stakeholders to turn the vision into a     working product</li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#metaphor_for_the_roles_in_terms_of_a_race_car","title":"Metaphor for the roles in terms of a race car","text":"<ul> <li> <p>ProductOwner = driver</p> </li> <li> <p>DevTeam = engine</p> </li> <li> <p>ScrumMaster = lubricants and sensors</p> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#scrummaster","title":"ScrumMaster","text":"<ul> <li> <p>Identify when the team is not performing to its ability</p> </li> <li> <p>Assist in correcting the issues</p> </li> <li> <p>Notice non-verbal cues</p> </li> <li> <p>Is comfortable with conflict</p> </li> <li> <p>Can build trust and earn respect</p> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#productowner","title":"ProductOwner","text":"<ul> <li> <p>Represent the customers</p> </li> <li> <p>Point the car in the correct direction</p> </li> <li> <p>Adjust the car direction to stay on course</p> </li> <li> <p>Make decisions about official release</p> </li> <li> <p>Ultimately he is responsible for success or failure of the projects</p> </li> <li> <p>Decide:</p> <ul> <li>What is developed</li> <li>When it is developed</li> <li>Whether the product meets expectations</li> </ul> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#devteam","title":"DevTeam","text":"<ul> <li> <p>Aka Team, Development team, Core team</p> </li> <li> <p>Developers, testers, architects, designers</p> <ul> <li>Cross-functionality is a good thing</li> </ul> </li> <li> <p>The ideal team size is 6 plus / minus 2</p> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#artifacts","title":"Artifacts","text":""},{"location":"work_organization/all.scrum.explanation.html#product_backlog","title":"Product backlog","text":"<ul> <li> <p>= master list of all features and functionalities needed to implement the     vision into the product</p> </li> <li> <p>The ProductOwner keeps the backlog:</p> <ul> <li>Prioritized</li> <li>Up to date</li> <li>Clear</li> </ul> </li> <li> <p>The backlog is never complete:</p> <ul> <li>Items are added and removed</li> <li>Reordered based on priority, value, or risk</li> </ul> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#product_backlog_items","title":"Product backlog items","text":"<ul> <li> <p>Aka PBI</p> </li> <li> <p>E.g., bugs, features, enhancements, non-functional requirements</p> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#complexity_of_pbi","title":"Complexity of PBI","text":"<ul> <li> <p>ProductOwner and the DevTeam estimate the size of each task</p> </li> <li> <p>The complexity of each task can be expressed in different ways:</p> <ul> <li>Points</li> <li>T-shirt size (S, M, L, XL)</li> </ul> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#high-priority_vs_lower-priority_tasks","title":"High-priority vs lower-priority tasks","text":"<ul> <li> <p>High-priority stories should be small and clear</p> <ul> <li>So they can be brought into the sprint</li> </ul> </li> <li> <p>Lower-priority items can be large and fuzzy</p> <ul> <li>Bigger stories are decomposed into smaller chunks</li> </ul> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#sprint_backlog","title":"Sprint backlog","text":"<ul> <li> <p>= output of the planning meeting</p> </li> <li> <p>List of tasks that need to complete during the sprint</p> </li> <li> <p>Sprint backlog tasks have an estimate in hours</p> </li> <li> <p>The DevTeam keeps the sprint backlog up to date</p> </li> <li> <p>During a sprint</p> <ul> <li>New tasks are discovered</li> <li>Tasks are adjusted (in terms of description or estimated hours)</li> <li>Tasks are marked as done</li> </ul> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#the_burndown","title":"The burndown","text":"<ul> <li> <p>Communicate how much work is remaining and what is the team velocity</p> </li> <li> <p>It is updated at the end of each day</p> </li> <li> <p>Plot the number of hours remaining (y-axis) against the number of days     remaining (x-axis)</p> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#the_meetings","title":"The meetings","text":""},{"location":"work_organization/all.scrum.explanation.html#planning_meeting","title":"Planning meeting","text":"<ul> <li>Each sprint begins with a sprint planning attended by the team, ScrumMaster,     ProductOwner<ul> <li>Typically one needs two hours per number of weeks to plan the sprint</li> <li>For a 1-month sprint, 8 hours of meeting</li> <li>For 2-week sprint, 4 hours of meeting</li> </ul> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#part_one_of_sprint_planning_meeting","title":"Part one of sprint planning meeting","text":"<ul> <li> <p>Review of potential product backlog items for the sprint</p> </li> <li> <p>ProductOwner describes what the goal of the meeting is</p> </li> <li> <p>DevTeam asks questions to drive away ambiguity</p> </li> <li> <p>Outcome is one-sentence description of the desired outcome of the sprint</p> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#part_two_of_sprint_planning_meeting","title":"Part two of sprint planning meeting","text":"<ul> <li> <p>Many DevTeams discuss how to implement the tasks</p> </li> <li> <p>The ProductOwner doesn't need to be present</p> </li> <li> <p>The ScrumMaster can be present facilitating the process</p> </li> <li> <p>The DevTeam discusses and decides the implementation of the tasks</p> </li> <li> <p>Decompose backlog items into work tasks</p> </li> <li> <p>Estimate tasks in terms of hours</p> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#daily_scrum","title":"Daily scrum","text":"<ul> <li> <p>Aka daily stand-up</p> </li> <li> <p>Give the DevTeam the opportunity to sync daily, at the same time, and at the     same place</p> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#daily_scrum_questions","title":"Daily scrum: questions","text":"<ul> <li>The 3 most frequent questions are:<ul> <li>What have you accomplished since the last meeting?</li> <li>What will you accomplish today?</li> <li>What obstacles are in your way?</li> </ul> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#what_the_daily_scrum_is_not","title":"What the daily scrum is not","text":"<ul> <li> <p>The daily scrum is not a deep-dive problem-solving meeting</p> <ul> <li>Any other issues need to be taken offline</li> </ul> </li> <li> <p>It is not a status report meeting to the ScrumMaster</p> <ul> <li>The purpose is for the DevTeam members to talk to each other</li> </ul> </li> <li> <p>The ProductOwner is in \"listen-only\" mode</p> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#sprint_review","title":"Sprint review","text":"<ul> <li> <p>On the last day of the sprint, the DevTeam holds a sprint review</p> </li> <li> <p>Everybody should join</p> <ul> <li>ScrumMaster</li> <li>ProductOwner</li> <li>DevTeam</li> <li>Customers, key stakeholders</li> <li>Executives</li> </ul> </li> <li> <p>DevTeam</p> <ul> <li>Recaps the goal of the sprint</li> <li>Presents the work done</li> </ul> </li> <li> <p>Customers</p> <ul> <li>Review the progress made on the project</li> <li>Accept changes</li> <li>Ask for changes</li> </ul> </li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#sprint_retrospective","title":"Sprint retrospective","text":"<ul> <li>After the sprint review, the retrospective is a way to identify how to improve     process and execution</li> </ul>"},{"location":"work_organization/all.scrum.explanation.html#sprint_retrospective_questions","title":"Sprint retrospective: questions","text":"<ul> <li> <p>What went well during the sprint?</p> </li> <li> <p>What could be improved in the next sprint?</p> </li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html","title":"All.team collaboration.how to guide","text":""},{"location":"work_organization/all.team_collaboration.how_to_guide.html#general_rules_of_collaboration","title":"General Rules of Collaboration","text":"<ul> <li>We are not going to discuss and debate the rationale behind the following     suggestions, but we assume that all is self-evident truth</li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#ask_somebody_if_you_have_any_doubts","title":"Ask somebody if you have any doubts","text":"<ul> <li>If you have doubts on how to do something you want to do:<ul> <li>Look in the documentation and our Google drive folders     Process     and Tech</li> <li>Try Google search/ChatGPT</li> </ul> </li> <li>If you still can't find the answer, ask your team members<ul> <li>Learn     how to ask questions     first</li> <li>Note that often people tell you his / her interpretation or their workaround     for a problem, which might not be the best approach, so be careful and     always think for yourself</li> <li>Don't hesitate to ask anyone, including GP &amp; Paul</li> </ul> </li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#ping_team_leaders_when_you_are_out_of_tasks","title":"Ping Team Leaders when you are out of tasks","text":"<ul> <li>When you're close to being out of tasks or all your ongoing PRs are waiting     for review and are close to being merged, feel free to ping us in the IM and     ask for more issues<ul> <li>IM = Telegram for interns / Slack for permanent team members</li> </ul> </li> <li>In this way, Team Leaders can quickly assign you another issue, before you run     out of work</li> <li>Everyone should have 2 issues to work on at the same time to avoid getting     blocked on others</li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#collaboration_for_problem_solving","title":"Collaboration for problem solving","text":"<ul> <li>Identify a problem and describe it in the issue</li> <li>Try your best to find a solution independently and outline the design in the     issue</li> <li>If in doubt, seek guidance from a more experienced team member</li> <li>Communicate with the team and reach consensus on the solution</li> <li>NB:<ul> <li>Not every step requires explicit approval. In our team members, we value     autonomy and ability to get things done</li> <li>Keep our usual conventions and workflows in mind. For example, usually there     is no need to ask \"Do we need to add unit tests for this?\" or \"Do we also     want this documented?\" - the answer is almost always \"YES\", so just doing it     saves time, shows proactivity and ability to follow processes</li> </ul> </li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#collaboration","title":"Collaboration","text":""},{"location":"work_organization/all.team_collaboration.how_to_guide.html#why_do_we_need_to_follow_this_handbook","title":"Why do we need to follow this handbook?","text":""},{"location":"work_organization/all.team_collaboration.how_to_guide.html#learning_from_each_other","title":"Learning from each other","text":"<ul> <li>Proper research and software engineering practices allow us to:<ul> <li>Learn from each other</li> <li>Accumulate and distill the wisdom of experts</li> <li>Share lessons learned from our mistakes along the way</li> </ul> </li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#consistency_and_process","title":"Consistency and process","text":"<ul> <li>Consistency is a crucial enabler to make teams faster</li> <li>Productivity increases when team members \"work in the same way\", i.e., there     is a single official way of performing a task, so that it's possible and easy     to:<ul> <li>Re-use research and software components</li> <li>Help each other in debugging issues</li> <li>Add/transfer new people to teams</li> <li>Work on multiple projects simultaneously</li> <li>Learn from each other's experience and mistakes</li> <li>Review each other's work looking for errors and improvements</li> <li>...</li> </ul> </li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#sync-ups","title":"Sync-ups","text":"<ul> <li>We meet regularly every week and with different audiences to check on the     progress of the projects we work on</li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#company_town-hall_meetings","title":"Company town-hall meetings","text":"<ul> <li>They usually happen on the first Monday of each month and have the following     goals:<ul> <li>Summarize ongoing projects and their status<ul> <li>Share the achieved milestones</li> <li>Discuss blocking tasks across projects</li> </ul> </li> <li>Discuss topics of general interest<ul> <li>E.g., organization, process</li> </ul> </li> <li>Talk about the team, hiring, customers</li> </ul> </li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#technical_sync-ups","title":"Technical sync-ups","text":"<ul> <li>We meet one or two times per week for each of the projects (e.g., IM, WEB3)</li> <li>Please check your calendar to make sure the times work and the invited     participants are correct</li> <li>The people running the day-to-day project should update the meeting agenda in     the Gdoc<ul> <li>Try to do it one day before so that everybody knows ahead of time what we     need to talk about and can come prepared</li> </ul> </li> <li>Typically 2-3 issues are more than enough to fill one hour of discussion<ul> <li>Give priority to tasks that are controversial, blocking, or finished</li> <li>No reason to linger on the successes or the easy stuff</li> </ul> </li> <li>Send an email or tag a comment to Gdocs to broadcast the agenda</li> <li>It's ok to skip a meeting when the agenda is empty, or keep it short when     there is not much to discuss<ul> <li>We don't have to fill one hour every time</li> </ul> </li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#ad-hoc_meetings","title":"Ad-hoc meetings","text":"<ul> <li>Don't hesitate to ask for a quick meeting if you are unsure about:<ul> <li>What exactly needs to be done in a GitHub Issue</li> <li>How to set-up something (e.g., environment, docker)</li> </ul> </li> <li>Better safe than sorry</li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#org_emails","title":"Org emails","text":"<ul> <li>GP &amp; Paul may send emails with the subject starting with \"ORG:\" pointing to     interesting docs that are of general interest and relevance</li> <li>Please make sure to read the docs carefully and internalize what we suggest to     do and, especially, the rationale of the proposed solutions</li> <li>It's ok to acknowledge the email replying to <code>eng@causify.ai</code></li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#synchronization_point","title":"Synchronization point","text":"<ul> <li>We understand that most of the time everybody is head-down making progress on     their tasks<ul> <li>This is great!</li> </ul> </li> <li>However, sometimes we need synchronization:<ul> <li>We need to stop the progress for a bit when requested</li> <li>Do an urgent task</li> <li>Acknowledge that the task is done</li> <li>Go back to pushing</li> </ul> </li> <li>The procedure is:<ul> <li>One of us (e.g., GP or Paul) creates a GitHub task, with:<ul> <li>Detailed instructions</li> <li>The list of all of the persons in charge of executing the task</li> </ul> </li> <li>Send a ping with the link on Slack if the task is urgent</li> <li>Everybody does what's asked</li> <li>Mark on the GitHub task your name</li> </ul> </li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#morning_todo_email","title":"Morning TODO email","text":"<p>The idea is to send a morning TODO email to broadcast:</p> <ul> <li>Issues you will be working on</li> <li>Working hours</li> <li> <p>Blocking issues/PRs</p> </li> <li> <p>E-mail template:     <pre><code>To: eng@causify.ai\n\nSubject: TODO\n\nHi all,\n\nToday I am going to work\n\nHours:\n- ...\n\nIssues:\n- GitHub issue title and number with a hyperlink\n - ETA: YYYY-MM-DD\n- GitHub issue title and number with a hyperlink\n - Original ETA: YYYY-MM-DD\n - ETA: YYYY-MM-DD\n - Reason for ETA update: ...\n - Blocked on: ... (ok to omit if not blocked)\n</code></pre></p> </li> <li> <p>Good example:     <pre><code>To: eng@causify.ai\n\nSubject: TODO\n\nHi all,\n\nToday I am going to work\n\nHours:\n- 8\n\nIssues:\n- Create matching service #261\n        - ETA: today (2023-05-25)\n        - Original ETA: yesterday (2023-05-24)\n        - Reason for ETA update: it was more complex than what we thought\n        - Blocked on: PR review from Grisha\n- Create linear supply/demand curves #177\n        - ETA: tomorrow (2023-05-26)\n- Unit test `compute_share_prices_and_slippage()` #8482\n        - ETA: 2024-06-19\n</code></pre></p> </li> <li> <p>Bad example:     <pre><code>To: eng@causify.ai\n\nSubject: to-do\n\nHi all,\n\nToday I am going to work 2-6 hours.\n- Calls\n- PR reviews\n- Finish the trading report analysis\n</code></pre></p> </li> <li> <p>The goal is:</p> <ul> <li>Think about what you are going to work on for the day, so you have a clear     plan</li> <li>Let Team Leaders know that you're going to work today and what is your     workload</li> <li>Make sure people blocked on your tasks know that / whether you are working     on those tasks</li> <li>Broadcast if you are blocked or if you don't have tasks</li> <li>A TODO email replaces stand-up meetings</li> </ul> </li> <li>When to send an email:<ul> <li>Within the first hour of beginning the day<ul> <li>There is no hard deadline, given that we have people working from     different time zones. Doing it first thing in the morning ensures one     doesn't forget</li> </ul> </li> <li>It is recommended to check the inbox (email, GitHub) first to reflect all     the update in the plan for the day</li> </ul> </li> <li>Send an email to:<ul> <li>For permanent team members/people on a 3-month trial: <code>eng@causify.ai</code></li> <li>For interns or collaborators: <code>contributors@causify.ai</code></li> </ul> </li> <li>Email subject:<ul> <li><code>TODO</code> (all caps)</li> <li>It makes it easier to filter emails by subject</li> </ul> </li> <li>Reply to your previous TODO email so that at least last week of TODOs is     included</li> <li>Specify how many hours are you going to work today<ul> <li>On Monday we also specify an estimation for a week</li> <li>No need to be too specific, give just an approximation</li> </ul> </li> <li>List all the tasks you're going to work during the day in priority order<ul> <li>Add a hyperlink to the corresponding GitHub issue to each task in order to     ease the navigation </li> <li>For each task provide an ETA<ul> <li>You always estimate the ETA yourself, based on the task's difficulty,     priority and your workload</li> <li>No reason to be optimistic: complex things take time to be done correctly</li> <li>Use a date in the YYYY-MM-DD format, e.g. 2023-05-20</li> <li>When possible, add \"today\", \"yesterday\", \"tomorrow\", \"end of week\" so that     it's easier to parse<ul> <li>\"End of week\" generally means Friday, although it can be extended if you     are planning to work on the weekend (provide the date to clarify)</li> <li>If nothing is applicable, it's okay to just provide the date</li> </ul> </li> <li>If the originally set ETA has not been changed yet, omit \"Original ETA\"     and \"Reason for ETA update\"</li> <li>If your original ETA needs to be updated (e.g., you thought that you would     have finished a task by yesterday, but it's taking longer), keep the older     ETA (as \"Original ETA\") and add the new one (as \"ETA\")</li> </ul> </li> </ul> </li> <li>Report the PR/issue blocked</li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#communication","title":"Communication","text":""},{"location":"work_organization/all.team_collaboration.how_to_guide.html#use_the_right_form_of_communication","title":"Use the right form of communication","text":"<ul> <li>GitHub<ul> <li>This is a major form of communication about technical details, so if you     have any questions about any particular issue or PR, discuss it there first,     e.g.:<ul> <li>Clarify issue specs</li> <li>Ask for help with debugging</li> <li>PR reviews</li> </ul> </li> </ul> </li> <li>Asana<ul> <li>Is concerned with all the non-technical issues in general, e.g.:<ul> <li>Work organization tasks</li> <li>Marketing and funding</li> <li>On-boarding process</li> </ul> </li> </ul> </li> <li>Slack<ul> <li>This is our messenger for tight interaction (like a debug session) or     immediacy (e.g., \"are you ready for the sync up?\")</li> <li>Please, avoid discussing anything that can be discussed at GitHub or Asana<ul> <li>You often need to reference some comments and ideas in other places like     issues or messages and it is impossible to reference a Slack message     outside of it</li> <li>It is much easier for all reviewers to catch up with all the thinking     process if it is logged at one place - Slack is never a place for this</li> </ul> </li> </ul> </li> <li>Jupyter notebooks<ul> <li>Generally used to implement and describe research in detail<ul> <li><code>Master</code> notebooks are intended to be used as tools for demonstrative     analysis with visible stats and plots</li> </ul> </li> </ul> </li> <li>Markdown files<ul> <li>Document instructions, process, design closely related to code</li> <li>Notes that need to be close to the code itself</li> <li>Documents that need to be authoritative and long-term (e.g., reviewed,     tracked carefully)</li> </ul> </li> <li>Google docs<ul> <li>Document research in a descriptive way</li> <li>Explain what are the results independently on how they were reached</li> </ul> </li> <li>Emails<ul> <li><code>TODO</code>s primarily</li> <li>Rarely used for any other purpose</li> <li>Exceptions are to send non-urgent information to everybody</li> </ul> </li> <li>There should be little replication among these forms of documentation<ul> <li>It's not ok to file a bug and then ping on Slack unless it's urgent</li> </ul> </li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#dry_also_applies_to_documentation","title":"DRY also applies to documentation","text":"<ul> <li>DRY! Do not Repeat     Yourself</li> <li>E.g., it's not a good idea to cut &amp; paste pieces of Gdocs in a GitHub bug,     rather just point to the relevant session on Gdocs from the GitHub bug</li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#avoid_write-once_code_and_research","title":"Avoid write-once code and research","text":"<ul> <li>Code and research is:<ul> <li>Written once by a few people</li> <li>Read many times by many people</li> </ul> </li> <li>Therefore it is essential to invest in the process of writing it heavily</li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#consistency","title":"Consistency","text":"<ul> <li>Coding/research across our group is done with consistent procedures, code     layout, and naming conventions</li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#training_period","title":"Training period","text":"<ul> <li>When you start working with us, you need to go through a period of training in     following the procedures and conventions described in this handbook</li> <li>We understand that this is a painful process for you:<ul> <li>You need to change your old habits for new habits that you might disagree     with, or not comprehend</li> <li>You need to rework your code/notebooks that are already correctly working     until it adheres to the new conventions</li> </ul> </li> <li>Understand that this is also a painful process for the reviewers:<ul> <li>On top of their usual workload, they need to:<ul> <li>Invest time to explain to you how we do things</li> <li>Answer your questions</li> <li>Try to convey the sense of why these procedures are important</li> </ul> </li> </ul> </li> <li>In a few words, nobody enjoys this process, and yet it is necessary,     mandatory, and even beneficial</li> <li>The process acquaintance can take several days if you are open and patient,     but months if you resist or treat it as an afterthought<ul> <li>Our suggestion is to accept these rules as the existence of gravity</li> </ul> </li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#go_slowly_to_go_faster","title":"Go slowly to go faster","text":"<ul> <li>Once you reach proficiency, you will be moving much faster and make up for the     invested time<ul> <li>In fact, everyone will be much quicker, because everyone will be able to     look at any part of the codebase or any notebook and get oriented quickly</li> </ul> </li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#vacationsooto_time","title":"Vacations/OOTO time","text":"<ul> <li>We use     vacation calendar     to announce time off</li> <li>If you are a part of @all mailing group you should be able to access this     calendar with your company email</li> <li>Create an event in it, whenever you have planned time off in order to let your     colleagues know in advance</li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#improve_your_english","title":"Improve your English!","text":"<ul> <li>Make sure you have English checker in all your tools:<ul> <li>Pycharm: you can use     this plugin</li> <li>Vim: <code>set spell</code></li> <li>Google docs: Grammarly</li> <li>GitHub and web: Grammarly</li> <li>Email client: TBD</li> </ul> </li> <li>These tools are going to help you improve since you can see the mistake as you     go</li> <li>Feel free to use Google Translate when you     are not sure about a word or a phrase</li> <li>What's the point of doing an excellent job if you can't communicate it?</li> </ul>"},{"location":"work_organization/all.team_collaboration.how_to_guide.html#study_an_english_grammar_book","title":"Study an English grammar book","text":"<ul> <li>I used     this     when I learned English (late in life at 25 starting from     no-English-whatsoever, so you can do it too)</li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html","title":"All.use github.how to guide","text":""},{"location":"work_organization/all.use_github.how_to_guide.html#use_github","title":"Use Github","text":""},{"location":"work_organization/all.use_github.how_to_guide.html#introduction","title":"Introduction","text":"<ul> <li>In the following we use the abbreviations below:<ul> <li>GH = GitHub</li> <li>PR = Pull Request</li> <li>RP = Responsible party (aka Team Leader)</li> </ul> </li> <li>Everything we work on comes in the form of a GH Issues<ul> <li>We call GH Issues \"issues\", and \"tasks\", (sometimes \"tickets\")     interchangeably</li> <li>We avoid to call them bugs since many times we use GH to track ideas,     activities, and improvements, and not only defects in the code</li> <li>We file tasks, prioritize them, and distribute the workload across the team</li> <li>We try to always work on high priority (aka, P0) tasks</li> </ul> </li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#concepts","title":"Concepts","text":""},{"location":"work_organization/all.use_github.how_to_guide.html#sprints","title":"Sprints","text":"<ul> <li>Sprints are weekly, Monday - Friday and consist of the Issues worked on during     the week</li> <li>Sprints help us answer the questions<ul> <li>What work should the team be focusing during this week?</li> <li>What did the team achieve last week?</li> </ul> </li> <li>Anything worked on during a week is added to that week's Sprint</li> <li>Issues added to a Sprint but not worked on or completed during the week should     not be removed (Issues can belong to more than one Sprint, and not removing     helps measure how \"overloaded\" a Sprint was)</li> <li>Each week's Sprint has Issues added to it by Team Leaders before Monday's work     begins</li> <li>Every Issue in a Sprint should be linked to a GH project</li> <li>To support adaptability and flexibility, Issues may be added to a Sprint     mid-week (but Issues should not be removed). While this may require     sacrificing other Issues in the Sprint, the point is to make the trade-off     apparent</li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#projects","title":"Projects","text":"<ul> <li>GitHub Projects are thematic groups of Issues that are somehow related by     their topic<ul> <li>It may take multiple Sprints to complete all the Issues in an Project</li> <li>Most Projects are created around software components or user workflows     (which may cross software components)</li> </ul> </li> <li>For more information on GH Projects, see     all.github_projects_process.reference.md</li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#issue","title":"Issue","text":"<ul> <li>Each Issue is a piece of work to be done</li> <li>Issues are combined into Projects by topic</li> <li>An Issue has certain characteristics, i.e. labels</li> <li>An Issue has a progress status, (e.g., <code>Todo</code>, <code>In progress</code>, <code>Done</code>)</li> <li>PRs are linked to work needed to complete an Issue</li> <li>An issue might not have an assignee but before execution of course it needs to     be resolved</li> <li>An issue may be labeled as \"Epic\" if it has associated sub-issues.<ul> <li>However, this is not a standard in our workflow.</li> </ul> </li> <li>See also     all.issue_workflow.explanation.md     for the description of the concept of Issues as opposed to Ideas/Projects.</li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#gh_actions","title":"GH Actions","text":"<ul> <li>GitHub Actions are used to automate tasks like running tests, checking     coverage, and deploying artifacts across our repositories</li> <li>Each workflow is defined in <code>.yml</code> files located under <code>.github/workflows/</code> in     each repo</li> <li>These actions run automatically based on defined triggers such as pushes, pull     requests, or scheduled events</li> </ul> <p>Disabling a GitHub Actions Workflow</p> <p>To disable a particular GitHub Actions workflow without deleting or commenting out the code:</p> <ul> <li>Rename the file so that GitHub no longer recognizes it as a valid workflow:     <pre><code>mv .github/workflows/ci.yml .github/workflows/ci.yml.DISABLED\n</code></pre></li> <li>This prevents GitHub from executing the workflow, while preserving the file     for future use or reference</li> <li>We follow this convention consistently across repos to make it visually     obvious when a workflow is intentionally deactivated</li> <li> <p>Note: Only files ending in <code>.yml</code> or <code>.yaml</code> are treated as valid workflows by     GitHub</p> <p>For example, read about of our repos with workflows: - Helpers:     all.gitleaks_workflow.explanation.md</p> </li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#label","title":"Label","text":"<ul> <li>Labels are attributes of an issue (or PR), e.g., <code>good first issue</code>,     <code>PR_for_reviewers</code>, <code>duplicate</code>, etc.</li> <li>See the current list of labels and their descriptions at     Git Issue Labels<ul> <li>The repos should always have labels in sync</li> </ul> </li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#list_of_labels","title":"List of Labels","text":"<ul> <li><code>Blocking</code>: This issue needs to be worked on immediately</li> <li><code>Bug</code>: Something isn't working</li> <li><code>Cleanup</code></li> <li><code>Design</code></li> <li><code>Documentation</code>: Improvements or additions to documentation</li> <li><code>Enhancement</code>: New feature or request</li> <li><code>Epic</code>: A high-level issue, possibly encompassing sub-issues</li> <li><code>good first issue</code>: Good for newcomers     &gt; TODO(gp): <code>Good_first_issue</code></li> <li><code>Outsource</code>: Anybody can do it</li> <li><code>P0</code>: Issue with a high priority</li> <li><code>P1</code>: Issue is important but has less priority</li> <li><code>P2</code>: Issue which is not urgent and has the lowest priority</li> <li><code>Paused</code>: An issue was started and then stopped</li> <li><code>PR_for_authors</code>: The PR needs authors to make changes</li> <li><code>PR_for_reviewers</code>: The PR needs to be reviewed by team leaders     &gt; TODO(gp): -&gt; <code>PR_for_team_leaders</code></li> <li><code>PR_for_integrators</code>: The PR needs to be reviewed by Integrators and possibly     merged</li> <li><code>Readings</code>: Reading a book, article and getting familiar with code</li> <li><code>To close</code>: An issue can be potentially closed     &gt; TODO(gp): -&gt; To_close</li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#status","title":"Status","text":"<ul> <li>Each Issue in a Project is assigned a progress status</li> <li>We have the following status options:<ul> <li><code>Todo</code><ul> <li>Issues that are new, where the work has not started yet</li> <li><code>assignee</code> should be the tech lead of that area</li> </ul> </li> <li><code>In Progress</code><ul> <li>Issues that we are currently being worked on</li> </ul> </li> <li><code>In Review</code><ul> <li>Issues opened for review and testing</li> <li>Code is ready to be merged pending feedback</li> </ul> </li> <li><code>PR back to author</code><ul> <li>Feedback has been given on a PR, awaiting updates from the author</li> </ul> </li> <li><code>QA</code></li> <li><code>Done</code><ul> <li>Issues that are done and are waiting for closing</li> <li>Integrators / team leaders are responsible for closing</li> </ul> </li> </ul> </li> </ul> <pre><code>stateDiagram\n        [*] --&gt; Todo\n        Todo --&gt; In_Progress\n        In_Progress --&gt; In_Review\n        In_Review --&gt; PR_back_to_author\n        PR_back_to_author --&gt; In_Review\n        In_Review --&gt; QA\n        QA --&gt; Done\n        Done --&gt; [*]</code></pre>"},{"location":"work_organization/all.use_github.how_to_guide.html#pr","title":"PR","text":"<ul> <li>A pull request (PR) is an event where a contributor asks to review code they     want to merge into a project</li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#issue_workflows","title":"Issue Workflows","text":""},{"location":"work_organization/all.use_github.how_to_guide.html#naming_an_issue","title":"Naming an Issue","text":"<ul> <li>Use an informative description, typically in the form of an action<ul> <li>E.g., \"Do this and that\"</li> </ul> </li> <li>Do not put too many details in the title making it too long<ul> <li>E.g., the full path to the file where the changes should be made is better     suited for the starting post, not the title</li> </ul> </li> <li>We don't use a period at the end of the title</li> <li> <p>We prefer to avoid too much capitalization to make the Issue title easy to     read and for consistency with the rest of the bugs</p> <p>Good</p> <pre><code>Optimize Prometheus configuration for enhanced Kubernetes monitoring\n</code></pre> <p>Bad</p> <pre><code>Optimize Prometheus Configuration for Enhanced Kubernetes Monitoring\n</code></pre> </li> <li> <p>They are equivalent, but the first one is more readable</p> </li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#filing_a_new_issue","title":"Filing a New Issue","text":"<ul> <li>If it is a \"serious\" problem (bug) put as much information about the Issue as     possible, e.g.,:<ul> <li>What you are trying to achieve</li> <li>Command line you ran, e.g.,     <pre><code>&gt; i lint -f defi/tulip/test/test_dao_cross_sol.py\n</code></pre></li> <li>Copy-paste the error and the stack trace from the command line, no     screenshots, e.g.,     <pre><code>Traceback (most recent call last):\n    File \"/venv/bin/invoke\", line 8, in &lt;module&gt;\n        sys.exit(program.run())\n    File \"/venv/lib/python3.8/site-packages/invoke/program.py\", line 373, in run\n        self.parse_collection()\nValueError: One and only one set-up config should be true:\n</code></pre></li> <li>The log of the run<ul> <li>Maybe the same run using <code>-v DEBUG</code> to get more info on the problem</li> </ul> </li> <li>What the problem is</li> <li>Why the outcome is different from what you expected</li> </ul> </li> <li>Use check boxes for \"small\" actions that need to be tracked in the Issue (not     worth their own Issue)<ul> <li>An issue should be closed only after all the checkboxes have been addressed     OR the remaining checkboxes were either transformed into new issues in their     own right (e.g. if the implementation turned out to be more complex than     initially thought) OR have a reason for not being implemented</li> <li>These things should be mentioned explicitly before closing the issue     (Element of Least Surprise.).</li> </ul> </li> <li>We use the <code>FYI @...</code> syntax to add \"watchers\"<ul> <li>E.g., <code>FYI @cryptomtc</code> so that he receives notifications for this issue</li> <li>Authors and assignees receive all the emails in any case</li> <li>In general everybody should be subscribed to receiving all the notifications     and you can quickly go through them to know what's happening around you</li> </ul> </li> <li>Assign an Issue to the right person<ul> <li>There should be a single assignee to a Issue so we know who needs to do the     work</li> <li>Assign to yourself if you are going to work on it</li> <li>Assign Integrators / Team leaders if not sure</li> </ul> </li> <li>If you are not sure, leave it unassigned but <code>@tag</code> Integrators / team leaders     to make sure we can take care of it</li> <li>Assign an Issue to the right Project and Label<ul> <li>Use <code>Blocking</code> label when an issue needs to be handled immediately, i.e. it     prevents you from making progress</li> <li>If you are unsure then you can leave it empty, but <code>@tag</code> Integrator / team     leaders to make sure we can re-route and improve the Projects/Labels</li> </ul> </li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#updating_an_issue","title":"Updating an Issue","text":"<ul> <li>For large or complex Issues, there should be a design phase (in the form of GH     Issue, Google Doc, or design PR) before starting to write a code<ul> <li>A team leader / integrator should review the design</li> </ul> </li> <li>When you start working on an Issue, change its status to <code>In Progress</code><ul> <li>Try to use <code>In Progress</code> only for Issues you are actively working on</li> <li>A rule of thumb is that you should not have more than 2-3 <code>In Progress</code>     Issues</li> <li>Give priority to Issues that are close to being completed, rather than     starting a new Issue</li> </ul> </li> <li>Update an Issue on GH often, like at least once a day of work<ul> <li>Show the progress to the team with quick updates</li> <li>Update your Issue with pointers to gdocs, PRs, notebooks</li> <li>If you have questions, post them on the bug and tag people</li> </ul> </li> <li>Once the task, in your opinion, is done, change the status to <code>To Review</code> so     that Integrator / team leaders can review it</li> <li>If we decide to stop the work, add a <code>Paused</code> label</li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#closing_an_issue","title":"Closing an Issue","text":"<ul> <li>A task is closed when PR has been reviewed and merged into <code>master</code></li> <li>When, in your opinion, there is no more work to be done on your side on an     Issue, change its status to <code>Done</code> but do not close it<ul> <li>Integrators / team leaders will close it after review</li> </ul> </li> <li>If you made specific assumptions, or if there are loose ends, etc., add a     <code>TODO(user)</code> or file a follow-up Issue</li> <li>Done means that something is \"DONE\", not \"99% done\"<ul> <li>\"DONE\" means that the code is tested, readable, and usable by other     teammates</li> </ul> </li> <li>Together we can decide that 99% done is good enough, but it should be a     conscious decision and not comes as a surprise</li> <li>There should be a reason when closing an issue<ul> <li>E.g. - closing as PR is merged</li> <li>E.g. - closing since obsolete</li> </ul> </li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#pr_workflows","title":"PR Workflows","text":""},{"location":"work_organization/all.use_github.how_to_guide.html#pr_labels","title":"PR Labels","text":"<ul> <li><code>PR_for_authors</code><ul> <li>There are changes to be addressed by an author of a PR</li> </ul> </li> <li><code>PR_for_reviewers</code><ul> <li>PR is ready for review by team leaders</li> </ul> </li> <li><code>PR_for_integrators</code><ul> <li>PR is ready for the final round of review by Integrators, i.e. close to     merge</li> </ul> </li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#filing_a_new_pr","title":"Filing a New PR","text":""},{"location":"work_organization/all.use_github.how_to_guide.html#general_tips","title":"General Tips","text":"<ul> <li>Implement a feature in a branch (not <code>master</code>), once it is ready for review     push it and file a PR via GH interface</li> <li>We have <code>invoke</code> tasks to automate some of these tasks:     <pre><code>&gt; i git_branch_create -i 828\n&gt; i git_branch_create -b Cmamp723_hello_world\n&gt; i gh_create_pr\n</code></pre></li> <li>If you want to make sure you are going in a right direction or just to confirm     the interfaces you can also file a PR to discuss</li> <li>Mark PR as draft if it is not ready, use the <code>Convert to draft</code> button<ul> <li> <p>Draft PR should be filed when there is something to discuss with and     demonstrate to the reviewer, but the feature is not completely implemented</p> <p></p> </li> </ul> </li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#filing_process","title":"Filing Process","text":"<ul> <li>The title of the PR should match the name of the branch<ul> <li>Look at the existing PRs in the repo for examples</li> </ul> </li> <li>Add a description to help reviewers to understand what it is about and what     you want the focus to be</li> <li>Add a pointer in the description to the issue that PR is related to - this     will ease the GH navigation for you and reviewers<ul> <li>Do not link the PR to the issue through the dedicated GH functionality.     The reason is that when they are linked, GH automatically closes the issue     when the PR is merged, and this is inconvenient if there is more work to do.     We always want to have control over when the issue is closed.</li> <li>Sometimes GH creates these links itself - usually when the PR description     contains keywords like \"Fixes #\". So please avoid such     phrasing and instead use something more abstract like \"Related to     #\". <li>Put yourself in the \"Assignees\" field</li> <li>Add reviewers to the reviewers list<ul> <li>For optional review just do <code>FYI @username</code> in the description</li> </ul> </li> <li>Add a corresponding label<ul> <li>Usually the first label in the filed PR is <code>PR_for_reviewers</code></li> <li>If it is urgent/blocking, use the <code>Blocking</code> label</li> </ul> </li> <li>Make sure that the corresponding tests pass</li> <li>Always lint (and commit files modified by Linter) before asking for a review</li>"},{"location":"work_organization/all.use_github.how_to_guide.html#review","title":"Review","text":"<ul> <li>A reviewer should check the code:<ul> <li>Architecture</li> <li>Conformity with specs</li> <li>Code style conventions</li> <li>Interfaces</li> <li>Mistakes</li> <li>Readability</li> </ul> </li> <li>There are 2 possible outcomes of a review:<ul> <li>There are changes to be addressed by author<ul> <li>A reviewer leaves comments to the code</li> <li>Marks PR as <code>PR_for_authors</code></li> </ul> </li> <li>A PR is ready to be merged:<ul> <li>Pass it to integrators and mark it as <code>PR_for_integrators</code><ul> <li>Usually is placed by team leaders after they approve PR</li> </ul> </li> </ul> </li> </ul> </li> </ul>"},{"location":"work_organization/all.use_github.how_to_guide.html#addressing_a_comment","title":"Addressing a Comment","text":"<ul> <li>If the reviewer's comment is clear to the author and agreed upon:<ul> <li>The author addresses the comment with a code change and after changing the     code (everywhere the comment applies) marks it as <code>RESOLVED</code> on the GH     interface</li> <li>Here we trust the authors to do a good job and to not skip / lose comments</li> <li>If the comment needs further discussion, the author adds a note explaining     why he/she disagrees and the discussion continues until consensus is reached</li> </ul> </li> <li>Once all comments are addressed:<ul> <li>Re-request the review</li> <li>Mark it as <code>PR_for_reviewers</code></li> </ul> </li> </ul>"}]}